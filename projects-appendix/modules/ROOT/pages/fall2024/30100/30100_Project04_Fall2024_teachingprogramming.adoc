= 301 Project 04 - Introduction to Linear Regression I

== Project Objectives

To understand the core components of a simple linear regression model.

== Reading and Resources

- [An Introduction to Statistical Learning](https://www.statlearning.com/)

== Dataset

- '/anvil/projects/tdm/data/youtube/USvideos.csv'

[source,python]
----
import pandas as pd

# Load the dataset
my_df = pd.read_csv('/anvil/projects/tdm/data/youtube/USvideos.csv')

# Display the first few rows of the dataset
print(my_df.head())
----

[NOTE]
====

Linear regression is a simple modeling technique that takes input (independent) variables and attempts to predict an output (dependent) variable. For example, taking the number of views (independent variable) and trying to predict the number of likes (dependent variable). Linear regression focuses on a continuous dependent variable (can take on any numeric value and isn't ordered).
====
=== Question 1 (2 points)
.. What is the size of the dataset ( How many rows and columns )?
.. Based on the explanation, identify the independent and dependent variables in the dataset.
.. Based on the initial exploration, what are the mean, median, and standard deviation of the median value of the dependent variable?
 
 
[NOTE]
====
Linear regression is a method that allows us to predict new values! If the model can learn enough about the patterns in the existing data, it can attempt to predict new values. Note that the model assumes that the predictions follow a similar specific pattern, both now and in the future. If they don't, the model won't do very well. There are other modeling techniques that handle different data patterns. Linear regression is also a core technique that many more advanced modeling types build off of.

====

=== Question 2 ( 2 points)

.. Create a scatter plot for views vs likes
.. Why is it important to visualize the data before building a model? What patterns can you observe from the scatter plot?

[NOTE]
====
We can remove outliers, clean the dataset by removing extreme values that could skew the analysis to make data more clean. Python has a library scipy provide utilities for this purpose. 

[source,python]
----
from scipy.stats import zscore
from sklearn.linear_model import LinearRegression

my_df['z_scores'] = zscore(df['views'])
my_df = my_df[my_df['z_scores'].abs()<3]
my_df = df.drop(columns=['z_scores'])
----
====
=== Question 3 (2 points)

.. Visualize the distribution and boxplot for the 'views' column before and after removing outliers. How do the plots differ?

[source,python]
----
# Plotting the distributions and boxplots before removing outliers
plt.figure(figsize=(12, 6))

plt.subplot(1, 2, 1)
plt.title('Distribution Plot - Before Outlier Removal')
sns.histplot(my_df['views'], kde=True)

plt.subplot(1, 2, 2)
plt.title('Boxplot - Before Outlier Removal')
sns.boxplot(y=my_df['views'])

plt.tight_layout()
plt.show()

# Plotting the distributions and boxplots after removing outliers
plt.figure(figsize=(12, 6))

plt.subplot(1, 2, 1)
plt.title('Distribution Plot - After Outlier Removal')
sns.histplot(cleaned_df['views'], kde=True)

plt.subplot(1, 2, 2)
plt.title('Boxplot - After Outlier Removal')
sns.boxplot(y=cleaned_df['views'])

plt.tight_layout()
plt.show()
----
[NOTE]
===
Outlier Removal**: Helps to .
- **Scaling**: Normalizes the data to ensure that features contribute equally to the model, improving model performance and convergence.


[NOTE]
====
We build a linear regression model by fitting a line to the data. The line is chosen to minimize the sum of the squared differences between the observed values and the values predicted by the line. This is known as the Least Squares Error (LSE) method.
====

=== Question 4(2 points)

.. Train a linear regression model using the 'views' feature to predict 'likes'. What are the Mean Squared Error (MSE) and R² score on the test set? 

.. Plot the predicted trend line against the actual test data. How well does the model fit the data?

[source,python]
----
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error, r2_score
from sklearn.preprocessing import StandardScaler

# Select relevant features
X = cleaned_df[['views']]
y = cleaned_df['likes']

# Scale the data
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# Split the dataset into training and testing sets
X_train, X_test, y_train, y_test = train_test_split(X_scaled, y, test_size=0.3, random_state=42)

# Initialize and train the Linear Regression model
lm = LinearRegression()
model = lm.fit(X_train, y_train)

# Predict the values on the test set
predictions = model.predict(X_test)

# Evaluate the model
mse = mean_squared_error(y_test, predictions)
r2 = r2_score(y_test, predictions)
print(f'Mean Squared Error on Test Set: {mse}')
print(f'R² Score on Test Set: {r2}')
----

[source,python]
----
# Plot the predicted trend line
plt.figure(figsize=(10, 6))
plt.title('Predicted Linear Regression')
plt.xlabel('Number of Views')
plt.ylabel('Actual Number of Likes')
plt.plot(X_test.flatten(), y_test.values.flatten(), 'bo', X_test.flatten(), predictions.flatten(), 'r-')
plt.show()
----
=== Question 5 (2 points)

..  How does the model perform for the top 5 channels?

[TIP]
====
[source,python]
----

# Identify the top 5 channels by video count
top_channels = my_df['channel_title'].value_counts().head(5).index
print("Top 5 channels by video count:\n", top_channels)

# Filter the dataset to include only videos from the top 5 channels
top_channels_df = cleaned_df[cleaned_df['channel_title'].isin(top_channels)]
print("Filtered dataset shape:", top_channels_df.shape)


# Plot the regression lines for the top 5 channels
plt.figure(figsize=(20, 16))

for i, channel in enumerate(top_channels, 1):
    channel_data = top_channels_df[top_channels_df['channel_title'] == channel]
    X_channel = channel_data[['views']]
    y_channel = channel_data['likes']
    
    # Scale the data
    X_channel_scaled = scaler.fit_transform(X_channel)

    # Split the dataset into training and testing sets
    X_train_channel, X_test_channel, y_train_channel, y_test_channel = train_test_split(X_channel_scaled, y_channel, test_size=0.3, random_state=42)

    # Train the Linear Regression model
    lm_channel = LinearRegression()
    model_channel = lm_channel.fit(X_train_channel, y_train_channel)

    # Predict the values on the test set
    predictions_channel = model_channel.predict(X_test_channel)

    # Plot the predicted trend line
    plt.subplot(3, 2, i)
    plt.title(f'Predicted Linear Regression for {channel}')
    plt.xlabel('Number of Views')
    plt.ylabel('Actual Number of Likes')
    plt.plot(X_test_channel.flatten(), y_test_channel.values.flatten(), 'bo', X_test_channel.flatten(), predictions_channel.flatten(), 'r-')

plt.tight_layout()
plt.show()

----
====

Project 04 Assignment Checklist
====
* Jupyter Lab notebook with your code, comments, and output for the assignment
    ** `firstname-lastname-project04.ipynb`
* Python file with code and comments for the assignment
    ** `firstname-lastname-project04 .py`
* Submit files through Gradescope
====

[WARNING]
====
_Please_ make sure to double-check that your submission is complete and contains all of your code and output before submitting. If you are on a spotty internet connection, it is recommended to download your submission after submitting it to make sure what you _think_ you submitted was what you _actually_ submitted.

In addition, please review our [submission guidelines](xref:projects:current-projects:submissions.adoc) before submitting your project.
====
 