= TDM 20100: Project 3 -- 2023

**Motivation:** The need to search files and datasets based on the text held within is common during various parts of the data wrangling process -- after all, projects in industry will not typically provide you with a path to your dataset and call it a day. `grep` is an extremely powerful UNIX tool that allows you to search text using regular expressions. Regular expressions are a structured method for searching for specified patterns. Regular expressions can be very complicated, https://blog.cloudflare.com/details-of-the-cloudflare-outage-on-july-2-2019/[even professionals can make critical mistakes]. With that being said, learning some of the basics is an incredible tool that will come in handy regardless of the language you are working in.


[NOTE]
====
Regular expressions are not something you will be able to completely escape from. They exist in some way, shape, and form in all major programming languages. Even if you are less-interested in UNIX tools (which you shouldn't be, they can be awesome), you should definitely take the time to learn regular expressions.
====

**Context:** We've just begun to learn the basics of navigating a file system in UNIX using various terminal commands. Now we will go into more depth with one of the most useful command line tools, `grep`, and experiment with regular expressions using `grep`, R, and later on, Python.

**Scope:** `grep`, regular expression basics, utilizing regular expression tools in R and Python

.Learning Objectives
****
- Use `grep` to search for patterns within a dataset.
- Use `cut` to section off and slice up data from the command line.
- Use `wc` to count the number of lines of input.
****

Make sure to read about, and use the template found xref:templates.adoc[here], and the important information about projects submissions xref:submissions.adoc[here].

== Dataset(s)

The following questions will use the following dataset(s):

- `/anvil/projects/tdm/data/consumer_complaints/complaints.csv`


[NOTE]

`grep` stands for (g)lobally search for a (r)egular (e)xpression and (p)rint matching lines. As such, to best demonstrate `grep`, we will be using it with textual data.

Let's assume for a second that we _didn't_ provide you with the location of this projects dataset, and you didn't know the name of the file either. With all of that being said, you _do_ know that it is the only dataset with the text "That's the sort of fraudy fraudulent fraud that Wells Fargo defrauds its fraud-victim customers with. Fraudulently." in it.

[TIP]
====
When you search for this sentence in the file, make sure that you type the single quote in "That's" so that you get a regular ASCII single quote.  Otherwise, you will not find this sentence. Or, just use a unique _part_ of the sentence that will likely not exist in another file.
====

=== Question 1 (1 pt)

[ARABIC]
.. Write a `grep` command that finds the dataset "Thatâ€™s the sort of fraudy fraudulent fraud that Wells Fargo defrauds its fraud-victim customers with. Fraudulently." 

[TIP]
====
You can start in the `/anvil/projects/tdm/data` directory to reduce the amount of text being searched. In addition, use a wildcard (*) to reduce the directories we search to only directories that start with a `con` inside the `/anvil/projects/tdm/data` directory such as

/anvil/projects/tdm/data/con*

 Just know that you'd _eventually_ find the file without using the wildcard, but we don't want to waste your time.


Use `man` to read about some of the options with `grep`. For example, you'll want to search _recursively_ through the entire contents of the directories starting with a `con` with option -R or -r.
====

.Items to submit
====
- Code used to solve this problem.
- Output from running the code.
====

=== Question 2 (1.5 pts)

[arabic]

.. Print out the first line _only_ of the file complains.csv 

[TIP]
====
Use command 'head' that could quickly print out the first _n_ lines of a file. A csv file typically has a header row to explain what data each column holds. 
====
[arabic]
[start=2]
.. Print out first 100 lines of 3 columns data `complaint_id`, `consumer_complaint_narrative`, and the `state` from file complains.csv 

[TIP] 
====
Use command 'head' to control the row and command 'cut' to select columns 
====
[arabic]
[start=3]
.. Print out only those same 3 columns for the _single_ line where we heard about the "fraudy fraudulent fraud".

[TIP]
====
Use `cat`, `head`, `tail`, and `cut` commands to isolate the 3 columns and the _single_ line
 
You can find the exact line from the file where the "fraudy fraudulent fraud" occurs, by using the `n` option from `grep`. That will tell you the line number, which can then be used with `head` and `tail` to isolate the single line.
====

.Items to submit
====
- Code used to solve this problem.
- Output from running the code.
====

=== Question 3 (2 pts)

[arabic]

.. Use one line statement to create a _new_ dataset called `southeast.csv`, the _new_ dataset will meet the following requirments

    * it will only contains the data for the five states - Florida, Georgia, Mississippi, Alabama, and South Carolina AND
    * it will only the contain the following four columns - `consumer_complaint_narrative`, `state`, `tags`, and `complaint_id`.

[TIP]
====
Be careful you don't accidentally get lines with a word like "CAPITAL" in them (AL is the state code of Alabama and is present in the word "CAPITAL"). 
====
[arabic]
[start=2]
.. Plase describe how many rows of data remain and How many megabytes is the new file

[TIP] 
====
Use `cut` to isolate _just_ the data we ask for. For example, _just_ print the number of rows, and _just_ print the value (in Mb) of the size of the file:
====

.this
----
20M
----

.not this
----
-rw-r--r-- 1 x-kamstut x-tdm-admin 20M Dec  13 10:59 /home/x-kamstut/southeast.csv
----

.Items to submit
====
- Code used to solve this problem.
- Output from running the code.
====

=== Question 4 (1.5 pt)

[arabic]
.. Use grep command to get complaints information from the _new_ data set 'southeast.csv', the output will need to meet the following requirements

* Contain one of the following words, the search is case-insensitive : "wow", "irritating", or "rude" followed by at least 1 exclamation mark.

* Use 'head' command to limit the output to only 5 rows  

.Items to submit
====
- Code used to solve this problem.
- Output from running the code.
====

=== Question 5 (2 pts)

[arabic]
.. Use `grep` to find the narratives that contain at least one dollar amount enclosed in curly braces `{` and `}`. Use `head` to limit output to only the first 5 results

[TIP]
====
You may find narratives from `consumer_complaint_narrative` column in our new dataset, `southeast.csv`, 

Use the option `-E` to use extended regular expressions in 'grep' command. This will make your regular expressions less messy (less escaping). 
====

[NOTE]
====
There are instances like `{>= $1000000}` and `{ XXXX }`. The first example qualifies, but the second doesn't. Make sure the following are matched:

- {$0.00}
- { $1,000.00 }
- {>= $1000000}
- { >= $1000000 }

And that the following are _not_ matched:

- { XXX }
- {XXX}
====

[TIP]
====
Regex is hard. Try the following logic. 

. Match a "{"
. Match 0 or more of any character that isn't a-z, A-Z, or 0-9
. Match 1 or more "$"
. Match 1 or more of any character that isn't "}"
. Match "}"
====

[TIP]
====
To verify your answer, the following code should have the following result.

[source,bash]
----
grep -E 'regexhere' $HOME/southeast.csv | head -n 5 | cut -d, -f4
----

.result
----
3185125
3184467
3183547
3183544
3182879
----
====

.Items to submit
====
- Code used to solve this problem.
- Output from running the code.
====

[WARNING]
====
_Please_ make sure to double check that your submission is complete, and contains all of your code and output before submitting. If you are on a spotty internet connection, it is recommended to download your submission after submitting it to make sure what you _think_ you submitted, was what you _actually_ submitted.
                                                                                                                             
In addition, please review our xref:submissions.adoc[submission guidelines] before submitting your project.
====