= TDM 20200: Project 9 -- 2024

**Motivation:** Spark uses a distributed computing model to process data, which means that data is processed in parallel across a cluster of machines. PySpark is a Spark API that allows you to interact with Spark through the Python shell, or in Jupyter Lab, or in DataBricks, etc. PySpark provides a way to access Spark's framework using Python. It combines the simplicity of Python with the power of Apache Spark.

**Context:** This is the second project that we will continue to understand components of Spark's ecosystem that PySpark can use

**Scope:** Python, Spark SQL, Spark Streaming, MLib, GraphX

.Learning Objectives
****
- Develop skills and techniques to use PySpark to read a dataset, perform transformations like filtering, mapping and execute actions like count, collect 
- Understand how to use Spark Streaming, MLib and GraphX
****

== Dataset(s)

The following questions will use the following dataset:

- `/anvil/projects/tdm/data/amazon/amazon_fine_food_reviews.csv`


== Readings and Resources

[NOTE]
====
- Make sure to read about, and use the template found xref:templates.adoc[here], and the important information about projects submissions xref:submissions.adoc[here].
- https://the-examples-book.com/starter-guides/data-engineering/containers/pyspark[PySpark]
- https://spark.apache.org/docs/latest/[Apache Spark]
- https://sparkbyexamples.com/[Spark Examples]
- https://www.analyticsvidhya.com/blog/2022/10/most-important-pyspark-functions-with-example/[PySpark Examples]
====

[WARNING]
====
You need to use 2 cores for your Jupyter Lab session for Project 9 this week.
====


== Questions

=== Question 1 (4 points)

.. Create a PySpark session, then load the dataset using PySpark 
.. Calculate the average score for reviews group by product

[TIP]
====
- You may refer to import following modules 
[source, python]
----
from pyspark.sql import SparkSession
from pyspark.sql.functions import avg
----

- While read csv, you may need to specify the option for headers, otherwise header will be treated as data;
[source,python]
----
read.option("header","true") 
----
- Use following option to make the column names accessible as DataFrame attributes
[source,python]
option("inferSchema","true")
====
 

=== Question 2 (4 points)

.. Question 1 we used batch processing mode to do data processing, the whole dataset is loaded and processed in one go. Now let us delve into Spark Streaming concepts. Assuming the dataset streams in real time. Please count the number of reviews for each product in a streaming style

[TIP]
====
- To simplify the data processing, create a new folder under your home directory, name it "spark"
- copy file to the folder "spark"
 
- Use the following statement to get the source directory for the dataset we will use for data processing

[source,python]
----
import os
home_dir = os.getenv("HOME")
data_dir = os.path.join(home_dir,"spark")
----
====
 

=== Question 3 (2 points)

.. After you complete the previous two questions, please state your understanding of the difference between reading data from a static file versus a streaming data source in Spark
 

Project 09 Assignment Checklist
====
* Jupyter Lab notebook with your code, comments and outputs for the assignment
    ** `firstname-lastname-project09.ipynb` 
* Python file with code and comments for the assignment
    ** `firstname-lastname-project09.py`
 
* Submit files through Gradescope
====

[WARNING]
====
_Please_ make sure to double check that your submission is complete, and contains all of your code and output before submitting. If you are on a spotty internet connection, it is recommended to download your submission after submitting it to make sure what you _think_ you submitted, was what you _actually_ submitted.

In addition, please review our xref:projects:current-projects:submissions.adoc[submission guidelines] before submitting your project.
====