<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Spring 2021 projects | The Examples Book</title>
  <meta name="description" content="A book of supplemental examples for The Data Mine at Purdue University." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Spring 2021 projects | The Examples Book" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A book of supplemental examples for The Data Mine at Purdue University." />
  <meta name="github-repo" content="kevinamstutz/the-examples-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Spring 2021 projects | The Examples Book" />
  
  <meta name="twitter:description" content="A book of supplemental examples for The Data Mine at Purdue University." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="images/touch-icon.png" />
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="faqs.html"/>
<link rel="next" href="fall2020-projects.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="book.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The Data Mine</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contribute"><i class="fa fa-check"></i>How to contribute</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#setup-github-desktop-and-clone-the-repository"><i class="fa fa-check"></i>Setup GitHub Desktop and clone the repository</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#making-a-contribution"><i class="fa fa-check"></i>Making a contribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="scholar.html"><a href="scholar.html"><i class="fa fa-check"></i>Scholar</a><ul>
<li class="chapter" data-level="" data-path="scholar.html"><a href="scholar.html#connecting-to-scholar"><i class="fa fa-check"></i>Connecting to Scholar</a><ul>
<li class="chapter" data-level="" data-path="scholar.html"><a href="scholar.html#rstudio-server-pro"><i class="fa fa-check"></i>RStudio Server Pro</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scholar.html"><a href="scholar.html#other-ways-to-connect"><i class="fa fa-check"></i>Other ways to connect</a><ul>
<li class="chapter" data-level="" data-path="scholar.html"><a href="scholar.html#connecting-with-thinlinc-webclient"><i class="fa fa-check"></i>ThinLinc web client</a></li>
<li class="chapter" data-level="" data-path="scholar.html"><a href="scholar.html#connecting-with-thinlinc-client"><i class="fa fa-check"></i>ThinLinc client</a></li>
<li class="chapter" data-level="" data-path="scholar.html"><a href="scholar.html#connecting-with-ssh"><i class="fa fa-check"></i>SSH</a></li>
<li class="chapter" data-level="" data-path="scholar.html"><a href="scholar.html#jupyterhub"><i class="fa fa-check"></i>JupyterHub</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scholar.html"><a href="scholar.html#scholar-resources"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-formats.html"><a href="data-formats.html"><i class="fa fa-check"></i>Data Formats</a><ul>
<li class="chapter" data-level="" data-path="data-formats.html"><a href="data-formats.html#html"><i class="fa fa-check"></i>HTML</a></li>
<li class="chapter" data-level="" data-path="data-formats.html"><a href="data-formats.html#xml"><i class="fa fa-check"></i>XML</a><ul>
<li class="chapter" data-level="" data-path="data-formats.html"><a href="data-formats.html#xml-xpath"><i class="fa fa-check"></i>XPath Expressions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html"><i class="fa fa-check"></i>Unix</a><ul>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#unix-getting-started"><i class="fa fa-check"></i>Getting started</a></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#unix-utilities"><i class="fa fa-check"></i>Standard utilities</a><ul>
<li><a href="unix.html#man"><code>man</code></a></li>
<li><a href="unix.html#cat"><code>cat</code></a></li>
<li><a href="unix.html#head"><code>head</code></a></li>
<li><a href="unix.html#tail"><code>tail</code></a></li>
<li><a href="unix.html#ls"><code>ls</code></a></li>
<li><a href="unix.html#du"><code>du</code></a></li>
<li><a href="unix.html#cp"><code>cp</code></a></li>
<li><a href="unix.html#mv"><code>mv</code></a></li>
<li><a href="unix.html#touch"><code>touch</code></a></li>
<li><a href="unix.html#mkdir"><code>mkdir</code></a></li>
<li><a href="unix.html#rm"><code>rm</code></a></li>
<li><a href="unix.html#rmdir"><code>rmdir</code></a></li>
<li><a href="unix.html#pwd"><code>pwd</code></a></li>
<li><a href="unix.html#type"><code>type</code></a></li>
<li><a href="unix.html#uniq"><code>uniq</code></a></li>
<li><a href="unix.html#wc"><code>wc</code></a></li>
<li><a href="unix.html#ssh"><code>ssh</code></a></li>
<li><a href="unix.html#scp"><code>scp</code></a></li>
<li><a href="unix.html#cut"><code>cut</code></a></li>
<li><a href="unix.html#sed"><code>sed</code></a></li>
<li><a href="unix.html#grep"><code>grep</code></a></li>
<li><a href="unix.html#find"><code>find</code></a></li>
<li><a href="unix.html#less"><code>less</code></a></li>
<li><a href="unix.html#sort"><code>sort</code></a></li>
<li><a href="unix.html#git-ref-01"><code>git</code></a></li>
</ul></li>
<li><a href="unix.html#awk"><code>awk</code></a><ul>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#unix-awk-built-in-variables"><i class="fa fa-check"></i>Built in variables</a></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#examples-5"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#dots"><i class="fa fa-check"></i>~ &amp; . &amp; ..</a><ul>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#examples-6"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#piping-and-redirection"><i class="fa fa-check"></i>Piping &amp; Redirection</a><ul>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#redirection"><i class="fa fa-check"></i>Redirection</a></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#piping"><i class="fa fa-check"></i>Piping</a></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#piping-and-redirection-resources"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#cron"><i class="fa fa-check"></i>Cron</a><ul>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#cron-examples"><i class="fa fa-check"></i>Examples</a></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#cron-resources"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#emacs"><i class="fa fa-check"></i>Emacs</a></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#nano"><i class="fa fa-check"></i>Nano</a></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#vim"><i class="fa fa-check"></i>Vim</a></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#unix-writing-scripts"><i class="fa fa-check"></i>Writing scripts</a><ul>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#unix-bash-arguments"><i class="fa fa-check"></i>Arguments</a></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#unix-bash-script-examples"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html"><i class="fa fa-check"></i>SQL</a><ul>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#sql-joins"><i class="fa fa-check"></i>Joins</a><ul>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#sql-inner-join"><i class="fa fa-check"></i>INNER JOIN</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#sql-left-join"><i class="fa fa-check"></i>LEFT OUTER JOIN</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#aliasing"><i class="fa fa-check"></i>Aliasing</a><ul>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#sql-rdbms"><i class="fa fa-check"></i>RDBMS</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#sql-in-r"><i class="fa fa-check"></i>SQL in R</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#sql-in-python"><i class="fa fa-check"></i>SQL in Python</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#sql-examples"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html"><i class="fa fa-check"></i>R</a><ul>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#getting-started-with-r"><i class="fa fa-check"></i>Getting started</a><ul>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-8451-intro"><i class="fa fa-check"></i>Examples using the 84.51 data set.</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-nyc-taxi-intro"><i class="fa fa-check"></i>Examples using the New York City yellow taxi cab data set.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-variables"><i class="fa fa-check"></i>Variables</a><ul>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-na"><i class="fa fa-check"></i>NA</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-nan"><i class="fa fa-check"></i>NaN</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-null"><i class="fa fa-check"></i>NULL</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-dates"><i class="fa fa-check"></i>Dates</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-factors"><i class="fa fa-check"></i>Factors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-logical-operators"><i class="fa fa-check"></i>Logical operators</a><ul>
<li class="chapter" data-level="" data-path="data-formats.html"><a href="data-formats.html#examples"><i class="fa fa-check"></i>Examples</a></li>
<li class="chapter" data-level="" data-path="data-formats.html"><a href="data-formats.html#resources"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-lists-and-vectors"><i class="fa fa-check"></i>Lists &amp; Vectors</a><ul>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-indexing"><i class="fa fa-check"></i>Indexing</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-recycling"><i class="fa fa-check"></i>Recycling</a></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#examples-2"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-basic-functions"><i class="fa fa-check"></i>Basic R functions</a><ul>
<li><a href="r.html#r-all"><code>all</code></a></li>
<li><a href="r.html#r-any"><code>any</code></a></li>
<li><a href="r.html#r-all.equal"><code>all.equal</code></a></li>
<li><a href="r.html#r-in"><code>%in%</code></a></li>
<li><a href="r.html#r-setdiff"><code>setdiff</code></a></li>
<li><a href="r.html#r-intersect"><code>intersect</code></a></li>
<li><a href="r.html#r-dim"><code>dim</code></a></li>
<li><a href="r.html#r-length"><code>length</code></a></li>
<li><a href="r.html#r-rep"><code>rep</code></a></li>
<li><a href="r.html#r-bind"><code>rbind</code> and <code>cbind</code></a></li>
<li><a href="r.html#r-which"><code>which</code>, <code>which.max</code>, <code>which.min</code></a></li>
<li><a href="r.html#r-grep"><code>grep</code>, <code>grepl</code>, etc.</a></li>
<li><a href="r.html#r-sum"><code>sum</code></a></li>
<li><a href="r.html#r-mean"><code>mean</code></a></li>
<li><a href="r.html#r-var"><code>var</code></a></li>
<li><a href="r.html#r-sums"><code>colSums</code> and <code>rowSums</code></a></li>
<li><a href="r.html#r-means"><code>colMeans</code> and <code>rowMeans</code></a></li>
<li><a href="r.html#r-unique"><code>unique</code></a></li>
<li><a href="r.html#r-summary"><code>summary</code></a></li>
<li><a href="r.html#r-order"><code>order</code> and <code>sort</code></a></li>
<li><a href="r.html#r-paste"><code>paste</code> and <code>paste0</code></a></li>
<li><a href="r.html#r-head"><code>head</code> and <code>tail</code></a></li>
<li><a href="r.html#r-str"><code>str</code></a></li>
<li><a href="r.html#r-strsplit"><code>strsplit</code></a></li>
<li><a href="r.html#r-names"><code>names</code></a></li>
<li><a href="r.html#r-colnames-and-rownames"><code>colnames</code> &amp; <code>rownames</code></a></li>
<li><a href="r.html#r-table"><code>table</code> &amp; <code>prop.table</code></a></li>
<li><a href="r.html#r-cut"><code>cut</code></a></li>
<li><a href="r.html#r-subset"><code>subset</code></a></li>
<li><a href="r.html#difftime-r-difftime"><code>difftime</code> {r#-difftime}</a></li>
<li><a href="r.html#r-merge"><code>merge</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-data-frames"><i class="fa fa-check"></i>Data.frames</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-reading-and-writing-data"><i class="fa fa-check"></i>Reading &amp; Writing data</a><ul>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#examples-29"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-control-flow"><i class="fa fa-check"></i>Control flow</a><ul>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-if-else"><i class="fa fa-check"></i>If/else statements</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-for-loops"><i class="fa fa-check"></i>For loops</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-apply-functions"><i class="fa fa-check"></i>Apply functions</a><ul>
<li><a href="r.html#r-apply"><code>apply</code></a></li>
<li><a href="r.html#r-lapply"><code>lapply</code></a></li>
<li><a href="r.html#r-sapply"><code>sapply</code></a></li>
<li><a href="r.html#r-tapply"><code>tapply</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-writing-functions"><i class="fa fa-check"></i>Writing functions</a><ul>
<li><a href="r.html#r-ellipsis"><code>...</code></a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#examples-34"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-plotting"><i class="fa fa-check"></i>Plotting</a><ul>
<li><a href="r.html#r-barplot"><code>barplot</code></a></li>
<li><a href="r.html#r-boxplot"><code>boxplot</code></a></li>
<li><a href="r.html#r-pie"><code>pie</code></a></li>
<li><a href="r.html#r-dotchart"><code>dotchart</code></a></li>
<li><a href="r.html#r-plot"><code>plot</code></a></li>
<li><a href="r.html#r-lines"><code>lines</code></a></li>
<li><a href="r.html#r-points"><code>points</code></a></li>
<li><a href="r.html#r-abline"><code>abline</code></a></li>
<li><a href="r.html#r-text"><code>text</code></a></li>
<li><a href="r.html#r-mtext"><code>mtext</code></a></li>
<li><a href="r.html#r-legend"><code>legend</code></a></li>
<li><a href="r.html#r-par"><code>par</code></a></li>
<li><a href="r.html#r-facet_grid"><code>facet_grid</code></a></li>
<li><a href="r.html#r-facet_wrap"><code>facet_wrap</code></a></li>
<li><a href="r.html#r-plot_usmap"><code>plot_usmap</code></a></li>
<li><a href="r.html#r-ggplot"><code>ggplot</code></a></li>
<li><a href="r.html#r-ggmap"><code>ggmap</code></a></li>
<li><a href="r.html#r-leaflet"><code>leaflet</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-rmarkdown"><i class="fa fa-check"></i>RMarkdown</a><ul>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#code-chunks"><i class="fa fa-check"></i>Code chunks</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-markdown-resources"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-tidyverse"><i class="fa fa-check"></i>Tidyverse</a><ul>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-piping"><i class="fa fa-check"></i>piping</a></li>
<li><a href="r.html#r-select"><code>select</code></a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-selection-helpers"><i class="fa fa-check"></i>selection helpers</a></li>
<li><a href="r.html#r-transmute"><code>transmute</code></a></li>
<li><a href="r.html#r-mutate"><code>mutate</code></a></li>
<li><a href="r.html#r-case_when"><code>case_when</code></a></li>
<li><a href="r.html#r-between"><code>between</code></a></li>
<li><a href="r.html#r-glimpse"><code>glimpse</code></a></li>
<li><a href="r.html#r-filter"><code>filter</code></a></li>
<li><a href="r.html#r-arrange"><code>arrange</code></a></li>
<li><a href="r.html#r-group-by"><code>group_by</code></a></li>
<li><a href="r.html#r-summarize"><code>summarize</code></a></li>
<li><a href="r.html#r-str-extract"><code>str_extract</code> and <code>str_extract_all</code></a></li>
<li><a href="r.html#r-lubridate"><code>lubridate</code></a></li>
<li><a href="r.html#r-strrep"><code>strrep</code></a></li>
<li><a href="r.html#r-nchar"><code>nchar</code></a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-lubridate-resources"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-datatable"><i class="fa fa-check"></i>data.table</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-sql"><i class="fa fa-check"></i>SQL in R</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-scraping"><i class="fa fa-check"></i>Scraping</a></li>
<li><a href="r.html#r-shiny"><code>shiny</code></a><ul>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-shiny-render-images"><i class="fa fa-check"></i>Rendering images</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html"><i class="fa fa-check"></i>Python</a><ul>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#getting-started-with-python"><i class="fa fa-check"></i>Getting started</a><ul>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#python-on-scholar"><i class="fa fa-check"></i>Python on Scholar</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#a-note-on-indentation"><i class="fa fa-check"></i>A note on indentation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-variables"><i class="fa fa-check"></i>Variables</a><ul>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-none"><i class="fa fa-check"></i>None</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-bool"><i class="fa fa-check"></i>bool</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-str"><i class="fa fa-check"></i>str</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-int"><i class="fa fa-check"></i>int</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-float"><i class="fa fa-check"></i>float</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-complex"><i class="fa fa-check"></i>complex</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-printing"><i class="fa fa-check"></i>Printing</a><ul>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-f-strings"><i class="fa fa-check"></i>f-strings</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-logical-operators"><i class="fa fa-check"></i>Logical operators</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-lists-and-tuples"><i class="fa fa-check"></i>Lists &amp; Tuples</a><ul>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-indexing"><i class="fa fa-check"></i>Indexing</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-list-methods"><i class="fa fa-check"></i>List methods</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#tuple-methods"><i class="fa fa-check"></i>Tuple methods</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-dicts"><i class="fa fa-check"></i>Dicts</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-sets"><i class="fa fa-check"></i>Sets</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-control-flow"><i class="fa fa-check"></i>Control flow</a><ul>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-if-else"><i class="fa fa-check"></i>If/else statements</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-for-loops"><i class="fa fa-check"></i>For loops</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-median"><i class="fa fa-check"></i>Finding a median</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-list-comprehensions"><i class="fa fa-check"></i>List comprehensions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-writing-functions"><i class="fa fa-check"></i>Writing functions</a><ul>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#packing-and-unpacking"><i class="fa fa-check"></i>packing and unpacking</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#arguments"><i class="fa fa-check"></i>arguments</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#docstrings"><i class="fa fa-check"></i>docstrings</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#annotations"><i class="fa fa-check"></i>annotations</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#decorators"><i class="fa fa-check"></i>decorators</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-reading-and-writing-data"><i class="fa fa-check"></i>Reading &amp; Writing data</a><ul>
<li><a href="python.html#read_csv"><code>read_csv</code></a></li>
<li><a href="python.html#p-csv-pkg"><code>csv</code></a></li>
</ul></li>
<li><a href="python.html#p-pathlib"><code>pathlib</code></a><ul>
<li><a href="python.html#p-pathlib-path"><code>Path</code></a></li>
</ul></li>
<li><a href="python.html#p-numpy"><code>numpy</code></a></li>
<li><a href="python.html#p-scipy"><code>scipy</code></a></li>
<li><a href="python.html#p-pandas"><code>pandas</code></a><ul>
<li><a href="python.html#p-pandas-shape-attribute"><code>shape</code> attribute</a></li>
<li><a href="python.html#p-pandas-read_csv"><code>read_csv</code></a></li>
<li><a href="python.html#p-pandas-to_csv"><code>to_csv</code></a></li>
<li><a href="python.html#p-pandas-read_parquet"><code>read_parquet</code></a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-pandas-dataframe"><i class="fa fa-check"></i>DataFrame</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-pandas-series"><i class="fa fa-check"></i>Series</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-pandas-indexing"><i class="fa fa-check"></i>Indexing</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-pandas-datetime"><i class="fa fa-check"></i>dates and times</a></li>
<li><a href="python.html#p-pandas-groupby"><code>groupby</code></a></li>
<li><a href="python.html#p-pandas-pivot"><code>pivot</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-jupyter-notebooks"><i class="fa fa-check"></i>Jupyter notebooks</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-writing-scripts"><i class="fa fa-check"></i>Writing scripts</a><ul>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-shebang"><i class="fa fa-check"></i>shebang</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-arguments"><i class="fa fa-check"></i>arguments</a></li>
<li><a href="python.html#p-argparse"><code>argparse</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-scraping"><i class="fa fa-check"></i>Scraping</a><ul>
<li><a href="python.html#p-requests"><code>requests</code></a></li>
<li><a href="python.html#lxml"><code>lxml</code></a></li>
<li><a href="python.html#p-selenium"><code>selenium</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-xml"><i class="fa fa-check"></i>XML</a><ul>
<li><a href="python.html#p-lxml"><code>lxml</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-plotting"><i class="fa fa-check"></i>Plotting</a><ul>
<li><a href="python.html#p-matplotlib"><code>matplotlib</code></a></li>
<li><a href="python.html#p-plotly"><code>plotly</code></a></li>
<li><a href="python.html#p-plotnine"><code>plotnine</code></a></li>
<li><a href="python.html#p-pygal"><code>pygal</code></a></li>
<li><a href="python.html#p-seaborn"><code>seaborn</code></a></li>
<li><a href="python.html#p-bokeh"><code>bokeh</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-classes"><i class="fa fa-check"></i>Classes</a></li>
<li><a href="python.html#tensorflow"><code>tensorflow</code></a></li>
<li><a href="python.html#pytorch"><code>pytorch</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html"><i class="fa fa-check"></i>Tools</a><ul>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#docker"><i class="fa fa-check"></i>Docker</a></li>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#tableau"><i class="fa fa-check"></i>Tableau</a></li>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#github"><i class="fa fa-check"></i>GitHub</a><ul>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#github-overview"><i class="fa fa-check"></i>Overview</a></li>
<li><a href="tools.html#git"><code>git</code></a></li>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#github-desktop"><i class="fa fa-check"></i>GitHub Desktop</a></li>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#git-resources"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#vpns"><i class="fa fa-check"></i>VPNs</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html"><i class="fa fa-check"></i>FAQs</a><ul>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-no-such-file-or-directory"><i class="fa fa-check"></i>Cannot open the connection. No such file or directory.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-how-do-i-connect-to-scholar-off-campus"><i class="fa fa-check"></i>How do I connect to Scholar from off-campus?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-cursor-offset"><i class="fa fa-check"></i>In Scholar, on RStudio, my font size looks weird or my cursor is offset.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-unable-to-type-terminal"><i class="fa fa-check"></i>I'm unable to type into the terminal in RStudio.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-unable-to-connect-to-rstudio-server"><i class="fa fa-check"></i>I'm unable to connect to RStudio Server.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-rstudio-long-time-to-open"><i class="fa fa-check"></i>RStudio is taking a long time to open.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-deleting-file-in-RStudio"><i class="fa fa-check"></i>How do I delete a file from my RStudio directory? (asked by Karthik Uppuluri)</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-how-do-i-rename-file-rstudio"><i class="fa fa-check"></i>How do I rename a file from my RStudio directory?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-running-R-code"><i class="fa fa-check"></i>How can you run a line of R code in RStudio without clicking the &quot;Run&quot; button?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-r-session-freezes"><i class="fa fa-check"></i>My R session freezes.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-scholar-is-slow"><i class="fa fa-check"></i>Scholar is slow.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-how-to-transfer-files"><i class="fa fa-check"></i>How to transfer files between your computer and Scholar.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#password-wont-work"><i class="fa fa-check"></i>My password will not work.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-jupyter-notebook-download-error-ie"><i class="fa fa-check"></i>Jupyter Notebook download error with IE.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-jupyter-notebook-kernel-dying"><i class="fa fa-check"></i>Jupyter Notebook kernel dying.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-kernel-jupyter-wont-save"><i class="fa fa-check"></i>Python kernel not working, Jupyter Notebook won't save.</a></li>
<li><a href="faqs.html#faq-installing-python-package">Installing <code>my_package</code> for Python.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-displaying-multiple-images-jupyter"><i class="fa fa-check"></i>Displaying multiple images after a single Jupyter Notebook Python code cell.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-error-has-null-value"><i class="fa fa-check"></i>RMarkdown “Error: option error has NULL value” when knitting&quot;.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-creating-rmarkdown-file"><i class="fa fa-check"></i>How do you create an RMarkdown file?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-problems-building-rmarkdown-scholar"><i class="fa fa-check"></i>Problems building an RMarkdown document on Scholar.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-how-to-use-sql-in-rmarkdown"><i class="fa fa-check"></i>How can I use SQL in RMarkdown?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-copy-paste-from-terminal-inside-rstudio"><i class="fa fa-check"></i>Copy/paste from terminal (not a console) inside RStudio to RMarkdown.</a></li>
<li><a href="faqs.html#faq-how-to-render-image-in-shiny-app">How do I render an image in a <code>shiny</code> app?</a></li>
<li><a href="faqs.html#faq-package-not-found">The package <code>my_package</code> is not found.</a></li>
<li><a href="faqs.html#faq-problems-installing-ggmap">Problems installing <code>ggmap</code>.</a></li>
<li><a href="faqs.html#faq-object-name-not-found">Error: <code>object_name</code> is not found.</a></li>
<li><a href="faqs.html#faq-zoom-in-ggmap">Zoom in on <code>ggmap</code>.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-find-lat-long-of-loc"><i class="fa fa-check"></i>Find the latitude and longitude of a location.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-save-work-pdf-scholar"><i class="fa fa-check"></i>Problems saving work as a PDF in R on Scholar.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-resources-for-html"><i class="fa fa-check"></i>What is a good resource to better understand HTML?</a></li>
<li><a href="faqs.html#faq-style-guide-r">Is there a style guide for <code>R</code> code?</a></li>
<li><a href="faqs.html#faq-best-practices-r">Is there a guide for best practices using <code>R</code>?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-tips-for-jupyter"><i class="fa fa-check"></i>Tips for using Jupyter notebooks.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-what-is-my-username"><i class="fa fa-check"></i>What is my username on Scholar?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-escape-characters"><i class="fa fa-check"></i>How and why would I need to &quot;escape a character&quot;?</a><ul>
<li class="chapter" data-level="" data-path="data-formats.html"><a href="data-formats.html#resources"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
<li><a href="faqs.html#faq-fix-illegal-byte-sequence">How can I fix the error &quot;Illegal byte sequence&quot; when using a UNIX utility like <code>cut</code>?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-rmarkdown-unicode-error"><i class="fa fa-check"></i>Unicode character error when Knitting an RMarkdown file to PDF.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#my-tab-key-will-not-auto-complete-anymore-in-rstudio.-how-can-i-fix-this"><i class="fa fa-check"></i>My tab key will not auto-complete anymore in RStudio. How can I fix this?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html"><i class="fa fa-check"></i>Spring 2021 projects</a><ul>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#templates"><i class="fa fa-check"></i>Templates</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#submissions"><i class="fa fa-check"></i>Submissions</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#stat-19000"><i class="fa fa-check"></i>STAT 19000</a><ul>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#topics"><i class="fa fa-check"></i>Topics</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p01-190"><i class="fa fa-check"></i>Project 1</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p02-190"><i class="fa fa-check"></i>Project 2</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p03-190"><i class="fa fa-check"></i>Project 3</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p04-190"><i class="fa fa-check"></i>Project 4</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p05-190"><i class="fa fa-check"></i>Project 5</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p06-190"><i class="fa fa-check"></i>Project 6</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p07-190"><i class="fa fa-check"></i>Project 7</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p08-190"><i class="fa fa-check"></i>Project 8</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p09-190"><i class="fa fa-check"></i>Project 9</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p10-190"><i class="fa fa-check"></i>Project 10</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p11-190"><i class="fa fa-check"></i>Project 11</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p12-190"><i class="fa fa-check"></i>Project 12</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p13-190"><i class="fa fa-check"></i>Project 13</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#stat-29000"><i class="fa fa-check"></i>STAT 29000</a><ul>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#topics-1"><i class="fa fa-check"></i>Topics</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p01-290"><i class="fa fa-check"></i>Project 1</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p02-290"><i class="fa fa-check"></i>Project 2</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p03-290"><i class="fa fa-check"></i>Project 3</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p04-290"><i class="fa fa-check"></i>Project 4</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p05-290"><i class="fa fa-check"></i>Project 5</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p06-290"><i class="fa fa-check"></i>Project 6</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p07-290"><i class="fa fa-check"></i>Project 7</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p08-290"><i class="fa fa-check"></i>Project 8</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p09-290"><i class="fa fa-check"></i>Project 9</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p10-290"><i class="fa fa-check"></i>Project 10</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p11-290"><i class="fa fa-check"></i>Project 11</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p12-290"><i class="fa fa-check"></i>Project 12</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#stat-39000"><i class="fa fa-check"></i>STAT 39000</a><ul>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#topics-2"><i class="fa fa-check"></i>Topics</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p01-390"><i class="fa fa-check"></i>Project 1</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p02-390"><i class="fa fa-check"></i>Project 2</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p03-390"><i class="fa fa-check"></i>Project 3</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p04-390"><i class="fa fa-check"></i>Project 4</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p05-390"><i class="fa fa-check"></i>Project 5</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p06-390"><i class="fa fa-check"></i>Project 6</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p07-390"><i class="fa fa-check"></i>Project 7</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p08-390"><i class="fa fa-check"></i>Project 8</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p09-390"><i class="fa fa-check"></i>Project 9</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p10-390"><i class="fa fa-check"></i>Project 10</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p11-390"><i class="fa fa-check"></i>Project 11</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p12-390"><i class="fa fa-check"></i>Project 12</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html"><i class="fa fa-check"></i>Fall 2020 projects</a><ul>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-stat-19000"><i class="fa fa-check"></i>STAT 19000</a><ul>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p01-190"><i class="fa fa-check"></i>Project 1</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p02-190"><i class="fa fa-check"></i>Project 2</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p03-190"><i class="fa fa-check"></i>Project 3</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p04-190"><i class="fa fa-check"></i>Project 4</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p05-190"><i class="fa fa-check"></i>Project 5</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p06-190"><i class="fa fa-check"></i>Project 6</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p07-190"><i class="fa fa-check"></i>Project 7</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p08-190"><i class="fa fa-check"></i>Project 8</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p09-190"><i class="fa fa-check"></i>Project 9</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p10-190"><i class="fa fa-check"></i>Project 10</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p11-190"><i class="fa fa-check"></i>Project 11</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p12-190"><i class="fa fa-check"></i>Project 12</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p13-190"><i class="fa fa-check"></i>Project 13</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p14-190"><i class="fa fa-check"></i>Project 14</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p15-190"><i class="fa fa-check"></i>Project 15</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-stat-29000"><i class="fa fa-check"></i>STAT 29000</a><ul>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p01-290"><i class="fa fa-check"></i>Project 1</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p02-290"><i class="fa fa-check"></i>Project 2</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p03-290"><i class="fa fa-check"></i>Project 3</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p04-290"><i class="fa fa-check"></i>Project 4</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p05-290"><i class="fa fa-check"></i>Project 5</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p06-290"><i class="fa fa-check"></i>Project 6</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p07-290"><i class="fa fa-check"></i>Project 7</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p08-290"><i class="fa fa-check"></i>Project 8</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p09-290"><i class="fa fa-check"></i>Project 9</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p10-290"><i class="fa fa-check"></i>Project 10</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p11-290"><i class="fa fa-check"></i>Project 11</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p12-290"><i class="fa fa-check"></i>Project 12</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p13-290"><i class="fa fa-check"></i>Project 13</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p14-290"><i class="fa fa-check"></i>Project 14</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p15-290"><i class="fa fa-check"></i>Project 15</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-stat-39000"><i class="fa fa-check"></i>STAT 39000</a><ul>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p01-390"><i class="fa fa-check"></i>Project 1</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p02-390"><i class="fa fa-check"></i>Project 2</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p03-390"><i class="fa fa-check"></i>Project 3</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p04-390"><i class="fa fa-check"></i>Project 4</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p05-390"><i class="fa fa-check"></i>Project 5</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p06-390"><i class="fa fa-check"></i>Project 6</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p07-390"><i class="fa fa-check"></i>Project 7</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p08-390"><i class="fa fa-check"></i>Project 8</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p09-390"><i class="fa fa-check"></i>Project 9</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p10-390"><i class="fa fa-check"></i>Project 10</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p11-390"><i class="fa fa-check"></i>Project 11</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p12-390"><i class="fa fa-check"></i>Project 12</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p13-390"><i class="fa fa-check"></i>Project 13</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p14-390"><i class="fa fa-check"></i>Project 14</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p15-390"><i class="fa fa-check"></i>Project 15</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="corporate-partners.html"><a href="corporate-partners.html"><i class="fa fa-check"></i>Corporate Partners</a></li>
<li class="chapter" data-level="" data-path="contributors.html"><a href="contributors.html"><i class="fa fa-check"></i>Contributors</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Examples Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="projects" class="section level1">
<h1>Spring 2021 projects</h1>
<div id="templates" class="section level2">
<h2>Templates</h2>
<p>Our course project template can be found <a href="https://raw.githubusercontent.com/TheDataMine/the-examples-book/master/files/project_template.Rmd">here</a>, or on Scholar:</p>
<p><code>/class/datamine/apps/templates/project_template.Rmd</code></p>
<p><strong>Important note:</strong> We've updated the template to allow a code chunk option that prevents content from running off the page. Simply add <code>linewidth=80</code> to any code chunk that creates output that runs off the page.</p>
<p>This video demonstrates:</p>
<ul>
<li>opening a browser (emphasizing Firefox as the best choice),</li>
<li>opening RStudio Server Pro (<a href="https://rstudio.scholar.rcac.purdue.edu" class="uri">https://rstudio.scholar.rcac.purdue.edu</a>),</li>
<li>introducing (basics) about what RStudio looks like,</li>
<li>checking to see that the students are using R 4.0,</li>
<li>running the initial (one-time) setup script,</li>
<li>opening the project template,</li>
<li>knitting the template into a PDF file, and</li>
<li>finally handling the popup blocker, which can potentially block the PDF.</li>
</ul>
<p><strong><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_444kq84l&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_5wx961lv">Click here for video</a></strong></p>
<p>Students in STAT 19000, 29000, and 39000 are to use this as a template for all project submissions. The template includes a code chunk that &quot;activates&quot; our Python environment, and adjusts some default settings. In addition, it provides examples on how to include solutions for Python, R, Bash, and SQL. Every question should be clearly marked with a third-level header (using 3 <code>#</code>s) followed by <code>Question 1</code>, <code>Question 2</code>, etc. Sections for solutions should be added or removed, based on the number of questions in the given project. All code chunks are to be run and solutions displayed for the compiled PDF submission.</p>
<p>Any format or template related questions should be asked in Piazza.</p>
</div>
<div id="submissions" class="section level2">
<h2>Submissions</h2>
<p>Unless otherwise specified, all projects will need 2-4 submitted files:</p>
<ol style="list-style-type: decimal">
<li>A compiled PDF file (built using the template), with all code and output.</li>
<li>The .Rmd file (based off of <a href="projects.html#templates">the template</a>), used to Knit the final PDF.</li>
<li>If it is a project containing R code, a .R file containing all of the R code with comments explaining what the code does. <em>Note: This is <strong>not</strong> an .Rmd file.</em></li>
<li>If it is a project containing Python code, a .py file containing all of the Python code.</li>
</ol>
<p>See <a href="https://thedatamine.github.io/the-examples-book/faqs.html#faq-how-to-transfer-files">here</a> to learn how to transfer files to and from Scholar.</p>
</div>
<div id="stat-19000" class="section level2">
<h2>STAT 19000</h2>
<div id="topics" class="section level3">
<h3>Topics</h3>
<p>The following table roughly highlights the topics and projects for the semester. This is slightly adjusted throughout the semester as student performance and feedback is taken into consideration.</p>
<table style="width:43%;">
<colgroup>
<col width="12%" />
<col width="13%" />
<col width="6%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th>Language</th>
<th>Project #</th>
<th>Name</th>
<th>Topics</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Python</td>
<td>1</td>
<td>Intro to Python: part I</td>
<td>declaring variables, printing, running cells, exporting to different formats, etc.</td>
</tr>
<tr class="even">
<td>Python</td>
<td>2</td>
<td>Intro to Python: part II</td>
<td>lists, tuples, if statements, opening files, pandas, matplotlib, etc.</td>
</tr>
<tr class="odd">
<td>Python</td>
<td>3</td>
<td>Intro to Python: part III</td>
<td>sets, dicts, pandas, matplotlib, lists, tuples, etc.</td>
</tr>
<tr class="even">
<td>Python</td>
<td>4</td>
<td>Control flow in Python</td>
<td>if statements, for loops, dicts, lists, matplotlib, etc.</td>
</tr>
<tr class="odd">
<td>Python</td>
<td>5</td>
<td>Scientific computing/Data wrangling: part I</td>
<td>timing, I/O, indexing in pandas, pandas functions, matplotlib, etc.</td>
</tr>
<tr class="even">
<td>Python</td>
<td>6</td>
<td>Functions: part I</td>
<td>writing functions, docstrings, pandas, etc.</td>
</tr>
<tr class="odd">
<td>Python</td>
<td>7</td>
<td>Functions: part II</td>
<td>writing functions, docstrings, pandas, etc.</td>
</tr>
<tr class="even">
<td>Python</td>
<td>8</td>
<td>Scientific computing/Data wrangling: part II</td>
<td>building a recommendation system</td>
</tr>
<tr class="odd">
<td>Python</td>
<td>9</td>
<td>Scientific computing/Data wrangling: part III</td>
<td>building a recommendation system, continued...</td>
</tr>
<tr class="even">
<td>Python</td>
<td>10</td>
<td>Packages</td>
<td>Learn more about Python packaging, importing, etc.</td>
</tr>
<tr class="odd">
<td>Python</td>
<td>11</td>
<td>Python Classes: part I</td>
<td>writing classes in Python to build a game, dunder methods, attributes, methods, etc.</td>
</tr>
<tr class="even">
<td>Python</td>
<td>12</td>
<td>Python Classes: part II</td>
<td>writing classes in Python to build a game, dunder methods, attributes, methods, etc., continued...</td>
</tr>
<tr class="odd">
<td>Python</td>
<td>13</td>
<td>Data wrangling &amp; matplotlib: part I</td>
<td>more pandas, more matplotlib, wrangling with increased difficulty, etc.</td>
</tr>
<tr class="even">
<td>Python</td>
<td>14</td>
<td>Data wrangling &amp; matplotlib: part II</td>
<td>more pandas, more matplotlib, wrangling with increased difficulty, etc.</td>
</tr>
</tbody>
</table>
</div>
<div id="p01-190" class="section level3">
<h3>Project 1</h3>
<hr />
<p><strong>Motivation:</strong> In this course we require the majority of project submissions to include a compiled PDF, a .Rmd file based off of <a href="https://raw.githubusercontent.com/TheDataMine/the-examples-book/master/files/project_template.Rmd">our template</a>, and a code file (a .R file if the project is in R, a .py file if the project is in Python). Although RStudio makes it easy to work with both Python and R, there are occasions where working out a Python problem in a Jupyter Notebook could be convenient. For that reason, we will introduce Jupyter Notebook in this project.</p>
<p><strong>Context:</strong> This is the first in a series of projects that will introduce Python and its tooling to students.</p>
<p><strong>Scope:</strong> jupyter notebooks, rstudio, python</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Use Jupyter Notebook to run Python code and create Markdown text.
</li>
<li>
Use RStudio to run Python code and compile your final PDF.
</li>
<li>
Gain exposure to Python control flow and reading external data.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/open_food_facts/openfoodfacts.tsv</code></p>
</div>
<div id="questions" class="section level4">
<h4>Questions</h4>
<div id="navigate-to-httpsnotebook.scholar.rcac.purdue.edu-and-sign-in-with-your-purdue-credentials-without-boilerkey.-this-is-an-instance-of-jupyter-notebook.-the-main-screen-will-show-a-series-of-files-and-folders-that-are-in-your-home-directory.-create-a-new-notebook-by-clicking-on-new-f2020-s2021." class="section level5">
<h5>1. Navigate to <a href="https://notebook.scholar.rcac.purdue.edu/" class="uri">https://notebook.scholar.rcac.purdue.edu/</a> and sign in with your Purdue credentials (<em>without</em> BoilerKey). This is an instance of Jupyter Notebook. The main screen will show a series of files and folders that are in your <code>$HOME</code> directory. Create a new notebook by clicking on <code>New &gt; f2020-s2021</code>.</h5>
</div>
<div id="change-the-name-of-your-notebook-to-lastname_firstname_project01-where-lastname-is-your-family-name-and-firstname-is-your-given-name.-try-to-export-your-notebook-using-the-file-dropdown-menu-choosing-the-option-download-as-what-format-options-for-example-.pdf-are-available-to-you" class="section level5">
<h5>Change the name of your notebook to &quot;LASTNAME_FIRSTNAME_project01&quot; where &quot;LASTNAME&quot; is your family name, and &quot;FIRSTNAME&quot; is your given name. Try to export your notebook (using the <code>File</code> dropdown menu, choosing the option <code>Download as</code>), what format options (for example, <code>.pdf</code>) are available to you?</h5>
<p><strong>Important note:</strong> <code>f2020-s2021</code> is the name of our course notebook kernel. A notebook kernel is an engine that runs code in a notebook. ipython kernels run Python code. <code>f2020-s2021</code> is an ipython kernel that we've created for our course Python environment, which contains a variety of compatible, pre-installed packages for you to use. When you select <code>f2020-s2021</code> as your kernel, all of the packages in our course environment are automatically made available to you.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_4g2lwx5g">Click here for video</a></p>
<p>If the kernel <code>f2020-s2021</code> does not appear in Jupyter Notebooks, you can make it appear as follows:</p>
<p>Login to <a href="https://rstudio.scholar.rcac.purdue.edu" class="uri">https://rstudio.scholar.rcac.purdue.edu</a><br />
Click on <code>Tools &gt; Shell...</code> (in the menu)<br />
In the shell (terminal looking thing that should say something like: <code>bash-4.2$</code>), type the following followed by Enter/Return: <code>/class/datamine/apps/runme</code><br />
Then click on <code>Session &gt; Restart R</code> (in the menu)<br />
You should now have access to the course kernel named <code>f2020-s2021</code> in <a href="https://notebook.scholar.rcac.purdue.edu" class="uri">https://notebook.scholar.rcac.purdue.edu</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
A list of export format options.
</li>
</ul>
</div>
</div>
<div id="solution" class="section level5">
<h5>Solution</h5>
<div class="solution">
<ul>
<li>
.ipynb
</li>
<li>
.py
</li>
<li>
.html
</li>
<li>
.md
</li>
<li>
.rst
</li>
<li>
.tex
</li>
<li>
.pdf
</li>
</ul>
</div>
</div>
<div id="each-box-in-a-jupyter-notebook-is-called-a-cell.-there-are-two-primary-types-of-cells-code-and-markdown.-by-default-a-cell-will-be-a-code-cell.-place-the-following-python-code-inside-the-first-cell-and-run-the-cell.-what-is-the-output" class="section level5">
<h5>2. Each &quot;box&quot; in a Jupyter Notebook is called a <em>cell</em>. There are two primary types of cells: code, and markdown. By default, a cell will be a code cell. Place the following Python code inside the first cell, and run the cell. What is the output?</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> thedatamine <span class="im">import</span> hello_datamine
hello_datamine()</code></pre></div>
<p><strong>Hint:</strong> You can run the code in the currently selected cell by using the GUI (the buttons), as well as by pressing <code>Ctrl+Return/Enter</code>.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Output from running the provided code.
</li>
</ul>
</div>
</div>
<div id="solution-1" class="section level5">
<h5>Solution</h5>
<div class="solution">
<p>
&quot;Hello student! Welcome to The Data Mine!&quot;
</p>
</div>
</div>
<div id="jupyter-notebooks-allow-you-to-easily-pull-up-documentation-similar-to-function-in-r.-to-do-so-use-the-help-function-like-this-helpmy_function.-what-is-the-output-from-running-the-help-function-on-hello_datamine-can-you-modify-the-code-from-question-2-to-print-a-customized-message-create-a-new-markdown-cell-and-explain-what-you-did-to-the-code-from-question-2-to-make-the-message-customized." class="section level5">
<h5>3. Jupyter Notebooks allow you to easily pull up documentation, similar to <code>?function</code> in R. To do so, use the <code>help</code> function, like this: <code>help(my_function)</code>. What is the output from running the help function on <code>hello_datamine</code>? Can you modify the code from question (2) to print a customized message? Create a new <em>markdown</em> cell and explain what you did to the code from question (2) to make the message customized.</h5>
<p><strong>Important note:</strong> Some Jupyter-only methods to do this are:</p>
<ul>
<li>Click on the function of interest and type <code>Shift+Tab</code> or <code>Shift+Tab+Tab</code>.</li>
<li>Run <code>function?</code>, for example, <code>print?</code>.</li>
</ul>
<p><strong>Important note:</strong> You can also see the source code of a function in a Jupyter Notebook by typing <code>function??</code>, for example, <code>print??</code>.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Output from running the <code>help</code> function on <code>hello_datamine</code>.
</li>
<li>
Modified code from question (2) that prints a customized message.
</li>
</ul>
</div>
</div>
<div id="solution-2" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="bu">help</span>(hello_datamine)</code></pre></div>
<div class="solution">
<p>
Help on function hello_datamine in module thedatamine.core:
</p>
<p>
hello_datamine(name: str = 'student') -&gt; None Prints a hello message to a Data Mine student.
</p>
<pre><code>Args:
    str (name, optional): The name of a student. Defaults to &#39;student&#39;.</code></pre>
</div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">hello_datamine(<span class="st">&quot;Kevin&quot;</span>)</code></pre></div>
</div>
<div id="at-this-point-in-time-youve-now-got-the-basics-of-running-python-code-in-jupyter-notebooks.-there-is-really-not-a-whole-lot-more-to-it.-for-this-class-however-we-will-continue-to-create-rmarkdown-documents-in-addition-to-the-compiled-pdfs.-you-are-welcome-to-use-jupyter-notebooks-for-personal-projects-or-for-testing-things-out-however-we-will-still-require-an-rmarkdown-file-.rmd-pdf-generated-from-the-rmarkdown-file-and-.py-file-containing-your-python-code.-for-example-please-move-your-solutions-from-questions-1-2-3-from-jupyter-notebooks-over-to-rmarkdown-we-discuss-rmarkdown-below.-lets-learn-how-to-run-python-code-chunks-in-rmarkdown." class="section level5">
<h5>4. At this point in time, you've now got the basics of running Python code in Jupyter Notebooks. There is really not a whole lot more to it. For this class, however, we will continue to create RMarkdown documents in addition to the compiled PDFs. You are welcome to use Jupyter Notebooks for personal projects or for testing things out, however, we will still require an RMarkdown file (.Rmd), PDF (generated from the RMarkdown file), and .py file (containing your python code). For example, please move your solutions from Questions 1, 2, 3 from Jupyter Notebooks over to RMarkdown (we discuss RMarkdown below). Let's learn how to run Python code chunks in RMarkdown.</h5>
</div>
<div id="sign-in-to-httpsrstudio.scholar.rcac.purdue.edu-with-boilerkey.-projects-in-the-data-mine-should-all-be-submitted-using-our-template-found-here-or-on-scholar-classdatamineappstemplatesproject_template.rmd." class="section level5">
<h5>Sign in to <a href="https://rstudio.scholar.rcac.purdue.edu" class="uri">https://rstudio.scholar.rcac.purdue.edu</a> (<em>with</em> BoilerKey). Projects in The Data Mine should all be submitted using our template found <a href="https://raw.githubusercontent.com/TheDataMine/the-examples-book/master/files/project_template.Rmd">here</a> or on Scholar (<code>/class/datamine/apps/templates/project_template.Rmd</code>).</h5>
</div>
<div id="open-the-project-template-and-save-it-into-your-home-directory-in-a-new-rmarkdown-file-named-project01.rmd.-prior-to-running-any-python-code-run-datamine_py-in-the-r-console-just-like-you-did-at-the-beginning-of-every-project-from-the-first-semester." class="section level5">
<h5>Open the project template and save it into your home directory, in a new RMarkdown file named <code>project01.Rmd</code>. Prior to running any Python code, run <code>datamine_py()</code> in the R console, just like you did at the beginning of every project from the first semester.</h5>
</div>
<div id="code-chunks-are-parts-of-the-rmarkdown-file-that-contains-code.-you-can-identify-what-type-of-code-a-code-chunk-contains-by-looking-at-the-engine-in-the-curly-braces-and-.-as-you-can-see-it-is-possible-to-mix-and-match-different-languages-just-by-changing-the-engine.-move-the-solutions-for-questions-1-3-to-your-project01.rmd.-make-sure-to-place-all-python-code-in-python-code-chunks.-run-the-python-code-chunks-to-ensure-you-get-the-same-results-as-you-got-when-running-the-python-code-in-a-jupyter-notebook." class="section level5">
<h5>Code chunks are parts of the RMarkdown file that contains code. You can identify what type of code a code chunk contains by looking at the <em>engine</em> in the curly braces &quot;{&quot; and &quot;}&quot;. As you can see, it is possible to mix and match different languages just by changing the engine. Move the solutions for questions 1-3 to your <code>project01.Rmd</code>. Make sure to place all Python code in <code>python</code> code chunks. Run the <code>python</code> code chunks to ensure you get the same results as you got when running the Python code in a Jupyter Notebook.</h5>
<p><strong>Important note:</strong> Make sure to run <code>datamine_py()</code> in the R console prior to attempting to run any Python code.</p>
<p><strong>Hint:</strong> The end result of the <code>project01.Rmd</code> should look <em>similar</em> to <a href="https://raw.githubusercontent.com/TheDataMine/the-examples-book/master/files/example02.Rmd">this</a>.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_nhkygxg9">Click here for video</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_tdz3wmim">Click here for video</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
<code>project01.Rmd</code> with the solutions from questions 1-3 (including any Python code in <code>python</code> code chunks).
</li>
</ul>
</div>
</div>
<div id="solution-3" class="section level5">
<h5>Solution</h5>
<div class="solution">
<p>
Done.
</p>
</div>
</div>
<div id="it-is-not-a-data-mine-project-without-data-here-are-some-examples-of-reading-in-data-line-by-line-using-the-csv-package.-how-many-columns-are-in-the-following-dataset-classdataminedataopen_food_factsopenfoodfacts.tsv-print-the-first-row-the-number-of-columns-and-then-exit-the-loop-after-the-first-iteration-using-the-break-keyword." class="section level5">
<h5>5. It is not a Data Mine project without data! <a href="python.html#p-csv-pkg">Here</a> are some examples of reading in data line by line using the <code>csv</code> package. How many columns are in the following dataset: <code>/class/datamine/data/open_food_facts/openfoodfacts.tsv</code>? Print the first row, the number of columns, and then exit the loop after the first iteration using the <code>break</code> keyword.</h5>
<p><strong>Hint:</strong> You can get the number of elements in a list by using the <code>len</code> method. For example: <code>len(my_list)</code>.</p>
<p><strong>Hint:</strong> You can use the <code>break</code> keyword to exit a loop. As soon as <code>break</code> is executed, the loop is exited and the code immediately following the loop is run.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">for</span> my_row <span class="kw">in</span> my_csv_reader:
    <span class="bu">print</span>(my_row)
    <span class="cf">break</span>

<span class="bu">print</span>(<span class="st">&quot;Exited loop as soon as &#39;break&#39; was run.&quot;</span>)</code></pre></div>
<p><strong>Hint:</strong> <code>'\t'</code> represents a tab in Python.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_ck74xlzq">Click here for video</a></p>
<p><strong>Important note:</strong> If you get a Dtype warning, feel free to just ignore it.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-for-loops">for loops</a>, <a href="python.html#p-break">break</a>, <a href="#p-print">print</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve this problem.
</li>
<li>
The first row printed, and the number of columns printed.
</li>
</ul>
</div>
</div>
<div id="solution-4" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">import</span> csv
<span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;/class/datamine/data/open_food_facts/openfoodfacts.tsv&#39;</span>) <span class="im">as</span> my_file:
    my_reader <span class="op">=</span> csv.reader(my_file, delimiter<span class="op">=</span><span class="st">&#39;</span><span class="ch">\t</span><span class="st">&#39;</span>)
    <span class="cf">for</span> row <span class="kw">in</span> my_reader:
        <span class="bu">print</span>(row)
        <span class="bu">print</span>(<span class="bu">len</span>(row))
        <span class="cf">break</span> <span class="co"># prematurely leave the loop</span></code></pre></div>
</div>
<div id="p1-06" class="section level5">
<h5>6 (optional). Unlike in R, where many of the tools you need are built-in (<code>read.csv</code>, data.frames, etc.), in Python, you will need to rely on packages like <code>numpy</code> and <code>pandas</code> to do the bulk of your data science work.</h5>
</div>
<div id="in-r-it-would-be-really-easy-to-find-the-mean-of-the-151st-column-caffeine_100g" class="section level5">
<h5>In R it would be really easy to find the mean of the 151st column, <code>caffeine_100g</code>:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myDF &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/open_food_facts/openfoodfacts.tsv&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">quote=</span><span class="st">&quot;&quot;</span>)
<span class="kw">mean</span>(myDF<span class="op">$</span>caffeine_100g, <span class="dt">na.rm=</span>T) <span class="co"># 2.075503</span></code></pre></div>
</div>
<div id="if-you-were-to-try-to-modify-our-loop-from-question-5-to-do-the-same-thing-you-will-run-into-a-myriad-of-issues-just-to-try-and-get-the-mean-of-a-column.-luckily-it-is-easy-to-do-using-pandas" class="section level5">
<h5>If you were to try to modify our loop from question (5) to do the same thing, you will run into a myriad of issues, just to try and get the mean of a column. Luckily, it is easy to do using <code>pandas</code>:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> pandas <span class="im">as</span> pd
myDF <span class="op">=</span> pd.read_csv(<span class="st">&quot;/class/datamine/data/open_food_facts/openfoodfacts.tsv&quot;</span>, sep<span class="op">=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)
myDF[<span class="st">&quot;caffeine_100g&quot;</span>].mean() <span class="co"># 2.0755028571428573</span></code></pre></div>
</div>
<div id="take-a-look-at-some-of-the-methods-you-can-perform-using-pandas-here.-perform-an-interesting-calculation-in-r-and-replicate-your-work-using-pandas.-which-did-you-prefer-python-or-r" class="section level5">
<h5>Take a look at some of the methods you can perform using pandas <a href="https://pandas.pydata.org/pandas-docs/stable/reference/frame.html#computations-descriptive-stats">here</a>. Perform an interesting calculation in R, and replicate your work using <code>pandas</code>. Which did you prefer, Python or R?</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_ybx1iukd">Click here for video</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Python code used to solve the problem.
</li>
</ul>
</div>
</div>
<div id="solution-5" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="co"># could be anything.</span></code></pre></div>
<hr />
</div>
</div>
</div>
<div id="p02-190" class="section level3">
<h3>Project 2</h3>
<hr />
<p><strong>Motivation:</strong> In Python it is very important to understand some of the data types in a little bit more depth than you would in R. Many of the data types in Python will seem very familiar. A <code>character</code> in R is similar to a <code>str</code> in Python. An <code>integer</code> in R is an <code>int</code> in Python. A <code>numeric</code> in R is similar to a <code>float</code> in Python. A <code>logical</code> in R is similar to a <code>bool</code> in Python. In addition to all of that, there are some very popular classes that packages like <code>numpy</code> and <code>pandas</code> introduces. On the other hand, there are some data types in Python like <code>tuple</code>s, <code>list</code>s, <code>set</code>s, and <code>dict</code>s that diverge from R a little bit more. It is integral to understand some basic concepts before jumping too far into everything.</p>
<p><strong>Context:</strong> This is the second project introducing some basic data types, and demonstrating some familiar control flow concepts, all while digging right into a dataset.</p>
<p><strong>Scope:</strong> tuples, lists, if statements, opening files</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
List the differences between lists &amp; tuples and when to use each.
</li>
<li>
Gain familiarity with string methods, list methods, and tuple methods.
</li>
<li>
Demonstrate the ability to read and write data of various formats using various packages.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset-1" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/craigslist/vehicles.csv</code></p>
</div>
<div id="questions-1" class="section level4">
<h4>Questions</h4>
<div id="read-in-the-dataset-classdataminedatacraigslistvehicles.csv-into-a-pandas-dataframe-called-mydf.-pandas-is-an-integral-tool-for-various-data-science-tasks-in-python.-you-can-read-a-quick-intro-here.-we-will-be-slowly-introducing-bits-and-pieces-of-this-package-throughout-the-semester.-similarly-we-will-try-to-introduce-byte-sized-ha-portions-of-plotting-packages-to-slowly-build-up-your-skills." class="section level5">
<h5>1. Read in the dataset <code>/class/datamine/data/craigslist/vehicles.csv</code> into a <code>pandas</code> DataFrame called <code>myDF</code>. <code>pandas</code> is an integral tool for various data science tasks in Python. You can read a quick intro <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/10min.html">here</a>. We will be slowly introducing bits and pieces of this package throughout the semester. Similarly, we will try to introduce byte-sized (ha!) portions of plotting packages to slowly build up your skills.</h5>
</div>
<div id="how-big-is-the-dataset-in-mb-or-gb" class="section level5">
<h5>How big is the dataset (in Mb or Gb)?</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_1bhwhkt2">Click here for video</a></p>
<p><strong>Important note:</strong> If you didn't do <a href="projects.html#p1-06">optional question 6 in project 1</a>, we would recommend taking a look.</p>
<p><strong>Hint:</strong> Remember to check out a question's <em>relevant topics</em>. We try very hard to link you to content and examples that will get you up and running as <em>quickly</em> as possible.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-read_csv">pandas read_csv</a>, <a href="python.html#p-pathlib-path">get filesize in Python</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
</ul>
</div>
</div>
<div id="solution-6" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">import</span> pandas <span class="im">as</span> pd
<span class="im">from</span> pathlib <span class="im">import</span> Path

myDF <span class="op">=</span> pd.read_csv(<span class="st">&quot;/class/datamine/data/craigslist/vehicles.csv&quot;</span>)

p <span class="op">=</span> Path(<span class="st">&quot;/class/datamine/data/craigslist/vehicles.csv&quot;</span>)
size_in_mb <span class="op">=</span> p.stat().st_size<span class="op">/</span><span class="dv">1000</span>
<span class="bu">print</span>(size_in_mb)</code></pre></div>
</div>
<div id="in-question-1-we-read-in-our-data-into-a-pandas-dataframe.-use-one-of-the-pandas-dataframe-attributes-to-get-the-number-of-columns-and-rows-of-our-dataset.-how-many-columns-and-rows-are-there-use-f-strings-to-print-a-message-for-example" class="section level5">
<h5>2. In question (1) we read in our data into a <code>pandas</code> DataFrame. Use one of the <code>pandas</code> DataFrame <a href="https://pandas.pydata.org/docs/reference/frame.html#attributes-and-underlying-data">attributes</a> to get the number of columns and rows of our dataset. How many columns and rows are there? Use f-strings to print a message, for example:</h5>
<pre><code>There are 123 columns in the DataFrame!
There are 321 rows in the DataFrame!</code></pre>
</div>
<div id="in-project-1-we-learned-how-to-read-a-csv-file-in-line-by-line-and-print-values.-use-the-csv-package-to-print-just-the-first-row-which-should-contain-the-names-of-the-columns-or-instead-of-using-the-csv-package-use-one-of-the-pandas-attributes-from-mydf-to-print-the-column-names." class="section level5">
<h5>In project 1, we learned how to read a csv file in, line-by-line, and print values. Use the <code>csv</code> package to print <em>just</em> the first row, which should contain the names of the columns, OR instead of using the <code>csv</code> package, use one of the <code>pandas</code> attributes from <code>myDF</code> (to print the column names).</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_cifzobbk">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-csv-pkg">csv read csv</a>, <a href="python.html#p-pandas-dataframe">pandas DataFrame</a>, <a href="https://realpython.com/python-f-strings/#f-strings-a-new-and-improved-way-to-format-strings-in-python">f-strings</a>, <a href="python.html#p-break">break</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The output from printing the f-strings.
</li>
<li>
Python code used to solve the problem.
</li>
</ul>
</div>
</div>
<div id="solution-7" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="bu">print</span>(<span class="ss">f&#39;There are </span><span class="sc">{</span>myDF<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> columns in the DataFrame!&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;There are </span><span class="sc">{</span>myDF<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> columns in the DataFrame!&#39;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">import</span> csv

our_row <span class="op">=</span> []
<span class="cf">with</span> <span class="bu">open</span>(<span class="st">&quot;/class/datamine/data/craigslist/vehicles.csv&quot;</span>) <span class="im">as</span> my_file:
    my_reader <span class="op">=</span> csv.reader(my_file)
    <span class="cf">for</span> row <span class="kw">in</span> my_reader:
        our_row <span class="op">=</span> row
        <span class="cf">break</span>

<span class="bu">print</span>(our_row)
<span class="bu">print</span>(myDF.columns.to_list())</code></pre></div>
</div>
<div id="use-the-csv-or-pandas-package-to-get-a-list-called-our_columns-that-contains-the-column-names.-add-a-string-extra-to-the-end-of-our_columns.-print-the-second-value-in-the-list.-without-using-a-loop-print-the-1st-3rd-5th-etc.-elements-of-the-list.-print-the-last-four-elements-of-the-list-state-lat-long-and-extra-by-accessing-their-negative-index." class="section level5">
<h5>3. Use the <code>csv</code> or <code>pandas</code> package to get a <a href="python.html#p-lists-and-tuples">list</a> called <code>our_columns</code> that contains the column names. Add a string, &quot;extra&quot;, to the end of <code>our_columns</code>. Print the second value in the list. Without using a loop, print the 1st, 3rd, 5th, etc. elements of the list. Print the last four elements of the list ( &quot;state&quot;, &quot;lat&quot;, &quot;long&quot;, and &quot;extra&quot;) by accessing their negative index.</h5>
</div>
<div id="extra-doesnt-belong-in-our-list-you-can-easily-remove-this-value-from-our-list-by-doing-the-following" class="section level5">
<h5>&quot;extra&quot; doesn't belong in our list, you can easily remove this value from our list by doing the following:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">our_columns.pop(<span class="dv">25</span>)

<span class="co"># or even this, as pop removes the last value by default</span>
our_columns.pop()</code></pre></div>
</div>
<div id="but-the-problem-with-this-solution-is-that-you-must-know-the-index-of-the-value-youd-like-to-remove-and-sometimes-you-do-not-know-the-index-of-the-value.-instead-please-show-how-to-use-a-list-method-to-remove-extra-by-value-rather-than-by-index." class="section level5">
<h5>BUT the problem with this solution is that you must know the index of the value you'd like to remove, and sometimes you do not know the index of the value. Instead, please show how to use a <a href="python.html#p-list-methods">list method</a> to remove &quot;extra&quot; by <em>value</em> rather than by <em>index</em>.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_1z6kxfn1">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-csv-pkg">csv read csv</a>, <a href="python.html#p-break">break</a>, <a href="python.html#p-list-methods">append</a>, <a href="python.html#p-indexing">indexing</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
The output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-8" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">our_columns <span class="op">=</span> []
<span class="cf">with</span> <span class="bu">open</span>(<span class="st">&quot;/class/datamine/data/craigslist/vehicles.csv&quot;</span>) <span class="im">as</span> my_file:
    my_reader <span class="op">=</span> csv.reader(my_file)
    <span class="cf">for</span> row <span class="kw">in</span> my_reader:
        our_columns <span class="op">=</span> row
        <span class="cf">break</span>

our_columns.append(<span class="st">&quot;extra&quot;</span>)
<span class="bu">print</span>(our_columns[<span class="dv">1</span>])
<span class="bu">print</span>(our_columns[::<span class="dv">2</span>])
<span class="bu">print</span>(our_columns[<span class="op">-</span><span class="dv">4</span>:])

<span class="bu">print</span>(our_columns.remove(<span class="st">&quot;extra&quot;</span>))</code></pre></div>
</div>
<div id="matplotlib-is-one-of-the-primary-plotting-packages-in-python.-you-are-provided-with-the-following-code" class="section level5">
<h5>4. <code>matplotlib</code> is one of the primary plotting packages in Python. You are provided with the following code:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">my_values <span class="op">=</span> <span class="bu">tuple</span>(myDF.loc[:, <span class="st">&#39;odometer&#39;</span>].dropna().to_list())</code></pre></div>
</div>
<div id="the-result-is-a-tuple-containing-the-odometer-readings-from-all-of-the-vehicles-in-our-dataset.-create-a-lineplot-of-the-odometer-readings." class="section level5">
<h5>The result is a <em>tuple</em> containing the odometer readings from all of the vehicles in our dataset. Create a lineplot of the odometer readings.</h5>
</div>
<div id="well-that-plot-doesnt-seem-too-informative.-lets-first-sort-the-values-in-our-tuple" class="section level5">
<h5>Well, that plot doesn't seem too informative. Let's first sort the values in our tuple:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">my_values.sort()</code></pre></div>
</div>
<div id="what-happened-a-tuple-is-immutable.-what-this-means-is-that-once-the-contents-of-a-tuple-are-declared-they-cannot-be-modified.-for-example" class="section level5">
<h5>What happened? A tuple is immutable. What this means is that once the contents of a tuple are declared they cannot be modified. For example:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co"># This will fail because tuples are immutable</span>
my_values[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">100</span></code></pre></div>
</div>
<div id="you-can-read-a-good-article-about-this-here.-in-addition-here-is-a-great-post-that-gives-you-an-idea-when-using-a-tuple-might-be-a-good-idea.-okay-so-lets-go-back-to-our-problem.-we-know-that-lists-are-mutable-and-therefore-sortable-so-convert-my_values-to-a-list-and-then-sort-and-re-plot." class="section level5">
<h5>You can read a good article about this <a href="http://www.compciv.org/guides/python/fundamentals/tuples-immutable/">here</a>. In addition, <a href="https://stackoverflow.com/questions/1708510/list-vs-tuple-when-to-use-each">here</a> is a great post that gives you an idea when using a tuple might be a good idea. Okay, so let's go back to our problem. We know that lists <em>are</em> mutable (and therefore sortable), so convert <code>my_values</code> to a list and then sort, and re-plot.</h5>
</div>
<div id="it-looks-like-there-are-some-potential-outliers-that-are-making-our-plot-look-a-little-wonky.-for-the-sake-of-seeing-how-the-plot-would-look-use-negative-indexing-to-plot-the-sorted-values-minus-the-last-50-values-the-50-highest-values.-new-new-plot-may-not-look-that-different-that-is-okay." class="section level5">
<h5>It looks like there are some (potential) outliers that are making our plot look a little wonky. For the sake of seeing how the plot would look, use negative indexing to plot the sorted values <em>minus</em> the last 50 values (the 50 highest values). New new plot may not look <em>that</em> different, that is okay.</h5>
<p><strong>Hint:</strong> To prevent plotting values on the same plot, close your plot with the <code>close</code> method, for example:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt
my_values <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>]
plt.plot(my_values)
plt.show()
plt.close()</code></pre></div>
<p><strong>Relevant topics:</strong> <a href="python.html#p-list-methods">list methods</a>, <a href="python.html#p-indexing">indexing</a>, <a href="python.html#p-matplotlib-lineplot">matplotlib lineplot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
The output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-9" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt

my_values <span class="op">=</span> <span class="bu">tuple</span>(myDF.loc[:, <span class="st">&#39;odometer&#39;</span>].dropna().to_list())
plt.plot(my_values)
plt.close()

my_values <span class="op">=</span> <span class="bu">list</span>(my_values)
my_values.sort()
plt.plot(my_values)
plt.show()
plt.close()

plt.plot(my_values[:<span class="op">-</span><span class="dv">50</span>])
plt.show()
plt.close()</code></pre></div>
</div>
<div id="weve-covered-a-lot-in-this-project-use-what-youve-learned-so-far-to-do-one-or-more-of-the-following-tasks" class="section level5">
<h5>5. We've covered a lot in this project! Use what you've learned so far to do one (or more) of the following tasks:</h5>
</div>
<div id="create-a-cool-graphic-using-matplotlib-that-summarizes-some-data-from-our-dataset." class="section level5">
<h5>- Create a cool graphic using <code>matplotlib</code>, that summarizes some data from our dataset.</h5>
</div>
<div id="use-pandas-and-your-investigative-skills-to-sift-through-the-dataset-and-glean-an-interesting-factoid." class="section level5">
<h5>- Use <code>pandas</code> and your investigative skills to sift through the dataset and glean an interesting factoid.</h5>
</div>
<div id="create-some-commented-coding-examples-that-highlight-the-differences-between-lists-and-tuples.-include-at-least-3-examples." class="section level5">
<h5>- Create some commented coding examples that highlight the differences between lists and tuples. Include at least 3 examples.</h5>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas">pandas</a>, <a href="python.html#p-indexing">indexing</a>, <a href="python.html#p-matplotlib">matplotlib</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
The output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-10" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="co"># Could be anything.</span></code></pre></div>
<hr />
</div>
</div>
</div>
<div id="p03-190" class="section level3">
<h3>Project 3</h3>
<hr />
<p><strong>Motivation:</strong> A dictionary (referred to as a <code>dict</code>) is one of the most useful data structures in Python. You can think about them as a data structure containing <em>key</em>: <em>value</em> pairs. Under the hood, a <code>dict</code> is essentially a data structure called a <em>hash table</em>. <a href="https://en.wikipedia.org/wiki/Hash_table">Hash tables</a> are a data structure with a useful set of properties. The time needed for searching, inserting, or removing a piece of data has a constant average lookup time, meaning that no matter how big your hash table grows to be, inserting, searching, or deleting a piece of data will <em>usually</em> take about the same amount of time. (The worst case time increases linearly.) Dictionaries (<code>dict</code>) are used a lot, so it is worthwhile to understand them. Although not used quite as often, another important data type called a <code>set</code>, is also worthwhile learning about.</p>
<p>Dictionaries, often referred to as dicts, are really powerful. There are two primary ways to &quot;get&quot; information from a dict. One is to use the <code>get</code> method, the other is to use square brackets and strings. Test out the following to understand the differences between the two:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">my_dict <span class="op">=</span> {<span class="st">&quot;fruits&quot;</span>: [<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;pear&quot;</span>], <span class="st">&quot;person&quot;</span>: <span class="st">&quot;John&quot;</span>, <span class="st">&quot;vegetables&quot;</span>: [<span class="st">&quot;carrots&quot;</span>, <span class="st">&quot;peas&quot;</span>]}

<span class="co"># If &quot;person&quot; is indeed a key, they will function the same way</span>
my_dict[<span class="st">&quot;person&quot;</span>]
my_dict.get(<span class="st">&quot;person&quot;</span>)

<span class="co"># If the key does not exist, like below, they will not </span>
<span class="co"># function the same way.</span>
my_dict.get(<span class="st">&quot;height&quot;</span>) <span class="co"># Returns None when key doesn&#39;t exist</span>
<span class="bu">print</span>(my_dict.get(<span class="st">&quot;height&quot;</span>)) <span class="co"># By printing, we can see None in this case</span>
my_dict[<span class="st">&quot;height&quot;</span>] <span class="co"># Throws a KeyError exception because the key, &quot;height&quot; doesn&#39;t exist</span></code></pre></div>
<p><strong>Context:</strong> In our third project, we introduce some basic data types, and we demonstrate some familiar control flow concepts, all while digging right into a dataset. Throughout the course, we will slowly introduce concepts from <code>pandas</code>, and popular plotting packages.</p>
<p><strong>Scope:</strong> dicts, sets, if/else statements, opening files, tuples, lists</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Explain what is a <code>dict</code> is and why it is useful.
</li>
<li>
Understand how a <code>set</code> works and when it could be useful.
</li>
<li>
List the differences between lists &amp; tuples and when to use each.
</li>
<li>
Gain familiarity with string methods, list methods, and tuple methods.
</li>
<li>
Gain familiarity with dict methods.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset-2" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/craigslist/vehicles.csv</code></p>
</div>
<div id="questions-2" class="section level4">
<h4>Questions</h4>
<div id="in-project-2-we-learned-how-to-read-in-data-using-pandas.-read-in-the-classdataminedatacraigslistvehicles.csv-dataset-into-a-dataframe-called-mydf-using-pandas.-in-r-we-can-get-a-sneak-peek-at-the-data-by-doing-something-like" class="section level5">
<h5>1. In project 2 we learned how to read in data using <code>pandas</code>. Read in the (<code>/class/datamine/data/craigslist/vehicles.csv</code>) dataset into a DataFrame called <code>myDF</code> using <code>pandas</code>. In R we can get a sneak peek at the data by doing something like:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(myDF) <span class="co"># where myDF is a data.frame</span></code></pre></div>
</div>
<div id="there-is-a-very-similar-and-aptly-named-method-in-pandas-that-allows-us-to-do-the-exact-same-thing-with-a-pandas-dataframe.-get-the-head-of-mydf-and-take-a-moment-to-consider-how-much-time-it-would-take-to-get-this-information-if-we-didnt-have-this-nice-head-method." class="section level5">
<h5>There is a very similar (and aptly named method) in <code>pandas</code> that allows us to do the exact same thing with a <code>pandas</code> DataFrame. Get the <code>head</code> of <code>myDF</code>, and take a moment to consider how much time it would take to get this information if we didn't have this nice <code>head</code> method.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_1rqwiges">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-read_csv">pandas read_csv</a>, <a href="python.html#p-pandas-dataframe">head</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
The <code>head</code> of the dataset.
</li>
</ul>
</div>
</div>
<div id="solution-11" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">import</span> pandas <span class="im">as</span> pd

myDF <span class="op">=</span> pd.read_csv(<span class="st">&quot;/class/datamine/data/craigslist/vehicles.csv&quot;</span>)
myDF.head()</code></pre></div>
</div>
<div id="dictionaries-often-referred-to-as-dicts-are-really-powerful.-there-are-two-primary-ways-to-get-information-from-a-dict.-one-is-to-use-the-get-method-the-other-is-to-use-square-brackets-and-strings.-test-out-the-following-to-understand-the-differences-between-the-two" class="section level5">
<h5>2. Dictionaries, often referred to as dicts, are really powerful. There are two primary ways to &quot;get&quot; information from a dict. One is to use the <code>get</code> method, the other is to use square brackets and strings. Test out the following to understand the differences between the two:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">my_dict <span class="op">=</span> {<span class="st">&quot;fruits&quot;</span>: [<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;pear&quot;</span>], <span class="st">&quot;person&quot;</span>: <span class="st">&quot;John&quot;</span>, <span class="st">&quot;vegetables&quot;</span>: [<span class="st">&quot;carrots&quot;</span>, <span class="st">&quot;peas&quot;</span>]}

<span class="co"># If &quot;person&quot; is indeed a key, they will function the same way</span>
my_dict[<span class="st">&quot;person&quot;</span>]
my_dict.get(<span class="st">&quot;person&quot;</span>)

<span class="co"># If the key does not exist, like below, they will not </span>
<span class="co"># function the same way.</span>
my_dict.get(<span class="st">&quot;height&quot;</span>) <span class="co"># Returns None when key doesn&#39;t exist</span>
<span class="bu">print</span>(my_dict.get(<span class="st">&quot;height&quot;</span>)) <span class="co"># By printing, we can see None in this case</span>
my_dict[<span class="st">&quot;height&quot;</span>] <span class="co"># Throws a KeyError exception because the key, &quot;height&quot; doesn&#39;t exist</span></code></pre></div>
</div>
<div id="look-at-the-dataset.-create-a-dict-called-my_dict-that-contains-keyvalue-pairs-where-the-keys-are-years-and-the-values-are-a-single-int-representing-the-number-of-vehicles-from-that-year-on-craigslist.-use-the-year-column-a-loop-and-a-dict-to-accomplish-this.-print-the-dictionary.-you-can-use-the-following-code-to-extract-the-year-column-as-a-list.-in-the-next-project-we-will-learn-how-to-loop-over-pandas-dataframes." class="section level5">
<h5>Look at the dataset. Create a dict called <code>my_dict</code> that contains key:value pairs where the keys are years, and the values are a single int representing the number of vehicles from that year on craigslist. Use the <code>year</code> column, a loop, and a dict to accomplish this. Print the dictionary. You can use the following code to extract the <code>year</code> column as a list. In the next project we will learn how to loop over <code>pandas</code> DataFrames.</h5>
<p><strong>Hint:</strong> If you get a <code>KeyError</code>, remember, you must declare each key value pair just like any other variable. Use the following code to initialize each <code>year</code> key to the value 0.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">myyears <span class="op">=</span> myDF[<span class="st">&#39;year&#39;</span>].dropna().to_list()

<span class="co"># get a list containing each unique year</span>
unique_years <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(myyears))

<span class="co"># for each year (key), initialize the value (value) to 0</span>
my_dict <span class="op">=</span> {}
<span class="cf">for</span> year <span class="kw">in</span> unique_years:
    my_dict[year] <span class="op">=</span> <span class="dv">0</span></code></pre></div>
<p><strong>Hint:</strong> Here are some of the results you should get:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(my_dict[<span class="dv">1912</span>]) <span class="co"># 5</span>
<span class="bu">print</span>(my_dict[<span class="dv">1982</span>]) <span class="co"># 185</span>
<span class="bu">print</span>(my_dict[<span class="dv">2014</span>]) <span class="co"># 31703</span></code></pre></div>
<p><strong>Note:</strong> There is a special kind of <code>dict</code> called a <code>defaultdict</code>, that allows you to give default values to a <code>dict</code>, giving you the ability to &quot;skip&quot; initialization. We will show you this when we release the solutions to this project! It is not required, but it is interesting to know about!</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_cl3b1xyy">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-dicts">dicts</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
<code>my_dict</code> printed.
</li>
</ul>
</div>
</div>
<div id="solution-12" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">years <span class="op">=</span> myDF[<span class="st">&#39;year&#39;</span>].dropna().to_list()

unique_years <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(years))

my_dict <span class="op">=</span> {}
<span class="cf">for</span> year <span class="kw">in</span> unique_years:
    my_dict[year] <span class="op">=</span> <span class="dv">0</span>

<span class="cf">for</span> year <span class="kw">in</span> years:
    my_dict[year] <span class="op">+=</span> <span class="dv">1</span>
    
<span class="bu">print</span>(my_dict)</code></pre></div>
<p>OR</p>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">from</span> collections <span class="im">import</span> defaultdict

years <span class="op">=</span> myDF[<span class="st">&#39;year&#39;</span>].dropna().to_list()
my_dict <span class="op">=</span> defaultdict(<span class="bu">int</span>)
<span class="cf">for</span> year <span class="kw">in</span> years:
    my_dict[year] <span class="op">+=</span> <span class="dv">1</span>

<span class="bu">print</span>(my_dict)</code></pre></div>
</div>
<div id="after-completing-question-2-you-can-easily-access-the-number-of-vehicles-from-a-given-year.-for-example-to-get-the-number-of-vehicles-on-craigslist-from-1912-just-run" class="section level5">
<h5>3. After completing question (2) you can easily access the number of vehicles from a given year. For example, to get the number of vehicles on craigslist from 1912, just run:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">my_dict[<span class="dv">1912</span>]

<span class="co"># or</span>

my_dict.get(<span class="dv">1912</span>)</code></pre></div>
</div>
<div id="a-dict-stores-its-data-in-keyvalue-pairs.-identify-a-key-from-my_dict-as-well-as-the-associated-value.-as-you-can-imagine-having-data-in-this-format-can-be-very-beneficial.-one-benefit-is-the-ability-to-easily-create-a-graphic-using-matplotlib.-use-matplotlib-to-create-a-bar-graph-with-the-year-on-the-x-axis-and-the-number-of-vehicles-from-that-year-on-the-y-axis." class="section level5">
<h5>A <code>dict</code> stores its data in key:value pairs. Identify a &quot;key&quot; from <code>my_dict</code>, as well as the associated &quot;value&quot;. As you can imagine, having data in this format can be very beneficial. One benefit is the ability to easily create a graphic using <code>matplotlib</code>. Use <code>matplotlib</code> to create a bar graph with the year on the x-axis, and the number of vehicles from that year on the y-axis.</h5>
<p><strong>Important note:</strong> If when you end up seeing something like <code>&lt;BarContainer object of X artists&gt;</code>, you should probably end the code chunk with <code>plt.show()</code> instead. What is happening is Python is trying to <code>print</code> the plot object. That text is the result. To instead display the plot you need to call <code>plt.show()</code>.</p>
<p><strong>Hint:</strong> To use <code>matplotlib</code>, first import it:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt

<span class="co"># now you can use it, for example</span>
plt.plot([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>])
plt.show()
plt.close()</code></pre></div>
<p><strong>Hint:</strong> The <code>keys</code> method and <code>values</code> method from <code>dict</code> could be useful here.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_mn3a3kss">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-dicts">dicts</a>, <a href="python.html#p-matplotlib">matplotlib</a>, <a href="python.html#p-matplotlib-barplot">barplot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
The resulting plot.
</li>
<li>
A sentence giving an example of a &quot;key&quot; and associated &quot;value&quot; from <code>my_dict</code> (e.g., a sentence explaining the 1912 example above).
</li>
</ul>
</div>
</div>
<div id="solution-13" class="section level5">
<h5>Solution</h5>
<div class="solution">
<p>
In <code>my_dict</code> a key is 1912, and the associated value is 5.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt

plt.bar(my_dict.keys(), my_dict.values())</code></pre></div>
</div>
<div id="in-the-hint-in-question-2-we-used-a-set-to-quickly-get-a-list-of-unique-years-in-a-list.-some-other-common-uses-of-a-set-are-when-you-want-to-get-a-list-of-values-that-are-in-one-list-but-not-another-or-get-a-list-of-values-that-are-present-in-both-lists.-examine-the-following-code.-youll-notice-that-we-are-looping-over-many-values.-replace-the-code-for-each-of-the-three-examples-below-with-code-that-uses-no-loops-whatsoever." class="section level5">
<h5>4. In the hint in question (2), we used a <code>set</code> to quickly get a list of unique years in a list. Some other common uses of a <code>set</code> are when you want to get a list of values that are in one list but not another, or get a list of values that are present in both lists. Examine the following code. You'll notice that we are looping over many values. Replace the code for each of the three examples below with code that uses <em>no</em> loops whatsoever.</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">listA <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">12</span>]
listB <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>]

<span class="co"># 1. values in list A but not list B</span>
<span class="co"># values in list A but not list B</span>
onlyA <span class="op">=</span> []
<span class="cf">for</span> valA <span class="kw">in</span> listA:
    <span class="cf">if</span> valA <span class="kw">not</span> <span class="kw">in</span> listB <span class="kw">and</span> valA <span class="kw">not</span> <span class="kw">in</span> onlyA:
        onlyA.append(valA)

<span class="bu">print</span>(onlyA) <span class="co"># [3, 4, 5, 6]</span>

<span class="co"># 2. values in listB but not list A</span>
onlyB <span class="op">=</span> []
<span class="cf">for</span> valB <span class="kw">in</span> listB:
    <span class="cf">if</span> valB <span class="kw">not</span> <span class="kw">in</span> listA <span class="kw">and</span> valB <span class="kw">not</span> <span class="kw">in</span> onlyB:
        onlyB.append(valB)

<span class="bu">print</span>(onlyB) <span class="co"># [7, 8, 9, 10, 11, 13]</span>

<span class="co"># 3. values in both lists</span>
<span class="co"># values in both lists</span>
in_both_lists <span class="op">=</span> []
<span class="cf">for</span> valA <span class="kw">in</span> listA:
    <span class="cf">if</span> valA <span class="kw">in</span> listB <span class="kw">and</span> valA <span class="kw">not</span> <span class="kw">in</span> in_both_lists:
        in_both_lists.append(valA)

<span class="bu">print</span>(in_both_lists) <span class="co"># [1,2,12]</span></code></pre></div>
<p><strong>Hint:</strong> You should use a <code>set</code>.</p>
<p><strong>Note:</strong> In addition to being easier to read, using a <code>set</code> is <em>much</em> faster than loops!</p>
<p><strong>Note:</strong> A set is a group of values that are unordered, unchangeable, and no duplicate values are allowed. While they aren't used a <em>lot</em>, they can be useful for a few common tasks like: removing duplicate values efficiently, efficiently finding values in one group of values that are not in another group of values, etc.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-sets">sets</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
The output from running the code.
</li>
</ul>
</div>
</div>
<div id="solution-14" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">listA <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">12</span>]
listB <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>]

onlyA <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(listA) <span class="op">-</span> <span class="bu">set</span>(listB))
<span class="bu">print</span>(onlyA)

onlyB <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(listB) <span class="op">-</span> <span class="bu">set</span>(listA))
<span class="bu">print</span>(onlyB)

in_both_lists <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>.intersection(<span class="bu">set</span>(listA), <span class="bu">set</span>(listB)))
<span class="bu">print</span>(in_both_lists)</code></pre></div>
</div>
<div id="the-value-of-a-dictionary-does-not-have-to-be-a-single-value-like-weve-shown-so-far.-it-can-be-anything.-observe-that-there-is-latitude-and-longitude-data-for-each-row-in-our-dataframe-lat-and-long-respectively.-wouldnt-it-be-useful-to-be-able-to-quickly-get-pairs-of-latitude-and-longitude-data-for-a-given-state" class="section level5">
<h5>5. The value of a dictionary does not have to be a single value (like we've shown so far). It can be <em>anything</em>. Observe that there is latitude and longitude data for each row in our DataFrame (<code>lat</code> and <code>long</code>, respectively). Wouldn't it be useful to be able to quickly &quot;get&quot; pairs of latitude and longitude data for a given state?</h5>
</div>
<div id="first-run-the-following-code-to-get-a-list-of-tuples-where-the-first-value-is-the-state-the-second-value-is-the-lat-and-the-third-value-is-the-long." class="section level5">
<h5>First, run the following code to get a list of tuples where the first value is the <code>state</code>, the second value is the <code>lat</code>, and the third value is the <code>long</code>.</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">states_list <span class="op">=</span> <span class="bu">list</span>(myDF.loc[:, [<span class="st">&quot;state&quot;</span>, <span class="st">&quot;lat&quot;</span>, <span class="st">&quot;long&quot;</span>]].dropna().to_records(index<span class="op">=</span><span class="va">False</span>))
states_list[<span class="dv">0</span>:<span class="dv">3</span>] <span class="co"># [(&#39;az&#39;, 34.4554, -114.269), (&#39;or&#39;, 46.1837, -123.824), (&#39;sc&#39;, 34.9352, -81.9654)]</span>

<span class="co"># to get the first tuple</span>
states_list[<span class="dv">0</span>] <span class="co"># (&#39;az&#39;, 34.4554, -114.269)</span>

<span class="co"># to get the first value in the first tuple</span>
states_list[<span class="dv">0</span>][<span class="dv">0</span>] <span class="co"># az</span>

<span class="co"># to get the second tuple</span>
states_list[<span class="dv">1</span>] <span class="co"># (&#39;or&#39;, 46.1837, -123.824)</span>

<span class="co"># to get the first value in the second tuple</span>
states_list[<span class="dv">1</span>][<span class="dv">0</span>] <span class="co"># or</span></code></pre></div>
<p><strong>Hint:</strong> If you have an issue where you cannot append values to a specific key, make sure to first initialize the specific key to an empty list so the append method is available to use.</p>
</div>
<div id="now-organize-the-latitude-and-longitude-data-in-a-dictionary-called-geodict-such-that-each-state-from-the-state-column-is-a-key-and-the-respective-value-is-a-list-of-tuples-where-the-first-value-in-each-tuple-is-the-latitude-lat-and-the-second-value-is-the-longitude-long.-for-example-the-first-2-latlong-pairs-in-indiana-in-are" class="section level5">
<h5>Now, organize the latitude and longitude data in a dictionary called <code>geoDict</code> such that each state from the <code>state</code> column is a key, and the respective value is a list of tuples, where the first value in each tuple is the latitude (<code>lat</code>) and the second value is the longitude (<code>long</code>). For example, the first 2 (lat,long) pairs in Indiana (<code>&quot;in&quot;</code>) are:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">geoDict.get(<span class="st">&quot;in&quot;</span>)[<span class="dv">0</span>:<span class="dv">2</span>] <span class="co"># [(39.0295, -86.8675), (38.8585, -86.4806)]</span>
<span class="bu">len</span>(geoDict.get(<span class="st">&quot;in&quot;</span>)) <span class="co"># 5687</span></code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_zrd28fgo">Click here for video</a></p>
</div>
<div id="now-that-you-can-easily-access-latitude-and-longitude-pairs-for-a-given-state-run-the-following-code-to-plot-the-points-for-texas-the-state-value-is-tx.-include-the-the-graphic-produced-below-in-your-solution-but-feel-free-to-experiment-with-other-states." class="section level5">
<h5>Now that you can easily access latitude and longitude pairs for a given state, run the following code to plot the points for Texas (the <code>state</code> value is <code>&quot;tx&quot;</code>). Include the the graphic produced below in your solution, but feel free to experiment with other states.</h5>
</div>
<div id="note-you-do-not-need-to-include-this-portion-of-question-5-in-your-markdown-.rmd-file.-we-cannot-get-this-portion-to-build-in-markdown-but-please-do-include-it-in-your-python-.py-file." class="section level5">
<h5>NOTE: You do NOT need to include this portion of Question 5 in your Markdown <code>.Rmd</code> file. We cannot get this portion to build in Markdown, but please do include it in your Python <code>.py</code> file.</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> shapely.geometry <span class="im">import</span> Point
<span class="im">import</span> geopandas <span class="im">as</span> gpd
<span class="im">from</span> geopandas <span class="im">import</span> GeoDataFrame

usa <span class="op">=</span> gpd.read_file(<span class="st">&#39;/class/datamine/data/craigslist/cb_2018_us_state_20m.shp&#39;</span>)
usa.crs <span class="op">=</span> {<span class="st">&#39;init&#39;</span>: <span class="st">&#39;epsg:4269&#39;</span>}

pts <span class="op">=</span> [Point(y,x) <span class="cf">for</span> x, y <span class="kw">in</span> geoDict.get(<span class="st">&quot;tx&quot;</span>)]
gdf <span class="op">=</span> gpd.GeoDataFrame(geometry<span class="op">=</span>pts, crs <span class="op">=</span> <span class="dv">4269</span>)
fig, gax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>))
base <span class="op">=</span> usa[usa[<span class="st">&#39;NAME&#39;</span>].isin([<span class="st">&#39;Hawaii&#39;</span>, <span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Puerto Rico&#39;</span>]) <span class="op">==</span> <span class="va">False</span>].plot(ax<span class="op">=</span>gax, color<span class="op">=</span><span class="st">&#39;white&#39;</span>, edgecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>)
gdf.plot(ax<span class="op">=</span>base, color<span class="op">=</span><span class="st">&#39;darkred&#39;</span>, marker<span class="op">=</span><span class="st">&quot;*&quot;</span>, markersize<span class="op">=</span><span class="dv">10</span>)
plt.show()
plt.close()

<span class="co"># to save to jpg:</span>
plt.savefig(<span class="st">&#39;q5.jpg&#39;</span>)</code></pre></div>
<p><strong>Relevant topics:</strong> <a href="python.html#p-dicts">dicts</a>, <a href="python.html#p-lists-and-tuples">lists and tuples</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Graphic file (<code>q5.jpg</code>) produced for the given state.
</li>
</ul>
</div>
</div>
<div id="solution-15" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">geoDict <span class="op">=</span> <span class="bu">dict</span>()

<span class="cf">for</span> val <span class="kw">in</span> states_list:
    geoDict[val[<span class="dv">0</span>]] <span class="op">=</span> []
    
<span class="cf">for</span> val <span class="kw">in</span> states_list:
    geoDict[val[<span class="dv">0</span>]].append((val[<span class="dv">1</span>],val[<span class="dv">2</span>]))
    
geoDict.get(<span class="st">&quot;in&quot;</span>)[<span class="dv">0</span>:<span class="dv">2</span>]
<span class="bu">len</span>(geoDict.get(<span class="st">&quot;in&quot;</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">from</span> shapely.geometry <span class="im">import</span> Point
<span class="im">import</span> geopandas <span class="im">as</span> gpd
<span class="im">from</span> geopandas <span class="im">import</span> GeoDataFrame

usa <span class="op">=</span> gpd.read_file(<span class="st">&#39;/class/datamine/data/craigslist/cb_2018_us_state_20m.shp&#39;</span>)
usa.crs <span class="op">=</span> {<span class="st">&#39;init&#39;</span>: <span class="st">&#39;epsg:4269&#39;</span>}

pts <span class="op">=</span> [Point(y,x) <span class="cf">for</span> x, y <span class="kw">in</span> geoDict.get(<span class="st">&quot;tx&quot;</span>)]
gdf <span class="op">=</span> gpd.GeoDataFrame(geometry<span class="op">=</span>pts, crs <span class="op">=</span> <span class="dv">4269</span>)
fig, gax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>))
base <span class="op">=</span> usa[usa[<span class="st">&#39;NAME&#39;</span>].isin([<span class="st">&#39;Hawaii&#39;</span>, <span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Puerto Rico&#39;</span>]) <span class="op">==</span> <span class="va">False</span>].plot(ax<span class="op">=</span>gax, color<span class="op">=</span><span class="st">&#39;white&#39;</span>, edgecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>)
gdf.plot(ax<span class="op">=</span>base, color<span class="op">=</span><span class="st">&#39;darkred&#39;</span>, marker<span class="op">=</span><span class="st">&quot;*&quot;</span>, markersize<span class="op">=</span><span class="dv">10</span>)
plt.show()

<span class="co"># to save to jpg:</span>
plt.savefig(<span class="st">&#39;q5.jpg&#39;</span>)</code></pre></div>
</div>
<div id="use-your-new-skills-to-extract-some-sort-of-information-from-our-dataset-and-create-a-graphic.-this-can-be-as-simple-or-complicated-as-you-are-comfortable-with" class="section level5">
<h5>6. Use your new skills to extract some sort of information from our dataset and create a graphic. This can be as simple or complicated as you are comfortable with!</h5>
<p><strong>Relevant topics:</strong> <a href="python.html#p-dicts">dicts</a>, <a href="python.html#p-lists-and-tuples">lists and tuples</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
The graphic produced using the code.
</li>
</ul>
</div>
</div>
<div id="solution-16" class="section level5">
<h5>Solution</h5>
<div class="solution">
<p>
Could be anything.
</p>
</div>
<hr />
</div>
</div>
</div>
<div id="p04-190" class="section level3">
<h3>Project 4</h3>
<hr />
<p><strong>Motivation:</strong> We've now been introduced to a variety of core Python data structures. Along the way we've touched on a bit of <code>pandas</code>, <code>matplotlib</code>, and have utilized some control flow features like for loops and if statements. We will continue to touch on <code>pandas</code> and <code>matplotlib</code>, but we will take a deeper dive in this project and learn more about control flow, all while digging into the data!</p>
<p><strong>Context:</strong> We just finished a project where we were able to see the power of dictionaries and sets. In this project we will take a step back and make sure we are able to really grasp control flow (if/else statements, loops, etc.) in Python.</p>
<p><strong>Scope:</strong> python, dicts, lists, if/else statements, for loops</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
List the differences between lists &amp; tuples and when to use each.
</li>
<li>
Explain what is a dict and why it is useful.
</li>
<li>
Demonstrate a working knowledge of control flow in python: if/else statements, while loops, for loops, etc.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset-3" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/craigslist/vehicles.csv</code></p>
</div>
<div id="questions-3" class="section level4">
<h4>Questions</h4>
<div id="unlike-in-r-where-traditional-loops-are-rare-and-typically-accomplished-via-one-of-the-apply-functions-in-python-loops-are-extremely-common-and-important-to-understand.-in-python-any-iterator-can-be-looped-over.-some-common-iterators-are-tuples-lists-dicts-sets-pandas-series-and-pandas-dataframes.-in-the-previous-project-we-had-some-examples-of-looping-over-lists-lets-learn-how-to-loop-over-pandas-series-and-dataframes" class="section level5">
<h5>1. Unlike in R, where traditional loops are rare and typically accomplished via one of the apply functions, in Python, loops are extremely common and important to understand. In Python, any iterator can be looped over. Some common iterators are: tuples, lists, dicts, sets, <code>pandas</code> Series, and <code>pandas</code> DataFrames. In the previous project we had some examples of looping over lists, let's learn how to loop over <code>pandas</code> Series and Dataframes!</h5>
</div>
<div id="load-up-our-dataset-classdataminedatacraigslistvehicles.csv-into-a-dataframe-called-mydf.-in-project-3-we-organized-the-latitude-and-longitude-data-in-a-dictionary-called-geodict-such-that-each-state-from-the-state-column-is-a-key-and-the-respective-value-is-a-list-of-tuples-where-the-first-value-in-each-tuple-is-the-latitude-lat-and-the-second-value-is-the-longitude-long.-repeat-this-question-but-do-not-use-lists-instead-use-pandas-to-accomplish-this." class="section level5">
<h5>Load up our dataset <code>/class/datamine/data/craigslist/vehicles.csv</code> into a DataFrame called <code>myDF</code>. In project (3), we organized the latitude and longitude data in a dictionary called <code>geoDict</code> such that each state from the <code>state</code> column is a key, and the respective value is a list of tuples, where the first value in each tuple is the latitude (<code>lat</code>) and the second value is the longitude (<code>long</code>). Repeat this question, but <strong>do not</strong> use lists, instead use <code>pandas</code> to accomplish this.</h5>
<p><strong>Hint:</strong> The data frame has 435,849 rows, and it takes forever to accomplish this with <code>pandas</code>. We just want you to do this one time, to see how slow this is. Try it first with only 10 rows, and then with 100 rows, and once you are sure it is working, try it with (say) 20,000 rows. You do not need to do this with the entire data frame. It takes too long!</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_hkg42wfr">Click here for video</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_tr8qvwn3">Here is a video about the new feature to reset your RStudio session if you make a big mistake or if your session is very slow</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-dataframe">DataFrame.iterrows()</a>,</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-17" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">import</span> pandas <span class="im">as</span> pd

myDF <span class="op">=</span> pd.read_csv(<span class="st">&quot;/class/datamine/data/craigslist/vehicles.csv&quot;</span>)

geoDict <span class="op">=</span> <span class="bu">dict</span>()
<span class="cf">for</span> my_index, my_row <span class="kw">in</span> myDF.iterrows():
    geoDict[my_row[<span class="st">&quot;state&quot;</span>]] <span class="op">=</span> []

<span class="cf">for</span> my_index, my_row <span class="kw">in</span> myDF.iterrows():
    geoDict[my_row[<span class="st">&quot;state&quot;</span>]].append((my_row[<span class="st">&quot;lat&quot;</span>], my_row[<span class="st">&quot;long&quot;</span>]))
    
geoDict.get(<span class="st">&quot;in&quot;</span>)[<span class="dv">0</span>:<span class="dv">2</span>]
<span class="bu">len</span>(geoDict.get(<span class="st">&quot;in&quot;</span>))</code></pre></div>
</div>
<div id="wow-the-solution-to-question-1-was-slow.-in-general-youll-want-to-avoid-looping-over-large-dataframes.-here-is-a-pretty-good-explanation-of-why-as-well-as-a-good-system-on-what-to-try-when-computing-something.-in-this-case-we-could-have-used-indexing-to-get-latitude-and-longitude-values-for-each-state-and-would-have-no-need-to-build-this-dict." class="section level5">
<h5>2. Wow! The solution to question (1) was <em>slow</em>. In general, you'll want to avoid looping over large DataFrames. <a href="https://stackoverflow.com/questions/16476924/how-to-iterate-over-rows-in-a-dataframe-in-pandas/55557758#55557758">Here</a> is a pretty good explanation of why, as well as a good system on what to try when computing something. In this case, we could have used indexing to get latitude and longitude values for each state, and would have no need to build this dict.</h5>
<p>The method we learned in Project 3, Question 5 is faster and easier! Just in case you did not solve Project 3, Question 5, here is a fast way to build <code>geoDict</code>:</p>
<pre><code>import pandas as pd
myDF = pd.read_csv(&quot;/class/datamine/data/craigslist/vehicles.csv&quot;)
states_list = list(myDF.loc[:, [&quot;state&quot;, &quot;lat&quot;, &quot;long&quot;]].dropna().to_records(index=False))
geoDict = {}
for mytriple in states_list:
  geoDict[mytriple[0]] = []
for mytriple in states_list:
  geoDict[mytriple[0]].append( (mytriple[1],mytriple[2]) )</code></pre>
</div>
<div id="now-we-will-practice-iterating-over-a-dictionary-list-and-tuple-all-at-once-loop-through-geodict-and-use-f-strings-to-print-the-state-abbreviation.-print-the-first-latitude-and-longitude-pair-as-well-as-every-5000th-latitude-and-longitude-pair-for-each-state.-round-values-to-the-hundreths-place.-for-example-if-the-state-was-pu-and-it-had-12000-latitude-and-longitude-pairs-we-would-print-the-following" class="section level5">
<h5>Now we will practice iterating over a dictionary, list, <em>and</em> tuple, all at once! Loop through <code>geoDict</code> and use f-strings to print the state abbreviation. Print the first latitude and longitude pair, as well as every 5000th latitude and longitude pair for each state. Round values to the hundreths place. For example, if the state was &quot;pu&quot;, and it had 12000 latitude and longitude pairs, we would print the following:</h5>
<pre><code>pu:
Lat: 41.41, Long: 41.41
Lat: 22.21, Long: 21.21
Lat: 11.11, Long: 10.22</code></pre>
</div>
<div id="in-the-above-example-lat-41.41-long-41.41-would-be-the-0th-pair-lat-22.21-long-21.21-would-be-the-5000th-pair-and-lat-11.11-long-10.22-would-be-the-10000th-pair.-make-sure-to-use-f-strings-to-round-the-latitude-and-longitude-values-to-two-decimal-places." class="section level5">
<h5>In the above example, <code>Lat: 41.41, Long: 41.41</code> would be the 0th pair, <code>Lat: 22.21, Long: 21.21</code> would be the 5000th pair, and <code>Lat: 11.11, Long: 10.22</code> would be the 10000th pair. Make sure to use f-strings to round the latitude and longitude values to two decimal places.</h5>
<p>There are several ways to solve this question. You can use whatever method is easiest for you, but please be sure (as always) to add comments to explain your method of solution.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_7j9j7edi">Click here for video</a></p>
<p><strong>Hint:</strong> <a href="python.html#p-enumerate">Enumerate</a> is a useful function that adds an index to our loop.</p>
<p><strong>Hint:</strong> Using an if statement and the <a href="https://www.jquery-az.com/python-modulo/">modulo operator</a> could be useful.</p>
<p><strong>Note:</strong> Whenever we have a loop <em>within</em> another loop, the &quot;inner&quot; loop is called a &quot;nested&quot; loop, as it is &quot;nested&quot; inside of the other.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-dicts">dicts</a>, modulus operator, <a href="python.html#p-f-strings">f-strings</a>, <a href="python.html#p-if-else">if/else</a>, <a href="python.html#p-for-loops">for loops</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-18" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="cf">for</span> key, value <span class="kw">in</span> geoDict.items():
    <span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">:&#39;</span>)
    <span class="cf">for</span> idx, triplet <span class="kw">in</span> <span class="bu">enumerate</span>(value):
        <span class="cf">if</span> (idx <span class="op">%</span> <span class="dv">5000</span> <span class="op">==</span> <span class="dv">0</span>):
            <span class="bu">print</span>(<span class="ss">f&#39;Lat: </span><span class="sc">{</span>triplet[<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="ss">, Long: </span><span class="sc">{</span>triplet[<span class="dv">1</span>]<span class="sc">:.2f}</span><span class="ss">&#39;</span>)</code></pre></div>
</div>
<div id="we-are-curious-about-how-the-year-of-the-car-year-effects-the-price-price.-in-r-we-could-get-the-median-price-by-year-easily-using-tapply" class="section level5">
<h5>3. We are curious about how the year of the car (<code>year</code>) effects the price (<code>price</code>). In R, we could get the median price by year easily, using <code>tapply</code>:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(myDF<span class="op">$</span>price, myDF<span class="op">$</span>year, median, <span class="dt">na.rm=</span>T)</code></pre></div>
</div>
<div id="using-pandas-we-would-do-this" class="section level5">
<h5>Using <code>pandas</code>, we would do this:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">res <span class="op">=</span> myDF.groupby([<span class="st">&#39;year&#39;</span>], dropna<span class="op">=</span><span class="va">True</span>).median()</code></pre></div>
</div>
<div id="these-are-very-convenient-functions-that-do-a-lot-of-work-for-you.-if-we-were-to-take-a-look-at-the-median-price-of-cars-by-year-it-would-look-like" class="section level5">
<h5>These are very convenient functions that do a lot of work for you. If we were to take a look at the median price of cars by year, it would look like:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt

res <span class="op">=</span> myDF.groupby([<span class="st">&#39;year&#39;</span>], dropna<span class="op">=</span><span class="va">True</span>).median()[<span class="st">&quot;price&quot;</span>]
plt.bar(res.index, res.values)</code></pre></div>
</div>
<div id="using-the-content-of-the-variable-my_list-provided-in-the-code-below-calculate-the-median-car-price-per-year-without-using-the-median-function-and-without-using-a-sort-function.-use-only-dictionaries-for-loops-and-if-statements.-replicate-the-plot-generated-by-running-the-code-above-you-can-use-the-plot-to-make-sure-it-looks-right." class="section level5">
<h5>Using the content of the variable <code>my_list</code> provided in the code below, calculate the median car price per year without using the <code>median</code> function and without using a <code>sort</code> function. Use only dictionaries, for loops and if statements. Replicate the plot generated by running the code above (you can use the plot to make sure it looks right).</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">my_list <span class="op">=</span> <span class="bu">list</span>(myDF.loc[:, [<span class="st">&quot;year&quot;</span>, <span class="st">&quot;price&quot;</span>,]].dropna().to_records(index<span class="op">=</span><span class="va">False</span>))</code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_li98uz29">Click here for video</a></p>
<p><strong>Hint:</strong> If you do not want to write your own median function to find the median, then it is OK to just use the <code>getMid</code> function <a href="python.html#p-median">found here</a> or to use a median function from elsewhere on the web. Just be sure to cite your source, if you do use a median function that someone else provides or that you use from the internet. There are many small variations on median functions, especially when it comes to (for instance) lists with even length.</p>
<p><strong>Hint:</strong> It is also OK to use: <code>import statistics</code> and the function <code>statistics.median</code></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-dicts">dicts</a>, <a href="python.html#p-for-loops">for loops</a>, <a href="python.html#p-if-else">if/else</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
The barplot.
</li>
</ul>
</div>
</div>
<div id="solution-19" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">from</span> collections <span class="im">import</span> defaultdict
<span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt

my_list <span class="op">=</span> <span class="bu">list</span>(myDF.loc[:, [<span class="st">&quot;year&quot;</span>, <span class="st">&quot;price&quot;</span>,]].dropna().to_records(index<span class="op">=</span><span class="va">False</span>))

my_dict <span class="op">=</span> defaultdict(<span class="bu">list</span>)
<span class="cf">for</span> (year, price) <span class="kw">in</span> my_list:
    my_dict[year].append(<span class="bu">float</span>(price))

my_years, my_prices <span class="op">=</span> [],[]
<span class="cf">for</span> year, prices <span class="kw">in</span> <span class="bu">sorted</span>(my_dict.items()):
    <span class="cf">if</span> <span class="bu">len</span>(prices) <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:
        lower_mid <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(prices)<span class="op">/</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">1</span>)
        upper_mid <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(prices)<span class="op">/</span><span class="dv">2</span>)
        prices_sorted <span class="op">=</span> <span class="bu">sorted</span>(prices)
        median_price <span class="op">=</span> (prices_sorted[lower_mid] <span class="op">+</span> prices_sorted[upper_mid]) <span class="op">/</span> <span class="dv">2</span>
        
    <span class="cf">else</span>:
        median_price <span class="op">=</span> <span class="bu">sorted</span>(prices)[<span class="bu">int</span>(<span class="bu">len</span>(prices)<span class="op">/</span><span class="dv">2</span>)]
        
    <span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>median_price<span class="sc">}</span><span class="ss">&#39;</span>)
    my_years.append(year)
    my_prices.append(median_price)
    
plt.bar(my_years, my_prices)
plt.show()</code></pre></div>
</div>
<div id="now-calculate-the-mean-price-by-yearstill-not-using-pandas-code-and-create-a-barplot-with-the-price-on-the-y-axis-and-year-on-the-x-axis.-whoa-something-is-odd-here.-explain-what-is-happening.-modify-your-code-to-use-an-if-statement-to-weed-out-the-likely-erroneous-value.-re-plot-your-values." class="section level5">
<h5>4. Now calculate the mean <code>price</code> by <code>year</code>(still not using pandas code), and create a barplot with the <code>price</code> on the y-axis and <code>year</code> on the x-axis. Whoa! Something is odd here. Explain what is happening. Modify your code to use an if statement to &quot;weed out&quot; the likely erroneous value. Re-plot your values.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_li98uz29">Click here for video (same as in Question 3)</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_8kgi1uio">Click here for another video</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_ladqyiqg">Click here for one more video</a></p>
<p><strong>Hint:</strong> It is also OK to use a built-in <code>mean</code> function, for instace: <code>import statistics</code> and the function <code>statistics.mean</code></p>
<p><strong>Relevant topics:</strong> sorted, <a href="python.html#p-for-loops">for loops</a>, <a href="python.html#p-if-else">if/else</a>, <a href="python.html#p-list-methods">list methods</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
The barplot.
</li>
</ul>
</div>
</div>
<div id="solution-20" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">from</span> collections <span class="im">import</span> defaultdict

my_dict <span class="op">=</span> defaultdict(<span class="bu">list</span>)
<span class="cf">for</span> (year, price) <span class="kw">in</span> my_list:
    my_dict[year].append(price)

my_years, my_prices <span class="op">=</span> [],[]
<span class="cf">for</span> year, prices <span class="kw">in</span> <span class="bu">sorted</span>(my_dict.items()):
    <span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">sum</span>(prices)<span class="op">/</span><span class="bu">len</span>(prices)<span class="sc">}</span><span class="ss">&#39;</span>)
    my_years.append(year)
    my_prices.append(<span class="bu">sum</span>(prices)<span class="op">/</span><span class="bu">len</span>(prices))
    
plt.bar(my_years, my_prices)
plt.show()</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">from</span> collections <span class="im">import</span> defaultdict

my_dict <span class="op">=</span> defaultdict(<span class="bu">list</span>)
<span class="cf">for</span> (year, price) <span class="kw">in</span> my_list:
    <span class="cf">if</span> price <span class="op">&gt;</span> <span class="dv">1</span>_000_000:
        <span class="cf">continue</span>
    my_dict[year].append(price)

my_years, my_prices <span class="op">=</span> [],[]
<span class="cf">for</span> year, prices <span class="kw">in</span> <span class="bu">sorted</span>(my_dict.items()):
    avg_price <span class="op">=</span> <span class="bu">sum</span>(prices)<span class="op">/</span><span class="bu">len</span>(prices)
    <span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>avg_price<span class="sc">}</span><span class="ss">&#39;</span>)
    my_years.append(year)
    my_prices.append(avg_price)
    
plt.bar(my_years, my_prices)
plt.show()</code></pre></div>
</div>
<div id="list-comprehensions-are-a-neat-feature-of-python-that-allows-for-a-more-concise-syntax-for-smaller-loops.-while-at-first-they-may-seem-difficult-and-more-confusing-eventually-they-grow-on-you.-for-example-say-you-wanted-to-capitalize-every-state-in-a-list-full-of-states" class="section level5">
<h5>5. List comprehensions are a neat feature of Python that allows for a more concise syntax for smaller loops. While at first they may seem difficult and more confusing, eventually they grow on you. For example, say you wanted to capitalize every <code>state</code> in a list full of states:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">my_states <span class="op">=</span> myDF[<span class="st">&#39;state&#39;</span>].to_list()
my_states <span class="op">=</span> [state.upper() <span class="cf">for</span> state <span class="kw">in</span> my_states]</code></pre></div>
</div>
<div id="or-maybe-you-wanted-to-find-the-average-price-of-cars-in-excellent-condition-without-pandas" class="section level5">
<h5>Or, maybe you wanted to find the average price of cars in &quot;excellent&quot; condition (without <code>pandas</code>):</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">my_list <span class="op">=</span> <span class="bu">list</span>(myDF.loc[:, [<span class="st">&quot;condition&quot;</span>, <span class="st">&quot;price&quot;</span>,]].dropna().to_records(index<span class="op">=</span><span class="va">False</span>))
my_list <span class="op">=</span> [price <span class="cf">for</span> (condition, price) <span class="kw">in</span> my_list <span class="cf">if</span> condition <span class="op">==</span> <span class="st">&quot;excellent&quot;</span>]
<span class="bu">sum</span>(my_list)<span class="op">/</span><span class="bu">len</span>(my_list)</code></pre></div>
</div>
<div id="do-the-following-using-list-comprehensions-and-the-provided-code" class="section level5">
<h5>Do the following using list comprehensions, and the provided code:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">my_list <span class="op">=</span> <span class="bu">list</span>(myDF.loc[:, [<span class="st">&quot;state&quot;</span>, <span class="st">&quot;price&quot;</span>,]].dropna().to_records(index<span class="op">=</span><span class="va">False</span>))</code></pre></div>
<ul>
<li>Calculate the average price of vehicles from Indiana (<code>in</code>).</li>
<li>Calculate the average price of vehicles from Indiana (<code>in</code>), Michigan (<code>mi</code>), and Illinois (<code>il</code>) combined.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">my_list <span class="op">=</span> <span class="bu">list</span>(myDF.loc[:, [<span class="st">&quot;manufacturer&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;price&quot;</span>,]].dropna().to_records(index<span class="op">=</span><span class="va">False</span>))</code></pre></div>
<ul>
<li>Calculate the average price of a &quot;honda&quot; (<code>manufacturer</code>) that is 2010 or newer (<code>year</code>).</li>
</ul>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_husv3712">Click here for video</a></p>
<p><strong>Relevant topics:</strong> sorted, <a href="python.html#p-for-loops">for loops</a>, <a href="python.html#p-if-else">if/else</a>, <a href="python.html#p-list-methods">list methods</a>, sum, len, defaultdict, <a href="python.html#p-matplotlib">matplotlib</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-21" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">my_list <span class="op">=</span> <span class="bu">list</span>(myDF.loc[:, [<span class="st">&quot;state&quot;</span>, <span class="st">&quot;price&quot;</span>,]].dropna().to_records(index<span class="op">=</span><span class="va">False</span>))
my_list <span class="op">=</span> [price <span class="cf">for</span> (state,price) <span class="kw">in</span> my_list <span class="cf">if</span> state <span class="op">==</span> <span class="st">&quot;in&quot;</span>]
<span class="bu">print</span>(<span class="bu">sum</span>(my_list)<span class="op">/</span><span class="bu">len</span>(my_list))

my_list <span class="op">=</span> <span class="bu">list</span>(myDF.loc[:, [<span class="st">&quot;state&quot;</span>, <span class="st">&quot;price&quot;</span>,]].dropna().to_records(index<span class="op">=</span><span class="va">False</span>))
my_list <span class="op">=</span> [price <span class="cf">for</span> (state,price) <span class="kw">in</span> my_list <span class="cf">if</span> state <span class="kw">in</span> (<span class="st">&#39;in&#39;</span>, <span class="st">&#39;il&#39;</span>, <span class="st">&#39;mi&#39;</span>)]
<span class="bu">print</span>(<span class="bu">sum</span>(my_list)<span class="op">/</span><span class="bu">len</span>(my_list))

my_list <span class="op">=</span> <span class="bu">list</span>(myDF.loc[:, [<span class="st">&quot;manufacturer&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;price&quot;</span>,]].dropna().to_records(index<span class="op">=</span><span class="va">False</span>))
my_list <span class="op">=</span> [p <span class="cf">for</span> (m, y, p) <span class="kw">in</span> my_list <span class="cf">if</span> m<span class="op">==</span><span class="st">&#39;honda&#39;</span> <span class="kw">and</span> y <span class="op">&gt;=</span> <span class="dv">2010</span>]
<span class="bu">print</span>(<span class="bu">sum</span>(my_list)<span class="op">/</span><span class="bu">len</span>(my_list))</code></pre></div>
</div>
<div id="lets-use-a-package-called-spacy-to-try-and-parse-phone-numbers-out-of-the-description-column.-first-simply-loop-through-and-print-the-text-and-the-label.-what-is-the-label-of-the-majority-of-the-phone-numbers-you-can-see" class="section level5">
<h5>6. Let's use a package called <code>spacy</code> to try and parse phone numbers out of the <code>description</code> column. First, simply loop through and print the text and the label. What is the label of the majority of the phone numbers you can see?</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> spacy

<span class="co"># get list of descriptions</span>
my_list <span class="op">=</span> <span class="bu">list</span>(myDF.loc[:, [<span class="st">&quot;description&quot;</span>,]].dropna().to_records(index<span class="op">=</span><span class="va">False</span>))
my_list <span class="op">=</span> [m[<span class="dv">0</span>] <span class="cf">for</span> m <span class="kw">in</span> my_list]

<span class="co"># load the pre-built spacy model</span>
nlp <span class="op">=</span> spacy.load(<span class="st">&quot;en_core_web_lg&quot;</span>)

<span class="co"># apply the model to a description</span>
doc <span class="op">=</span> nlp(my_list[<span class="dv">0</span>])

<span class="co"># print the text and label of each &quot;entity&quot;</span>
<span class="cf">for</span> entity <span class="kw">in</span> doc.ents:
    <span class="bu">print</span>(entity.text, entity.label_)</code></pre></div>
</div>
<div id="use-an-if-statement-to-filter-out-all-entities-that-are-not-the-label-you-see.-loop-through-again-and-see-what-our-printed-data-looks-like.-there-is-still-a-lot-of-data-there-that-we-dont-want-to-capture-right-phone-numbers-in-the-us-are-usually-7-5555555-8-555-5555-10-5555555555-11-15555555555-12-555-555-5555-or-14-1-555-555-5555-digits.-in-addition-to-your-first-filter-add-another-filter-that-keeps-only-text-where-the-text-is-one-of-those-lengths." class="section level5">
<h5>Use an if statement to filter out all entities that are not the label you see. Loop through again and see what our printed data looks like. There is still a lot of data there that we <em>don't</em> want to capture, right? Phone numbers in the US are <em>usually</em> 7 (5555555), 8 (555-5555), 10 (5555555555), 11 (15555555555), 12 (555-555-5555), or 14 (1-555-555-5555) digits. In addition to your first &quot;filter&quot;, add another &quot;filter&quot; that keeps only text where the text is one of those lengths.</h5>
</div>
<div id="that-is-starting-to-look-better-but-there-are-still-some-erroneous-values.-come-up-with-another-filter-and-loop-through-our-data-again.-explain-what-your-filter-does-and-make-sure-that-it-does-a-better-job-on-the-first-10-documents-than-when-we-dont-use-your-filter." class="section level5">
<h5>That is starting to look better, but there are still some erroneous values. Come up with another &quot;filter&quot;, and loop through our data again. Explain what your filter does and make sure that it does a better job on the first 10 documents than when we don't use your filter.</h5>
<p><strong>Note:</strong> If you get an error when trying to knit that talks about &quot;unicode&quot; characters, this is caused by trying to print special characters (non-ascii). An easy fix is just to remove all non-ascii text. You can do this with the <code>encode</code> string method. For example:</p>
<p>Instead of:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">for</span> entity <span class="kw">in</span> doc.ents:
    <span class="bu">print</span>(entity.text, entity.label_)</code></pre></div>
<p>Do:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">for</span> entity <span class="kw">in</span> doc.ents:
    <span class="bu">print</span>(entity.text.encode(<span class="st">&#39;ascii&#39;</span>, errors<span class="op">=</span><span class="st">&#39;ignore&#39;</span>), entity.label_)</code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_cnjzidu8">Click here for video</a></p>
<p><strong>Note:</strong> It can be fun to utilize machine learning and natural language processing, but that doesn't mean it is always the best solution! We could get rid of all of our filters and use regular expressions with much better results! We will demonstrate this in our solution.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-for-loops">for loops</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
1-2 sentences explaining what your filter does.
</li>
</ul>
</div>
</div>
<div id="solution-22" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">import</span> spacy

my_list <span class="op">=</span> <span class="bu">list</span>(myDF.loc[:, [<span class="st">&quot;description&quot;</span>,]].dropna().to_records(index<span class="op">=</span><span class="va">False</span>))
my_list <span class="op">=</span> [m[<span class="dv">0</span>] <span class="cf">for</span> m <span class="kw">in</span> my_list]

<span class="co"># load the pre-built spacy model</span>
nlp <span class="op">=</span> spacy.load(<span class="st">&quot;en_core_web_lg&quot;</span>)

<span class="cf">for</span> doc <span class="kw">in</span> my_list[:<span class="dv">10</span>]:
    d <span class="op">=</span> nlp(doc)
    <span class="cf">for</span> entity <span class="kw">in</span> d.ents:
        <span class="bu">print</span>(entity.text.encode(<span class="st">&#39;ascii&#39;</span>, errors<span class="op">=</span><span class="st">&#39;ignore&#39;</span>), entity.label_)

<span class="cf">for</span> doc <span class="kw">in</span> my_list[:<span class="dv">10</span>]:
    d <span class="op">=</span> nlp(doc)
    <span class="cf">for</span> entity <span class="kw">in</span> d.ents:
        <span class="cf">if</span> entity.label_ <span class="op">==</span> <span class="st">&quot;CARDINAL&quot;</span>:
            <span class="bu">print</span>(entity.text.encode(<span class="st">&#39;ascii&#39;</span>, errors<span class="op">=</span><span class="st">&#39;ignore&#39;</span>), entity.label_)

<span class="cf">for</span> doc <span class="kw">in</span> my_list[:<span class="dv">10</span>]:
    d <span class="op">=</span> nlp(doc)
    <span class="cf">for</span> entity <span class="kw">in</span> d.ents:
        <span class="cf">if</span> entity.label_ <span class="op">==</span> <span class="st">&quot;CARDINAL&quot;</span> <span class="kw">and</span> <span class="bu">len</span>(entity.text) <span class="kw">in</span> [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">14</span>]:
            <span class="bu">print</span>(entity.text.encode(<span class="st">&#39;ascii&#39;</span>, errors<span class="op">=</span><span class="st">&#39;ignore&#39;</span>), entity.label_)

<span class="cf">for</span> doc <span class="kw">in</span> my_list[:<span class="dv">10</span>]:
    d <span class="op">=</span> nlp(doc)
    <span class="cf">for</span> entity <span class="kw">in</span> d.ents:
        <span class="cf">if</span> entity.label_ <span class="op">==</span> <span class="st">&quot;CARDINAL&quot;</span> <span class="kw">and</span> <span class="bu">len</span>(entity.text) <span class="kw">in</span> [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">14</span>]:
            <span class="bu">print</span>(entity.text.encode(<span class="st">&#39;ascii&#39;</span>, errors<span class="op">=</span><span class="st">&#39;ignore&#39;</span>), entity.label_)
            
<span class="im">import</span> re
pattern <span class="op">=</span> <span class="st">&#39;\(?([0-9]</span><span class="sc">{3}</span><span class="st">)?\)?[-.]?([0-9]</span><span class="sc">{3}</span><span class="st">)[-.]?([0-9]</span><span class="sc">{4}</span><span class="st">)&#39;</span>
<span class="cf">for</span> doc <span class="kw">in</span> my_list[:<span class="dv">10</span>]:
    <span class="cf">if</span> matches :<span class="op">=</span> re.finditer(pattern, doc):
        <span class="cf">for</span> match <span class="kw">in</span> matches:
            <span class="bu">print</span>(match.group())</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="p05-190" class="section level3">
<h3>Project 5</h3>
<hr />
<p><strong>Motivation:</strong> Up until this point we've utilized bits and pieces of the <code>pandas</code> library to perform various tasks. In this project we will formally introduce <code>pandas</code> and <code>numpy</code>, and utilize their capabilities to solve data-driven problems.</p>
<p><strong>Context:</strong> By now you'll have had some limited exposure to <code>pandas</code>. This is the first in a three project series that covers some of the main components of both the <code>numpy</code> and <code>pandas</code> libraries. We will take a two project intermission to learn about functions, and then continue.</p>
<p><strong>Scope:</strong> python, pandas, numpy, DataFrames, Series, ndarrays, indexing</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Distinguish the differences between numpy, pandas, DataFrames, Series, and ndarrays.
</li>
<li>
Use numpy, scipy, and pandas to solve a variety of data-driven problems.
</li>
<li>
Demonstrate the ability to read and write data of various formats using various packages.
</li>
<li>
View and access data inside DataFrames, Series, and ndarrays.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset-4" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/stackoverflow/unprocessed/2018.csv</code></p>
<p><code>/class/datamine/data/stackoverflow/unprocessed/2018.parquet</code></p>
<p><code>/class/datamine/data/stackoverflow/unprocessed/2018.feather</code></p>
</div>
<div id="questions-4" class="section level4">
<h4>Questions</h4>
<div id="take-a-look-at-the-pandas-docs.-there-are-a-lot-of-formats-that-pandas-has-the-ability-to-read.-the-most-popular-formats-in-this-course-are-csv-with-commas-or-some-other-separator-excel-json-or-some-database.-csv-is-very-prevalent-but-it-was-not-designed-to-work-well-with-large-amounts-of-data.-newer-formats-like-parquet-and-feather-are-designed-from-the-ground-up-to-be-efficient-and-take-advantage-of-special-processor-instruction-set-called-simd.-the-benefits-of-using-these-formats-can-be-significant.-lets-do-some-experiments" class="section level5">
<h5>1. Take a look at the <a href="https://pandas.pydata.org/docs/reference/io.html"><code>pandas</code> docs</a>. There are a <em>lot</em> of formats that <code>pandas</code> has the ability to read. The most popular formats in this course are: csv (with commas or some other separator), excel, json, or some database. CSV is very prevalent, but it was not designed to work well with large amounts of data. Newer formats like parquet and feather are designed from the ground up to be efficient, and take advantage of special processor instruction set called SIMD. The benefits of using these formats can be significant. Let's do some experiments!</h5>
</div>
<div id="how-much-space-do-each-of-the-following-files-take-up-on-scholar-2018.csv-2018.parquet-and-2018.feather-how-much-smaller-as-a-percentage-is-the-parquet-file-than-the-csv-how-much-smaller-as-a-percentage-is-the-feather-file-than-the-csv-use-f-strings-to-format-the-percentages." class="section level5">
<h5>How much space do each of the following files take up on Scholar: <code>2018.csv</code>, <code>2018.parquet</code>, and <code>2018.feather</code>? How much smaller (as a percentage) is the parquet file than the csv? How much smaller (as a percentage) is the feather file than the csv? Use f-strings to format the percentages.</h5>
</div>
<div id="time-reading-in-the-following-files-2018.csv-2018.parquet-and-2018.feather.-how-much-faster-as-a-percentage-is-reading-the-parquet-file-than-the-csv-how-much-faster-as-a-percentage-is-reading-the-feather-file-than-the-csv-use-f-strings-to-format-the-percentages." class="section level5">
<h5>Time reading in the following files: <code>2018.csv</code>, <code>2018.parquet</code>, and <code>2018.feather</code>. How much faster (as a percentage) is reading the parquet file than the csv? How much faster (as a percentage) is reading the feather file than the csv? Use f-strings to format the percentages.</h5>
</div>
<div id="to-time-a-piece-of-code-you-can-use-the-block-timer-package" class="section level5">
<h5>To time a piece of code, you can use the <code>block-timer</code> package:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> block_timer.timer <span class="im">import</span> Timer

<span class="cf">with</span> Timer(title<span class="op">=</span><span class="st">&quot;Using dict to declare a dict&quot;</span>) <span class="im">as</span> t1:
    my_dict <span class="op">=</span> <span class="bu">dict</span>()

<span class="cf">with</span> Timer(title<span class="op">=</span><span class="st">&quot;Using </span><span class="sc">{}</span><span class="st"> to declare a dict&quot;</span>) <span class="im">as</span> t2:
    my_dict <span class="op">=</span> {}

<span class="co"># or if you need more fine-tuned values</span>
<span class="bu">print</span>(t1.elapsed)
<span class="bu">print</span>(t2.elapsed)</code></pre></div>
</div>
<div id="read-the-2018.csv-file-into-a-pandas-dataframe-called-my2018.-time-writing-the-contents-of-my2018-to-the-following-files-2018.csv-2018.parquet-and-2018.feather.-write-the-files-to-your-scratch-directory-scratchscholarusername-where-username-is-your-username.-how-much-faster-as-a-percentage-is-writing-the-parquet-file-than-the-csv-how-much-faster-as-a-percentage-is-writing-the-feather-file-than-the-csv-use-f-strings-to-format-the-percentages." class="section level5">
<h5>Read the <code>2018.csv</code> file into a <code>pandas</code> DataFrame called <code>my2018</code>. Time writing the contents of <code>my2018</code> to the following files: <code>2018.csv</code>, <code>2018.parquet</code>, and <code>2018.feather</code>. Write the files to your scratch directory: <code>/scratch/scholar/&lt;username&gt;</code>, where <code>&lt;username&gt;</code> is your username. How much faster (as a percentage) is writing the parquet file than the csv? How much faster (as a percentage) is writing the feather file than the csv? Use f-strings to format the percentages.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_8g9yeay5">Click here for video</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_bbwx9tdi">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-read_csv">pandas read_csv</a>, <a href="python.html#p-pandas-to_csv">pandas to_csv</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-23" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">import</span> pandas <span class="im">as</span> pd
<span class="im">from</span> block_timer.timer <span class="im">import</span> Timer

<span class="cf">with</span> Timer(title<span class="op">=</span><span class="st">&quot;csv&quot;</span>) <span class="im">as</span> csv:
    myDF <span class="op">=</span> pd.read_csv(<span class="st">&quot;/class/datamine/data/stackoverflow/unprocessed/2018.csv&quot;</span>)

<span class="cf">with</span> Timer(title<span class="op">=</span><span class="st">&quot;parquet&quot;</span>) <span class="im">as</span> parquet:
    myDF <span class="op">=</span> pd.read_parquet(<span class="st">&quot;/class/datamine/data/stackoverflow/unprocessed/2018.parquet&quot;</span>)

<span class="cf">with</span> Timer(title<span class="op">=</span><span class="st">&quot;feather&quot;</span>) <span class="im">as</span> feather:
    myDF <span class="op">=</span> pd.read_feather(<span class="st">&quot;/class/datamine/data/stackoverflow/unprocessed/2018.feather&quot;</span>)
    
<span class="bu">print</span>(<span class="ss">f&#39;Reading parquet is </span><span class="sc">{</span>csv<span class="sc">.</span>elapsed<span class="op">/</span>parquet<span class="sc">.</span>elapsed<span class="fl">-1.0</span><span class="sc">:.2%}</span><span class="ss"> faster than csv.&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;Reading feather is </span><span class="sc">{</span>csv<span class="sc">.</span>elapsed<span class="op">/</span>feather<span class="sc">.</span>elapsed<span class="fl">-1.0</span><span class="sc">:.2%}</span><span class="ss"> faster than csv.&#39;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">from</span> block_timer.timer <span class="im">import</span> Timer

myDF <span class="op">=</span> pd.read_csv(<span class="st">&quot;/class/datamine/data/stackoverflow/unprocessed/2018.csv&quot;</span>)

<span class="cf">with</span> Timer(title<span class="op">=</span><span class="st">&quot;csv&quot;</span>) <span class="im">as</span> csv:
    myDF.to_csv(<span class="st">&quot;/scratch/scholar/kamstut/2018.csv&quot;</span>)

<span class="cf">with</span> Timer(title<span class="op">=</span><span class="st">&quot;parquet&quot;</span>) <span class="im">as</span> parquet:
    myDF.to_parquet(<span class="st">&quot;/scratch/scholar/kamstut/2018.parquet&quot;</span>)

<span class="cf">with</span> Timer(title<span class="op">=</span><span class="st">&quot;feather&quot;</span>) <span class="im">as</span> feather:
    myDF.to_feather(<span class="st">&quot;/scratch/scholar/kamstut/2018.feather&quot;</span>)
    
<span class="bu">print</span>(<span class="ss">f&#39;Writing parquet is </span><span class="sc">{</span>csv<span class="sc">.</span>elapsed<span class="op">/</span>parquet<span class="sc">.</span>elapsed<span class="fl">-1.0</span><span class="sc">:.2%}</span><span class="ss"> faster than csv.&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;Writing feather is </span><span class="sc">{</span>csv<span class="sc">.</span>elapsed<span class="op">/</span>feather<span class="sc">.</span>elapsed<span class="fl">-1.0</span><span class="sc">:.2%}</span><span class="ss"> faster than csv.&#39;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">from</span> pathlib <span class="im">import</span> Path

csv <span class="op">=</span> Path(<span class="st">&#39;/class/datamine/data/stackoverflow/unprocessed/2018.csv&#39;</span>).stat().st_size
parquet <span class="op">=</span> Path(<span class="st">&#39;/class/datamine/data/stackoverflow/unprocessed/2018.parquet&#39;</span>).stat().st_size
feather <span class="op">=</span> Path(<span class="st">&#39;/class/datamine/data/stackoverflow/unprocessed/2018.feather&#39;</span>).stat().st_size

<span class="bu">print</span>(<span class="ss">f&#39;The parquet file is </span><span class="sc">{</span>csv<span class="op">/</span>parquet<span class="sc">:.2%}</span><span class="ss"> smaller than csv.&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;Writing feather is </span><span class="sc">{</span>csv<span class="op">/</span>feather<span class="sc">:.2%}</span><span class="ss"> smaller than csv.&#39;</span>)</code></pre></div>
</div>
<div id="a-method-is-just-a-function-associated-with-an-object-or-class.-for-example-mean-is-just-a-method-of-the-pandas-dataframe" class="section level5">
<h5>2. A <em>method</em> is just a function associated with an object or class. For example, <code>mean</code> is just a method of the <code>pandas</code> DataFrame:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co"># myDF is an object of class DataFrame</span>
<span class="co"># mean is a method of the DataFrame class</span>
myDF.mean()</code></pre></div>
</div>
<div id="in-pandas-there-are-two-main-methods-used-for-indexing-loc-and-iloc.-use-the-column-student-and-indexing-in-pandas-to-calculate-what-percentage-of-respondents-are-students-and-not-students.-consider-the-respondent-to-be-a-student-if-the-student-column-is-anything-but-no.-create-a-new-dataframe-called-not_students-that-is-a-subset-of-the-original-dataset-without-students." class="section level5">
<h5>In <code>pandas</code> there are two main methods used for indexing: <a href="https://pandas.pydata.org/docs/user_guide/indexing.html#different-choices-for-indexing"><code>loc</code> and <code>iloc</code></a>. Use the column <code>Student</code> and indexing in <code>pandas</code> to calculate what percentage of respondents are students and not students. Consider the respondent to be a student if the <code>Student</code> column is anything but &quot;No&quot;. Create a new DataFrame called <code>not_students</code> that is a subset of the original dataset <em>without</em> students.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_49qt7vnq">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-indexing">loc/iloc/indexing</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-24" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">not_students <span class="op">=</span> myDF.loc[myDF.loc[:,<span class="st">&quot;Student&quot;</span>]<span class="op">==</span><span class="st">&quot;No&quot;</span>,:]
not_student_percent <span class="op">=</span> <span class="bu">len</span>(not_students.loc[:, <span class="st">&quot;Respondent&quot;</span>])<span class="op">/</span><span class="bu">len</span>(myDF.loc[:, <span class="st">&quot;Respondent&quot;</span>])
student_percent <span class="op">=</span> <span class="dv">1</span><span class="op">-</span>not_student_percent
<span class="bu">print</span>(<span class="ss">f&quot;Percent not students: </span><span class="sc">{</span>not_student_percent<span class="sc">}</span><span class="ss">&quot;</span>)
<span class="bu">print</span>(<span class="ss">f&quot;Percent students: </span><span class="sc">{</span>student_percent<span class="sc">}</span><span class="ss">&quot;</span>)</code></pre></div>
</div>
<div id="in-pandas-if-you-were-to-isolate-a-single-column-using-indexing-like-this" class="section level5">
<h5>3. In <code>pandas</code>, if you were to isolate a single column using indexing, like this:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">myDF.loc[:, <span class="st">&quot;Student&quot;</span>]</code></pre></div>
</div>
<div id="the-result-would-be-a-pandas-series.-a-series-is-the-1-dimensional-equivalent-of-a-dataframe." class="section level5">
<h5>The result would be a <code>pandas</code> Series. A Series is the 1-dimensional equivalent of a DataFrame.</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">type</span>(myDF.loc[:, <span class="st">&quot;Student&quot;</span>]) <span class="co"># pandas.core.series.Series</span></code></pre></div>
</div>
<div id="pandas-and-numpy-make-it-very-easy-to-convert-between-a-series-ndarray-and-list.-here-is-a-very-useful-graphic-to-highlight-how-to-do-this.-look-at-the-devtype-column-in-not_students.-as-you-can-see-a-single-value-may-contain-a-list-of-semi-colon-separated-professions.-create-a-list-with-a-unique-group-of-all-the-possible-professions.-consider-each-semi-colon-separated-value-a-profession.-how-many-professions-are-there" class="section level5">
<h5><code>pandas</code> and <code>numpy</code> make it very easy to convert between a Series, ndarray, and list. <a href="https://miro.medium.com/max/1400/1*rv1JADavAhDKN4-3iM7phQ.png">Here</a> is a very useful graphic to highlight how to do this. Look at the <code>DevType</code> column in <code>not_students</code>. As you can see, a single value may contain a list of semi-colon-separated professions. Create a list with a unique group of all the possible professions. Consider each semi-colon-separated value a profession. How many professions are there?</h5>
</div>
<div id="it-looks-like-somehow-the-profession-student-got-in-there-even-though-we-filtered-by-the-student-column.-use-not_students-to-get-a-subset-of-our-data-for-which-the-respondents-replied-no-to-student-yet-put-student-as-one-of-many-possible-devtypes.-how-many-respondents-are-in-that-subset" class="section level5">
<h5>It looks like somehow the profession &quot;Student&quot; got in there even though we filtered by the <code>Student</code> column. Use <code>not_students</code> to get a subset of our data for which the respondents replied &quot;No&quot; to <code>Student</code>, yet put &quot;Student&quot; as one of many possible <code>DevType</code>s. How many respondents are in that subset?</h5>
<p><strong>Hint:</strong> If you have a column containing strings in <code>pandas</code>, and would like to use string methods on every string in the column, you can use <code>.str</code>. For example:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co"># this would use the `strip` string method on each value in myColumn, and compare them to &#39;&#39;</span>
<span class="co"># `contains` is another useful string method...</span>
myDF.loc[myDF.loc[:, <span class="st">&quot;myColumn&quot;</span>].<span class="bu">str</span>.strip() <span class="op">==</span> <span class="st">&#39;&#39;</span>, :]</code></pre></div>
<p><strong>Hint:</strong> See <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#boolean-indexing">here</a>.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_53z6v4m4">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-list-comprehensions">list comprehensions</a>, <a href="python.html#p-for-loops">for loops</a>, <a href="python.html#p-pandas-indexing">loc/iloc/indexing</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
The number of professions there are.
</li>
<li>
The number of respondents that replied &quot;No&quot; to <code>Student</code>, yet put &quot;Student&quot; as the <code>DevType</code>.
</li>
</ul>
</div>
</div>
<div id="solution-25" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">professions <span class="op">=</span> [p.split(<span class="st">&quot;;&quot;</span>) <span class="cf">for</span> p <span class="kw">in</span> not_students.loc[:, <span class="st">&quot;DevType&quot;</span>].dropna().tolist()]

<span class="co"># unnest the nested lists</span>
professions <span class="op">=</span> [p <span class="cf">for</span> li <span class="kw">in</span> professions <span class="cf">for</span> p <span class="kw">in</span> li]
professions <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(professions))

<span class="bu">print</span>(professions)
<span class="bu">print</span>(<span class="bu">len</span>(professions))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">result <span class="op">=</span> myDF.loc[(myDF.loc[:, <span class="st">&quot;Student&quot;</span>]<span class="op">==</span><span class="st">&quot;No&quot;</span>) <span class="op">&amp;</span> (myDF.loc[:, <span class="st">&quot;DevType&quot;</span>].<span class="bu">str</span>.contains(<span class="st">&quot;Student&quot;</span>)),:]
<span class="bu">len</span>(result)</code></pre></div>
</div>
<div id="as-you-can-see-while-perhaps-a-bit-more-strict-indexing-in-pandas-is-not-that-much-more-difficult-than-indexing-in-r.-while-not-always-necessary-remembering-to-put-to-indicate-all-columns-or-all-rows-makes-life-easier.-in-addition-remembering-to-put-parentheses-around-logical-groupings-is-also-a-good-thing.-practice-makes-perfect-randomly-select-100-females-and-100-males.-how-many-of-each-sample-is-in-each-age-category-do-not-use-the-sample-method-yet-but-instead-use-numeric-indexing-and-random" class="section level5">
<h5>4. As you can see, while perhaps a bit more strict, indexing in <code>pandas</code> is not that much more difficult than indexing in R. While not always necessary, remembering to put &quot;:&quot; to indicate &quot;all columns&quot; or &quot;all rows&quot; makes life easier. In addition, remembering to put parentheses around logical groupings is also a good thing. Practice makes perfect! Randomly select 100 females and 100 males. How many of each sample is in each <code>Age</code> category? (<em>Do not</em> use the <code>sample</code> method yet, but instead use numeric indexing and <code>random</code>)</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> random

<span class="bu">print</span>(<span class="ss">f&quot;A random integer between 1 and 100 is </span><span class="sc">{</span>random<span class="sc">.</span>randint(<span class="dv">1</span>, <span class="dv">101</span>)<span class="sc">}</span><span class="ss">&quot;</span>)</code></pre></div>
<pre><code>## A random integer between 1 and 100 is 80</code></pre>
</div>
<div id="it-would-be-nice-to-visualize-these-results.-pandas-series-have-some-built-in-methods-to-create-plots.-use-this-method-to-generate-a-bar-plot-for-both-females-and-males.-how-do-they-compare" class="section level5">
<h5>It would be nice to visualize these results. <code>pandas</code> Series have some built in methods to create plots. Use [this] method to generate a bar plot for both females and males. How do they compare?</h5>
<p><strong>Hint:</strong> You may need to import <code>matplotlib</code> in order to display the graphic:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt 

<span class="co"># female barplot code here</span>
plt.show()

<span class="co"># male barplot code here</span>
plt.show()</code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_aib7hfxy">Click here for video</a></p>
<p><strong>Hint:</strong> Once you have your female and male DataFrames, the <code>value_counts</code> method found <a href="https://pandas.pydata.org/docs/reference/series.html#computations-descriptive-stats">here</a> may be particularly useful.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-list-comprehensions">list comprehensions</a>, <a href="python.html#p-for-loops">for loops</a>, <a href="python.html#p-pandas-indexing">loc/iloc/indexing</a>, <a href="python.html#p-matplotlib-barplot">barplot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-26" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">import</span> random
<span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt 


males <span class="op">=</span> myDF.loc[(myDF.loc[:, <span class="st">&quot;Gender&quot;</span>]<span class="op">==</span><span class="st">&quot;Male&quot;</span>), :]
random_indices <span class="op">=</span> [random.randint(<span class="dv">0</span>, <span class="bu">len</span>(males)) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">100</span>)]
males <span class="op">=</span> males.iloc[random_indices, ]
<span class="bu">print</span>(males.loc[:,<span class="st">&quot;Age&quot;</span>].value_counts())

females <span class="op">=</span> myDF.loc[(myDF.loc[:, <span class="st">&quot;Gender&quot;</span>]<span class="op">==</span><span class="st">&quot;Female&quot;</span>), :]
random_indices <span class="op">=</span> [random.randint(<span class="dv">0</span>, <span class="bu">len</span>(females)) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">100</span>)]
females <span class="op">=</span> females.iloc[random_indices]
<span class="bu">print</span>(females.loc[:,<span class="st">&quot;Age&quot;</span>].value_counts())

males.loc[:,<span class="st">&quot;Age&quot;</span>].value_counts().plot.bar()
plt.show()

females.loc[:,<span class="st">&quot;Age&quot;</span>].value_counts().plot.bar()
plt.show()</code></pre></div>
</div>
<div id="pandas-really-helps-out-when-it-comes-to-working-with-data-in-python.-this-is-a-really-cool-dataset-use-your-newfound-skills-to-do-a-mini-analysis.-your-mini-analysis-should-include-1-or-more-graphics-along-with-some-interesting-observation-you-made-while-exploring-the-data." class="section level5">
<h5>5. <code>pandas</code> really helps out when it comes to working with data in Python. This is a really cool dataset, use your newfound skills to do a mini-analysis. Your mini-analysis should include 1 or more graphics, along with some interesting observation you made while exploring the data.</h5>
<p><strong>Relevant topics:</strong></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
A graphic.
</li>
<li>
1-2 sentences explaining your interesting observation and graphic.
</li>
</ul>
</div>
</div>
<div id="solution-27" class="section level5">
<h5>Solution</h5>
<div class="solution">
<p>
Could be anything.
</p>
</div>
<hr />
</div>
</div>
</div>
<div id="p06-190" class="section level3">
<h3>Project 6</h3>
<hr />
<p><strong>Motivation:</strong> Being able to analyze and create good visualizations is a skill that is invaluable in <em>many</em> fields. It can be pretty fun too! In this project, we are going to take a small hiatus from the regular stream of projects to do some data visualizations.</p>
<p><strong>Context:</strong> We've been working hard all semester and learning valuable skills. In this project we are going to ask you to examine some plots, write a little bit, and use your creative energies to create good visualizations about the flight data.</p>
<p><strong>Scope:</strong> python, r, visualizing data</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Demostrate the ability to create basic graphs with default settings.
</li>
<li>
Demonstrate the ability to modify axes labels and titles.
</li>
<li>
Demonstrate the ability to customize a plot (color, shape/linetype).
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset-5" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/flights/*.csv</code> (all csv files)</p>
</div>
<div id="questions-5" class="section level4">
<h4>Questions</h4>
<div id="here-are-the-results-from-the-2009-data-expo-poster-competition.-the-object-of-the-competition-was-to-visualize-interesting-information-from-the-flights-dataset.-examine-all-8-posters-and-write-a-single-sentence-for-each-poster-with-your-first-impressions.-an-example-of-an-impression-that-will-not-get-full-credit-would-be-my-first-impression-is-that-this-poster-is-bad-and-doesnt-look-organized..-an-example-of-an-impression-that-will-get-full-credit-would-be-my-first-impression-is-that-the-author-had-a-good-visualization-to-text-ratio-and-it-seems-easy-to-follow-along.." class="section level5">
<h5>1. <a href="http://stat-computing.org/dataexpo/2009/posters/">Here</a> are the results from the 2009 Data Expo poster competition. The object of the competition was to visualize interesting information from the flights dataset. Examine all 8 posters and write a single sentence for each poster with your first impression(s). An example of an impression that will not get full credit would be: &quot;My first impression is that this poster is bad and doesn't look organized.&quot;. An example of an impression that will get full credit would be: &quot;My first impression is that the author had a good visualization-to-text ratio and it seems easy to follow along.&quot;.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_43j9xh4d">Click here for video</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
8 bullets, each containing a sentence with the first impression of the 8 visualizations. Order should be &quot;first place&quot;, to &quot;honourable mention&quot;, followed by &quot;other posters&quot; in the given order. Or, label which graphic each sentence is about.
</li>
</ul>
</div>
</div>
<div id="creating-more-effective-graphs-by-dr.-naomi-robbins-and-the-elements-of-graphing-data-by-dr.-william-cleveland-at-purdue-university-are-two-excellent-books-about-data-visualization.-read-the-following-excerpts-from-the-books-respectively-and-list-2-things-you-learned-or-found-interesting-from-each-book." class="section level5">
<h5>2. <a href="https://www.amazon.com/dp/0985911123/">Creating More Effective Graphs</a> by Dr. Naomi Robbins and <a href="https://www.amazon.com/Elements-Graphing-Data-William-Cleveland/dp/0963488414/ref=sr_1_1?dchild=1&amp;keywords=elements+of+graphing+data&amp;qid=1614013761&amp;sr=8-1">The Elements of Graphing Data</a> by Dr. William Cleveland at Purdue University, are two excellent books about data visualization. Read the following excerpts from the books (respectively), and list 2 things you learned, or found interesting from <em>each</em> book.</h5>
<ul>
<li><a href="./files/CreatingMoreEffectiveGraphs.pdf">Excerpt 1</a></li>
<li><a href="./files/ElementsOfGraphingData.pdf">Excerpt 2</a></li>
</ul>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_6c1ge176">Click here for video</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Two bullets for each book with items you learned or found interesting.
</li>
</ul>
</div>
</div>
<div id="of-the-7-posters-with-at-least-3-plots-andor-maps-choose-1-poster-that-you-think-you-could-improve-upon-or-out-plot.-create-4-plotsmaps-that-either" class="section level5">
<h5>3. Of the 7 posters with at least 3 plots and/or maps, choose 1 poster that you think you could improve upon or &quot;out plot&quot;. Create 4 plots/maps that either:</h5>
<ol style="list-style-type: decimal">
<li>Improve upon a plot from the poster you chose, or</li>
<li>Show a completely different plot that does a good job of getting an idea or observation across, or</li>
<li>Ruin a plot. Purposefully break the best practices you've learned about in order to make the visualization misleading. (limited to 1 of the 4 plots)</li>
</ol>
</div>
<div id="for-each-plotmap-where-you-choose-to-do-1-include-1-2-sentences-explaining-what-exactly-you-improved-upon-and-how.-point-out-some-of-the-best-practices-from-the-2-provided-texts-that-you-followed.-for-each-plotmap-where-you-choose-to-do-2-include-1-2-sentences-explaining-your-graphic-and-outlining-the-best-practices-from-the-2-texts-that-you-followed.-for-each-plotmap-where-you-choose-to-do-3-include-1-2-sentences-explaining-what-you-changed-what-principle-it-broke-and-how-it-made-the-plot-misleading-or-worse." class="section level5">
<h5>For each plot/map where you choose to do (1), include 1-2 sentences explaining what exactly you improved upon and how. Point out some of the best practices from the 2 provided texts that you followed. For each plot/map where you choose to do (2), include 1-2 sentences explaining your graphic and outlining the best practices from the 2 texts that you followed. For each plot/map where you choose to do (3), include 1-2 sentences explaining what you changed, what principle it broke, and how it made the plot misleading or worse.</h5>
</div>
<div id="while-we-are-not-asking-you-to-create-a-poster-please-use-rmarkdown-to-keep-your-plots-code-and-text-nicely-formatted-and-organized.-the-more-like-a-story-your-project-reads-the-better.-you-are-free-to-use-either-r-or-python-or-both-to-complete-this-project.-please-note-that-it-would-be-unadvisable-to-use-an-interactive-plotting-package-like-plotly-as-these-packages-will-not-render-plots-from-within-rmarkdown-in-rstudio." class="section level5">
<h5>While we are not asking you to create a poster, please use RMarkdown to keep your plots, code, and text nicely formatted and organized. The more like a story your project reads, the better. You are free to use either R or Python or both to complete this project. Please note that it would be unadvisable to use an interactive plotting package like <code>plotly</code>, as these packages will not render plots from within RMarkdown in RStudio.</h5>
</div>
<div id="some-useful-r-packages" class="section level5">
<h5>Some useful R packages:</h5>
<ul>
<li><a href="r.html#r-plotting">base R functions</a>: bar, plot, lines, etc.</li>
<li><a href="r.html#r-plot_usmap">usmap</a></li>
<li><a href="https://uc-r.github.io/ggplot_intro">ggplot</a></li>
</ul>
</div>
<div id="some-useful-python-packages" class="section level5">
<h5>Some useful Python packages:</h5>
<ul>
<li><a href="https://thedatamine.github.io/the-examples-book/python.html#p-matplotlib">matplotlib</a></li>
<li><a href="https://plotnine.readthedocs.io/en/stable/#">plotnine</a></li>
</ul>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_kmvuq0zc">Click here for video</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
All associated R/Python code you used to wrangling the data and create your graphics.
</li>
<li>
4 plots, with at least 4 associated RMarkdown code chunks.
</li>
<li>
1-2 sentences per plot explaining what exactly you improved upon, what best practices from the texts you used, and how. If it is a brand new visualization, describe and explain your graphic, outlining the best practices from the 2 texts that you followed. If it is the ruined plot you chose, explain what you changed, what principle it broke, and how it made the plot misleading or worse.
</li>
</ul>
</div>
</div>
<div id="now-that-youve-been-exploring-data-visualization-copy-paste-and-update-your-first-impressions-from-question-1-with-your-updated-impressions.-which-impression-changed-the-most-and-why" class="section level5">
<h5>4. Now that you've been exploring data visualization, copy, paste, and update your first impressions from question (1) with your updated impressions. Which impression changed the most, and why?</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_3fkl4ln3">Click here for video</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
8 bullets with updated impressions (still just a sentence or two) from question (1).
</li>
<li>
A sentence explaining which impression changed the most and why.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="p07-190" class="section level3">
<h3>Project 7</h3>
<hr />
<p><strong>Motivation:</strong> There is one pretty major topic that we have yet to explore in Python -- functions! A key component to writing efficient code is writing functions. Functions allow us to repeat and reuse coding steps that we used previously, over and over again. If you find you are repeating code over and over, a function may be a good way to reduce lots of lines of code.</p>
<p><strong>Context:</strong> We are taking a small hiatus from our <code>pandas</code> and <code>numpy</code> focused series to learn about and write our own functions in Python!</p>
<p><strong>Scope:</strong> python, functions, pandas</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Comprehend what a function is, and the components of a function in Python.
</li>
<li>
Differentiate between positional and keyword arguments.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset-6" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/yelp/data/parquet</code></p>
</div>
<div id="questions-6" class="section level4">
<h4>Questions</h4>
<div id="youve-been-given-a-path-to-a-folder-for-a-dataset.-explore-the-files.-give-a-brief-description-of-the-files-and-what-each-file-contains." class="section level5">
<h5>1. You've been given a path to a folder for a dataset. Explore the files. Give a brief description of the files and what each file contains.</h5>
<p><strong>Note:</strong> Take a look at the size of each of the files. If you are interested in experimenting, try using <code>pandas</code> <code>read_json</code> function to read the <code>yelp_academic_dataset_user.json</code> file in the json folder <code>/class/datamine/data/yelp/data/json/yelp_academic_dataset_user.json</code>. Even with the large amount of memory available to you, this should fail. In order to make it work you would need to use the <code>chunksize</code> option to read the data in bit by bit. Now consider that the <code>reviews.parquet</code> file is .3gb <em>larger</em> than the <code>yelp_academic_dataset_user.json</code> file, but can be read in with no problem. That is seriously impressive!</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_lbvcdjyw">Click here for video</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_h13rpztv">Click here for another video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-read_parquet">read_parquet</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
The name of each dataset and a brief summary of each dataset. No more than 1-2 sentences about each dataset.
</li>
</ul>
</div>
</div>
<div id="solution-28" class="section level5">
<h5>Solution</h5>
</div>
<div id="read-the-businesses.parquet-file-into-a-pandas-dataframe-called-businesses.-take-a-look-to-the-hours-and-attributes-columns.-if-you-look-closely-youll-observe-that-both-columns-contain-a-lot-more-than-a-single-feature.-in-fact-the-attributes-column-contains-39-features-and-the-hours-column-contains-7" class="section level5">
<h5>2. Read the <code>businesses.parquet</code> file into a <code>pandas</code> DataFrame called <code>businesses</code>. Take a look to the <code>hours</code> and <code>attributes</code> columns. If you look closely, you'll observe that both columns contain a lot more than a single feature. In fact, the <code>attributes</code> column contains 39 features and the <code>hours</code> column contains 7!</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">len</span>(businesses.loc[:, <span class="st">&quot;attributes&quot;</span>].iloc[<span class="dv">0</span>].keys()) <span class="co"># 39</span>
<span class="bu">len</span>(businesses.loc[:, <span class="st">&quot;hours&quot;</span>].iloc[<span class="dv">0</span>].keys()) <span class="co"># 7</span></code></pre></div>
</div>
<div id="lets-start-by-writing-a-simple-function.-create-a-function-called-has_attributes-that-takes-a-business_id-as-an-argument-and-returns-true-if-the-business-has-any-attributes-and-false-otherwise.-test-it-with-the-following-code" class="section level5">
<h5>Let's start by writing a simple function. Create a function called <code>has_attributes</code> that takes a <code>business_id</code> as an argument, and returns <code>True</code> if the business has any <code>attributes</code> and <code>False</code> otherwise. Test it with the following code:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(has_attributes(<span class="st">&#39;f9NumwFMBDn751xgFiRbNA&#39;</span>)) <span class="co"># True</span>
<span class="bu">print</span>(has_attributes(<span class="st">&#39;XNoUzKckATkOD1hP6vghZg&#39;</span>)) <span class="co"># False</span>
<span class="bu">print</span>(has_attributes(<span class="st">&#39;Yzvjg0SayhoZgCljUJRF9Q&#39;</span>)) <span class="co"># True</span>
<span class="bu">print</span>(has_attributes(<span class="st">&#39;7uYJJpwORUbCirC1mz8n9Q&#39;</span>)) <span class="co"># False</span></code></pre></div>
</div>
<div id="while-this-is-useful-to-get-whether-or-not-a-single-business-has-any-attributes-if-you-wanted-to-apply-this-function-to-the-entire-attributes-columnseries-you-would-just-use-the-notna-method" class="section level5">
<h5>While this is useful to get whether or not a single business has any attributes, if you wanted to apply this function to the entire <code>attributes</code> column/Series, you would just use the <code>notna</code> method:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">businesses.loc[:, <span class="st">&quot;attributes&quot;</span>].notna()</code></pre></div>
<p><strong>Important note:</strong> Make sure your return value is of type <code>bool</code>. To check this:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">type</span>(<span class="va">True</span>) <span class="co"># bool</span>
<span class="bu">type</span>(<span class="st">&quot;True&quot;</span>) <span class="co"># str</span></code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_l2b5g5pb">Click here for video</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_jcnolv45">Click here for another video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-indexing">pandas indexing</a>, <a href="python.html#p-writing-functions">functions</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running the provided &quot;test&quot; code.
</li>
</ul>
</div>
</div>
<div id="take-a-look-at-the-attributes-of-the-first-business" class="section level5">
<h5>3. Take a look at the <code>attributes</code> of the first business:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">businesses.loc[:, <span class="st">&quot;attributes&quot;</span>].iloc[<span class="dv">0</span>]</code></pre></div>
</div>
<div id="what-is-the-type-of-the-value-lets-assume-the-company-you-work-for-gets-data-formatted-like-businesses-each-week-but-your-boss-wants-the-39-features-in-attributes-and-the-7-features-in-hours-to-become-their-own-columns.-write-a-function-called-fix_businesses_data-that-accepts-an-argument-called-data_path-of-type-str-that-is-a-full-path-to-a-parquet-file-that-is-in-the-exact-same-format-as-businesses.parquet.-in-addition-to-the-data_path-argument-fix_businesses_data-should-accept-another-argument-called-output_dir-of-type-str.-output_dir-should-contain-the-path-where-you-want-your-fixed-parquet-file-to-output.-fix_businesses_data-should-return-none." class="section level5">
<h5>What is the type of the value? Let's assume the company you work for gets data formatted like <code>businesses</code> each week, but your boss wants the 39 features in <code>attributes</code> and the 7 features in <code>hours</code> to become their own columns. Write a function called <code>fix_businesses_data</code> that accepts an argument called <code>data_path</code> (of type <code>str</code>) that is a full path to a parquet file that is in the exact same format as <code>businesses.parquet</code>. In addition to the <code>data_path</code> argument, <code>fix_businesses_data</code> should accept another argument called <code>output_dir</code> (of type <code>str</code>). <code>output_dir</code> should contain the path where you want your &quot;fixed&quot; parquet file to output. <code>fix_businesses_data</code> should return <code>None</code>.</h5>
</div>
<div id="the-result-of-your-function-should-be-a-new-file-called-new_businesses.parquet-saved-in-the-output_dir-the-data-in-this-file-should-no-longer-contain-either-the-attributes-or-hours-columns.-instead-each-row-should-contain-397-new-columns.-test-your-function-out" class="section level5">
<h5>The result of your function, should be a new file called <code>new_businesses.parquet</code> saved in the <code>output_dir</code>, the data in this file should no longer contain either the <code>attributes</code> or <code>hours</code> columns. Instead, each row should contain 39+7 new columns. Test your function out:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> pathlib <span class="im">import</span> Path

my_username <span class="op">=</span> <span class="st">&quot;kamstut&quot;</span> <span class="co"># replace &quot;kamstut&quot; with YOUR username</span>
fix_businesses_data(data_path<span class="op">=</span><span class="st">&quot;/class/datamine/data/yelp/data/parquet/businesses.parquet&quot;</span>, output_dir<span class="op">=</span><span class="ss">f&quot;/scratch/scholar/</span><span class="sc">{</span>my_username<span class="sc">}</span><span class="ss">&quot;</span>)

<span class="co"># see if output exists</span>
p <span class="op">=</span> Path(<span class="ss">f&quot;/scratch/scholar/</span><span class="sc">{</span>my_username<span class="sc">}</span><span class="ss">&quot;</span>).glob(<span class="st">&#39;**/*&#39;</span>)
files <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> p <span class="cf">if</span> x.is_file()]
<span class="bu">print</span>(files)</code></pre></div>
<p><strong>Important note:</strong> Make sure that either <code>/scratch/scholar/{my_username}</code> or <code>/scratch/scholar/{my_username}/</code> will work as arguments to <code>output_dir</code>. If you use the <code>pathlib</code> library, as shown in the provided function &quot;skeleton&quot; below, both will work automatically!</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> pathlib <span class="im">import</span> Path

<span class="kw">def</span> fix_businesses_data(data_path: <span class="bu">str</span>, output_dir: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:
    <span class="co">&quot;&quot;&quot;</span>
<span class="co">    fix_data accepts a parquet file that contains data in a specific format. </span>
<span class="co">    fix_data &quot;explodes&quot; the attributes and hours columns into 39+7=46 new </span>
<span class="co">    columns.</span>
<span class="co">    Args:</span>
<span class="co">        data_path (str): Full path to a file in the same format as businesses.parquet.</span>
<span class="co">        output_dir (str): Path to a directory where new_businesses.parquet should be output.</span>
<span class="co">    &quot;&quot;&quot;</span>
    <span class="co"># read in original parquet file</span>
    businesses <span class="op">=</span> pd.read_parquet(data_path)
    
    <span class="co"># unnest the attributes column</span>
    
    <span class="co"># unnest the hours column</span>
    
    <span class="co"># output new file</span>
    businesses.to_parquet(<span class="bu">str</span>(Path(<span class="ss">f&quot;</span><span class="sc">{</span>output_dir<span class="sc">}</span><span class="ss">&quot;</span>).joinpath(<span class="st">&quot;new_businesses.parquet&quot;</span>)))
    
    <span class="cf">return</span> <span class="va">None</span></code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_zf4bl8g4">Click here for video</a></p>
<p><strong>Hint:</strong> Check out the code below, notice how using <code>pathlib</code> handles whether or not we have the trailing <code>/</code>.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> pathlib <span class="im">import</span> Path

<span class="bu">print</span>(Path(<span class="st">&quot;/class/datamine/data/&quot;</span>).joinpath(<span class="st">&quot;my_file.txt&quot;</span>))
<span class="bu">print</span>(Path(<span class="st">&quot;/class/datamine/data&quot;</span>).joinpath(<span class="st">&quot;my_file.txt&quot;</span>))</code></pre></div>
<p><strong>Hint:</strong> You can test out your function on <code>/class/datamine/data/yelp/data/parquet/businesses_sample.parquet</code> to not waste as much time.</p>
<p><strong>Hint:</strong> If we were using R and the <code>tidyverse</code> package, this sort of behavior is called &quot;unnesting&quot;. You can read more about it <a href="https://tidyr.tidyverse.org/reference/nest.html">here</a>.</p>
<p><strong>Hint:</strong> <a href="https://stackoverflow.com/questions/38231591/splitting-dictionary-list-inside-a-pandas-column-into-separate-columns">This</a> stackoverflow post should be <em>very</em> useful! Specifically, run this code and take a look at the output:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">businesses
businesses.loc[<span class="dv">0</span>:<span class="dv">4</span>, <span class="st">&quot;attributes&quot;</span>].<span class="bu">apply</span>(pd.Series)</code></pre></div>
<p>Notice that some rows have json, and others have <code>None</code>:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">businesses.loc[<span class="dv">0</span>, <span class="st">&quot;attributes&quot;</span>] <span class="co"># has json</span>
businesses.loc[<span class="dv">2</span>, <span class="st">&quot;attributes&quot;</span>] <span class="co"># has None</span></code></pre></div>
<p>This method allows us to handle both cases. If the row has json it converts the values, if it has <code>None</code> it just puts each column with a value of <code>None</code>.</p>
<p><strong>Hint:</strong> <a href="https://stackoverflow.com/questions/44723377/pandas-combining-two-dataframes-horizontally">Here</a> is an example that shows you how to concatenate (combine) dataframes.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-indexing">pandas indexing</a>, <a href="python.html#p-writing-functions">functions</a>, <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html">concat</a>, <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.apply.html">apply</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="thats-a-pretty-powerful-function-and-could-definitely-be-useful.-what-if-instead-of-working-on-just-our-specifically-formatted-parquet-file-we-wrote-a-function-that-worked-for-any-pandas-dataframe-write-a-function-called-unnest-that-accepts-a-pandas-dataframe-as-an-argument-lets-call-this-argument-mydf-and-a-list-of-columns-lets-call-this-argument-columns-and-returns-a-dataframe-where-the-provided-columns-are-unnested." class="section level5">
<h5>4. That's a pretty powerful function, and could definitely be useful. What if, instead of working on just our specifically formatted parquet file, we wrote a function that worked for <em>any</em> <code>pandas</code> DataFrame? Write a function called <code>unnest</code> that accepts a <code>pandas</code> DataFrame as an argument (let's call this argument <code>myDF</code>), and a list of columns (let's call this argument <code>columns</code>), and returns a DataFrame where the provided columns are unnested.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_0yb372sp">Click here for video</a></p>
<p><strong>Important note:</strong> You may write <code>unnest</code> so that the resulting dataframe contains the original dataframe <em>and</em> the unnested columns, or you may return just the unnested columns -- both will be accepted solutions.</p>
<p><strong>Hint:</strong> The following should work:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">businesses <span class="op">=</span> pd.read_parquet(<span class="st">&quot;/class/datamine/data/yelp/data/parquet/businesses.parquet&quot;</span>)

new_businesses_df <span class="op">=</span> unnest(businesses, [<span class="st">&quot;attributes&quot;</span>, ])
new_businesses_df.shape <span class="co"># (209393, 39)</span>
new_businesses_df.head()

new_businesses_df <span class="op">=</span> unnest(businesses, [<span class="st">&quot;attributes&quot;</span>, <span class="st">&quot;hours&quot;</span>])
new_businesses_df.shape <span class="co"># (209393, 46)</span>
new_businesses_df.head()</code></pre></div>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-indexing">pandas indexing</a>, <a href="python.html#p-writing-functions">functions</a>, <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.apply.html">apply</a>, <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.drop.html?highlight=drop#pandas.DataFrame.drop">drop</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running the provided code.
</li>
</ul>
</div>
</div>
<div id="try-out-the-code-below.-if-a-provided-column-isnt-already-nested-the-column-name-is-ruined-and-the-data-is-changed.-if-the-column-doesnt-already-exist-a-keyerror-is-thrown.-modify-our-function-from-question-4-to-skip-unnesting-if-the-column-doesnt-exist.-in-addition-modify-the-function-from-question-4-to-skip-the-column-if-the-column-isnt-nested.-lets-consider-a-column-nested-if-the-value-of-the-column-is-a-dict-and-not-nested-otherwise." class="section level5">
<h5>5. Try out the code below. If a provided column isn't already nested, the column name is ruined and the data is changed. If the column doesn't already exist, a KeyError is thrown. Modify our function from question (4) to skip unnesting if the column doesn't exist. In addition, modify the function from question (4) to skip the column if the column isn't nested. Let's consider a column nested if the value of the column is a <code>dict</code>, and not nested otherwise.</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">businesses <span class="op">=</span> pd.read_parquet(<span class="st">&quot;/class/datamine/data/yelp/data/parquet/businesses.parquet&quot;</span>)

new_businesses_df <span class="op">=</span> unnest(businesses, [<span class="st">&quot;doesntexist&quot;</span>,]) <span class="co"># KeyError</span>
new_businesses_df <span class="op">=</span> unnest(businesses, [<span class="st">&quot;postal_code&quot;</span>,]) <span class="co"># not nested</span></code></pre></div>
</div>
<div id="to-test-your-code-run-the-following.-the-result-should-be-a-dataframe-where-attributes-has-been-unnested-and-that-is-it." class="section level5">
<h5>To test your code, run the following. The result should be a DataFrame where <code>attributes</code> has been unnested, and that is it.</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">businesses <span class="op">=</span> pd.read_parquet(<span class="st">&quot;/class/datamine/data/yelp/data/parquet/businesses.parquet&quot;</span>)
results <span class="op">=</span> unnest(businesses, [<span class="st">&quot;doesntexist&quot;</span>, <span class="st">&quot;postal_code&quot;</span>, <span class="st">&quot;attributes&quot;</span>])
results.shape <span class="co"># (209393, 39)</span>
results.head()</code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_0e4q4ley">Click here for video</a></p>
<p><strong>Hint:</strong> To see if a variable is a <code>dict</code> you could use <code>type</code>:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">my_variable <span class="op">=</span> {<span class="st">&#39;key&#39;</span>: <span class="st">&#39;value&#39;</span>}
<span class="bu">type</span>(my_variable)</code></pre></div>
<pre><code>## &lt;class &#39;dict&#39;&gt;</code></pre>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-indexing">pandas indexing</a>, <a href="python.html#p-writing-functions">functions</a>, <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.apply.html">apply</a>, <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.drop.html?highlight=drop#pandas.DataFrame.drop">drop</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running the provided code.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="p08-190" class="section level3">
<h3>Project 8</h3>
<hr />
<p><strong>Motivation:</strong> A key component to writing efficient code is writing functions. Functions allow us to repeat and reuse coding steps that we used previously, over and over again. If you find you are repeating code over and over, a function may be a good way to reduce lots of lines of code. There are some pretty powerful features of functions that we have yet to explore that aren't necessarily present in R. In this project we will continue to learn about and harness the power of functions to solve data-driven problems.</p>
<p><strong>Context:</strong> We are taking a small hiatus from our <code>pandas</code> and <code>numpy</code> focused series to learn about and write our own functions in Python!</p>
<p><strong>Scope:</strong> python, functions, pandas</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Comprehend what a function is, and the components of a function in Python.
</li>
<li>
Differentiate between positional and keyword arguments.
</li>
<li>
Learn about packing and unpacking variables and arguments.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset-7" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/yelp/data/parquet</code></p>
</div>
<div id="questions-7" class="section level4">
<h4>Questions</h4>
<div id="the-company-you-work-for-is-assigning-you-to-the-task-of-building-out-some-functions-for-the-new-api-theyve-built.-please-load-these-two-pandas-dataframes" class="section level5">
<h5>1. The company you work for is assigning you to the task of building out some functions for the new API they've built. Please load these two <code>pandas</code> DataFrame's:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">users <span class="op">=</span> pd.read_parquet(<span class="st">&quot;/class/datamine/data/yelp/data/parquet/users.parquet&quot;</span>)
reviews <span class="op">=</span> pd.read_parquet(<span class="st">&quot;/class/datamine/data/yelp/data/parquet/reviews.parquet&quot;</span>)</code></pre></div>
<p>You do <strong>not</strong> need these four DataFrames in this project.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">photos <span class="op">=</span> pd.read_parquet(<span class="st">&quot;/class/datamine/data/yelp/data/parquet/photos.parquet&quot;</span>)
businesses <span class="op">=</span> pd.read_parquet(<span class="st">&quot;/class/datamine/data/yelp/data/parquet/businesses.parquet&quot;</span>)
checkins <span class="op">=</span> pd.read_parquet(<span class="st">&quot;/class/datamine/data/yelp/data/parquet/checkins.parquet&quot;</span>)
tips <span class="op">=</span> pd.read_parquet(<span class="st">&quot;/class/datamine/data/yelp/data/parquet/tips.parquet&quot;</span>)</code></pre></div>
</div>
<div id="you-would-expect-that-friends-may-have-a-similar-taste-in-restaurants-or-businesses.-write-a-function-called-get_friends_data-that-accepts-a-user_id-as-an-argument-and-returns-a-pandas-dataframe-with-the-information-in-the-users-dataframe-for-each-friend-of-user_id.-look-at-the-solutions-from-the-previous-project-as-well-as-this-page.-add-type-hints-for-your-function.-you-should-have-a-type-hint-for-our-argument-user_id-as-well-as-a-type-hint-for-the-returned-data.-in-addition-to-type-hints-make-sure-to-document-your-function-with-a-docstring." class="section level5">
<h5>You would expect that friends may have a similar taste in restaurants or businesses. Write a function called <code>get_friends_data</code> that accepts a <code>user_id</code> as an argument, and returns a <code>pandas</code> DataFrame with the information in the <code>users</code> DataFrame for each friend of <code>user_id</code>. Look at the solutions from the previous project, as well as <a href="https://docs.python.org/3.8/library/typing.html">this</a> page. Add type hints for your function. You should have a type hint for our argument, <code>user_id</code>, as well as a type hint for the returned data. In addition to type hints, make sure to document your function with a docstring.</h5>
<p><strong>Hint:</strong> Every function in the solutions for last week's projects has a docstring. You can use this as a reference.</p>
<p><strong>Hint:</strong> You should get the same number of friends for the following code:</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_3rz4xvfd">Click here for video</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_svzmy7k9">Click here for another video</a></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(get_friends_data(<span class="st">&quot;ntlvfPzc8eglqvk92iDIAw&quot;</span>).shape) <span class="co"># (13,22)</span>
<span class="bu">print</span>(get_friends_data(<span class="st">&quot;AY-laIws3S7YXNl_f_D6rQ&quot;</span>).shape) <span class="co"># (1, 22)</span>
<span class="bu">print</span>(get_friends_data(<span class="st">&quot;xvu8G900tezTzbbfqmTKvA&quot;</span>).shape) <span class="co"># (193,22)</span></code></pre></div>
<p><strong>Note:</strong> It is sufficient to just load the first of these three examples, when you Knit your project (to save time during Knitting).</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-indexing">pandas indexing</a>, <a href="python.html#p-writing-functions">functions</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="write-a-function-called-calculate_avg_business_stars-that-accepts-a-business_id-and-returns-the-average-number-of-stars-that-business-received-in-reviews.-like-in-question-1-make-sure-to-add-type-hints-and-docstrings.-in-addition-add-comments-when-and-if-necessary." class="section level5">
<h5>2. Write a function called <code>calculate_avg_business_stars</code> that accepts a <code>business_id</code> and returns the average number of stars that business received in reviews. Like in question (1) make sure to add type hints and docstrings. In addition, add comments when (and if) necessary.</h5>
</div>
<div id="there-is-a-really-cool-method-that-gives-us-the-same-powers-that-tapply-gives-us-in-r.-use-the-groupby-method-from-pandas-to-calculate-the-average-stars-for-all-businesses.-index-the-result-to-confirm-that-your-calculate_avg_business_stars-function-worked-properly." class="section level5">
<h5>There is a really cool method that gives us the same &quot;powers&quot; that <code>tapply</code> gives us in R. Use the <code>groupby</code> method from <code>pandas</code> to calculate the average stars for all businesses. Index the result to confirm that your <code>calculate_avg_business_stars</code> function worked properly.</h5>
<p><strong>Hint:</strong> You should get the same average number of start value for the following code:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(calculate_avg_business_stars(<span class="st">&quot;f9NumwFMBDn751xgFiRbNA&quot;</span>)) <span class="co"># 3.1025641025641026</span></code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_ltlxogfg">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-indexing">pandas indexing</a>, <a href="python.html#p-writing-functions">functions</a>, <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.core.groupby.GroupBy.mean.html">groupby</a>, <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html">numpy.mean()</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="write-a-function-called-visualize_stars_over_time-that-accepts-a-business_id-and-returns-a-line-plot-that-shows-the-average-number-of-stars-for-each-year-the-business-has-review-data.-like-in-previous-questions-make-sure-to-add-type-hints-and-docstrings.-in-addition-add-comments-when-and-if-necessary.-you-can-test-your-function-with-some-of-these" class="section level5">
<h5>3. Write a function called <code>visualize_stars_over_time</code> that accepts a <code>business_id</code> and returns a line plot that shows the average number of stars for each year the business has review data. Like in previous questions, make sure to add type hints and docstrings. In addition, add comments when (and if) necessary. You can test your function with some of these:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">visualize_stars_over_time(<span class="st">&#39;RESDUcs7fIiihp38-d6_6g&#39;</span>)</code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_5r822u5j">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-indexing">pandas indexing</a>, <a href="python.html#p-writing-functions">functions</a>, <a href="python.html#p-matplotlib-lineplot">matplotlib lineplot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="modify-question-3-and-add-an-argument-called-granularity-that-dictates-whether-the-plot-will-show-the-average-rating-over-years-or-months.-granularity-should-accept-one-of-two-strings-years-or-months.-by-default-if-granularity-isnt-specified-it-should-be-years." class="section level5">
<h5>4. Modify question (3), and add an argument called <code>granularity</code> that dictates whether the plot will show the average rating over years, or months. <code>granularity</code> should accept one of two strings: &quot;years&quot;, or &quot;months&quot;. By default, if <code>granularity</code> isn't specified, it should be &quot;years&quot;.</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">visualize_stars_over_time(<span class="st">&#39;RESDUcs7fIiihp38-d6_6g&#39;</span>, <span class="st">&quot;months&quot;</span>)</code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_wdg4hfac">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-indexing">pandas indexing</a>, <a href="python.html#p-writing-functions">functions</a>, <a href="python.html#p-matplotlib-lineplot">matplotlib lineplot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="modify-question-4-to-accept-multiple-business_ids-and-create-a-line-for-each-id.-each-of-the-following-should-work" class="section level5">
<h5>5. Modify question (4) to accept multiple business_id's, and create a line for each id. Each of the following should work:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">visualize_stars_over_time(<span class="st">&quot;RESDUcs7fIiihp38-d6_6g&quot;</span>, <span class="st">&quot;4JNXUYY8wbaaDmk3BPzlWw&quot;</span>, <span class="st">&quot;months&quot;</span>)
visualize_stars_over_time(<span class="st">&quot;RESDUcs7fIiihp38-d6_6g&quot;</span>, <span class="st">&quot;4JNXUYY8wbaaDmk3BPzlWw&quot;</span>, <span class="st">&quot;K7lWdNUhCbcnEvI0NhGewg&quot;</span>, <span class="st">&quot;months&quot;</span>)
visualize_stars_over_time(<span class="st">&quot;RESDUcs7fIiihp38-d6_6g&quot;</span>, <span class="st">&quot;4JNXUYY8wbaaDmk3BPzlWw&quot;</span>, <span class="st">&quot;K7lWdNUhCbcnEvI0NhGewg&quot;</span>, granularity<span class="op">=</span><span class="st">&quot;years&quot;</span>)</code></pre></div>
<p><strong>Hint:</strong> Use <code>plt.show</code> to decide when to show your complete plot and start anew.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_4kmhcne8">Click here for video</a></p>
<p><strong>Note:</strong> It is sufficient to just load the first of these three examples, when you Knit your project (to save time during Knitting).</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-indexing">pandas indexing</a>, <a href="python.html#p-writing-functions">functions</a>, <a href="python.html#p-matplotlib-lineplot">matplotlib lineplot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="after-some-thought-your-boss-decided-that-using-the-function-from-question-5-would-get-pretty-tedious-when-there-are-a-lot-of-businesses-to-include-in-the-plot.-you-disagree.-you-think-there-is-a-way-to-pass-a-list-of-business_ids-without-modifying-your-function-but-rather-how-you-pass-the-arguments-to-the-function.-demonstrate-how-to-do-this-with-the-list-provided" class="section level5">
<h5>6. After some thought, your boss decided that using the function from question (5) would get pretty tedious when there are a lot of businesses to include in the plot. You disagree. You think there is a way to pass a list of <code>business_id</code>s <em>without</em> modifying your function, but rather how you pass the arguments to the function. Demonstrate how to do this with the list provided:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">our_businesses <span class="op">=</span> [<span class="st">&quot;RESDUcs7fIiihp38-d6_6g&quot;</span>, <span class="st">&quot;4JNXUYY8wbaaDmk3BPzlWw&quot;</span>, <span class="st">&quot;K7lWdNUhCbcnEvI0NhGewg&quot;</span>]

<span class="co"># modify something below to make this work:</span>
visualize_stars_over_time(our_businesses, granularity<span class="op">=</span><span class="st">&quot;years&quot;</span>)</code></pre></div>
<p><strong>Hint:</strong> Google &quot;python packing unpacking arguments&quot;.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_9yu4s58t">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-indexing">pandas indexing</a>, <a href="python.html#p-writing-functions">functions</a>, <a href="python.html#p-matplotlib-lineplot">matplotlib lineplot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="p09-190" class="section level3">
<h3>Project 9</h3>
<hr />
<p><strong>Motivation:</strong> We've covered a lot of material in a very short amount of time. At this point in time, you have so many powerful tools at your disposal. Last semester in project 14 we used our new skills to build a beer recommendation system. It is pretty generous to call what we built a recommendation system. In the next couple of projects, we will use our Python skills to build a real beer recommendation system!</p>
<p><strong>Context:</strong> At this point in the semester we have a solid grasp on Python basics, and are looking to build our skills using the <code>pandas</code> and <code>numpy</code> packages to build a data-driven recommendation system for beers.</p>
<p><strong>Scope:</strong> python, pandas, numpy</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Distinguish the differences between numpy, pandas, DataFrames, Series, and ndarrays.
</li>
<li>
Use numpy, scipy, and pandas to solve a variety of data-driven problems.
</li>
<li>
Demonstrate the ability to read and write data of various formats using various packages.
</li>
<li>
View and access data inside DataFrames, Series, and ndarrays.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset-8" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/beer</code></p>
<p>Load the following datasets up and assume they are always available:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">beers <span class="op">=</span> pd.read_parquet(<span class="st">&quot;/class/datamine/data/beer/beers.parquet&quot;</span>)
breweries <span class="op">=</span> pd.read_parquet(<span class="st">&quot;/class/datamine/data/beer/breweries.parquet&quot;</span>)
reviews <span class="op">=</span> pd.read_parquet(<span class="st">&quot;/class/datamine/data/beer/reviews.parquet&quot;</span>)</code></pre></div>
</div>
<div id="questions-8" class="section level4">
<h4>Questions</h4>
<div id="write-a-function-called-prepare_data-that-accepts-an-argument-called-mydf-that-is-a-pandas-dataframe.-in-addition-prepare_data-should-accept-an-argument-called-min_num_reviews-that-is-an-integer-representing-the-minimum-amount-of-reviews-that-the-user-and-the-beer-must-have-to-be-included-in-the-data.-the-function-prepare_data-should-return-a-pandas-dataframe-with-the-following-properties" class="section level5">
<h5>1. Write a function called <code>prepare_data</code> that accepts an argument called <code>myDF</code> that is a <code>pandas</code> DataFrame. In addition, <code>prepare_data</code> should accept an argument called <code>min_num_reviews</code> that is an integer representing the minimum amount of reviews that the user and the beer must have, to be included in the data. The function <code>prepare_data</code> should return a <code>pandas</code> DataFrame with the following properties:</h5>
<p>First remove all rows where <code>score</code> or <code>username</code> or <code>beer_id</code> is missing, like this:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">    myDF <span class="op">=</span> myDF.loc[myDF.loc[:, <span class="st">&quot;score&quot;</span>].notna(), :]
    myDF <span class="op">=</span> myDF.loc[myDF.loc[:, <span class="st">&quot;username&quot;</span>].notna(), :]
    myDF <span class="op">=</span> myDF.loc[myDF.loc[:, <span class="st">&quot;beer_id&quot;</span>].notna(), :]
    myDF.reset_index(drop<span class="op">=</span><span class="va">True</span>)</code></pre></div>
<p>Among the remaining rows, choose the rows of <code>myDF</code> that have a user (<code>username</code>) and a <code>beer_id</code> that each occur at least <code>min_num_reviews</code> times in <code>myDF</code>.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">train <span class="op">=</span> prepare_data(reviews, <span class="dv">1000</span>)
<span class="bu">print</span>(train.shape) <span class="co"># (952105, 10)</span></code></pre></div>
<p><strong>Hint:</strong> We added two examples of how to do this with the election data (instead of the beer review data) in the book: <a href="python.html#p-cleaning-filtering-example">cleaning and filtering data</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_x6uoyxdh">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-indexing">indexing in pandas</a>, <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.isin.html?highlight=isin#pandas.Series.isin">isin</a>, <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.notna.html?highlight=notna#pandas.Series.notna">notna</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-29" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="kw">def</span> prepare_data(myDF, min_num_reviews):
    
    <span class="co"># remove rows where score is na</span>
    myDF <span class="op">=</span> myDF.loc[myDF.loc[:, <span class="st">&quot;score&quot;</span>].notna(), :]
    <span class="co"># get a list of usernames that have at least min_num_reviews</span>
    usernames <span class="op">=</span> myDF.loc[:, <span class="st">&quot;username&quot;</span>].value_counts() <span class="op">&gt;=</span> min_num_reviews
    usernames <span class="op">=</span> usernames.loc[usernames].index.values.tolist()
    <span class="co"># get a list of beer_ids that have at least min_num_reviews</span>
    beerids <span class="op">=</span> myDF.loc[:, <span class="st">&quot;beer_id&quot;</span>].value_counts() <span class="op">&gt;=</span> min_num_reviews
    beerids <span class="op">=</span> beerids.loc[beerids].index.values.tolist()
    <span class="co"># first remove all rows where the username has less than min_num_reviews</span>
    myDF <span class="op">=</span> myDF.loc[myDF.loc[:, <span class="st">&quot;username&quot;</span>].isin(usernames), :]
    
    <span class="co"># remove rows where the beer_id has less than min_num_reviews</span>
    myDF <span class="op">=</span> myDF.loc[myDF.loc[:, <span class="st">&quot;beer_id&quot;</span>].isin(beerids), :]
    
    <span class="cf">return</span> myDF
train <span class="op">=</span> prepare_data(reviews, <span class="dv">1000</span>)</code></pre></div>
</div>
<div id="run-the-function-in-question-1.-use-trainprepare_datareviews-1000.-the-basis-of-our-recommendation-system-will-be-to-match-a-user-to-another-user-will-similar-taste-in-beer.-different-users-will-have-different-means-and-variances-in-their-scores.-if-we-are-going-to-compare-users-scores-we-should-standardize-users-scores.-update-the-train-dataframe-with-1-additional-column-standardized_score.-to-calculate-the-standardized_score-take-each-individual-score-and-subtract-off-the-users-average-score-and-divide-that-result-by-the-users-scores-standard-deviation." class="section level5">
<h5>2. Run the function in question (1). Use <code>train=prepare_data(reviews, 1000)</code>. The basis of our recommendation system will be to &quot;match&quot; a user to another user will similar taste in beer. Different users will have different means and variances in their scores. If we are going to compare users' scores, we should <em>standardize</em> users' scores. Update the <code>train</code> DataFrame with 1 additional column: <code>standardized_score</code>. To calculate the <code>standardized_score</code>, take each individual score, and subtract off the user's average score and divide that result by the user's score's standard deviation.</h5>
</div>
<div id="in-r-we-have-the-following-code" class="section level5">
<h5>In R, we have the following code:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myDF &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">a=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">b=</span><span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>), <span class="dt">c=</span><span class="kw">c</span>(<span class="dv">9</span>,<span class="dv">9</span>,<span class="dv">9</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>))
myMean =<span class="st"> </span><span class="kw">tapply</span>(myDF<span class="op">$</span>b <span class="op">+</span><span class="st"> </span>myDF<span class="op">$</span>c, myDF<span class="op">$</span>a, mean)
myMeanDF =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">a=</span><span class="kw">as.numeric</span>(<span class="kw">names</span>(myMean)), <span class="dt">mean=</span>myMean)
myDF =<span class="st"> </span><span class="kw">merge</span>(myDF, myMeanDF, <span class="dt">by=</span><span class="st">&#39;a&#39;</span>)</code></pre></div>
</div>
<div id="or-you-could-also-use-a-very-handy-package-called-tidyverse-in-r-to-do-the-same-thing" class="section level5">
<h5>Or you could also use a <em>very</em> handy package called tidyverse in R to do the same thing:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
myDF &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">a=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">b=</span><span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>), <span class="dt">c=</span><span class="kw">c</span>(<span class="dv">9</span>,<span class="dv">9</span>,<span class="dv">9</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>))
myDF <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(a) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">d=</span><span class="kw">mean</span>(b<span class="op">+</span>c))</code></pre></div>
</div>
<div id="unfortunately-there-isnt-a-great-way-to-do-this-in-python" class="section level5">
<h5>Unfortunately, there isn't a <em>great</em> way to do this in Python:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> summer(data):
    data[<span class="st">&#39;d&#39;</span>] <span class="op">=</span> (data[<span class="st">&#39;b&#39;</span>]<span class="op">+</span>data[<span class="st">&#39;c&#39;</span>]).mean()
    <span class="cf">return</span> data

myDF <span class="op">=</span> myDF.groupby([<span class="st">&quot;a&quot;</span>]).<span class="bu">apply</span>(summer)</code></pre></div>
</div>
<div id="create-a-new-column-standardized_score.-calculate-the-standardized_score-by-taking-the-score-and-subtracting-the-average-score-then-divide-by-the-standard-deviation.-as-it-may-take-a-minute-or-two-to-create-this-new-column-feel-free-to-test-it-on-a-small-sample-of-the-reviews-dataframe" class="section level5">
<h5>Create a new column <code>standardized_score</code>. Calculate the <code>standardized_score</code> by taking the score and subtracting the average score, then divide by the standard deviation. As it may take a minute or two to create this new column, feel free to test it on a small sample of the reviews DataFrame:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> pandas <span class="im">as</span> pd
testDF <span class="op">=</span> pd.read_parquet(<span class="st">&#39;/class/datamine/data/beer/reviews_sample.parquet&#39;</span>)</code></pre></div>
<p><strong>Hint:</strong> Don't forget about the <code>pandas</code> DataFrame <code>std</code> and <code>mean</code> methods.</p>
<p><strong>Note:</strong> If you are worried about getting <code>NA</code>s, do not worry. The only way we would get <code>NA</code>s would be if there is only a single review for the user (which we took care of by limiting to users with at least 1000 reviews), or if there is no variance in a user's scores (which doesn't happen).</p>
<p><strong>Note:</strong> We added an example about how to do this with the election data in the book: <a href="python.html#p-standardization-example">standardizing data example</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_dcqycw5g">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-groupby">groupby</a>, <a href="python.html#p-writing-functions">functions</a>, <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.mean.html?highlight=mean#pandas.Series.mean">mean</a>, <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.std.html?highlight=std">std</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-30" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="kw">def</span> mutate_std_score(data: pd.DataFrame) <span class="op">-&gt;</span> pd.DataFrame:
    <span class="co">&quot;&quot;&quot;</span>
<span class="co">    mutate_std_score is a function to use in conjunction with </span>
<span class="co">    pd.apply and pd.groupby to create a new column that is </span>
<span class="co">    the standardized score.</span>
<span class="co">    Args:</span>
<span class="co">        data (pd.DataFrame): A pandas DataFrame.</span>
<span class="co">    Returns:</span>
<span class="co">        pd.DataFrame: A modified pandas DataFrame.</span>
<span class="co">    &quot;&quot;&quot;</span>
    data[<span class="st">&#39;standardized_score&#39;</span>] <span class="op">=</span> (data[<span class="st">&#39;score&#39;</span>] <span class="op">-</span> data[<span class="st">&#39;score&#39;</span>].mean())<span class="op">/</span>data[<span class="st">&#39;score&#39;</span>].std()
    <span class="cf">return</span> data
train <span class="op">=</span> train.groupby([<span class="st">&quot;username&quot;</span>]).<span class="bu">apply</span>(mutate_std_score)</code></pre></div>
</div>
<div id="use-the-pivot_table-method-from-pandas-to-put-your-train-data-into-wide-format.-what-this-means-is-that-each-row-in-the-new-dataframe-will-be-a-username-and-each-column-will-be-a-beer_id.-each-cell-will-contain-the-standardized_score-for-the-given-username-and-beer-combination.-call-the-resulting-dataframe-score_matrix." class="section level5">
<h5>3. Use the <code>pivot_table</code> method from <code>pandas</code> to put your <code>train</code> data into &quot;wide&quot; format. What this means is that each row in the new DataFrame will be a <code>username</code>, and each column will be a <code>beer_id</code>. Each cell will contain the <code>standardized_score</code> for the given <code>username</code> and <code>beer</code> combination. Call the resulting DataFrame <code>score_matrix</code>.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_46s7cp33">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-pivot">pivot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output the <code>head</code> and <code>shape</code> of <code>score_matrix</code>.
</li>
</ul>
</div>
</div>
<div id="solution-31" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">score_matrix <span class="op">=</span> pd.pivot_table(train, values<span class="op">=</span><span class="st">&#39;standardized_score&#39;</span>, index<span class="op">=</span><span class="st">&#39;username&#39;</span>, columns<span class="op">=</span><span class="st">&#39;beer_id&#39;</span>)
<span class="bu">print</span>(score_matrix.shape)
score_matrix.head()</code></pre></div>
</div>
<div id="the-result-from-question-3-should-be-a-sparse-matrix-lots-of-missing-data.-lets-fill-in-the-missing-data.-for-now-lets-fill-in-a-beer_ids-missing-data-by-filling-in-every-missing-value-with-the-average-score-for-the-beer." class="section level5">
<h5>4. The result from question (3) should be a sparse matrix (lots of missing data!). Let's fill in the missing data. For now, let's fill in a beer_id's missing data by filling in every missing value with the average score for the beer.</h5>
<p><strong>Hint:</strong> The <code>fillna</code> method in <code>pandas</code> will be very helpful!</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_71spdi11">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.fillna.html?highlight=fillna">fillna</a>, <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.mean.html?highlight=mean#pandas.DataFrame.mean">mean</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output the <code>head</code> of <code>score_matrix</code>.
</li>
</ul>
</div>
</div>
<div id="solution-32" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">score_matrix <span class="op">=</span> score_matrix.fillna(score_matrix.mean(axis<span class="op">=</span><span class="dv">0</span>))
score_matrix.head()</code></pre></div>
</div>
<div id="congratulations-next-week-we-will-complete-our-recommendation-system" class="section level5">
<h5>Congratulations! Next week, we will complete our recommendation system!</h5>
<hr />
</div>
</div>
</div>
<div id="p10-190" class="section level3">
<h3>Project 10</h3>
<hr />
<p><strong>Motivation:</strong> We've covered a lot of material in a very short amount of time. At this point in time, you have so many powerful tools at your disposal. Last semester in project 14 we used our new skills to build a beer recommendation system. It is pretty generous to call what we built a recommendation system. In the next couple of projects, we will use our Python skills to build a real beer recommendation system!</p>
<p><strong>Context:</strong> This is the third project in a series of projects designed to learn about the <code>pandas</code> and <code>numpy</code> packages. In this project we build on to our previous project to finalize our beer recommendation system.</p>
<p><strong>Scope:</strong> python, numpy, pandas</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Distinguish the differences between numpy, pandas, DataFrames, Series, and ndarrays.
</li>
<li>
Use numpy, scipy, and pandas to solve a variety of data-driven problems.
</li>
<li>
Demonstrate the ability to read and write data of various formats using various packages.
</li>
<li>
View and access data inside DataFrames, Series, and ndarrays.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset-9" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/beer</code></p>
<p>Load the following datasets up and assume they are always available:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">beers <span class="op">=</span> pd.read_parquet(<span class="st">&quot;/class/datamine/data/beer/beers.parquet&quot;</span>)
breweries <span class="op">=</span> pd.read_parquet(<span class="st">&quot;/class/datamine/data/beer/breweries.parquet&quot;</span>)
reviews <span class="op">=</span> pd.read_parquet(<span class="st">&quot;/class/datamine/data/beer/reviews.parquet&quot;</span>)</code></pre></div>
<p>Previous project code:</p>
<div id="solution-33" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="kw">def</span> prepare_data(myDF, min_num_reviews):
    
    <span class="co"># remove rows where score is na</span>
    myDF <span class="op">=</span> myDF.loc[myDF.loc[:, <span class="st">&quot;score&quot;</span>].notna(), :]
    <span class="co"># get a list of usernames that have at least min_num_reviews</span>
    usernames <span class="op">=</span> myDF.loc[:, <span class="st">&quot;username&quot;</span>].value_counts() <span class="op">&gt;=</span> min_num_reviews
    usernames <span class="op">=</span> usernames.loc[usernames].index.values.tolist()
    <span class="co"># get a list of beer_ids that have at least min_num_reviews</span>
    beerids <span class="op">=</span> myDF.loc[:, <span class="st">&quot;beer_id&quot;</span>].value_counts() <span class="op">&gt;=</span> min_num_reviews
    beerids <span class="op">=</span> beerids.loc[beerids].index.values.tolist()
    <span class="co"># first remove all rows where the username has less than min_num_reviews</span>
    myDF <span class="op">=</span> myDF.loc[myDF.loc[:, <span class="st">&quot;username&quot;</span>].isin(usernames), :]
    
    <span class="co"># remove rows where the beer_id has less than min_num_reviews</span>
    myDF <span class="op">=</span> myDF.loc[myDF.loc[:, <span class="st">&quot;beer_id&quot;</span>].isin(beerids), :]
    
    <span class="cf">return</span> myDF
train <span class="op">=</span> prepare_data(reviews, <span class="dv">1000</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="kw">def</span> mutate_std_score(data: pd.DataFrame) <span class="op">-&gt;</span> pd.DataFrame:
    <span class="co">&quot;&quot;&quot;</span>
<span class="co">    mutate_std_score is a function to use in conjunction with </span>
<span class="co">    pd.apply and pd.groupby to create a new column that is </span>
<span class="co">    the standardized score.</span>
<span class="co">    Args:</span>
<span class="co">        data (pd.DataFrame): A pandas DataFrame.</span>
<span class="co">    Returns:</span>
<span class="co">        pd.DataFrame: A modified pandas DataFrame.</span>
<span class="co">    &quot;&quot;&quot;</span>
    data[<span class="st">&#39;standardized_score&#39;</span>] <span class="op">=</span> (data[<span class="st">&#39;score&#39;</span>] <span class="op">-</span> data[<span class="st">&#39;score&#39;</span>].mean())<span class="op">/</span>data[<span class="st">&#39;score&#39;</span>].std()
    <span class="cf">return</span> data
train <span class="op">=</span> train.groupby([<span class="st">&quot;username&quot;</span>]).<span class="bu">apply</span>(mutate_std_score)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">score_matrix <span class="op">=</span> pd.pivot_table(train, values<span class="op">=</span><span class="st">&#39;standardized_score&#39;</span>, index<span class="op">=</span><span class="st">&#39;username&#39;</span>, columns<span class="op">=</span><span class="st">&#39;beer_id&#39;</span>)
<span class="bu">print</span>(score_matrix.shape)
score_matrix.head()</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">score_matrix <span class="op">=</span> score_matrix.fillna(score_matrix.mean(axis<span class="op">=</span><span class="dv">0</span>))
score_matrix.head()</code></pre></div>
</div>
</div>
<div id="questions-9" class="section level4">
<h4>Questions</h4>
<div id="if-you-struggled-or-did-not-do-the-previous-project-or-would-like-to-start-fresh-please-see-the-solutions-to-the-previous-project-will-be-posted-saturday-morning-and-feel-free-to-use-them-as-your-own.-cosine-similarity-is-a-measure-of-similarity-between-two-non-zero-vectors.-it-is-used-in-a-variety-of-ways-in-data-science.-here-is-a-pretty-good-article-that-tries-to-give-some-intuition-into-it.-sklearn-provides-us-with-a-function-that-calculates-cosine-similarity" class="section level5">
<h5>1. If you struggled or did not do the previous project, or would like to start fresh, please see the solutions to the previous project (will be posted Saturday morning) and feel free to use them as your own. Cosine similarity is a measure of similarity between two non-zero vectors. It is used in a variety of ways in data science. <a href="https://towardsdatascience.com/understanding-cosine-similarity-and-its-application-fd42f585296a">Here</a> is a pretty good article that tries to give some intuition into it. <code>sklearn</code> provides us with a function that calculates cosine similarity:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> sklearn.metrics.pairwise <span class="im">import</span> cosine_similarity</code></pre></div>
</div>
<div id="use-the-cosine_similarity-function-on-our-score_matrix.-the-result-will-be-a-numpy-array.-use-the-fill_diagonal-method-from-numpy-to-fill-the-diagonals-with-0.-convert-the-array-back-to-a-pandas-dataframe.-make-sure-to-manually-assign-the-indexes-of-the-new-dataframe-to-be-equal-to-score_matrix.index.-lastly-manually-assign-the-columns-to-be-score_matrix.index-as-well.-the-end-result-should-be-a-matrix-with-usernames-on-both-the-x-and-y-axes.-each-value-in-the-cell-represents-how-close-one-user-is-to-another.-normally-the-values-in-the-diagonals-would-be-1-because-the-same-user-is-100-similar.-to-prevent-this-we-forced-the-diagonals-to-be-0.-name-the-final-result-cosine_similarity_matrix." class="section level5">
<h5>Use the <code>cosine_similarity</code> function on our <code>score_matrix</code>. The result will be a <code>numpy</code> array. Use the <code>fill_diagonal</code> method from <code>numpy</code> to fill the diagonals with 0. Convert the array back to a <code>pandas</code> DataFrame. Make sure to manually assign the indexes of the new DataFrame to be equal to <code>score_matrix.index</code>. Lastly, manually assign the columns to be <code>score_matrix.index</code> as well. The end result should be a matrix with usernames on both the x and y axes. Each value in the cell represents how &quot;close&quot; one user is to another. Normally the values in the diagonals would be 1 because the same user is 100% similar. To prevent this we forced the diagonals to be 0. Name the final result <code>cosine_similarity_matrix</code>.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_tfxmdz61">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="https://numpy.org/doc/stable/reference/generated/numpy.fill_diagonal.html">fill diagonal</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
<code>head</code> of <code>cosine_similarity_matrix</code>.
</li>
</ul>
</div>
</div>
<div id="write-a-function-called-get_knn-that-accepts-the-cosine_similarity_matrix-a-username-and-a-value-k.-the-function-get_knn-should-return-a-pandas-series-or-list-containing-the-usernames-of-the-k-most-similar-users-to-the-input-username." class="section level5">
<h5>2. Write a function called <code>get_knn</code> that accepts the <code>cosine_similarity_matrix</code>, a <code>username</code>, and a value, <code>k</code>. The function <code>get_knn</code> should return a <code>pandas</code> Series or list containing the usernames of the <code>k</code> most similar users to the input <code>username</code>.</h5>
<p><strong>Hint:</strong> This may <em>sound</em> difficult, but it is not. It really only involves sorting some values and grabbing the first <code>k</code>.</p>
</div>
<div id="test-it-on-the-following-we-demonstrate-the-output-if-you-return-a-list" class="section level5">
<h5>Test it on the following; we demonstrate the output if you return a list:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">k_similar<span class="op">=</span>get_knn(cosine_similarity_matrix,<span class="st">&quot;2GOOFY&quot;</span>,<span class="dv">4</span>)
<span class="bu">print</span>(k_similar) <span class="co"># [&#39;Phil-Fresh&#39;, &#39;mishi_d&#39;, &#39;SlightlyGrey&#39;, &#39;MI_beerdrinker&#39;]</span></code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_pbpamhwn">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-functions">writing functions</a>, <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sort_values.html">sort values</a>, <a href="python.html#p-pandas-indexing">indexing</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="lets-test-get_knn-to-see-if-the-results-make-sense.-pick-out-a-user-and-the-most-similar-other-user.-first-get-a-dataframe-lets-call-it-aux-containing-just-their-reviews.-the-result-should-be-a-dataframe-that-looks-just-like-the-reviews-dataframe-but-just-contains-your-users-reviews." class="section level5">
<h5>3. Let's test <code>get_knn</code> to see if the results make sense. Pick out a user, and the most similar other user. First, get a DataFrame (let's call it <code>aux</code>) containing just their reviews. The result should be a DataFrame that looks just like the <code>reviews</code> DataFrame, but just contains your users' reviews.</h5>
</div>
<div id="next-look-at-aux.-wouldnt-it-be-nice-to-get-a-dataframe-where-the-beer_id-is-the-row-index-the-first-column-contains-the-scores-for-the-first-user-and-the-second-column-contains-the-scores-for-the-second-user-use-the-pivot_table-method-to-accomplish-this-and-save-the-result-as-aux." class="section level5">
<h5>Next, look at <code>aux</code>. Wouldn't it be nice to get a DataFrame where the <code>beer_id</code> is the row index, the first column contains the scores for the first user, and the second column contains the scores for the second user? Use the <code>pivot_table</code> method to accomplish this, and save the result as <code>aux</code>.</h5>
</div>
<div id="lastly-use-the-dropna-method-to-remove-all-rows-where-at-least-one-of-the-users-has-an-na-value.-sort-the-values-in-aux-using-the-sort_values-method.-take-a-look-at-the-result-and-write-1-2-sentences-explaining-whether-or-not-you-think-the-users-rated-the-beers-similarly." class="section level5">
<h5>Lastly, use the <code>dropna</code> method to remove all rows where at least one of the users has an <code>NA</code> value. Sort the values in <code>aux</code> using the <code>sort_values</code> method. Take a look at the result and write 1-2 sentences explaining whether or not you think the users rated the beers similarly.</h5>
<p><strong>Hint:</strong> You could also create a scatter plot using the resulting DataFrame. If it is a good match the plot should look like a positive sloping line.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_ee8u3ti5">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sort_values.html">sort values</a>, <a href="python.html#p-pandas-indexing">indexing</a>, <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.pivot_table.html?highlight=pivot_table#pandas.DataFrame.pivot_table">pivot_table</a>, <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.isin.html?highlight=isin#pandas.Series.isin">isin</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
1-2 sentences explaining whether or not you think the users rated the beers similarly.
</li>
</ul>
</div>
</div>
<div id="we-are-so-close-and-things-are-looking-good-the-next-step-for-our-system-is-to-write-a-function-that-finds-recommendations-for-a-given-user.-write-a-function-called-recommend_beers-that-accepts-three-arguments-the-train-dataframe-a-username-a-cosine_similarity_matrix-and-k-how-many-neighbors-to-use.-the-function-recommend_beers-should-return-the-top-5-recommendations." class="section level5">
<h5>4. We are so close, and things are looking good! The next step for our system, is to write a function that finds recommendations for a given user. Write a function called <code>recommend_beers</code>, that accepts three arguments: the <code>train</code> DataFrame, a <code>username</code>, a <code>cosine_similarity_matrix</code>, and <code>k</code> (how many neighbors to use). The function <code>recommend_beers</code> should return the top 5 recommendations.</h5>
</div>
<div id="calculate-the-recommendations-by" class="section level5">
<h5>Calculate the recommendations by:</h5>
<ol style="list-style-type: decimal">
<li>Finding the <code>k</code> nearest neighbors of the input <code>username</code>.</li>
<li>Get a DataFrame with all of the reviews from <code>train</code> for every neighbor. Let's call this <code>aux</code>.</li>
<li>Get a list of all <code>beer_id</code>s that the user with <code>username</code> has reviewed.</li>
<li>Remove all beers from <code>aux</code> that have already been reviewed by the user with <code>username</code>.</li>
<li>Group by <code>beer_id</code> and calculate the mean <code>standardized_score</code>.</li>
<li>Sort the results in descending order, and return the top 5 <code>beer_id</code>s.</li>
</ol>
</div>
<div id="test-it-on-the-following" class="section level5">
<h5>Test it on the following:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">recommend_beers(train, <span class="st">&quot;22Blue&quot;</span>, cosine_similarity_matrix, <span class="dv">30</span>) <span class="co"># [40057, 69522, 22172, 59672, 86487]</span></code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_7cpn21th">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-functions">writing functions</a>, <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sort_values.html">sort values</a>, <a href="python.html#p-pandas-indexing">indexing</a>, <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.isin.html?highlight=isin#pandas.Series.isin">isin</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="optional-0-pts-improve-our-recommendation-system-below-are-some-suggestions-dont-feel-limited-by-them" class="section level5">
<h5>5. (optional, 0 pts) Improve our recommendation system! Below are some suggestions, don't feel limited by them:</h5>
<ul>
<li>Instead of returning a list of <code>beer_id</code>s, return the beer info from the <code>beers</code> dataset.</li>
<li>Remove all retired beers.</li>
<li>Somehow add a cool plot.</li>
<li>Etc.</li>
</ul>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-functions">writing functions</a>, <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sort_values.html">sort values</a>, <a href="python.html#p-pandas-indexing">indexing</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="p11-190" class="section level3">
<h3>Project 11</h3>
<hr />
<p><strong>Motivation:</strong> We've had a pretty intense series of projects recently, and, although you may not have digested everything fully, you <em>may</em> be surprised at how far you've come! What better way to realize this but to take a look at some familiar questions that you've solved in the past in R, and solve them in Python instead? You will (a) have the solutions in R to be able to compare and contrast what you come up with in Python, and (b) be able to fill in any gaps you find you have along the way.</p>
<p><strong>Context:</strong> We've just finished a two project series where we built a beer recommendation system using Python. In this project, we are going to take a (hopefully restful) step back and tackle some familiar data wrangling tasks, but in Python instead of R.</p>
<p><strong>Scope:</strong> python, r</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Use numpy, scipy, and pandas to solve a variety of data-driven problems.
</li>
<li>
Demonstrate the ability to read and write data of various formats using various packages.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset-10" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/fars</code></p>
</div>
<div id="questions-10" class="section level4">
<h4>Questions</h4>
<div id="the-fars-dataset-contains-a-series-of-folders-labeled-by-year.-in-each-year-folder-there-is-at-least-the-files-accident.csv-person.csv-and-vehicle.csv.-if-you-take-a-peek-at-any-accident.csv-file-in-any-year-youll-notice-that-the-column-year-only-contains-the-last-two-digits-of-the-year.-add-a-new-year-column-that-contains-the-full-year.-use-the-pd.concat-function-to-create-a-dataframe-called-accidents-that-combines-the-accident.csv-files-from-the-years-1975-through-1981-inclusive-into-one-big-dataset.-after-or-before-creating-that-accidents-dataframe-change-the-values-in-the-year-column-from-two-digits-to-four-digits-i.e.-paste-a-19-onto-each-year-value." class="section level5">
<h5>1. The <code>fars</code> dataset contains a series of folders labeled by year. In each year folder there is (at least) the files <code>ACCIDENT.CSV</code>, <code>PERSON.CSV</code>, and <code>VEHICLE.CSV</code>. If you take a peek at any <code>ACCIDENT.CSV</code> file in any year, you'll notice that the column <code>YEAR</code> only contains the last two digits of the year. Add a new <code>YEAR</code> column that contains the full year. Use the <code>pd.concat</code> function to create a DataFrame called <code>accidents</code> that combines the <code>ACCIDENT.CSV</code> files from the years 1975 through 1981 (inclusive) into one big dataset. After (or before) creating that <code>accidents</code> DataFrame, change the values in the <code>YEAR</code> column from two digits to four digits (i.e., paste a 19 onto each year value).</h5>
<p><strong>Hint:</strong> One way to append strings to every value in a column is to first convert the column to <code>str</code> using <code>astype</code> and then use the <code>+</code> operator, like normal:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">myDF[<span class="st">&quot;myCol&quot;</span>].astype(<span class="bu">str</span>) <span class="op">+</span> <span class="st">&quot;appending_this_string&quot;</span></code></pre></div>
<p><strong>Relevant topics:</strong> <a href="https://pandas.pydata.org/docs/reference/api/pandas.concat.html?highlight=concat">pandas concat</a>, <a href="python.html#p-for-loops">loops</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
<code>head</code> of the <code>accidents</code> dataframe.
</li>
</ul>
</div>
</div>
<div id="using-the-new-accidents-data-frame-that-you-created-in-1-how-many-accidents-are-there-in-which-1-or-more-drunk-drivers-were-involved-in-an-accident-with-a-school-bus" class="section level5">
<h5>2. Using the new <code>accidents</code> data frame that you created in (1), how many accidents are there in which 1 or more drunk drivers were involved in an accident with a school bus?</h5>
<p><strong>Hint:</strong> Look at the variables <code>DRUNK_DR</code> and <code>SCH_BUS</code>.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-indexing">pandas indexing</a>, <a href="python.html#p-pandas-shape-attribute">pandas shape attribute</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="again-using-the-accidents-data-frame-for-accidents-involving-1-or-more-drunk-drivers-and-a-school-bus-how-many-happened-in-each-of-the-7-years-which-year-had-the-largest-number-of-these-types-of-accidents" class="section level5">
<h5>3. Again using the <code>accidents</code> data frame: For accidents involving 1 or more drunk drivers and a school bus, how many happened in each of the 7 years? Which year had the largest number of these types of accidents?</h5>
<p><strong>Important note:</strong> Does the <code>groupby</code> method seem familiar to you? It should! It is extremely similar to <code>tapply</code> in R. Typically functions that behave like <code>tapply</code> are called something like &quot;groupby&quot; -- R is the oddball this time.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-indexing">pandas indexing</a>, <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.idxmax.html">pandas idxmax</a>, <a href="python.html#p-pandas-groupby">pandas groupby</a>, <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.count.html">pandas count</a>, <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.reset_index.html?highlight=reset_index">pandas reset_index</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="again-using-the-accidents-data-frame-calculate-the-mean-number-of-motorists-involved-in-an-accident-column-persons-with-i-drunk-drivers-column-drunk_dr-where-i-takes-the-values-from-0-through-6." class="section level5">
<h5>4. Again using the <code>accidents</code> data frame: Calculate the mean number of motorists involved in an accident (column <code>PERSONS</code>) with <code>i</code> drunk drivers (column <code>DRUNK_DR</code>), where <code>i</code> takes the values from 0 through 6.</h5>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas-groupby">pandas groupby</a>, <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.mean.html">pandas mean</a>, <a href="python.html#p-pandas-indexing">pandas indexing</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="break-the-day-into-portions-as-follows-midnight-to-6am-6am-to-12-noon-12-noon-to-6pm-6pm-to-midnight-other.-find-the-total-number-of-fatalities-that-occur-during-each-of-these-time-intervals.-also-find-the-average-number-of-fatalities-per-crash-that-occurs-during-each-of-these-time-intervals." class="section level5">
<h5>5. Break the day into portions, as follows: midnight to 6AM, 6AM to 12 noon, 12 noon to 6PM, 6PM to midnight, other. Find the total number of fatalities that occur during each of these time intervals. Also, find the average number of fatalities per crash that occurs during each of these time intervals.</h5>
<p><strong>Hint:</strong> You'll want to pay special attention to the <code>include_lowest</code> option of <code>pandas.cut</code> (similarly to R's <code>cut</code>).</p>
<p><strong>Relevant topics:</strong> <a href="https://pandas.pydata.org/docs/reference/api/pandas.cut.html">pandas cut</a>, <a href="python.html#p-pandas-groupby">pandas groupby</a>, <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sum.html">pandas sum</a>, <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.mean.html">pandas mean</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="p12-190" class="section level3">
<h3>Project 12</h3>
<hr />
<p><strong>Motivation:</strong> We’d be remiss spending almost an entire semester solving data driven problems in python without covering the basics of classes. Whether or not you will ever choose to use this feature in your work, it is best to at least understand some of the basics so you can navigate libraries and other code that does use it.</p>
<p><strong>Context:</strong> We’ve spent nearly the entire semester solving data driven problems in python, and now we are going to learn about one of the primary features in python: classes. Python is an object oriented programming language, and as such, much of python, and the libraries you use in python are objects which have properties and methods. In this project we will explore some of the terminology and syntax relating to classes.</p>
<p><strong>Scope:</strong> python</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Explain the basics of object oriented programming, and what a class is.
</li>
<li>
Use classes to solve a data-driven problem.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset-11" class="section level4">
<h4>Dataset</h4>
<p>In this project, and the next, we will learn about classes by simulating a simplified version of Blackjack! Don't worry, while this may sound intimidating, there is very little coding involved, and much of the code will be provided to you to use!</p>
</div>
<div id="questions-11" class="section level4">
<h4>Questions</h4>
<div id="create-a-card-class-with-a-number-and-a-suit.-the-number-should-be-any-number-between-2-10-or-any-of-a-j-q-k-or-a-for-jack-queen-king-or-ace.-the-suit-should-be-any-of-clubs-hearts-spades-or-diamonds.-you-should-initialize-a-card-by-first-providing-the-number-then-the-suit.-make-sure-that-any-provided-number-is-one-of-our-valid-values-if-it-isnt-throw-an-exception-that-is-stop-the-function-and-return-a-message" class="section level5">
<h5>1. Create a <code>Card</code> class with a <code>number</code> and a <code>suit</code>. The <code>number</code> should be any number between 2-10 or any of a 'J', 'Q', 'K', or 'A' (for Jack, Queen, King, or Ace). The <code>suit</code> should be any of: &quot;Clubs&quot;, &quot;Hearts&quot;, &quot;Spades&quot;, or &quot;Diamonds&quot;. You should initialize a <code>Card</code> by first providing the <code>number</code> then the <code>suit</code>. Make sure that any provided <code>number</code> is one of our valid values, if it isn't, throw an exception (that is, stop the function and return a message):</h5>
</div>
<div id="here-are-some-examples-to-test" class="section level5">
<h5>Here are some examples to test:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">my_card <span class="op">=</span> Card(<span class="dv">11</span>, <span class="st">&quot;Hearts&quot;</span>) <span class="co"># Exception: Number wasn&#39;t 2-10 or J, Q, K, or A.</span>
my_card <span class="op">=</span> Card(<span class="dv">10</span>, <span class="st">&quot;Stars&quot;</span>) <span class="co"># Suit wasn&#39;t one of: clubs, hearts, spades, or diamonds.</span>
my_card <span class="op">=</span> Card(<span class="st">&quot;10&quot;</span>, <span class="st">&quot;Spades&quot;</span>)
my_card <span class="op">=</span> Card(<span class="st">&quot;2&quot;</span>, <span class="st">&quot;clubs&quot;</span>)
my_card <span class="op">=</span> Card(<span class="st">&quot;2&quot;</span>, <span class="st">&quot;club&quot;</span>) <span class="co"># Suit wasn&#39;t one of: clubs, hearts, spades, or diamonds.</span></code></pre></div>
<p><strong>Hint:</strong> To raise an exception, you can do:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">raise</span> <span class="pp">Exception</span>(<span class="st">&quot;Suit wasn&#39;t one of: clubs, hearts, spades, or diamonds.&quot;</span>)</code></pre></div>
<p><strong>Hint:</strong> Here is some starter code to fill in:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">class</span> Card:
    _value_dict <span class="op">=</span> {<span class="st">&quot;2&quot;</span>: <span class="dv">2</span>, <span class="st">&quot;3&quot;</span>: <span class="dv">3</span>, <span class="st">&quot;4&quot;</span>: <span class="dv">4</span>, <span class="st">&quot;5&quot;</span>: <span class="dv">5</span>, <span class="st">&quot;6&quot;</span>: <span class="dv">6</span>, <span class="st">&quot;7&quot;</span>: <span class="dv">7</span>, <span class="st">&quot;8&quot;</span>:<span class="dv">8</span>, <span class="st">&quot;9&quot;</span>:<span class="dv">9</span>, <span class="st">&quot;10&quot;</span>: <span class="dv">10</span>, <span class="st">&quot;j&quot;</span>: <span class="dv">11</span>, <span class="st">&quot;q&quot;</span>: <span class="dv">12</span>, <span class="st">&quot;k&quot;</span>: <span class="dv">13</span>, <span class="st">&quot;a&quot;</span>: <span class="dv">14</span>}
    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, number, suit):
        <span class="co"># if number is not a valid 2-10 or j, q, k, or a</span>
        <span class="co"># raise Exception</span>
        
        <span class="co"># else set the value for self.number to str(self.number)</span>

        <span class="co"># if the suit.lower() isn&#39;t a valid suit: clubs hearts diamonds spades</span>
        <span class="co"># raise Exception</span>
        
        <span class="co"># else, set the value for self.suit to suit.lower()</span></code></pre></div>
<p><strong>Important note:</strong> Accept both upper and lowercase variants for both <code>suit</code> and <code>number</code>. To do this, convert any input to lowercase prior to processing/saving. For <code>number</code>, you can do <code>str(num).lower()</code>.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-classes">classes</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="usually-when-we-talk-about-a-particular-card-we-say-it-is-a-four-of-spades-or-king-of-hearts-etc.-right-now-if-you-printmy_card-you-will-get-something-like-__main__.card-object-at-0x7fccd0523208.-not-very-useful.-we-have-a-dunder-method-for-that" class="section level5">
<h5>2. Usually when we talk about a particular card, we say it is a &quot;Four of Spades&quot; or &quot;King of Hearts&quot;, etc. Right now, if you <code>print(my_card)</code> you will get something like <code>&lt;__main__.Card object at 0x7fccd0523208&gt;</code>. Not very useful. We have a <a href="https://docs.python.org/3/reference/datamodel.html?highlight=__str__#object.__str__">dunder method</a> for that!</h5>
</div>
<div id="implement-the-__str__-dunder-method-to-work-like-this" class="section level5">
<h5>Implement the <code>__str__</code> dunder method to work like this:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(Card(<span class="st">&quot;10&quot;</span>, <span class="st">&quot;Spades&quot;</span>)) <span class="co"># 10 of spades</span>
<span class="bu">print</span>(Card(<span class="st">&quot;2&quot;</span>, <span class="st">&quot;clubs&quot;</span>)) <span class="co"># 2 of clubs</span></code></pre></div>
</div>
<div id="another-closely-related-dunder-method-is-called-__repr__----short-for-representation.-this-is-similar-to-__str__-in-that-it-should-print-the-code-used-to-create-the-object-being-printed.-so-for-our-examples" class="section level5">
<h5>Another, closely related dunder method is called <a href="https://docs.python.org/3/reference/datamodel.html?highlight=__str__#object.__repr__"><code>__repr__</code></a> -- short for representation. This is similar to <code>__str__</code> in that it should print the code used to create the object being printed. So for our examples:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">repr</span>(Card(<span class="st">&quot;10&quot;</span>, <span class="st">&quot;Spades&quot;</span>)) <span class="co"># Card(str(10), &quot;spades&quot;)</span>
<span class="bu">repr</span>(Card(<span class="st">&quot;2&quot;</span>, <span class="st">&quot;clubs&quot;</span>)) <span class="co"># Card(str(2), &quot;clubs&quot;)</span></code></pre></div>
</div>
<div id="implement-both-dunder-methods-to-function-as-exemplified." class="section level5">
<h5>Implement both dunder methods to function as exemplified.</h5>
<p><strong>Hint:</strong> <a href="https://medium.com/python-features/magic-methods-demystified-3c9e93144bf7">This</a> article has examples of both <code>__str__</code> and <code>__repr__</code>.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-classes">classes</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="it-is-natural-that-we-should-be-able-to-compare-cards-after-all-thats-necessary-to-play-nearly-any-game.-typically-there-are-two-ways-to-sort-cards.-ace-high-or-ace-low.-ace-high-is-when-the-ace-represents-the-highest-card." class="section level5">
<h5>3. It is natural that we should be able to compare cards, after all thats necessary to play nearly any game. Typically there are two ways to &quot;sort&quot; cards. Ace high, or ace low. Ace high is when the Ace represents the highest card.</h5>
</div>
<div id="implement-the-following-dunder-methods-to-enable-comparison-of-cards-where-ace-is-high" class="section level5">
<h5>Implement the <a href="https://docs.python.org/3/reference/datamodel.html?highlight=__str__#object.__lt__">following</a> dunder methods to enable comparison of cards where ace is high:</h5>
<ul>
<li><code>__eq__</code></li>
<li><code>__lt__</code></li>
<li><code>__gt__</code></li>
</ul>
</div>
<div id="make-sure-the-following-examples-work" class="section level5">
<h5>Make sure the following examples work:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">card1 <span class="op">=</span> Card(<span class="dv">2</span>, <span class="st">&quot;spades&quot;</span>)
card2 <span class="op">=</span> Card(<span class="dv">3</span>, <span class="st">&quot;hearts&quot;</span>)
card3 <span class="op">=</span> Card(<span class="dv">3</span>, <span class="st">&quot;diamonds&quot;</span>)
card4 <span class="op">=</span> Card(<span class="dv">3</span>, <span class="st">&quot;Hearts&quot;</span>)
card5 <span class="op">=</span> Card(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;Spades&quot;</span>)
card6 <span class="op">=</span> Card(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;Hearts&quot;</span>)
card7 <span class="op">=</span> Card(<span class="st">&quot;K&quot;</span>, <span class="st">&quot;Diamonds&quot;</span>)

<span class="bu">print</span>(card1 <span class="op">&lt;</span> card2) <span class="co"># True</span>
<span class="bu">print</span>(card1 <span class="op">&lt;</span> card3) <span class="co"># True</span>
<span class="bu">print</span>(card2 <span class="op">==</span> card3) <span class="co"># True</span>
<span class="bu">print</span>(card2 <span class="op">==</span> card4) <span class="co"># True</span>
<span class="bu">print</span>(card3 <span class="op">&lt;</span> card4) <span class="co"># False</span>
<span class="bu">print</span>(card4 <span class="op">&lt;</span> card3) <span class="co"># False</span>
<span class="bu">print</span>(card5 <span class="op">&gt;</span> card4) <span class="co"># True</span>
<span class="bu">print</span>(card5 <span class="op">&gt;</span> card6) <span class="co"># False</span>
<span class="bu">print</span>(card5 <span class="op">==</span> card6) <span class="co"># True</span>
<span class="bu">print</span>(card7 <span class="op">&lt;</span> card5) <span class="co"># True</span>
<span class="bu">print</span>(card7 <span class="op">&gt;</span> card1) <span class="co"># True</span></code></pre></div>
<p><strong>Important note:</strong> Two cards are deemed equal if they have the same number, regardless of their suits.</p>
<p><strong>Hint:</strong> There are many ways to deal with comparing the &quot;JKQA&quot; against other numbers. One possibility is to have a dict that maps the value of the card to it's numeric value.</p>
<p><strong>Hint:</strong> <a href="https://www.tutorialspoint.com/How-to-implement-Python-lt-gt-custom-overloaded-operators">This</a> example shows a short example of how to implement these dunder methods.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-classes">classes</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="weve-provided-you-with-the-code-below" class="section level5">
<h5>4. We've provided you with the code below:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">class</span> Deck:
    _suits <span class="op">=</span> [<span class="st">&quot;clubs&quot;</span>, <span class="st">&quot;hearts&quot;</span>, <span class="st">&quot;diamonds&quot;</span>, <span class="st">&quot;spades&quot;</span>]
    _numbers <span class="op">=</span> [<span class="bu">str</span>(num) <span class="cf">for</span> num <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">11</span>)] <span class="op">+</span> <span class="bu">list</span>(<span class="st">&quot;jqka&quot;</span>)

    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):
        <span class="va">self</span>.cards <span class="op">=</span> [Card(number, suit) <span class="cf">for</span> suit <span class="kw">in</span> <span class="va">self</span>._suits <span class="cf">for</span> number <span class="kw">in</span> <span class="va">self</span>._numbers]</code></pre></div>
</div>
<div id="as-you-can-see-we-are-working-on-building-a-deck-class.-use-the-code-provided-and-create-an-instance-of-a-new-deck-called-lucky_deck.-print-the-cards-out-to-make-sure-it-looks-right.-make-sure-that-the-deck-has-the-correct-number-of-cards-print-the-len-of-the-deck.-what-happens-instead-of-trying-to-find-the-length-try-to-access-and-print-a-single-card-printlucky_deck10.-what-happens" class="section level5">
<h5>As you can see, we are working on building a <code>Deck</code> class. Use the code provided and create an instance of a new <code>Deck</code> called <code>lucky_deck</code>. Print the cards out to make sure it looks right. Make sure that the <code>Deck</code> has the correct number of cards, print the <code>len</code> of the <code>Deck</code>. What happens? Instead of trying to find the length, try to access and print a single card: <code>print(lucky_deck[10])</code>. What happens?</h5>
<p><strong>Relevant topics:</strong> <a href="python.html#p-classes">classes</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
1-2 sentences explaining what happens when you try doing what we ask.
</li>
</ul>
</div>
</div>
<div id="as-it-turns-out-we-can-fix-both-of-the-issues-we-ran-into-in-question-4.-to-fix-the-issue-with-len-implement-the-__len__-dunder-method.-does-it-work-now" class="section level5">
<h5>5. As it turns out, we can fix both of the issues we ran into in question (4). To fix the issue with <code>len</code>, implement the <a href="https://docs.python.org/3/reference/datamodel.html#object.__len__"><code>__len__</code></a> dunder method. Does it work now?</h5>
</div>
<div id="to-fix-the-indexing-issue-implement-the-__getitem__-dunder-method.-test-out-but-dont-forget-to-re-run-to-get-an-updated-lucky_deck" class="section level5">
<h5>To fix the indexing issue, implement the <a href="https://docs.python.org/3/reference/datamodel.html#object.__getitem__"><code>__getitem__</code></a> dunder method. Test out (but don't forget to re-run to get an updated <code>lucky_deck</code>):</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co"># make sure to re-create your Deck below this line</span>


<span class="co"># these should both work now</span>
<span class="bu">len</span>(lucky_deck) <span class="co"># 52</span>
<span class="bu">print</span>(lucky_deck[<span class="dv">10</span>]) <span class="co"># q of clubs </span></code></pre></div>
<p><strong>Hint:</strong> <a href="https://medium.com/python-features/magic-methods-demystified-3c9e93144bf7">This</a> article has examples of both <code>__len__</code> and <code>__getitem__</code>.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-classes">classes</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="p13-190" class="section level3">
<h3>Project 13</h3>
<hr />
<p><strong>Motivation:</strong> We’d be remiss spending almost an entire semester solving data driven problems in python without covering the basics of classes. Whether or not you will ever choose to use this feature in your work, it is best to at least understand some of the basics so you can navigate libraries and other code that does use it.</p>
<p><strong>Context:</strong> We’ve spent nearly the entire semester solving data driven problems in python, and now we are going to learn about one of the primary features in python: classes. Python is an object oriented programming language, and as such, much of python, and the libraries you use in python are objects which have properties and methods. In this project we will explore some of the terminology and syntax relating to classes.</p>
<p><strong>Scope:</strong> python</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Explain the basics of object oriented programming, and what a class is.
</li>
<li>
Use classes to solve a data-driven problem.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset-12" class="section level4">
<h4>Dataset</h4>
<p>This is the continuation of the previous project. In this project we will learn about classes by simulating a simplified version of Blackjack! Don't worry, while this may sound intimidating, there is very little coding involved, and much of the code will be provided to you to use!</p>
</div>
<div id="questions-12" class="section level4">
<h4>Questions</h4>
<div id="in-the-previous-project-we-built-a-deck-and-card-class.-what-is-one-other-very-common-task-that-people-do-with-decks-of-cards-shuffle-there-is-a-function-in-python-called-shuffle.-it-can-be-used-like" class="section level5">
<h5>1. In the previous project, we built a <code>Deck</code> and <code>Card</code> class. What is one other very common task that people do with decks of cards? Shuffle! There is a function in Python called <code>shuffle</code>. It can be used like:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> random <span class="im">import</span> shuffle

my_list <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]
<span class="bu">print</span>(my_list)</code></pre></div>
<pre><code>## [1, 2, 3]</code></pre>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">shuffle(my_list)
<span class="bu">print</span>(my_list)</code></pre></div>
<pre><code>## [2, 1, 3]</code></pre>
</div>
<div id="run-the-deck-and-card-code-from-the-previous-project.-create-a-deck-and-try-to-shuffle-it.-what-happens" class="section level5">
<h5>Run the <code>Deck</code> and <code>Card</code> code from the previous project. Create a <code>Deck</code> and try to shuffle it. What happens?</h5>
</div>
<div id="to-fix-this-we-can-implement-the-__setitem__-dunder-method.-this-dunder-method-allows-us-to-set-a-value-much-in-the-same-way-__getitem__-allows-us-to-get-a-value.-re-run-your-deck-class-and-try-to-shuffle-again-and-print-out-the-first-couple-of-cards-to-ensure-it-is-truly-shuffled." class="section level5">
<h5>To fix this, we can implement the <code>__setitem__</code> dunder method. This dunder method allows us to &quot;set&quot; a value, much in the same way <code>__getitem__</code> allows us to &quot;get&quot; a value. Re-run your <code>Deck</code> class and try to shuffle again and print out the first couple of cards to ensure it is truly shuffled.</h5>
<p><strong>Relevant topics:</strong></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
1-2 sentences explaining what happens.
</li>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="lets-take-one-last-look-at-the-card-class.-in-blackjack-one-thing-you-need-to-be-able-to-do-is-count-the-value-of-the-cards-in-your-hand.-wouldnt-it-be-convenient-if-we-were-able-to-add-cards-together-like-the-following" class="section level5">
<h5>2. Let's take one last look at the <code>Card</code> class. In Blackjack, one thing you need to be able to do is count the value of the cards in your hand. Wouldn't it be convenient if we were able to add <code>Card</code>s together like the following?</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(Card(<span class="st">&quot;2&quot;</span>, <span class="st">&quot;clubs&quot;</span>) <span class="op">+</span> Card(<span class="st">&quot;k&quot;</span>, <span class="st">&quot;diamonds&quot;</span>))</code></pre></div>
</div>
<div id="in-order-to-do-this-implement-the-__add__-dunder-method-and-test-out-the-following." class="section level5">
<h5>In order to do this, implement the <code>__add__</code> dunder method, and test out the following.</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(Card(<span class="st">&quot;2&quot;</span>, <span class="st">&quot;clubs&quot;</span>) <span class="op">+</span> Card(<span class="st">&quot;k&quot;</span>, <span class="st">&quot;diamonds&quot;</span>)) <span class="co"># 15</span>
<span class="bu">print</span>(Card(<span class="st">&quot;k&quot;</span>, <span class="st">&quot;hearts&quot;</span>) <span class="op">+</span> Card(<span class="st">&quot;q&quot;</span>, <span class="st">&quot;hearts&quot;</span>)) <span class="co"># 25</span>
<span class="bu">print</span>(Card(<span class="st">&quot;k&quot;</span>, <span class="st">&quot;diamonds&quot;</span>) <span class="op">+</span> Card(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;spades&quot;</span>) <span class="op">+</span> Card(<span class="st">&quot;5&quot;</span>, <span class="st">&quot;hearts&quot;</span>)) <span class="co"># ??</span></code></pre></div>
</div>
<div id="what-happens-with-the-last-example-the-reason-this-happens-is-that-the-first-2-cards-are-added-together-without-any-issue.-then-we-add-the-final-card-and-everything-breaks-down.-any-guesses-why-the-reason-is-that-the-result-of-adding-the-first-2-cards-is-an-integer-27-and-we-try-to-then-add-27-card5-hearts-and-python-doesnt-know-what-to-do-as-usual-there-is-a-dunder-method-for-that." class="section level5">
<h5>What happens with the last example? The reason this happens is that the first 2 cards are added together without any issue. Then, we add the final card and everything breaks down. Any guesses why? The reason is that the result of adding the first 2 cards is an integer, 27, and we try to then add <span class="math inline">\(27 + Card(&quot;5&quot;, &quot;hearts&quot;)\)</span> and Python doesn't know what to do! As usual, there is a dunder method for that.</h5>
</div>
<div id="implement-__radd__-and-try-again.-__radd__-will-look-nearly-identical-to-__add__-but-where-you-previously-added-together-the-result-of-2-dictionary-lookups-we-now-just-add-the-plain-argument-to-1-dictionary-lookup." class="section level5">
<h5>Implement <code>__radd__</code> and try again. <code>__radd__</code> will look nearly identical to <code>__add__</code>, but where you previously added together the result of 2 dictionary lookups, we now just add the plain argument to 1 dictionary lookup.</h5>
<p><strong>Relevant topics:</strong></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="okay-rather-than-force-you-to-stumble-through-writing-a-bunch-of-new-code-we-are-going-to-provide-you-with-a-good-amount-of-code-and-have-you-read-through-it-and-digest-it.-weve-provided" class="section level5">
<h5>3. Okay, rather than force you to stumble through writing a bunch of new code, we are going to provide you with a good amount of code, and have you read through it and digest it. We've provided:</h5>
<ul>
<li>A <code>Card</code> class with an updated <code>__eq__</code> method, and updated card values to fit blackjack. <strong>Make sure to add your <code>__add__</code> and <code>__radd__</code> methods to the provided <code>Card</code> class. They are necessary to make everything work.</strong></li>
<li>An updated <code>Deck</code> class with a <code>draw</code> method that allows the user to draw a card from the deck and keep track of how many cards are drawn. <strong>Make sure to add your <code>__setitem__</code> and <code>__getitem__</code> methods to the provided <code>Deck</code> class.</strong></li>
<li>A <code>Hand</code> class that represents a &quot;hand&quot; of cards.</li>
<li>A <code>Player</code> class that represents a player.</li>
<li>A <code>BlackJack</code> class that represents a single game of Blackjack.</li>
</ul>
</div>
<div id="card" class="section level5">
<h5><code>Card</code></h5>
<p><strong>Make sure to add your <code>__add__</code> and <code>__radd__</code> methods to the provided <code>Card</code> class. They are necessary to make everything work.</strong></p>
<p><strong>Methods from the previous project will be added below Saturday morning, or at the latest Monday morning.</strong></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">class</span> Card:
    _value_dict <span class="op">=</span> {<span class="st">&quot;2&quot;</span>: <span class="dv">2</span>, <span class="st">&quot;3&quot;</span>: <span class="dv">3</span>, <span class="st">&quot;4&quot;</span>: <span class="dv">4</span>, <span class="st">&quot;5&quot;</span>: <span class="dv">5</span>, <span class="st">&quot;6&quot;</span>: <span class="dv">6</span>, <span class="st">&quot;7&quot;</span>: <span class="dv">7</span>, <span class="st">&quot;8&quot;</span>:<span class="dv">8</span>, <span class="st">&quot;9&quot;</span>:<span class="dv">9</span>, <span class="st">&quot;10&quot;</span>: <span class="dv">10</span>, <span class="st">&quot;j&quot;</span>: <span class="dv">10</span>, <span class="st">&quot;q&quot;</span>: <span class="dv">10</span>, <span class="st">&quot;k&quot;</span>: <span class="dv">10</span>, <span class="st">&quot;a&quot;</span>: <span class="dv">11</span>}
    <span class="co"># ...</span>
    <span class="kw">def</span> <span class="fu">__eq__</span>(<span class="va">self</span>, other):
        <span class="cf">if</span> <span class="bu">isinstance</span>(other, <span class="bu">type</span>(<span class="va">self</span>)):
            <span class="cf">if</span> <span class="va">self</span>.number <span class="op">==</span> other.number:
                <span class="cf">return</span> <span class="va">True</span>
            <span class="cf">else</span>:
                <span class="cf">return</span> <span class="va">False</span>
        <span class="cf">else</span>:
            <span class="cf">if</span> <span class="va">self</span>.number <span class="op">==</span> other:
                <span class="cf">return</span> <span class="va">True</span>
            <span class="cf">else</span>:
                <span class="cf">return</span> <span class="va">False</span>
    <span class="co"># ...</span></code></pre></div>
</div>
<div id="deck" class="section level5">
<h5><code>Deck</code></h5>
<p><strong>Make sure to add your <code>__setitem__</code> and <code>__getitem__</code> methods to the provided <code>Deck</code> class.</strong></p>
<p><strong>Methods from the previous project will be added below Saturday morning, or at the latest Monday morning.</strong></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> random <span class="im">import</span> shuffle

<span class="kw">class</span> Deck:
    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):
        <span class="va">self</span>.cards <span class="op">=</span> [Card(number, suit) <span class="cf">for</span> suit <span class="kw">in</span> <span class="va">self</span>._suits <span class="cf">for</span> number <span class="kw">in</span> <span class="va">self</span>._numbers]
        <span class="va">self</span>._drawn <span class="op">=</span> <span class="dv">0</span>
    <span class="co"># ...</span>
    <span class="kw">def</span> draw(<span class="va">self</span>, number_cards <span class="op">=</span> <span class="dv">1</span>):
        <span class="cf">try</span>:
            drawn_cards <span class="op">=</span> <span class="va">self</span>.cards[<span class="va">self</span>._drawn:(<span class="va">self</span>._drawn<span class="op">+</span>number_cards)]
        <span class="cf">except</span>:
            <span class="bu">print</span>(<span class="ss">f&quot;Can&#39;t draw anymore cards, deck empty.&quot;</span>)
            
        <span class="va">self</span>._drawn <span class="op">+=</span> number_cards
        <span class="cf">return</span> drawn_cards
    <span class="co"># ...</span></code></pre></div>
</div>
<div id="hand" class="section level5">
<h5><code>Hand</code></h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> queue
<span class="kw">class</span> Hand:
    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, <span class="op">*</span>cards):
        <span class="va">self</span>.cards <span class="op">=</span> [card <span class="cf">for</span> card <span class="kw">in</span> cards]
        
    <span class="kw">def</span> <span class="fu">__str__</span>(<span class="va">self</span>):
        vals <span class="op">=</span> [<span class="bu">str</span>(val) <span class="cf">for</span> val <span class="kw">in</span> <span class="va">self</span>.cards]
        <span class="cf">return</span>(<span class="st">&#39;, &#39;</span>.join(vals))
    
    <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):
        vals <span class="op">=</span> [<span class="bu">repr</span>(val) <span class="cf">for</span> val <span class="kw">in</span> <span class="va">self</span>.cards]
        <span class="cf">return</span>(<span class="st">&#39;, &#39;</span>.join(vals))
    
    <span class="kw">def</span> <span class="fu">__len__</span>(<span class="va">self</span>):
        <span class="cf">return</span> <span class="bu">len</span>(<span class="va">self</span>.cards)
    
    <span class="kw">def</span> <span class="fu">__getitem__</span>(<span class="va">self</span>, key):
        <span class="cf">return</span> <span class="va">self</span>.cards[key]
    
    <span class="kw">def</span> <span class="fu">__setitem__</span>(<span class="va">self</span>, key, value):
        <span class="va">self</span>.cards[key] <span class="op">=</span> value
    
    <span class="kw">def</span> <span class="bu">sum</span>(<span class="va">self</span>):
        number_aces <span class="op">=</span> <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> card <span class="kw">in</span> <span class="va">self</span>.cards <span class="cf">if</span> card <span class="op">==</span> Card(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;hearts&quot;</span>))
        non_ace_sum <span class="op">=</span> <span class="bu">sum</span>(card <span class="cf">for</span> card <span class="kw">in</span> <span class="va">self</span>.cards <span class="cf">if</span> card <span class="op">!=</span> Card(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;hearts&quot;</span>))
        
        <span class="cf">if</span> number_aces <span class="op">==</span> <span class="dv">0</span>:
            <span class="cf">return</span> non_ace_sum
        
        <span class="cf">else</span>:
            <span class="co"># only 2 options 1 ace is 11 the rest 1 or all 1</span>
            high_option <span class="op">=</span> non_ace_sum <span class="op">+</span> number_aces<span class="op">*</span><span class="dv">1</span> <span class="op">+</span> <span class="dv">10</span>
            low_option <span class="op">=</span> non_ace_sum <span class="op">+</span> number_aces<span class="op">*</span><span class="dv">1</span>
            
            <span class="cf">if</span> high_option <span class="op">&lt;=</span> <span class="dv">21</span>:
                <span class="cf">return</span> high_option
            <span class="cf">else</span>:
                <span class="cf">return</span> low_option
            
    <span class="kw">def</span> add(<span class="va">self</span>, <span class="op">*</span>cards):
        <span class="va">self</span>.cards <span class="op">=</span> <span class="va">self</span>.cards <span class="op">+</span> <span class="bu">list</span>(cards)
        <span class="cf">return</span> <span class="va">self</span>
    
    <span class="kw">def</span> clear(<span class="va">self</span>):
        <span class="va">self</span>.cards <span class="op">=</span> []</code></pre></div>
</div>
<div id="player" class="section level5">
<h5><code>Player</code></h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">class</span> Player:
    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, strategy <span class="op">=</span> <span class="va">None</span>, dealer <span class="op">=</span> <span class="va">False</span>):
        <span class="va">self</span>.name <span class="op">=</span> name
        <span class="va">self</span>.hand <span class="op">=</span> Hand()
        <span class="va">self</span>.dealer <span class="op">=</span> dealer
        <span class="va">self</span>.wins <span class="op">=</span> <span class="dv">0</span>
        <span class="va">self</span>.draws <span class="op">=</span> <span class="dv">0</span>
        <span class="va">self</span>.losses <span class="op">=</span> <span class="dv">0</span>
        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.dealer <span class="kw">and</span> <span class="kw">not</span> strategy:
            <span class="bu">print</span>(<span class="ss">f&quot;Non-dealer MUST have strategy.&quot;</span>)
            
        <span class="va">self</span>.strategy <span class="op">=</span> strategy

        
    <span class="kw">def</span> <span class="fu">__str__</span>(<span class="va">self</span>):
        summary <span class="op">=</span> <span class="ss">f&#39;&#39;&#39;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>name<span class="sc">}</span>
<span class="ss">------------</span>
<span class="ss">Wins: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>wins<span class="op">/</span>(<span class="va">self</span>.wins<span class="op">+</span><span class="va">self</span>.losses<span class="op">+</span><span class="va">self</span>.draws)<span class="sc">:.2%}</span>
<span class="ss">Losses: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>losses<span class="op">/</span>(<span class="va">self</span>.wins<span class="op">+</span><span class="va">self</span>.losses<span class="op">+</span><span class="va">self</span>.draws)<span class="sc">:.2%}</span>
<span class="ss">Draws: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>draws<span class="op">/</span>(<span class="va">self</span>.wins<span class="op">+</span><span class="va">self</span>.losses<span class="op">+</span><span class="va">self</span>.draws)<span class="sc">:.2%}</span><span class="ss">&#39;&#39;&#39;</span>
        <span class="cf">return</span> summary
    
    <span class="kw">def</span> cards(<span class="va">self</span>):
        <span class="cf">if</span> <span class="va">self</span>.dealer:
            <span class="cf">return</span> [<span class="bu">list</span>(<span class="va">self</span>.hand.cards)[<span class="dv">0</span>], <span class="st">&quot;Face down&quot;</span>]
        <span class="cf">else</span>:
            <span class="cf">return</span> <span class="va">self</span>.hand</code></pre></div>
</div>
<div id="blackjack" class="section level5">
<h5><code>BlackJack</code></h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> sys

<span class="kw">class</span> BlackJack:
    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, <span class="op">*</span>players, dealer <span class="op">=</span> <span class="va">None</span>):
        <span class="va">self</span>.players <span class="op">=</span> players
        <span class="va">self</span>.deck <span class="op">=</span> Deck()
        <span class="va">self</span>.dealt <span class="op">=</span> <span class="va">False</span>
        <span class="cf">if</span> <span class="kw">not</span> dealer:
            <span class="va">self</span>.dealer <span class="op">=</span> Player(<span class="st">&#39;dealer&#39;</span>, dealer<span class="op">=</span><span class="va">True</span>)
        
    <span class="kw">def</span> deal(<span class="va">self</span>):
        <span class="co"># shuffle the deck</span>
        shuffle(<span class="va">self</span>.deck)
        
        <span class="co"># we are ignoring dealing order and dealing to the dealer</span>
        <span class="co"># first</span>
        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>):
            <span class="va">self</span>.dealer.hand.add(<span class="op">*</span><span class="va">self</span>.deck.draw())
            
        <span class="co"># deal 2 cards to each player</span>
        <span class="cf">for</span> player <span class="kw">in</span> <span class="va">self</span>.players:
            
            <span class="co"># first, clear out the players hands in case they&#39;ve played already</span>
            player.hand.clear()
            <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>):
                player.hand.add(<span class="op">*</span><span class="va">self</span>.deck.draw())
                
        <span class="va">self</span>.dealt <span class="op">=</span> <span class="va">True</span>
    
    <span class="kw">def</span> play(<span class="va">self</span>):
        
        <span class="co"># make sure we&#39;ve dealt</span>
        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.dealt:
            sys.exit(<span class="st">&quot;You MUST deal the cards before playing.&quot;</span>)
        
        <span class="co"># if dealer has face up ace or 10, checks to make sure </span>
        <span class="co"># doesn&#39;t have blackjack</span>
        face_value_ten <span class="op">=</span> (Card(<span class="st">&quot;10&quot;</span>, <span class="st">&quot;hearts&quot;</span>), Card(<span class="st">&quot;j&quot;</span>, <span class="st">&quot;hearts&quot;</span>), Card(<span class="st">&quot;q&quot;</span>, <span class="st">&quot;hearts&quot;</span>), Card(<span class="st">&quot;k&quot;</span>, <span class="st">&quot;hearts&quot;</span>), Card(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;hearts&quot;</span>))
        <span class="cf">if</span> <span class="va">self</span>.dealer.cards()[<span class="dv">0</span>] <span class="kw">in</span> face_value_ten:
            
            <span class="cf">if</span> <span class="va">self</span>.dealer.hand.<span class="bu">sum</span>() <span class="op">==</span> <span class="dv">21</span>:
                <span class="co"># winners get a draw, losers</span>
                <span class="co"># get a loss</span>
                <span class="cf">for</span> player <span class="kw">in</span> <span class="va">self</span>.players:
                    <span class="cf">if</span> player.hand.<span class="bu">sum</span>() <span class="op">==</span> <span class="dv">21</span>:
                        player.draws <span class="op">+=</span> <span class="dv">1</span>

                    <span class="cf">else</span>:
                        player.losses <span class="op">+=</span> <span class="dv">1</span>
                
                <span class="cf">return</span> <span class="st">&quot;GAME OVER&quot;</span>
                

        <span class="co"># if the dealer doesn&#39;t win with a blackjack,</span>
        <span class="co"># the players now know the dealer doesn&#39;t </span>
        <span class="co"># have a blackjack</span>
        
            
        <span class="co"># if the dealer doesn&#39;t have blackjack</span>
        <span class="cf">for</span> player <span class="kw">in</span> <span class="va">self</span>.players:
            <span class="co"># players play using their strategy until they hold</span>
            <span class="cf">while</span> <span class="va">True</span>:
                player_move <span class="op">=</span> player.strategy(<span class="va">self</span>, player)

                <span class="cf">if</span> player_move <span class="op">==</span> <span class="st">&quot;hit&quot;</span>:
                    player.hand.add(<span class="op">*</span><span class="va">self</span>.deck.draw())
                <span class="cf">else</span>:
                    <span class="cf">break</span>

        <span class="co"># dealer draws until &gt;= 17</span>
        <span class="cf">while</span> <span class="va">self</span>.dealer.hand.<span class="bu">sum</span>() <span class="op">&lt;</span> <span class="dv">17</span>:
            <span class="va">self</span>.dealer.hand.add(<span class="op">*</span><span class="va">self</span>.deck.draw())

        <span class="co"># if the dealer gets 21, players who get 21 draw</span>
        <span class="co"># other lose</span>
        <span class="cf">if</span> <span class="va">self</span>.dealer.hand.<span class="bu">sum</span>() <span class="op">==</span> <span class="dv">21</span>:
            <span class="cf">for</span> player <span class="kw">in</span> <span class="va">self</span>.players:
                <span class="cf">if</span> player.hand.<span class="bu">sum</span>() <span class="op">==</span> <span class="dv">21</span>:
                    player.draws <span class="op">+=</span> <span class="dv">1</span>

                <span class="cf">else</span>:
                    player.losses <span class="op">+=</span> <span class="dv">1</span>

        <span class="co"># otherwise, dealer has &lt; 21, anyone with more wins, same draws,</span>
        <span class="co"># and less loses</span>
        <span class="cf">elif</span> <span class="va">self</span>.dealer.hand.<span class="bu">sum</span>() <span class="op">&lt;</span> <span class="dv">21</span>:
            <span class="cf">for</span> player <span class="kw">in</span> <span class="va">self</span>.players:

                <span class="cf">if</span> player.hand.<span class="bu">sum</span>() <span class="op">&gt;</span> <span class="dv">21</span>:
                    <span class="co"># player busts</span>
                    player.losses <span class="op">+=</span> <span class="dv">1</span>

                <span class="cf">elif</span> player.hand.<span class="bu">sum</span>() <span class="op">&gt;</span> <span class="va">self</span>.dealer.hand.<span class="bu">sum</span>():
                    <span class="co"># player wins</span>
                    player.wins <span class="op">+=</span> <span class="dv">1</span>

                <span class="cf">elif</span> player.hand.<span class="bu">sum</span>() <span class="op">==</span> <span class="va">self</span>.dealer.hand.<span class="bu">sum</span>():
                    <span class="co"># player ties</span>
                    player.draws <span class="op">+=</span> <span class="dv">1</span>

                <span class="cf">else</span>:
                    <span class="co"># player loses</span>
                    player.losses <span class="op">+=</span> <span class="dv">1</span>

        <span class="co"># if dealer busts, players who didn&#39;t bust, win</span>
        <span class="co"># players who busted, lose -- this is the house&#39;s edge</span>
        <span class="cf">else</span>:
            <span class="cf">for</span> player <span class="kw">in</span> <span class="va">self</span>.players:

                <span class="cf">if</span> player.hand.<span class="bu">sum</span>() <span class="op">&lt;</span> <span class="dv">21</span>:
                    <span class="co"># player won</span>
                    player.wins <span class="op">+=</span> <span class="dv">1</span>

                <span class="cf">else</span>:
                    <span class="co"># player busted</span>
                    player.losses <span class="op">+=</span> <span class="dv">1</span>
            
        <span class="cf">return</span> <span class="st">&quot;GAME OVER&quot;</span></code></pre></div>
</div>
<div id="read-and-understand-the-hand-class.-create-a-hand-containing-the-ace-of-diamonds-king-of-hearts-ace-of-spades.-print-the-sum-of-the-hand.-add-the-8-of-hearts-to-your-hand-and-print-the-new-sum.-do-things-appear-to-be-working-okay" class="section level5">
<h5>Read and understand the <code>Hand</code> class. Create a hand containing the: Ace of Diamonds, King of Hearts, Ace of Spades. Print the sum of the <code>Hand</code>. Add the 8 of Hearts to your <code>Hand</code>, and print the new sum. Do things appear to be working okay?</h5>
<p><strong>Relevant topics:</strong></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="if-you-take-a-look-at-the-player-class-and-inside-of-the-blackjack-class-you-may-notice-something-we-refer-to-as-a-strategy.-we-define-a-strategy-as-any-function-that-accepts-a-blackjack-object-and-a-player-object-and-returns-either-a-str-hit-or-a-str-hold.-here-are-a-couple-examples-of-strategies" class="section level5">
<h5>4. If you take a look at the <code>Player</code> class and inside of the <code>BlackJack</code> class, you may notice something we refer to as a &quot;strategy&quot;. We define a strategy as any function that accepts a <code>BlackJack</code> object, and a <code>Player</code> object, and returns either a <code>str</code> &quot;hit&quot; or a <code>str</code> &quot;hold&quot;. Here are a couple examples of &quot;strategies&quot;:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> always_hit_once(my_blackjack_game, me) <span class="op">-&gt;</span> <span class="bu">str</span>:
    <span class="co">&quot;&quot;&quot;</span>
<span class="co">    This is a simple strategy where the player</span>
<span class="co">    always hits once.</span>
<span class="co">    &quot;&quot;&quot;</span>
    <span class="cf">if</span> <span class="bu">len</span>(me.hand) <span class="op">==</span> <span class="dv">3</span>:
        <span class="cf">return</span> <span class="st">&quot;hold&quot;</span>
    <span class="cf">else</span>:
        <span class="cf">return</span> <span class="st">&quot;hit&quot;</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> seventeen_plus(my_blackjack_game, me) <span class="op">-&gt;</span> <span class="bu">str</span>:
    <span class="co">&quot;&quot;&quot;</span>
<span class="co">    This is a simple strategy where the player holds if the sum</span>
<span class="co">    of cards is 17+, and hits otherwise.</span>
<span class="co">    &quot;&quot;&quot;</span>
    <span class="cf">if</span> me.hand.<span class="bu">sum</span>() <span class="op">&gt;=</span> <span class="dv">17</span>:
        <span class="cf">return</span> <span class="st">&quot;hold&quot;</span>
    <span class="cf">else</span>:
        <span class="cf">return</span> <span class="st">&quot;hit&quot;</span></code></pre></div>
</div>
<div id="when-you-create-a-player-object-you-provide-a-strategy-as-an-argument-and-that-player-uses-the-strategy-inside-of-a-blackjack-game." class="section level5">
<h5>When you create a <code>Player</code> object, you provide a strategy as an argument, and that player uses the strategy inside of a <code>BlackJack</code> game.</h5>
</div>
<div id="create-2-or-more-players-using-any-of-the-provided-strategies.-create-1000-or-more-blackjack-games-with-those-players-and-play-the-games.-print-the-results-for-each-player." class="section level5">
<h5>Create 2 or more <code>Player</code>s, using any of the provided strategies. Create 1000 or more <code>BlackJack</code> games with those players, and play the games. Print the results for each player.</h5>
<p><strong>Relevant topics:</strong></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="create-your-own-strategy-make-new-games-and-see-how-your-strategy-compares-to-the-other-provided-strategies.-optionally-create-a-plot-that-illustrates-the-differences-in-the-strategy." class="section level5">
<h5>5. Create your own strategy, make new games, and see how your strategy compares to the other provided strategies. Optionally, create a plot that illustrates the differences in the strategy.</h5>
<p><strong>Relevant topics:</strong></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
(Optionally, 0 pts) The plot described.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
</div>
<div id="stat-29000" class="section level2">
<h2>STAT 29000</h2>
<div id="topics-1" class="section level3">
<h3>Topics</h3>
<p>The following table roughly highlights the topics and projects for the semester. This is slightly adjusted throughout the semester as student performance and feedback is taken into consideration.</p>
<table style="width:43%;">
<colgroup>
<col width="12%" />
<col width="13%" />
<col width="6%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th>Language</th>
<th>Project #</th>
<th>Name</th>
<th>Topics</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Python</td>
<td>1</td>
<td>Web scraping: part I</td>
<td>xml, lxml, pandas, etc.</td>
</tr>
<tr class="even">
<td>Python</td>
<td>2</td>
<td>Web scraping: part II</td>
<td>requests, functions, xml, loops, if statements, etc.</td>
</tr>
<tr class="odd">
<td>Python</td>
<td>3</td>
<td>Web scraping: part III</td>
<td>selenium, lxml, lists, pandas, etc.</td>
</tr>
<tr class="even">
<td>Python</td>
<td>4</td>
<td>Web scraping: part IV</td>
<td>requests, beautifulsoup4, lxml, selenium, xml, cronjobs, loops, etc.</td>
</tr>
<tr class="odd">
<td>Python</td>
<td>5</td>
<td>Web scraping: part V</td>
<td>web scraping + related topics</td>
</tr>
<tr class="even">
<td>Python</td>
<td>6</td>
<td>Plotting in Python: part I</td>
<td>ways to plot in Python, more work with pandas, etc.</td>
</tr>
<tr class="odd">
<td>Python</td>
<td>7</td>
<td>Plotting in Python: part II</td>
<td>ways to plot in Python, more work with pandas, etc.</td>
</tr>
<tr class="even">
<td>Python</td>
<td>8</td>
<td>Writing scripts: part I</td>
<td>how to write scripts in Python, more work with pandas, matplotlib, etc.</td>
</tr>
<tr class="odd">
<td>Python</td>
<td>9</td>
<td>Writing scripts: part II</td>
<td>how to write scripts in Python, argparse, more work with pandas, matplotlib, etc.</td>
</tr>
<tr class="even">
<td>R</td>
<td>10</td>
<td>ggplot: part I</td>
<td>ggplot basics</td>
</tr>
<tr class="odd">
<td>R</td>
<td>11</td>
<td>ggplot: part II</td>
<td>more ggplot</td>
</tr>
<tr class="even">
<td>R</td>
<td>12</td>
<td>tidyverse &amp; data.table: part I</td>
<td>data wrangling and computation using tidyverse packages and data.table</td>
</tr>
<tr class="odd">
<td>R</td>
<td>13</td>
<td>tidyverse &amp; data.table: part II</td>
<td>data wrangling and computation using tidyverse packages and data.table</td>
</tr>
<tr class="even">
<td>R</td>
<td>14</td>
<td>tidyverse &amp; data.table: part III</td>
<td>data wrangling and computation using tidyverse packages and data.table</td>
</tr>
</tbody>
</table>
</div>
<div id="p01-290" class="section level3">
<h3>Project 1</h3>
<hr />
<p><strong>Motivation:</strong> Extensible Markup Language or XML is a very important file format for storing structured data. Even though formats like JSON, and csv tend to be more prevalent, many, many legacy systems still use XML, and it remains an appropriate format for storing complex data. In fact, JSON and csv are quickly becoming less relevant as new formats and serialization methods like <a href="https://arrow.apache.org/faq/">parquet</a> and <a href="https://developers.google.com/protocol-buffers">protobufs</a> are becoming more common.</p>
<p><strong>Context:</strong> In previous semesters we've explored XML. In this project we will refresh our skills and, rather than exploring XML in R, we will use the <code>lxml</code> package in Python. This is the first project in a series of 5 projects focused on web scraping in R and Python.</p>
<p><strong>Scope:</strong> python, XML</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Review and summarize the differences between XML and HTML/CSV.
</li>
<li>
Match XML terms to sections of XML demonstrating working knowledge.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset-13" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/apple/health/watch_dump.xml</code></p>
</div>
<div id="resources" class="section level4">
<h4>Resources</h4>
<p>We realize that for many of you this is a big &quot;jump&quot; right into Python. Don't worry! Python is a very intuitive language with a clean syntax. It is easy to read and write. We will do our very best to keep things as straightforward as possible, especially in the early learning stages of the class.</p>
<p>We will be actively updating the examples book with videos and more examples throughout the semester. Ask a question in Piazza and perhaps we will add an example straight to the book to help out.</p>
<p>Some potentially useful resources for the semester include:</p>
<ul>
<li>The STAT 19000 projects. We are easing 19000 students into Python and will post solutions each week. It would be well worth 10 minutes to look over the questions and solutions each week.</li>
<li><a href="https://towardsdatascience.com/cheat-sheet-for-python-dataframe-r-dataframe-syntax-conversions-450f656b44ca">Here</a> is a decent cheat sheet that helps you quickly get an idea of how to do something you know how to do in R, in Python.</li>
<li><a href="https://thedatamine.github.io/the-examples-book/">The Examples Book</a> -- updating daily with more examples and videos. Be sure to click on the &quot;relevant topics&quot; links as we try to point you to topics with examples that should be particularly useful to solve the problems we assign.</li>
</ul>
</div>
<div id="questions-13" class="section level4">
<h4>Questions</h4>
<p><strong>Important note:</strong> It would be well worth your time to read through the <a href="data-formats.html#xml">xml section</a> of the book, as well as take the time to work through <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/10min.html">pandas 10 minute intro</a>.</p>
<div id="a-good-first-step-when-working-with-xml-is-to-get-an-idea-how-your-document-is-structured.-normally-there-should-be-good-documentation-that-spells-this-out-for-you-but-it-is-good-to-know-what-to-do-when-you-dont-have-the-documentation.-start-by-finding-the-root-node.-what-is-the-name-of-the-root-node-of-the-provided-dataset" class="section level5">
<h5>1. A good first step when working with XML is to get an idea how your document is structured. Normally, there should be good documentation that spells this out for you, but it is good to know what to do when you <em>don't</em> have the documentation. Start by finding the &quot;root&quot; node. What is the name of the root node of the provided dataset?</h5>
<p><strong>Hint:</strong> Make sure to import the <code>lxml</code> package first:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> lxml <span class="im">import</span> etree</code></pre></div>
<p>Here are two videos about running Python in RStudio:</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_nhkygxg9">Click here for video</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_tdz3wmim">Click here for video</a></p>
<p>and here is a video about XML scraping in Python:</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_1ywsbxyp">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-lxml">lxml</a>, <a href="data-formats.html#xml">xml</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-34" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">from</span> lxml <span class="im">import</span> etree

tree <span class="op">=</span> etree.parse(<span class="st">&quot;/class/datamine/data/apple/health/watch_dump.xml&quot;</span>)

tree.xpath(<span class="st">&quot;/*&quot;</span>)[<span class="dv">0</span>].tag</code></pre></div>
</div>
<div id="remember-xml-can-be-nested.-in-question-1-we-figured-out-what-the-root-node-was-called.-what-are-the-names-of-the-next-tier-of-elements" class="section level5">
<h5>2. Remember, XML can be nested. In question (1) we figured out what the root node was called. What are the names of the next &quot;tier&quot; of elements?</h5>
<p><strong>Hint:</strong> Now that we know the root node, you could use the root node name as a part of your xpath expression.</p>
<p><strong>Hint:</strong> As you may have noticed in question (1) the <code>xpath</code> method returns a list. Sometimes this list can contain many repeated tag names. Since our goal is to see the names of the second &quot;tier&quot; elements, you could convert the resulting <code>list</code> to a <code>set</code> to quickly see the unique list as <code>set</code>'s only contain unique values.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-for-loops">for loops</a>, <a href="python.html#p-lxml">lxml</a>, <a href="data-formats.html#xml">xml</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-35" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/*&quot;</span>)])</code></pre></div>
</div>
<div id="continue-to-explore-each-tier-of-data-until-there-isnt-any-left.-name-the-full-paths-of-all-of-the-last-tier-tags." class="section level5">
<h5>3. Continue to explore each &quot;tier&quot; of data until there isn't any left. Name the &quot;full paths&quot; of all of the &quot;last tier&quot; tags.</h5>
<p><strong>Hint:</strong> Let's say a &quot;last tier&quot; tag is just a path where there are no more nested elements. For example, <code>/HealthData/Workout/WorkoutRoute/FileReference</code> is a &quot;last tier&quot; tag. If you try and get the nested elements for it, they don't exist:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">tree.xpath(<span class="st">&quot;/HealthData/Workout/WorkoutRoute/FileReference/*&quot;</span>)</code></pre></div>
<p><strong>Hint:</strong> Here are 3 of the 7 &quot;full paths&quot;:</p>
<pre><code>/HealthData/Workout/WorkoutRoute/FileReference
/HealthData/Record/MetadataEntry
/HealthData/ActivitySummary</code></pre>
<p><strong>Relevant topics:</strong> <a href="python.html#p-lxml">lxml</a>, <a href="data-formats.html#xml">xml</a>, <a href="python.html#p-for-loops">for loops</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-36" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/*&quot;</span>)]))

<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/ActivitySummary/*&quot;</span>)]))
<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/Record/*&quot;</span>)]))
<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/Workout/*&quot;</span>)]))

<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/Record/HeartRateVariabilityMetadataList/*&quot;</span>)]))
<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/Record/MetadataEntry/*&quot;</span>)]))
<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/Workout/WorkoutEvent/*&quot;</span>)]))
<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/Workout/WorkoutRoute/*&quot;</span>)]))
<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/Workout/WorkoutEntry/*&quot;</span>)]))

<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/Record/HeartRateVariabilityMetadataList/InstantaneousBeatsPerMinute/*&quot;</span>)]))
<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/Workout/WorkoutRoute/FileReference/*&quot;</span>)]))
<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/Workout/WorkoutRoute/MetadataEntry/*&quot;</span>)]))</code></pre></div>
<div class="solution">
<p>
/HealthData/Record/HeartRateVariabilityMetadataList/InstantaneousBeatsPerMinute /HealthData/Workout/WorkoutRoute/FileReference /HealthData/Workout/WorkoutRoute/MetadataEntry /HealthData/Record/MetadataEntry /HealthData/Workout/WorkoutEvent /HealthData/Workout/WorkoutEntry /HealthData/ActivitySummary
</p>
</div>
</div>
<div id="at-this-point-in-time-you-may-be-asking-yourself-but-where-is-the-data-depending-on-the-structure-of-the-xml-file-the-data-could-either-be-between-tags-like" class="section level5">
<h5>4. At this point in time you may be asking yourself &quot;but where is the data&quot;? Depending on the structure of the XML file, the data could either be between tags like:</h5>
<div class="sourceCode"><pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;some_tag&gt;</span>mydata<span class="kw">&lt;/some_tag&gt;</span></code></pre></div>
</div>
<div id="or-it-could-be-in-an-attribute" class="section level5">
<h5>Or, it could be in an attribute:</h5>
<div class="sourceCode"><pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;question</span><span class="ot"> answer=</span><span class="st">&quot;tac&quot;</span><span class="kw">&gt;</span>What is cat spelled backwards?<span class="kw">&lt;/question&gt;</span></code></pre></div>
</div>
<div id="collect-the-activitysummary-data-and-convert-the-list-of-dicts-to-a-pandas-dataframe.-the-following-is-an-example-of-converting-a-list-of-dicts-to-a-pandas-dataframe-called-mydf" class="section level5">
<h5>Collect the &quot;ActivitySummary&quot; data, and convert the list of dicts to a <code>pandas</code> DataFrame. The following is an example of converting a list of dicts to a <code>pandas</code> DataFrame called <code>myDF</code>:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> pandas <span class="im">as</span> pd

list_of_dicts <span class="op">=</span> []
list_of_dicts.append({<span class="st">&#39;columnA&#39;</span>: <span class="dv">1</span>, <span class="st">&#39;columnB&#39;</span>: <span class="dv">2</span>})
list_of_dicts.append({<span class="st">&#39;columnB&#39;</span>: <span class="dv">4</span>, <span class="st">&#39;columnA&#39;</span>: <span class="dv">1</span>}) 

myDF <span class="op">=</span> pd.DataFrame(list_of_dicts)</code></pre></div>
<p><strong>Hint:</strong> It is important to note that an element's &quot;attrib&quot; attribute looks and feels like a <code>dict</code>, but it is actually a <code>lxml.etree._Attrib</code>. If you try to convert a list of <code>lxml.etree._Attrib</code> to a <code>pandas</code> DataFrame, it will not work out as you planned. Make sure to first convert each <code>lxml.etree._Attrib</code> to a <code>dict</code> before converting to a DataFrame. You can do so like:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co"># this will convert a single `lxml.etree._Attrib` to a dict</span>
my_dict <span class="op">=</span> <span class="bu">dict</span>(my_lxml_etree_attrib)</code></pre></div>
<p><strong>Relevant topics:</strong> <a href="python.html#p-dicts">dicts</a>, <a href="#p-lists">lists</a>, <a href="python.html#p-lxml">lxml</a>, <a href="data-formats.html#xml">xml</a>, <a href="python.html#p-for-loops">for loops</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-37" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">dat <span class="op">=</span> tree.xpath(<span class="st">&quot;/HealthData/ActivitySummary&quot;</span>)
list_of_dicts <span class="op">=</span> []

<span class="cf">for</span> e <span class="kw">in</span> dat:
    list_of_dicts.append(<span class="bu">dict</span>(e.attrib))
    
myDF <span class="op">=</span> pd.DataFrame(data<span class="op">=</span>list_of_dicts)
myDF.sort_values([<span class="st">&#39;activeEnergyBurned&#39;</span>], ascending<span class="op">=</span><span class="va">False</span>).head()</code></pre></div>
</div>
<div id="pandas-is-a-python-package-that-provides-the-dataframe-and-series-classes.-a-dataframe-is-very-similar-to-a-data.frame-in-r-and-can-be-used-to-manipulate-the-data-within-very-easily.-a-series-is-the-class-that-handles-a-single-column-of-a-dataframe.-go-through-the-pandas-in-10-minutes-page-from-the-official-documentation.-sort-find-and-print-the-top-5-rows-of-data-based-on-the-activeenergyburned-column." class="section level5">
<h5>5. <code>pandas</code> is a Python package that provides the DataFrame and Series classes. A DataFrame is very similar to a data.frame in R and can be used to manipulate the data within very easily. A Series is the class that handles a single column of a DataFrame. Go through the <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/10min.html">pandas in 10 minutes</a> page from the official documentation. Sort, find, and print the top 5 rows of data based on the &quot;activeEnergyBurned&quot; column.</h5>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas">pandas</a>, <a href="python.html#p-dicts">dicts</a>, <a href="#p-lists">lists</a>, <a href="python.html#p-lxml">lxml</a>, <a href="data-formats.html#xml">xml</a>, <a href="python.html#p-for-loops">for loops</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-38" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="co"># could be anything</span></code></pre></div>
<hr />
</div>
</div>
</div>
<div id="p02-290" class="section level3">
<h3>Project 2</h3>
<hr />
<p><strong>Motivation:</strong> Web scraping is is the process of taking content off of the internet. Typically this goes hand-in-hand with parsing or processing the data. Depending on the task at hand, web scraping can be incredibly simple. With that being said, it can quickly become difficult. Typically, students find web scraping fun and empowering.</p>
<p><strong>Context:</strong> In the previous project we gently introduced XML and xpath expressions. In this project, we will learn about web scraping, scrape data from The New York Times, and parse through our newly scraped data using xpath expressions.</p>
<p><strong>Scope:</strong> python, web scraping, xml</p>
<p><strong>Learning objectives:</strong> <a href="data-formats.html#html">html</a></p>
<div class="bbox">
<ul>
<li>
Review and summarize the differences between XML and HTML/CSV.
</li>
<li>
Use the requests package to scrape a web page.
</li>
<li>
Use the lxml package to filter and parse data from a scraped web page.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset-14" class="section level4">
<h4>Dataset</h4>
<p>You will be extracting your own data from online in this project. There is no base dataset.</p>
</div>
<div id="questions-14" class="section level4">
<h4>Questions</h4>
<div id="the-new-york-times-is-one-of-the-most-popular-newspapers-in-the-united-states.-open-a-modern-browser-preferably-firefox-or-chrome-and-navigate-to-httpsnytimes.com." class="section level5">
<h5>1. The New York Times is one of the most popular newspapers in the United States. Open a modern browser (preferably Firefox or Chrome), and navigate to <a href="https://nytimes.com" class="uri">https://nytimes.com</a>.</h5>
</div>
<div id="by-the-end-of-this-project-you-will-be-able-to-scrape-some-data-from-this-website-the-first-step-is-to-explore-the-structure-of-the-website.-you-can-either-right-click-and-click-on-view-page-source-which-will-pull-up-a-page-full-of-html-used-to-render-the-page.-alternatively-if-you-want-to-focus-on-a-single-element-an-article-title-for-example-right-click-on-the-article-title-and-click-on-inspect-element.-this-will-pull-up-an-inspector-that-allows-you-to-see-portions-of-the-html." class="section level5">
<h5>By the end of this project you will be able to scrape some data from this website! The first step is to explore the structure of the website. You can either right click and click on &quot;view page source&quot;, which will pull up a page full of HTML used to render the page. Alternatively, if you want to focus on a single element, an article title, for example, right click on the article title and click on &quot;inspect element&quot;. This will pull up an inspector that allows you to see portions of the HTML.</h5>
</div>
<div id="click-around-the-website-and-explore-the-html-however-you-see-fit.-open-a-few-front-page-articles-and-notice-how-most-articles-start-with-a-bunch-of-really-important-information-namely-an-article-title-summary-picture-picture-caption-picture-source-author-portraits-authors-and-article-datetime." class="section level5">
<h5>Click around the website and explore the HTML however you see fit. Open a few front page articles and notice how most articles start with a bunch of really important information, namely: an article title, summary, picture, picture caption, picture source, author portraits, authors, and article datetime.</h5>
</div>
<div id="for-example" class="section level5">
<h5>For example:</h5>
<p><a href="https://www.nytimes.com/2021/01/19/us/politics/trump-china-xinjiang.html" class="uri">https://www.nytimes.com/2021/01/19/us/politics/trump-china-xinjiang.html</a></p>
<div class="figure">
<img src="images/nytimes_image.jpg" />

</div>
</div>
<div id="copy-and-paste-the-h1-element-in-its-entirety-containing-the-article-title-for-the-article-provided-in-an-html-code-chunk.-do-the-same-for-the-same-articles-summary." class="section level5">
<h5>Copy and paste the <strong>h1</strong> element (in its entirety) containing the article title (for the article provided) in an HTML code chunk. Do the same for the same article's summary.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_eew0i16y">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="data-formats.html#html">html</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
2 code chunks containing the HTML requested.
</li>
</ul>
</div>
</div>
<div id="solution-39" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode html solution"><code class="sourceCode html"><span class="kw">&lt;h1</span><span class="ot"> id=</span><span class="st">&quot;link-4686dc8b&quot;</span><span class="ot"> class=</span><span class="st">&quot;css-rsa88z e1h9rw200&quot;</span><span class="ot"> data-test-id=</span><span class="st">&quot;headline&quot;</span><span class="kw">&gt;</span>U.S. Says China’s Repression of Uighurs Is ‘Genocide’<span class="kw">&lt;/h1&gt;</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode html solution"><code class="sourceCode html"><span class="kw">&lt;p</span><span class="ot"> id=</span><span class="st">&quot;article-summary&quot;</span><span class="ot"> class=</span><span class="st">&quot;css-w6ymp8 e1wiw3jv0&quot;</span><span class="kw">&gt;</span>The finding by the Trump administration is the strongest denunciation by any government of China’s actions and follows a Biden campaign statement with the same declaration.<span class="kw">&lt;/p&gt;</span></code></pre></div>
</div>
<div id="in-question-1-we-copied-two-elements-of-an-article.-when-scraping-data-from-a-website-it-is-important-to-continually-consider-the-patterns-in-the-structure.-specifically-it-is-important-to-consider-whether-or-not-the-defining-characteristics-you-use-to-parse-the-scraped-data-will-continue-to-be-in-the-same-format-for-new-data.-what-do-i-mean-by-defining-characterstic-i-mean-some-combination-of-tag-attribute-and-content-from-which-you-can-isolate-the-data-of-interest." class="section level5">
<h5>2. In question (1) we copied two elements of an article. When scraping data from a website, it is important to continually consider the patterns in the structure. Specifically, it is important to consider whether or not the defining characteristics you use to parse the scraped data will continue to be in the same format for <em>new</em> data. What do I mean by defining characterstic? I mean some combination of tag, attribute, and content from which you can isolate the data of interest.</h5>
</div>
<div id="for-example-given-a-link-to-a-new-nytimes-article-do-you-think-you-could-isolate-the-article-title-by-using-the-idlink-4686dc8b-attribute-of-the-h1-tag-maybe-or-maybe-not-but-it-sure-seems-like-link-4686dc8b-might-be-unique-to-the-article-and-not-able-to-be-used-given-a-new-article." class="section level5">
<h5>For example, given a link to a new nytimes article, do you think you could isolate the article title by using the <code>id=&quot;link-4686dc8b&quot;</code> attribute of the <strong>h1</strong> tag? Maybe, or maybe not, but it sure seems like &quot;link-4686dc8b&quot; might be unique to the article and not able to be used given a new article.</h5>
</div>
<div id="write-an-xpath-expression-to-isolate-the-article-title-and-another-xpath-expression-to-isolate-the-article-summary." class="section level5">
<h5>Write an xpath expression to isolate the article title, and another xpath expression to isolate the article summary.</h5>
<p><strong>Important note:</strong> You do <em>not</em> need to test your xpath expression yet, we will be doing that shortly.</p>
<p><strong>Relevant topics:</strong> <a href="data-formats.html#html">html</a>, <a href="data-formats.html#xml">xml</a>, <a href="data-formats.html#xml-xpath">xpath expressions</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Two xpath expressions in an HTML code chunk.
</li>
</ul>
</div>
</div>
<div id="solution-40" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode html solution"><code class="sourceCode html">//h1[@data-test-id=&quot;headline&quot;]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode html solution"><code class="sourceCode html">//p[@id=&quot;article-summary&quot;]</code></pre></div>
</div>
<div id="use-the-requests-package-to-scrape-the-webpage-containing-our-article-from-questions-1-and-2.-use-the-lxml.html-package-and-the-xpath-method-to-test-out-your-xpath-expressions-from-question-2.-did-they-work-print-the-content-of-the-elements-to-confirm." class="section level5">
<h5>3. Use the <code>requests</code> package to scrape the webpage containing our article from questions (1) and (2). Use the <code>lxml.html</code> package and the <code>xpath</code> method to test out your xpath expressions from question (2). Did they work? Print the content of the elements to confirm.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_qw2xb058">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="data-formats.html#html">html</a>, <a href="data-formats.html#xml">xml</a>, <a href="data-formats.html#xml-xpath">xpath expressions</a>, <a href="python.html#p-lxml">lxml</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-41" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">import</span> lxml.html
<span class="im">import</span> requests

url <span class="op">=</span>  <span class="st">&quot;https://www.nytimes.com/2021/01/19/us/politics/trump-china-xinjiang.html&quot;</span>
response <span class="op">=</span> requests.get(url, stream<span class="op">=</span><span class="va">True</span>)
response.raw.decode_content <span class="op">=</span> <span class="va">True</span>
tree <span class="op">=</span> lxml.html.parse(response.raw)

<span class="bu">print</span>(tree.xpath(<span class="st">&#39;//p[@id=&quot;article-summary&quot;]&#39;</span>)[<span class="dv">0</span>].text)
<span class="bu">print</span>(tree.xpath(<span class="st">&#39;//h1[@data-test-id=&quot;headline&quot;]&#39;</span>)[<span class="dv">0</span>].text)</code></pre></div>
</div>
<div id="here-are-a-list-of-article-links-from-httpsnytimes.com" class="section level5">
<h5>4. Here are a list of article links from <a href="https://nytimes.com" class="uri">https://nytimes.com</a>:</h5>
<p><a href="https://www.nytimes.com/2021/01/19/us/politics/trump-china-xinjiang.html" class="uri">https://www.nytimes.com/2021/01/19/us/politics/trump-china-xinjiang.html</a></p>
<p><a href="https://www.nytimes.com/2021/01/06/technology/personaltech/tech-2021-augmented-reality-chatbots-wifi.html" class="uri">https://www.nytimes.com/2021/01/06/technology/personaltech/tech-2021-augmented-reality-chatbots-wifi.html</a></p>
<p><a href="https://www.nytimes.com/2021/01/13/movies/letterboxd-growth.html" class="uri">https://www.nytimes.com/2021/01/13/movies/letterboxd-growth.html</a></p>
</div>
<div id="write-a-function-called-get_article_and_summary-that-accepts-a-string-called-link-as-an-argument-and-returns-both-the-article-title-and-summary.-test-get_article_and_summary-out-on-each-of-the-provided-links" class="section level5">
<h5>Write a function called <code>get_article_and_summary</code> that accepts a string called <code>link</code> as an argument, and returns both the article title and summary. Test <code>get_article_and_summary</code> out on each of the provided links:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">title, summary <span class="op">=</span> get_article_and_summary(<span class="st">&#39;https://www.nytimes.com/2021/01/19/us/politics/trump-china-xinjiang.html&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;Title: </span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">, Summary: </span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&#39;</span>)
title, summary <span class="op">=</span> get_article_and_summary(<span class="st">&#39;https://www.nytimes.com/2021/01/06/technology/personaltech/tech-2021-augmented-reality-chatbots-wifi.html&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;Title: </span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">, Summary: </span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&#39;</span>)
title, summary <span class="op">=</span> get_article_and_summary(<span class="st">&#39;https://www.nytimes.com/2021/01/13/movies/letterboxd-growth.html&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;Title: </span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">, Summary: </span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&#39;</span>)</code></pre></div>
<p><strong>Hint:</strong> The first line of your function should look like this:</p>
<p><code>def get_article_and_summary(myURL: str) -&gt; (str, str):</code></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_jrtrt5fo">Click here for video</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_7yhabkeg">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="data-formats.html#html">html</a>, <a href="data-formats.html#xml">xml</a>, <a href="data-formats.html#xml-xpath">xpath expressions</a>, <a href="python.html#p-lxml">lxml</a>, <a href="python.html#p-writing-functions">functions</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-42" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">from</span> typing <span class="im">import</span> Tuple
<span class="im">import</span> lxml.html
<span class="im">import</span> requests

<span class="kw">def</span> get_article_and_summary(link: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">str</span>]:
    <span class="co">&quot;&quot;&quot;</span>
<span class="co">    Given a link to a new york times article, return the article title and summary.</span>

<span class="co">    Args:</span>
<span class="co">        link (str): The link to the new york times article.</span>

<span class="co">    Returns:</span>
<span class="co">        Tuple[str, str]: A tuple first containing the article title, and then the article summary.</span>
<span class="co">    &quot;&quot;&quot;</span>
    
    <span class="co"># scrape the web page</span>
    response <span class="op">=</span> requests.get(link, stream<span class="op">=</span><span class="va">True</span>)
    response.raw.decode_content <span class="op">=</span> <span class="va">True</span>
    tree <span class="op">=</span> lxml.html.parse(response.raw)
    
    title <span class="op">=</span> tree.xpath(<span class="st">&#39;//p[@id=&quot;article-summary&quot;]&#39;</span>)[<span class="dv">0</span>].text
    summary <span class="op">=</span> tree.xpath(<span class="st">&#39;//h1[@data-test-id=&quot;headline&quot;]&#39;</span>)[<span class="dv">0</span>].text
    
    <span class="cf">return</span> title, summary</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">title, summary <span class="op">=</span> get_article_and_summary(<span class="st">&#39;https://www.nytimes.com/2021/01/19/us/politics/trump-china-xinjiang.html&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;Title: </span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">, Summary: </span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&#39;</span>)
title, summary <span class="op">=</span> get_article_and_summary(<span class="st">&#39;https://www.nytimes.com/2021/01/06/technology/personaltech/tech-2021-augmented-reality-chatbots-wifi.html&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;Title: </span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">, Summary: </span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&#39;</span>)
title, summary <span class="op">=</span> get_article_and_summary(<span class="st">&#39;https://www.nytimes.com/2021/01/13/movies/letterboxd-growth.html&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;Title: </span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">, Summary: </span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&#39;</span>)</code></pre></div>
</div>
<div id="in-question-1-we-mentioned-a-myriad-of-other-important-information-given-at-the-top-of-most-new-york-times-articles.-choose-one-other-listed-pieces-of-information-and-copy-paste-and-update-your-solution-to-question-4-to-scrape-and-return-those-chosen-pieces-of-information." class="section level5">
<h5>5. In question (1) we mentioned a myriad of other important information given at the top of most New York Times articles. Choose <strong>one</strong> other listed pieces of information and copy, paste, and update your solution to question (4) to scrape and return those chosen pieces of information.</h5>
<p><strong>Important note:</strong> If you choose to scrape non-textual data, be sure to return data of an appropriate type. For example, if you choose to scrape one of the images, either print the image or return a PIL object.</p>
<p><strong>Relevant topics:</strong> <a href="data-formats.html#html">html</a>, <a href="data-formats.html#xml">xml</a>, <a href="data-formats.html#xml-xpath">xpath expressions</a>, <a href="python.html#p-lxml">lxml</a>, <a href="python.html#p-writing-functions">functions</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-43" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">from</span> typing <span class="im">import</span> Tuple
<span class="im">import</span> lxml.html
<span class="im">import</span> requests
<span class="im">import</span> io
<span class="im">from</span> PIL <span class="im">import</span> Image
<span class="im">from</span> IPython.display <span class="im">import</span> display

<span class="kw">def</span> get_article_and_summary(link: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">str</span>]:
    <span class="co">&quot;&quot;&quot;</span>
<span class="co">    Given a link to a new york times article, return the article title and summary.</span>

<span class="co">    Args:</span>
<span class="co">        link (str): The link to the new york times article.</span>

<span class="co">    Returns:</span>
<span class="co">        Tuple[str, str]: A tuple first containing the article title, and then the article summary.</span>
<span class="co">    &quot;&quot;&quot;</span>
    
    <span class="co"># scrape the web page</span>
    response <span class="op">=</span> requests.get(link, stream<span class="op">=</span><span class="va">True</span>)
    response.raw.decode_content <span class="op">=</span> <span class="va">True</span>
    tree <span class="op">=</span> lxml.html.parse(response.raw)
    
    <span class="co"># parse out the title</span>
    title <span class="op">=</span> tree.xpath(<span class="st">&#39;//p[@id=&quot;article-summary&quot;]&#39;</span>)[<span class="dv">0</span>].text
    
    <span class="co"># parse out the summary</span>
    summary <span class="op">=</span> tree.xpath(<span class="st">&#39;//h1[@data-test-id=&quot;headline&quot;]&#39;</span>)[<span class="dv">0</span>].text
    
    <span class="co"># parse out the url to the image</span>
    photo_src <span class="op">=</span> tree.xpath(<span class="st">&#39;//picture/img&#39;</span>)[<span class="dv">0</span>].attrib.get(<span class="st">&quot;src&quot;</span>)
    
    <span class="co"># scrape image</span>
    photo_content <span class="op">=</span> requests.get(photo_src).content
    
    <span class="co"># convert image format </span>
    photo_file <span class="op">=</span> io.BytesIO(photo_content)
    photo <span class="op">=</span> Image.<span class="bu">open</span>(photo_file).convert(<span class="st">&#39;RGB&#39;</span>)    
    
    <span class="co"># parse out photo caption</span>
    caption <span class="op">=</span> tree.xpath(<span class="st">&#39;//figcaption/span&#39;</span>)[<span class="dv">0</span>].text
    
    <span class="co"># parse out the photo credits</span>
    credits <span class="op">=</span> tree.xpath(<span class="st">&#39;//figcaption/span/span[contains(text(), &quot;Credit&quot;)]/following-sibling::span/span&#39;</span>)
    
    credits_list <span class="op">=</span> []
    <span class="cf">for</span> c <span class="kw">in</span> credits:
        credits_list.append(c.text)
        
    <span class="co"># parse author photo url</span>
    <span class="co"># only gets if &quot;author&quot; in photo src attribute</span>
    photo_src_elements <span class="op">=</span> tree.xpath(<span class="st">&#39;//img[contains(@src, &quot;author&quot;)]&#39;</span>)
    
    <span class="co"># if &quot;author&quot; in photo src attribute</span>
    photo_srcs <span class="op">=</span> []
    <span class="cf">for</span> p <span class="kw">in</span> photo_src_elements:
        photo_srcs.append(p.attrib.get(<span class="st">&quot;src&quot;</span>))
    
    <span class="co"># scrape image</span>
    author_images <span class="op">=</span> []
    <span class="cf">for</span> img <span class="kw">in</span> photo_srcs:
        photo_content <span class="op">=</span> requests.get(img).content
    
        <span class="co"># convert image format </span>
        photo_file <span class="op">=</span> io.BytesIO(photo_content)
        photo <span class="op">=</span> Image.<span class="bu">open</span>(photo_file).convert(<span class="st">&#39;RGB&#39;</span>)    
        
        author_images.append(photo)
        
    <span class="co"># parse out authors</span>
    authors_elements <span class="op">=</span> tree.xpath(<span class="st">&quot;//span[@class=&#39;byline-prefix&#39;]/following-sibling::a/span&quot;</span>)
    authors <span class="op">=</span> []
    <span class="cf">for</span> a <span class="kw">in</span> authors_elements:
        authors.append(a.text)
        
    <span class="co"># parse out article publish date/time</span>
    dt <span class="op">=</span> tree.xpath(<span class="st">&quot;//time&quot;</span>)[<span class="dv">0</span>].attrib.get(<span class="st">&quot;datetime&quot;</span>)
    
    <span class="cf">return</span> title, summary, photo, caption, credits, author_images, authors, dt


title, summary, photo, caption, credits, author_images, authors, dt <span class="op">=</span> get_article_and_summary(<span class="st">&#39;https://www.nytimes.com/2021/01/19/us/politics/trump-china-xinjiang.html&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;Title:</span><span class="ch">\n</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">, Summary:</span><span class="ch">\n</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">, Caption:</span><span class="ch">\n</span><span class="sc">{</span>caption<span class="sc">}</span><span class="ss">&#39;</span>)
title, summary, photo, caption, credits, author_images, authors, dt <span class="op">=</span> get_article_and_summary(<span class="st">&#39;https://www.nytimes.com/2021/01/06/technology/personaltech/tech-2021-augmented-reality-chatbots-wifi.html&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;Title:</span><span class="ch">\n</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">, Summary:</span><span class="ch">\n</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">, Caption:</span><span class="ch">\n</span><span class="sc">{</span>caption<span class="sc">}</span><span class="ss">&#39;</span>)
title, summary, photo, caption, credits, author_images, authors, dt <span class="op">=</span> get_article_and_summary(<span class="st">&#39;https://www.nytimes.com/2021/01/13/movies/letterboxd-growth.html&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;Title:</span><span class="ch">\n</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">, Summary:</span><span class="ch">\n</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">, Caption:</span><span class="ch">\n</span><span class="sc">{</span>caption<span class="sc">}</span><span class="ss">&#39;</span>)</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="p03-290" class="section level3">
<h3>Project 3</h3>
<hr />
<p><strong>Motivation:</strong> Web scraping takes practice, and it is important to work through a variety of common tasks in order to know how to handle those tasks when you next run into them. In this project, we will use a variety of scraping tools in order to scrape data from <a href="https://trulia.com" class="uri">https://trulia.com</a>.</p>
<p><strong>Context:</strong> In the previous project, we got our first taste at actually scraping data from a website, and using a parser to extract the information we were interested in. In this project, we will introduce some tasks that will require you to use a tool that let's you interact with a browser, selenium.</p>
<p><strong>Scope:</strong> python, web scraping, selenium</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Review and summarize the differences between XML and HTML/CSV.
</li>
<li>
Use the requests package to scrape a web page.
</li>
<li>
Use the lxml package to filter and parse data from a scraped web page.
</li>
<li>
Use selenium to interact with a browser in order to get a web page to a desired state for scraping.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="questions-15" class="section level4">
<h4>Questions</h4>
<div id="visit-httpstrulia.com.-many-websites-have-a-similar-interface-i.e.-a-bold-and-centered-search-bar-for-a-user-to-interact-with.-using-selenium-write-python-code-that-that-first-finds-the-input-element-and-then-types-west-lafayette-in-followed-by-an-emulated-enterreturn.-confirm-you-code-works-by-printing-the-url-after-that-process-completes." class="section level5">
<h5>1. Visit <a href="https://trulia.com" class="uri">https://trulia.com</a>. Many websites have a similar interface, i.e. a bold and centered search bar for a user to interact with. Using <code>selenium</code> write Python code that that first finds the <code>input</code> element, and then types &quot;West Lafayette, IN&quot; followed by an emulated &quot;Enter/Return&quot;. Confirm you code works by printing the url after that process completes.</h5>
<p><strong>Hint:</strong> You will want to use <code>time.sleep</code> to pause a bit after the search so the updated url is returned.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_ztju698f">Click here for video</a></p>
<p>That video is already relevant for Question 2 too.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-selenium">selenium</a>, <a href="data-formats.html#xml">xml</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-44" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">from</span> selenium <span class="im">import</span> webdriver
<span class="im">from</span> selenium.webdriver.common.keys <span class="im">import</span> Keys
<span class="im">from</span> selenium.webdriver.firefox.options <span class="im">import</span> Options
<span class="im">from</span> selenium.common.exceptions <span class="im">import</span> NoSuchElementException

<span class="im">import</span> time</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">firefox_options <span class="op">=</span> Options()
firefox_options.add_argument(<span class="st">&quot;window-size=1920,1080&quot;</span>)
firefox_options.add_argument(<span class="st">&quot;--headless&quot;</span>) <span class="co"># Headless mode means no GUI</span>
firefox_options.add_argument(<span class="st">&quot;start-maximized&quot;</span>)
firefox_options.add_argument(<span class="st">&quot;disable-infobars&quot;</span>)
firefox_options.add_argument(<span class="st">&quot;--disable-extensions&quot;</span>)
firefox_options.add_argument(<span class="st">&quot;--no-sandbox&quot;</span>)
firefox_options.add_argument(<span class="st">&quot;--disable-dev-shm-usage&quot;</span>)
firefox_options.binary_location <span class="op">=</span> <span class="st">&#39;/class/datamine/apps/firefox/firefox&#39;</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">driver <span class="op">=</span> webdriver.Firefox(options<span class="op">=</span>firefox_options, executable_path<span class="op">=</span><span class="st">&#39;/class/datamine/apps/geckodriver&#39;</span>)
url <span class="op">=</span> <span class="st">&#39;https://www.trulia.com&#39;</span>
driver.get(url)

search_input <span class="op">=</span> driver.find_element_by_id(<span class="st">&quot;banner-search&quot;</span>)
search_input.send_keys(<span class="st">&quot;West Lafayette, IN&quot;</span>)
search_input.send_keys(Keys.RETURN)
time.sleep(<span class="dv">3</span>)
<span class="bu">print</span>(driver.current_url)</code></pre></div>
</div>
<div id="use-your-code-from-question-1-to-test-out-the-following-queries" class="section level5">
<h5>2. Use your code from question (1) to test out the following queries:</h5>
<ul>
<li>West Lafayette, IN (City, State)</li>
<li>47906 (Zip)</li>
<li>4505 Kahala Ave, Honolulu, HI 96816 (Full address)</li>
</ul>
</div>
<div id="if-you-look-closely-you-will-see-that-there-are-patterns-in-the-url.-for-example-the-following-link-would-probably-bring-up-homes-in-crawfordsville-in-httpstrulia.comincrawfordsville.-with-that-being-said-if-you-only-had-a-zip-code-like-47933-it-wouldnt-be-easy-to-guess-httpswww.trulia.comincrawfordsville47933-hence-one-reason-why-the-search-bar-is-useful." class="section level5">
<h5>If you look closely you will see that there are patterns in the url. For example, the following link would probably bring up homes in Crawfordsville, IN: <a href="https://trulia.com/IN/Crawfordsville" class="uri">https://trulia.com/IN/Crawfordsville</a>. With that being said, if you only had a zip code, like 47933, it wouldn't be easy to guess <a href="https://www.trulia.com/IN/Crawfordsville/47933/" class="uri">https://www.trulia.com/IN/Crawfordsville/47933/</a>, hence, one reason why the search bar is useful.</h5>
</div>
<div id="if-you-used-xpath-expressions-to-complete-question-1-instead-use-a-different-method-to-find-the-input-element.-if-you-used-a-different-method-use-xpath-expressions-to-complete-question-1." class="section level5">
<h5>If you used xpath expressions to complete question (1), instead use a <a href="https://selenium-python.readthedocs.io/locating-elements.html#locating-elements">different method</a> to find the <code>input</code> element. If you used a different method, use xpath expressions to complete question (1).</h5>
<p><strong>Relevant topics:</strong> <a href="python.html#p-selenium">selenium</a>, <a href="data-formats.html#xml">xml</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-45" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">driver <span class="op">=</span> webdriver.Firefox(options<span class="op">=</span>firefox_options, executable_path<span class="op">=</span><span class="st">&#39;/class/datamine/apps/geckodriver&#39;</span>)
url <span class="op">=</span> <span class="st">&#39;https://www.trulia.com&#39;</span>
driver.get(url)

search_input <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//input[@id=&#39;banner-search&#39;]&quot;</span>)
search_input.send_keys(<span class="st">&quot;West Lafayette, IN&quot;</span>)
search_input.send_keys(Keys.RETURN)
time.sleep(<span class="dv">3</span>)
<span class="bu">print</span>(driver.current_url)</code></pre></div>
</div>
<div id="lets-call-the-page-after-a-citystate-or-zipcode-search-a-sales-page.-for-example" class="section level5">
<h5>3. Let's call the page after a city/state or zipcode search a &quot;sales page&quot;. For example:</h5>
<div class="figure">
<img src="images/trulia.png" />

</div>
</div>
<div id="use-requests-to-scrape-the-entire-page-httpswww.trulia.cominwest_lafayette47906.-use-lxml.html-to-parse-the-page-and-get-all-of-the-img-elements-that-make-up-the-house-pictures-on-the-left-side-of-the-website." class="section level5">
<h5>Use <code>requests</code> to scrape the entire page: <a href="https://www.trulia.com/IN/West_Lafayette/47906/" class="uri">https://www.trulia.com/IN/West_Lafayette/47906/</a>. Use <code>lxml.html</code> to parse the page and get all of the <code>img</code> elements that make up the house pictures on the left side of the website.</h5>
<p><strong>Important note:</strong> Make sure you are actually scraping what you think you are scraping! Try printing your html to confirm it has the content you think it should have:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> requests
response <span class="op">=</span> requests.get(...)
<span class="bu">print</span>(response.text)</code></pre></div>
<p><strong>Hint:</strong> Are you human? Depends. Sometimes if you add a header to your request, it won't ask you if you are human. Let's pretend we are Firefox:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> requests
my_headers <span class="op">=</span> {<span class="st">&#39;User-Agent&#39;</span>: <span class="st">&#39;Mozilla/5.0&#39;</span>}
response <span class="op">=</span> requests.get(..., headers<span class="op">=</span>my_headers)</code></pre></div>
</div>
<div id="okay-after-all-of-that-work-you-may-have-discovered-that-only-a-few-images-have-actually-been-scraped.-if-you-cycle-through-all-of-the-img-elements-and-try-to-print-the-value-of-the-src-attribute-this-will-be-clear" class="section level5">
<h5>Okay, after all of that work you may have discovered that only a few images have actually been scraped. If you cycle through all of the <code>img</code> elements and try to print the value of the <code>src</code> attribute, this will be clear:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> lxml.html
tree <span class="op">=</span> lxml.html.fromstring(response.text)
elements <span class="op">=</span> tree.xpath(<span class="st">&quot;//img&quot;</span>)
<span class="cf">for</span> element <span class="kw">in</span> elements:
    <span class="bu">print</span>(element.attrib.get(<span class="st">&quot;src&quot;</span>))</code></pre></div>
</div>
<div id="this-is-because-the-webpage-is-not-immediately-completely-loaded.-this-is-a-common-website-behavior-to-make-things-appear-faster.-if-you-pay-close-to-when-you-load-httpswww.trulia.comincrawfordsville47933-and-you-quickly-scroll-down-you-will-see-images-still-needing-to-finish-rendering-all-of-the-way-slowly.-what-we-need-to-do-to-fix-this-is-use-selenium-instead-of-lxml.html-to-behave-like-a-human-and-scroll-prior-to-scraping-the-page-try-using-the-following-code-to-slowly-scroll-down-the-page-before-finding-the-elements" class="section level5">
<h5>This is because the webpage is not immediately, <em>completely</em> loaded. This is a common website behavior to make things appear faster. If you pay close to when you load <a href="https://www.trulia.com/IN/Crawfordsville/47933/" class="uri">https://www.trulia.com/IN/Crawfordsville/47933/</a>, and you quickly scroll down, you will see images still needing to finish rendering all of the way, slowly. What we need to do to fix this, is use <code>selenium</code> (instead of <code>lxml.html</code>) to behave like a human and scroll prior to scraping the page! Try using the following code to slowly scroll down the page before finding the elements:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co"># driver setup and get the url</span>

<span class="co"># Needed to get the window size set right and scroll in headless mode</span>
myheight <span class="op">=</span> driver.execute_script(<span class="st">&#39;return document.body.scrollHeight&#39;</span>)
driver.set_window_size(<span class="dv">1080</span>,myheight<span class="op">+</span><span class="dv">100</span>)

<span class="kw">def</span> scroll(driver, scroll_point):  
    driver.execute_script(<span class="ss">f&#39;window.scrollTo(0, </span><span class="sc">{</span>scroll_point<span class="sc">}</span><span class="ss">);&#39;</span>)
    time.sleep(<span class="dv">5</span>) 
    
scroll(driver, myheight<span class="op">*</span><span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)
scroll(driver, myheight<span class="op">*</span><span class="dv">2</span><span class="op">/</span><span class="dv">4</span>)
scroll(driver, myheight<span class="op">*</span><span class="dv">3</span><span class="op">/</span><span class="dv">4</span>)
scroll(driver, myheight<span class="op">*</span><span class="dv">4</span><span class="op">/</span><span class="dv">4</span>)

<span class="co"># find_elements_by_*</span></code></pre></div>
<p><strong>Hint:</strong> At the time of writing there should be about 86 links to images of homes.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_v9iesfnc">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-selenium">selenium</a>, <a href="data-formats.html#xml">xml</a>, <a href="python.html#p-for-loops">loops</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-46" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">driver <span class="op">=</span> webdriver.Firefox(options<span class="op">=</span>firefox_options, executable_path<span class="op">=</span><span class="st">&#39;/Users/kamstut/Downloads/geckodriver&#39;</span>)
url <span class="op">=</span> <span class="st">&#39;https://www.trulia.com/IN/West_Lafayette/47906/&#39;</span>
driver.get(url)

<span class="co"># Needed to get the window size set right and scroll in headless mode</span>
height <span class="op">=</span> driver.execute_script(<span class="st">&#39;return document.body.scrollHeight&#39;</span>)
driver.set_window_size(<span class="dv">1080</span>,height<span class="op">+</span><span class="dv">100</span>)

<span class="kw">def</span> scroll(driver, scroll_point):  
    driver.execute_script(<span class="ss">f&#39;window.scrollTo(0, </span><span class="sc">{</span>scroll_point<span class="sc">}</span><span class="ss">);&#39;</span>)
    time.sleep(<span class="dv">5</span>) 
    
scroll(driver, height<span class="op">/</span><span class="dv">4</span>)
scroll(driver, height<span class="op">/</span><span class="dv">4</span><span class="op">*</span><span class="dv">2</span>)
scroll(driver, height<span class="op">/</span><span class="dv">4</span><span class="op">*</span><span class="dv">3</span>)
scroll(driver, height)

elements <span class="op">=</span> driver.find_elements_by_xpath(<span class="st">&quot;//picture/img&quot;</span>)
<span class="bu">print</span>(<span class="bu">len</span>(elements))
<span class="cf">for</span> e <span class="kw">in</span> elements:
    <span class="bu">print</span>(e.get_attribute(<span class="st">&quot;src&quot;</span>))</code></pre></div>
</div>
<div id="write-a-function-called-avg_house_cost-that-accepts-a-zip-code-as-an-argument-and-returns-the-average-cost-of-the-first-page-of-homes.-now-to-make-this-a-more-meaningful-statistic-filter-for-3-beds-and-then-find-the-average.-test-avg_house_cost-out-on-the-zip-code-47906-and-print-the-average-costs." class="section level5">
<h5>4. Write a function called <code>avg_house_cost</code> that accepts a zip code as an argument, and returns the average cost of the first page of homes. Now, to make this a more meaningful statistic, filter for &quot;3+&quot; beds and <em>then</em> find the average. Test <code>avg_house_cost</code> out on the zip code <code>47906</code> and print the average costs.</h5>
<p><strong>Important note:</strong> Use <code>selenium</code> to &quot;click&quot; on the &quot;3+ beds&quot; filter.</p>
<p><strong>Hint:</strong> If you get an error that tells you <code>button</code> is not clickable because it is covered by an <code>li</code> element, try clicking on the <code>li</code> element instead.</p>
<p><strong>Hint:</strong> You will want to wait a solid 10-15 seconds for the sales page to load before trying to select or click on anything.</p>
<p><strong>Hint:</strong> Your results may end up including prices for &quot;Homes Near &lt;ZIPCODE&gt;&quot;. This is okay. Even better if you manage to remove those results. If you <em>do</em> choose to remove those results, take a look at the <code>data-testid</code> attribute with value <code>search-result-list-container</code>. Perhaps only selecting the children of the first element will get the desired outcome.</p>
<p><strong>Hint:</strong> You can use the following code to remove the non-numeric text from a string, and then convert to an integer:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> re

<span class="bu">int</span>(re.sub(<span class="st">&quot;[^0-9]&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;removenon45454_numbers$&quot;</span>))</code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_ahm64jjz">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-selenium">selenium</a>, <a href="data-formats.html#xml">xml</a>, <a href="python.html#p-for-loops">loops</a>, <a href="#p-functions">functions</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-47" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">from</span> selenium.webdriver.support.ui <span class="im">import</span> WebDriverWait
<span class="im">import</span> re

<span class="kw">def</span> avg_house_cost(<span class="bu">zip</span>: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">float</span>:
    firefox_options <span class="op">=</span> Options()
    firefox_options.add_argument(<span class="st">&quot;window-size=1920,1080&quot;</span>)
    <span class="co"># firefox_options.add_argument(&quot;--headless&quot;) # Headless mode means no GUI</span>
    firefox_options.add_argument(<span class="st">&quot;start-maximized&quot;</span>)
    firefox_options.add_argument(<span class="st">&quot;disable-infobars&quot;</span>)
    firefox_options.add_argument(<span class="st">&quot;--disable-extensions&quot;</span>)
    firefox_options.add_argument(<span class="st">&quot;--no-sandbox&quot;</span>)
    firefox_options.add_argument(<span class="st">&quot;--disable-dev-shm-usage&quot;</span>)
    firefox_options.binary_location <span class="op">=</span> <span class="st">&#39;/Applications/Firefox.app/Contents/MacOS/firefox&#39;</span>
    
    driver <span class="op">=</span> webdriver.Firefox(options<span class="op">=</span>firefox_options, executable_path<span class="op">=</span><span class="st">&#39;/Users/kamstut/Downloads/geckodriver&#39;</span>)
    url <span class="op">=</span> <span class="st">&#39;https://www.trulia.com/&#39;</span>
    driver.get(url)
    
    search_input <span class="op">=</span> driver.find_element_by_id(<span class="st">&quot;banner-search&quot;</span>)
    search_input.send_keys(<span class="bu">zip</span>)
    search_input.send_keys(Keys.RETURN)
    time.sleep(<span class="dv">10</span>)
    
    allbed_button <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//button[@data-testid=&#39;srp-xl-bedrooms-filter-button&#39;]/ancestor::li&quot;</span>)
    allbed_button.click()
    time.sleep(<span class="dv">2</span>)
    
    bed_button <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//button[contains(text(), &#39;3+&#39;)]&quot;</span>)
    bed_button.click()
    time.sleep(<span class="dv">3</span>)
    
    price_elements <span class="op">=</span> driver.find_elements_by_xpath(<span class="st">&quot;(//div[@data-testid=&#39;search-result-list-container&#39;])[1]//div[@data-testid=&#39;property-price&#39;]&quot;</span>)
    prices <span class="op">=</span> [<span class="bu">int</span>(re.sub(<span class="st">&quot;[^0-9]&quot;</span>, <span class="st">&quot;&quot;</span>, e.text)) <span class="cf">for</span> e <span class="kw">in</span> price_elements]
    
    driver.quit()
    
    <span class="cf">return</span> <span class="bu">sum</span>(prices)<span class="op">/</span><span class="bu">len</span>(prices)
    
avg_house_cost(<span class="st">&#39;47906&#39;</span>)</code></pre></div>
</div>
<div id="get-creative.-either-add-an-interesting-feature-to-your-function-from-4-or-use-matplotlib-to-generate-some-sort-of-accompanying-graphic-with-your-output.-make-sure-to-explain-what-your-additions-do." class="section level5">
<h5>5. Get creative. Either add an interesting feature to your function from (4), or use <code>matplotlib</code> to generate some sort of accompanying graphic with your output. Make sure to explain what your additions do.</h5>
<p><strong>Relevant topics:</strong> <a href="python.html#p-selenium">selenium</a>, <a href="data-formats.html#xml">xml</a>, <a href="python.html#p-for-loops">loops</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-48" class="section level5">
<h5>Solution</h5>
<div class="solution">
<p>
Could be anything.
</p>
</div>
<hr />
</div>
</div>
</div>
<div id="p04-290" class="section level3">
<h3>Project 4</h3>
<hr />
<p><strong>Motivation:</strong> In this project we will continue to hone your web scraping skills, introduce you to some &quot;gotchas&quot;, and give you a little bit of exposure to a powerful tool called cron.</p>
<p><strong>Context:</strong> We are in the second to last project focused on web scraping. This project will introduce some supplementary tools that work well with web scraping: cron, sending emails from Python, etc.</p>
<p><strong>Scope:</strong> python, web scraping, selenium, cron</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Review and summarize the differences between XML and HTML/CSV.
</li>
<li>
Use the requests package to scrape a web page.
</li>
<li>
Use the lxml package to filter and parse data from a scraped web page.
</li>
<li>
Use the beautifulsoup4 package to filter and parse data from a scraped web page.
</li>
<li>
Use selenium to interact with a browser in order to get a web page to a desired state for scraping.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="questions-16" class="section level4">
<h4>Questions</h4>
<div id="check-out-the-following-website-httpsproject4.tdm.wiki" class="section level5">
<h5>1. Check out the following website: <a href="https://project4.tdm.wiki" class="uri">https://project4.tdm.wiki</a></h5>
</div>
<div id="use-selenium-to-scrape-and-print-the-6-colors-of-pants-offered." class="section level5">
<h5>Use <code>selenium</code> to scrape and print the 6 colors of pants offered.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_j3ik06bo">Click here for video for Question 1</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_tr8qvwn3">Here is a video about the new feature to reset your RStudio session if you make a big mistake or if your session is very slow</a></p>
<p><strong>Hint:</strong> You <em>may</em> have to interact with the webpage for certain elements to render.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-scraping">scraping</a>, <a href="python.html#p-selenium">selenium</a>, <a href="python.html#p-selenium-example01">example clicking a button</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-49" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">from</span> selenium <span class="im">import</span> webdriver
<span class="im">from</span> selenium.webdriver.common.keys <span class="im">import</span> Keys
<span class="im">from</span> selenium.webdriver.firefox.options <span class="im">import</span> Options
<span class="im">from</span> selenium.common.exceptions <span class="im">import</span> NoSuchElementException

<span class="im">import</span> time</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">driver.get(<span class="st">&quot;https://project4.tdm.wiki/&quot;</span>)

elements <span class="op">=</span> driver.find_elements_by_xpath(<span class="st">&quot;//span[@class=&#39;ui-component-card--color-amount&#39;]&quot;</span>)
<span class="cf">for</span> element <span class="kw">in</span> elements:
    <span class="bu">print</span>(element.text)

<span class="co"># click the &quot;wild colors&quot; button</span>
label <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//label[@for=&#39;ui-component-toggle__wild&#39;]&quot;</span>)
label.click()

elements <span class="op">=</span> driver.find_elements_by_xpath(<span class="st">&quot;//span[@class=&#39;ui-component-card--color-amount&#39;]&quot;</span>)
<span class="cf">for</span> element <span class="kw">in</span> elements:
    <span class="bu">print</span>(element.text)
    
driver.quit()</code></pre></div>
</div>
<div id="websites-are-updated-frequently.-you-can-imagine-a-scenario-where-a-change-in-a-website-is-a-sign-that-there-is-more-data-available-or-that-something-of-note-has-happened.-this-is-a-fake-website-designed-to-help-students-emulate-real-changes-to-a-website.-specifically-there-is-one-part-of-the-website-that-has-two-possible-states-lets-say-state-a-and-state-b.-upon-refreshing-the-website-or-scraping-the-website-again-there-is-an-x-chance-that-the-website-will-be-in-state-a-and-a-1-x-chance-the-website-will-be-in-state-b." class="section level5">
<h5>2. Websites are updated frequently. You can imagine a scenario where a change in a website is a sign that there is more data available, or that something of note has happened. This is a fake website designed to help students emulate real changes to a website. Specifically, there is one part of the website that has two possible states (let's say, state <code>A</code> and state <code>B</code>). Upon refreshing the website, or scraping the website again, there is an <span class="math inline">\(x\%\)</span> chance that the website will be in state <code>A</code> and a <span class="math inline">\(1-x\%\)</span> chance the website will be in state <code>B</code>.</h5>
</div>
<div id="describe-the-two-states-the-thing-element-or-set-of-elements-that-changes-as-you-refresh-the-page-and-scrape-the-website-enough-to-estimate-x." class="section level5">
<h5>Describe the two states (the thing (element or set of elements) that changes as you refresh the page), and scrape the website enough to estimate <span class="math inline">\(x\)</span>.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_2zaiodzi">Click here for video for Questions 2 and 3</a></p>
<p><strong>Hint:</strong> You <em>will</em> need to interact with the website to &quot;see&quot; the change.</p>
<p><strong>Hint:</strong> Since we are just asking about a state, and not any specific element, you could use the <code>page_source</code> attribute of the <code>selenium</code> driver to scrape the entire page instead of trying to use xpath expressions to find a specific element.</p>
<p><strong>Hint:</strong> Your estimate of <span class="math inline">\(x\)</span> does not need to be perfect.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-scraping">scraping</a>, <a href="python.html#p-selenium">selenium</a>, <a href="python.html#p-selenium-example01">example clicking a button</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
What state <code>A</code> and <code>B</code> represent.
</li>
<li>
An estimate for <code>x</code>.
</li>
</ul>
</div>
</div>
<div id="solution-50" class="section level5">
<h5>Solution</h5>
<div class="solution">
<p>
25% in stock 75% out of stock -- anything remotely close give full credit
</p>
</div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="co"># The state of the Chartreuse pants, sold out (A) or in stock (B)</span>
driver <span class="op">=</span> webdriver.Firefox(options<span class="op">=</span>firefox_options, executable_path<span class="op">=</span><span class="st">&#39;/class/datamine/apps/geckodriver&#39;</span>)
driver.get(<span class="st">&quot;https://project4.tdm.wiki/&quot;</span>)

<span class="co"># click the &quot;wild colors&quot; button</span>
label <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//label[@for=&#39;ui-component-toggle__wild&#39;]&quot;</span>)
label.click()

stateA <span class="op">=</span> driver.page_source
stateAct <span class="op">=</span> <span class="dv">0</span>
stateBct <span class="op">=</span> <span class="dv">0</span>
<span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):
    driver <span class="op">=</span> webdriver.Firefox(options<span class="op">=</span>firefox_options, executable_path<span class="op">=</span><span class="st">&#39;/class/datamine/apps/geckodriver&#39;</span>)
    driver.get(<span class="st">&quot;https://project4.tdm.wiki/&quot;</span>)

    <span class="co"># click the &quot;wild colors&quot; button</span>
    label <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//label[@for=&#39;ui-component-toggle__wild&#39;]&quot;</span>)
    label.click()
    
    <span class="cf">if</span> driver.page_source <span class="op">==</span> stateA:
        stateAct <span class="op">+=</span> <span class="dv">1</span>
    <span class="cf">else</span>:
        stateBct <span class="op">+=</span> <span class="dv">1</span>

    driver.quit()

<span class="bu">print</span>(<span class="ss">f&quot;State A: </span><span class="sc">{</span>stateAct<span class="sc">}</span><span class="ss">&quot;</span>)
<span class="bu">print</span>(<span class="ss">f&quot;State B: </span><span class="sc">{</span>stateBct<span class="sc">}</span><span class="ss">&quot;</span>)</code></pre></div>
</div>
<div id="dig-into-the-changing-thing-from-question-2.-what-specifically-is-changing-use-selenium-and-xpath-expressions-to-scrape-and-print-the-content.-what-are-the-two-possible-values-for-the-content" class="section level5">
<h5>3. Dig into the changing &quot;thing&quot; from question (2). What specifically is changing? Use selenium and xpath expressions to scrape and print the content. What are the two possible values for the content?</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_2zaiodzi">Click here for video (same as above) for Questions 2 and 3</a></p>
<p><strong>Hint:</strong> Due to the changes that occur when a button is clicked, I'd highly advice you to use the <code>data-color</code> attribute in your xpath expression instead of <code>contains(text(), 'blahblah')</code>.</p>
<p><strong>Hint:</strong> <code>parent::</code> and <code>following-sibling::</code> may be useful <a href="https://www.w3schools.com/xml/xpath_axes.asp">xpath axes</a> to use.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-scraping">scraping</a>, <a href="python.html#p-selenium">selenium</a>, <a href="python.html#p-selenium-example01">example using <code>following-sibling::</code></a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-51" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="co"># The state of the Chartreuse pants, sold out (A) or in stock (B)</span>
driver <span class="op">=</span> webdriver.Firefox(options<span class="op">=</span>firefox_options, executable_path<span class="op">=</span><span class="st">&#39;/class/datamine/apps/geckodriver&#39;</span>)
driver.get(<span class="st">&quot;https://project4.tdm.wiki/&quot;</span>)

<span class="co"># click the &quot;wild colors&quot; button</span>
label <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//label[@for=&#39;ui-component-toggle__wild&#39;]&quot;</span>)
label.click()

element <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//span[@data-color=&#39;Chartreuse&#39;]/parent::div/following-sibling::div/span&quot;</span>)
<span class="bu">print</span>(element.text)

driver.quit()</code></pre></div>
</div>
<div id="the-following-code-allows-you-to-send-an-email-using-python-from-your-purdue-email-account.-replace-the-username-and-password-with-your-own-information-and-send-a-test-email-to-yourself-to-ensure-that-it-works." class="section level5">
<h5>4. The following code allows you to send an email using Python from your Purdue email account. Replace the username and password with your own information and send a test email to yourself to ensure that it works.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_dt6j3sov">Click here for video for Questions 4 and 5</a></p>
<p><strong>Important note:</strong> Do <strong>NOT</strong> include your password in your homework submission. Any time you need to type your password in you final submission just put something like &quot;SUPERSECRETPASSWORD&quot; or &quot;MYPASSWORD&quot;.</p>
<p><strong>Hint:</strong> To include an image (or screenshot) in RMarkdown, try <code>![](./my_image.png)</code> where <code>my_image.png</code> is inside the same folder as your <code>.Rmd</code> file.</p>
<p><strong>Hint:</strong> The spacing and tabs near the <code>message</code> variable are very important. Make sure to copy the code exactly. Otherwise, your subject may not end up in the subject of your email, or the email could end up being blank when sent.</p>
<p><strong>Hint:</strong> Questions 4 and 5 were inspired by examples and borrowed from the code found at the <a href="https://realpython.com/python-send-email/">Real Python</a> website.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> send_purdue_email(my_purdue_email, my_password, to, my_subject, my_message):
  <span class="im">import</span> smtplib, ssl
  <span class="im">from</span> email.mime.text <span class="im">import</span> MIMEText
  <span class="im">from</span> email.mime.multipart <span class="im">import</span> MIMEMultipart
  
  message <span class="op">=</span> MIMEMultipart(<span class="st">&quot;alternative&quot;</span>)
  message[<span class="st">&quot;Subject&quot;</span>] <span class="op">=</span> my_subject
  message[<span class="st">&quot;From&quot;</span>] <span class="op">=</span> my_purdue_email
  message[<span class="st">&quot;To&quot;</span>] <span class="op">=</span> to
  
  <span class="co"># Create the plain-text and HTML version of your message</span>
  text <span class="op">=</span> <span class="ss">f&#39;&#39;&#39;\</span>
<span class="ss">Subject: </span><span class="sc">{</span>my_subject<span class="sc">}</span>
<span class="ss">To: </span><span class="sc">{to}</span>
<span class="ss">From: </span><span class="sc">{</span>my_purdue_email<span class="sc">}</span>
<span class="ss">  </span>
<span class="sc">{</span>my_message<span class="sc">}</span><span class="ss">&#39;&#39;&#39;</span>
  html <span class="op">=</span> <span class="ss">f&#39;&#39;&#39;\</span>
<span class="ss">&lt;html&gt;</span>
<span class="ss">  &lt;body&gt;</span>
<span class="ss">    </span><span class="sc">{</span>my_message<span class="sc">}</span>
<span class="ss">  &lt;/body&gt;</span>
<span class="ss">&lt;/html&gt;</span>
<span class="ss">&#39;&#39;&#39;</span>
  <span class="co"># Turn these into plain/html MIMEText objects</span>
  part1 <span class="op">=</span> MIMEText(text, <span class="st">&quot;plain&quot;</span>)
  part2 <span class="op">=</span> MIMEText(html, <span class="st">&quot;html&quot;</span>)
  
  <span class="co"># Add HTML/plain-text parts to MIMEMultipart message</span>
  <span class="co"># The email client will try to render the last part first</span>
  message.attach(part1)
  message.attach(part2)
  
  context <span class="op">=</span> ssl.create_default_context()
  <span class="cf">with</span> smtplib.SMTP(<span class="st">&quot;smtp.purdue.edu&quot;</span>, <span class="dv">587</span>) <span class="im">as</span> server:
    server.ehlo()  <span class="co"># Can be omitted</span>
    server.starttls(context<span class="op">=</span>context)
    server.ehlo()  <span class="co"># Can be omitted</span>
    server.login(my_purdue_email, my_password)
    server.sendmail(my_purdue_email, to, message.as_string())
        
<span class="co"># this sends an email from kamstut@purdue.edu to mdw@purdue.edu</span>
<span class="co"># replace supersecretpassword with your own password</span>
<span class="co"># do NOT include your password in your homework submission.</span>
send_purdue_email(<span class="st">&quot;kamstut@purdue.edu&quot;</span>, <span class="st">&quot;supersecretpassword&quot;</span>, <span class="st">&quot;mdw@purdue.edu&quot;</span>, <span class="st">&quot;put subject here&quot;</span>, <span class="st">&quot;put message body here&quot;</span>)</code></pre></div>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-functions">functions</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
Screenshot showing your received the email.
</li>
</ul>
</div>
</div>
<div id="solution-52" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">import</span> smtplib, ssl

port <span class="op">=</span> <span class="dv">587</span>  <span class="co"># For starttls</span>
smtp_server <span class="op">=</span> <span class="st">&quot;smtp.purdue.edu&quot;</span>
sender_email <span class="op">=</span> <span class="st">&quot;kamstut@purdue.edu&quot;</span>
receiver_email <span class="op">=</span> <span class="st">&quot;kamstut@purdue.edu&quot;</span>
password <span class="op">=</span> <span class="st">&quot;MYPASSWORD&quot;</span>
message <span class="op">=</span> <span class="st">&quot;&quot;&quot;\</span>
<span class="st">Subject: Hi there</span>

<span class="st">This message is sent from Python.&quot;&quot;&quot;</span>

context <span class="op">=</span> ssl.create_default_context()
<span class="cf">with</span> smtplib.SMTP(smtp_server, port) <span class="im">as</span> server:
    server.ehlo()  <span class="co"># Can be omitted</span>
    server.starttls(context<span class="op">=</span>context)
    server.ehlo()  <span class="co"># Can be omitted</span>
    server.login(sender_email, password)
    server.sendmail(sender_email, receiver_email, message)</code></pre></div>
</div>
<div id="the-following-is-the-content-of-a-new-python-script-called-is_in_stock.py" class="section level5">
<h5>5. The following is the content of a new Python script called <code>is_in_stock.py</code>:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> send_purdue_email(my_purdue_email, my_password, to, my_subject, my_message):
  <span class="im">import</span> smtplib, ssl
  <span class="im">from</span> email.mime.text <span class="im">import</span> MIMEText
  <span class="im">from</span> email.mime.multipart <span class="im">import</span> MIMEMultipart
  
  message <span class="op">=</span> MIMEMultipart(<span class="st">&quot;alternative&quot;</span>)
  message[<span class="st">&quot;Subject&quot;</span>] <span class="op">=</span> my_subject
  message[<span class="st">&quot;From&quot;</span>] <span class="op">=</span> my_purdue_email
  message[<span class="st">&quot;To&quot;</span>] <span class="op">=</span> to
  
  <span class="co"># Create the plain-text and HTML version of your message</span>
  text <span class="op">=</span> <span class="ss">f&#39;&#39;&#39;\</span>
<span class="ss">Subject: </span><span class="sc">{</span>my_subject<span class="sc">}</span>
<span class="ss">To: </span><span class="sc">{to}</span>
<span class="ss">From: </span><span class="sc">{</span>my_purdue_email<span class="sc">}</span>
<span class="ss">  </span>
<span class="sc">{</span>my_message<span class="sc">}</span><span class="ss">&#39;&#39;&#39;</span>
  html <span class="op">=</span> <span class="ss">f&#39;&#39;&#39;\</span>
<span class="ss">&lt;html&gt;</span>
<span class="ss">  &lt;body&gt;</span>
<span class="ss">    </span><span class="sc">{</span>my_message<span class="sc">}</span>
<span class="ss">  &lt;/body&gt;</span>
<span class="ss">&lt;/html&gt;</span>
<span class="ss">&#39;&#39;&#39;</span>
  <span class="co"># Turn these into plain/html MIMEText objects</span>
  part1 <span class="op">=</span> MIMEText(text, <span class="st">&quot;plain&quot;</span>)
  part2 <span class="op">=</span> MIMEText(html, <span class="st">&quot;html&quot;</span>)
  
  <span class="co"># Add HTML/plain-text parts to MIMEMultipart message</span>
  <span class="co"># The email client will try to render the last part first</span>
  message.attach(part1)
  message.attach(part2)
  
  context <span class="op">=</span> ssl.create_default_context()
  <span class="cf">with</span> smtplib.SMTP(<span class="st">&quot;smtp.purdue.edu&quot;</span>, <span class="dv">587</span>) <span class="im">as</span> server:
    server.ehlo()  <span class="co"># Can be omitted</span>
    server.starttls(context<span class="op">=</span>context)
    server.ehlo()  <span class="co"># Can be omitted</span>
    server.login(my_purdue_email, my_password)
    server.sendmail(my_purdue_email, to, message.as_string())
        
<span class="kw">def</span> main():
    <span class="co"># scrape element from question 3</span>
    
    <span class="co"># does the text indicate it is in stock?</span>
    
    <span class="co"># if yes, send email to yourself telling you it is in stock.</span>
    
    <span class="co"># otherwise, gracefully end script using the &quot;pass&quot; Python keyword</span>

<span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:
    main()</code></pre></div>
</div>
<div id="first-make-a-copy-of-the-script-in-your-home-directory" class="section level5">
<h5>First, make a copy of the script in your <code>$HOME</code> directory:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cp</span> /class/datamine/data/scraping/is_in_stock.py <span class="va">$HOME</span>/is_in_stock.py</code></pre></div>
</div>
<div id="if-you-now-look-in-the-files-tab-in-the-lower-right-hand-corner-of-rstudio-and-click-the-refresh-button-you-should-see-the-file-is_in_stock.py.-you-can-open-and-modify-this-file-directly-in-rstudio.-before-you-do-so-however-change-the-permissions-of-the-homeis_in_stock.py-script-so-only-you-can-read-write-and-execute-it" class="section level5">
<h5>If you now look in the &quot;Files&quot; tab in the lower right hand corner of RStudio, and click the refresh button, you should see the file <code>is_in_stock.py</code>. You can open and modify this file directly in RStudio. Before you do so, however, change the permissions of the <code>$HOME/is_in_stock.py</code> script so only YOU can read, write, and execute it:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">chmod</span> 700 <span class="va">$HOME</span>/is_in_stock.py</code></pre></div>
</div>
<div id="the-script-should-now-appear-in-rstudio-in-your-home-directory-with-the-correct-permissions.-open-the-script-in-rstudio-and-fill-in-the-main-function-as-indicated-by-the-comments.-we-want-the-script-to-scrape-to-see-whether-the-pants-from-question-3-are-in-stock-or-not." class="section level5">
<h5>The script should now appear in RStudio, in your home directory, with the correct permissions. Open the script (in RStudio) and fill in the <code>main</code> function as indicated by the comments. We want the script to scrape to see whether the pants from question 3 are in stock or not.</h5>
</div>
<div id="a-cron-job-is-a-task-that-runs-at-a-certain-interval.-create-a-cron-job-that-runs-your-script-classdatamineappspythonf2020-s2021envbinpython-homeis_in_stock.py-every-5-minutes.-wait-10-15-minutes-and-verify-that-it-is-working-properly.-the-long-path-classdatamineappspythonf2020-s2021envbinpython-simply-makes-sure-that-our-script-is-run-with-access-to-all-of-the-packages-in-our-course-environment.-homeis_in_stock.py-is-the-path-to-your-script-home-expands-or-transforms-to-homemy_purdue_alias." class="section level5">
<h5>A cron job is a task that runs at a certain interval. Create a cron job that runs your script, <code>/class/datamine/apps/python/f2020-s2021/env/bin/python $HOME/is_in_stock.py</code> every 5 minutes. Wait 10-15 minutes and verify that it is working properly. The long path, <code>/class/datamine/apps/python/f2020-s2021/env/bin/python</code> simply makes sure that our script is run with access to all of the packages in our course environment. <code>$HOME/is_in_stock.py</code> is the path to your script (<code>$HOME</code> expands or transforms to <code>/home/&lt;my_purdue_alias&gt;</code>.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_dt6j3sov">Click here for video (same as above) for Questions 4 and 5</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_xz9df91y">Click here for a longer video about setting up the cronjob in Question 5</a></p>
<p><strong>Hint:</strong> If you struggle to use the text editor used with the <code>crontab -e</code> command, be sure to continue reading the <a href="unix.html#cron">cron section</a> of the book. We highlight another method that may be easier.</p>
<p><strong>Hint:</strong> Don't forget to copy your import statements from question (3) as well.</p>
<p><strong>Important note:</strong> Once you are finished with the project, if you no longer wish to receive emails every so often, follow the instructions <a href="unix.html#how-to-delete-cron-job">here</a> to remove the cron job.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#cron">cron</a>, <a href="https://crontab.guru">crontab guru</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
The content of your cron job in a bash code chunk.
</li>
<li>
The content of your <code>is_in_stock.py</code> script.
</li>
</ul>
</div>
</div>
<div id="solution-53" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash solution"><code class="sourceCode bash"><span class="ex">*/5</span> * * * * /home/kamstut/is_in_stock.py</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="co">#!/usr/bin/env python3</span>

<span class="kw">def</span> send_purdue_email(my_purdue_email, my_password, to):
    <span class="im">import</span> smtplib, ssl
    
    port <span class="op">=</span> <span class="dv">587</span>  <span class="co"># For starttls</span>
    smtp_server <span class="op">=</span> <span class="st">&quot;smtp.purdue.edu&quot;</span>
    sender_email <span class="op">=</span> my_purdue_email
    receiver_email <span class="op">=</span> to
    password <span class="op">=</span> my_password
    message <span class="op">=</span> <span class="st">&quot;&quot;&quot;\</span>
<span class="st">    Subject: Test subject</span>
<span class="st">    </span>
<span class="st">    This is the email body.&quot;&quot;&quot;</span>
    
    context <span class="op">=</span> ssl.create_default_context()
    <span class="cf">with</span> smtplib.SMTP(smtp_server, port) <span class="im">as</span> server:
        server.ehlo()  <span class="co"># Can be omitted</span>
        server.starttls(context<span class="op">=</span>context)
        server.ehlo()  <span class="co"># Can be omitted</span>
        server.login(sender_email, password)
        server.sendmail(sender_email, receiver_email, message)
        
<span class="kw">def</span> main():
    <span class="co"># scrape element from question 3</span>

    <span class="co"># The state of the Chartreuse pants, sold out (A) or in stock (B)</span>
    driver <span class="op">=</span> webdriver.Firefox(options<span class="op">=</span>firefox_options, executable_path<span class="op">=</span><span class="st">&#39;/class/datamine/apps/geckodriver&#39;</span>)
    driver.get(<span class="st">&quot;https://project4.tdm.wiki/&quot;</span>)

    <span class="co"># click the &quot;wild colors&quot; button</span>
    label <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//label[@for=&#39;ui-component-toggle__wild&#39;]&quot;</span>)
    label.click()

    element <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//span[@data-color=&#39;Chartreuse&#39;]/parent::div/following-sibling::div/span&quot;</span>)
    
    <span class="co"># does the text indicate it is in stock?</span>
    <span class="cf">if</span> element.text <span class="op">==</span> <span class="st">&quot;In stock&quot;</span>:
    
        <span class="co"># if yes, send email to yourself telling you it is in stock.</span>
        send_purdue_email(<span class="st">&quot;kamstut@purdue.edu&quot;</span>, <span class="st">&quot;MYPASSWORD&quot;</span>, <span class="st">&quot;kamstut@purdue.edu&quot;</span>)
    
    <span class="co"># otherwise, gracefully end script using the &quot;pass&quot; Python keyword</span>
    <span class="cf">else</span>:
        <span class="cf">pass</span>

<span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:
    main()</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="p05-290" class="section level3">
<h3>Project 5</h3>
<hr />
<p><strong>Motivation:</strong> One of the best things about learning to scrape data is the many applications of the skill that may pop into your mind. In this project, we want to give you some flexibility to explore your own ideas, but at the same time, add a couple of important tools to your tool set. We hope that you've learned a lot in this series, and can think of creative ways to utilize your new skills.</p>
<p><strong>Context:</strong> This is the last project in a series focused on scraping data. We have created a couple of very common scenarios that can be problematic when first learning to scrape data, and we want to show you how to get around them.</p>
<p><strong>Scope:</strong> python, web scraping, etc.</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Use the requests package to scrape a web page.
</li>
<li>
Use the lxml/selenium package to filter and parse data from a scraped web page.
</li>
<li>
Learn how to step around header-based filtering.
</li>
<li>
Learn how to handle rate limiting.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="questions-17" class="section level4">
<h4>Questions</h4>
<div id="it-is-not-uncommon-to-be-blocked-from-scraping-a-website.-there-are-a-variety-of-strategies-that-they-use-to-do-this-and-in-general-they-work-well.-in-general-if-a-company-wants-you-to-extract-information-from-their-website-they-will-make-an-api-application-programming-interface-available-for-you-to-use.-one-method-that-is-commonly-paired-with-other-methods-is-blocking-your-request-based-on-headers.-you-can-read-about-headers-here.-in-general-you-can-think-of-headers-as-some-extra-data-that-gives-the-server-or-client-context.-here-is-a-list-of-headers-and-some-more-explanation." class="section level5">
<h5>1. It is not uncommon to be blocked from scraping a website. There are a variety of strategies that they use to do this, and in general they work well. In general, if a company wants you to extract information from their website, they will make an API (application programming interface) available for you to use. One method (that is commonly paired with other methods) is blocking your request based on <em>headers</em>. You can read about headers <a href="https://developer.mozilla.org/en-US/docs/Glossary/Request_header">here</a>. In general, you can think of headers as some extra data that gives the server or client context. <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers">Here</a> is a list of headers, and some more explanation.</h5>
</div>
<div id="each-header-has-a-purpose.-one-common-header-is-called-the-user-agent-header.-a-user-agent-looks-something-like" class="section level5">
<h5>Each header has a purpose. One common header is called the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent">User-Agent header</a>. A User-Agent looks something like:</h5>
<pre><code>User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:86.0) Gecko/20100101 Firefox/86.0</code></pre>
</div>
<div id="you-can-see-headers-if-you-open-the-console-in-firefox-or-chrome-and-load-a-website.-it-will-look-something-like" class="section level5">
<h5>You can see headers if you open the console in Firefox or Chrome and load a website. It will look something like:</h5>
<div class="figure">
<img src="images/headers01.png" />

</div>
</div>
<div id="from-the-mozilla-link-this-header-is-a-string-that-lets-servers-and-network-peers-identify-the-application-operating-system-vendor-andor-version-of-the-requesting-user-agent.-basically-if-you-are-browsing-the-internet-with-a-common-browser-the-server-will-know-what-you-are-using.-in-the-provided-example-we-are-using-firefox-86-from-mozilla-on-a-mac-running-mac-os-10.16-with-an-intel-processor." class="section level5">
<h5>From the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent">mozilla link</a>, this header is a string that &quot;lets servers and network peers identify the application, operating system, vendor, and/or version of the requesting user agent.&quot; Basically, if you are browsing the internet with a common browser, the server will know what you are using. In the provided example, we are using Firefox 86 from Mozilla, on a Mac running Mac OS 10.16 with an Intel processor.</h5>
</div>
<div id="when-we-send-a-request-from-a-package-like-requests-in-python-here-is-what-the-headers-look-like" class="section level5">
<h5>When we send a request from a package like <code>requests</code> in Python, here is what the headers look like:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> requests

response <span class="op">=</span> requests.get(<span class="st">&quot;https://project5-headers.tdm.wiki&quot;</span>)
<span class="bu">print</span>(response.request.headers)</code></pre></div>
<pre><code>{&#39;User-Agent&#39;: &#39;python-requests/2.25.1&#39;, &#39;Accept-Encoding&#39;: &#39;gzip, deflate&#39;, &#39;Accept&#39;: &#39;*/*&#39;, &#39;Connection&#39;: &#39;keep-alive&#39;}</code></pre>
</div>
<div id="as-you-can-see-our-user-agent-is-python-requests2.25.1.-you-will-find-that-many-websites-block-requests-made-from-anything-such-user-agents.-one-such-website-is-httpsproject5-headers.tdm.wiki." class="section level5">
<h5>As you can see our User-Agent is <code>python-requests/2.25.1</code>. You will find that many websites block requests made from anything such user agents. One such website is: <a href="https://project5-headers.tdm.wiki" class="uri">https://project5-headers.tdm.wiki</a>.</h5>
</div>
<div id="scrape-httpsproject5-headers.tdm.wiki-from-scholar-and-explain-what-happens.-what-is-the-response-code-and-what-does-that-response-code-mean-can-you-ascertain-what-you-would-be-seeing-more-or-less-in-a-browser-based-on-the-text-of-the-response-the-actual-html-read-this-section-of-the-documentation-for-the-headers-package-and-attempt-to-trick-httpsproject5-headers.tdm.wiki-into-presenting-you-with-the-desired-information.-the-desired-information-should-look-something-like" class="section level5">
<h5>Scrape <a href="https://project5-headers.tdm.wiki" class="uri">https://project5-headers.tdm.wiki</a> from Scholar and explain what happens. What is the <a href="python.html#p-requests-response-code">response code</a>, and what does that response code mean? Can you ascertain what you would be seeing (more or less) in a browser based on the <a href="python.html#p-requests-example01">text of the response</a> (the actual HTML)? Read <a href="https://requests.readthedocs.io/en/master/user/quickstart/#custom-headers">this section of the documentation for the <code>headers</code> package</a>, and attempt to &quot;trick&quot; <a href="https://project5-headers.tdm.wiki" class="uri">https://project5-headers.tdm.wiki</a> into presenting you with the desired information. The desired information should look something like:</h5>
<pre><code>Hostname: c1de5faf1daa
IP: 127.0.0.1
IP: 172.18.0.4
RemoteAddr: 172.18.0.2:34520
GET / HTTP/1.1
Host: project5-headers.tdm.wiki
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:86.0) Gecko/20100101 Firefox/86.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Encoding: gzip
Accept-Language: en-US,en;q=0.5
Cdn-Loop: cloudflare
Cf-Connecting-Ip: 107.201.65.5
Cf-Ipcountry: US
Cf-Ray: 62289b90aa55f975-EWR
Cf-Request-Id: 084d3f8e740000f975e0038000000001
Cf-Visitor: {&quot;scheme&quot;:&quot;https&quot;}
Cookie: __cfduid=d9df5daa57fae5a4e425173aaaaacbfc91613136177
Dnt: 1
Sec-Gpc: 1
Upgrade-Insecure-Requests: 1
X-Forwarded-For: 123.123.123.123
X-Forwarded-Host: project5-headers.tdm.wiki
X-Forwarded-Port: 443
X-Forwarded-Proto: https
X-Forwarded-Server: 6afe64faffaf
X-Real-Ip: 123.123.123.123</code></pre>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_qg61j5iu">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-requests">requests</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Response code received (a number), and an explanation of what that HTTP response code means.
</li>
<li>
What you would (probably) be seeing in a browser if you were blocked.
</li>
<li>
Python code used to &quot;trick&quot; the website into being scraped.
</li>
<li>
The content of the successfully scraped site.
</li>
</ul>
</div>
</div>
<div id="solution-54" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">import</span> requests

response <span class="op">=</span> requests.get(<span class="st">&quot;https://project5-headers.tdm.wiki&quot;</span>)
<span class="bu">print</span>(response.status_code) <span class="co"># 403</span>

<span class="co"># 403 is an https response code that means the content is forbidden</span>

<span class="co"># based on the HTML it looks like we&#39;d be presented with a CAPTCHA</span>
<span class="bu">print</span>(response.text)

<span class="co"># to fix this, let&#39;s change our User-Agent header</span>
response <span class="op">=</span> requests.get(<span class="st">&quot;https://project5-headers.tdm.wiki&quot;</span>, headers<span class="op">=</span>{<span class="st">&quot;User-Agent&quot;</span>: <span class="st">&quot;anything&quot;</span>})
<span class="bu">print</span>(response.text)

<span class="co"># or even better, would be to &quot;fake&quot; a browser</span>
response <span class="op">=</span> requests.get(<span class="st">&quot;https://project5-headers.tdm.wiki&quot;</span>, headers<span class="op">=</span>{<span class="st">&quot;User-Agent&quot;</span>: <span class="st">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:86.0) Gecko/20100101 Firefox/86.0&quot;</span>})
<span class="bu">print</span>(response.text)</code></pre></div>
</div>
<div id="open-a-browser-and-navigate-to-httpsproject5-rate-limit.tdm.wiki.-while-at-first-glance-it-will-seem-identical-to-httpsproject5-headers.tdm.wiki-it-is-not.-httpsproject5-rate-limit.tdm.wiki-is-rate-limited-based-on-ip-address.-depending-on-when-you-are-completing-this-project-this-may-or-may-not-be-obvious.-if-you-refresh-your-browser-fast-enough-instead-of-receiving-a-bunch-of-information-you-will-receive-text-that-says-too-many-requests." class="section level5">
<h5>2. Open a browser and navigate to: <a href="https://project5-rate-limit.tdm.wiki/" class="uri">https://project5-rate-limit.tdm.wiki/</a>. While at first glance, it will seem identical to <a href="https://project5-headers.tdm.wiki/" class="uri">https://project5-headers.tdm.wiki/</a>, it is not. <a href="https://project5-rate-limit.tdm.wiki/" class="uri">https://project5-rate-limit.tdm.wiki/</a> is rate limited based on IP address. Depending on when you are completing this project, this may or may not be obvious. If you refresh your browser fast enough, instead of receiving a bunch of information, you will receive text that says &quot;Too Many Requests&quot;.</h5>
</div>
<div id="the-following-function-tries-to-scrape-the-cf-request-id-header-which-will-have-a-unique-value-each-request" class="section level5">
<h5>The following function tries to scrape the <code>Cf-Request-Id</code> header which will have a unique value each request:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> requests
<span class="im">import</span> lxml.html

<span class="kw">def</span> scrape_cf_request_id(url):
    resp <span class="op">=</span> requests.get(url)
    tree <span class="op">=</span> lxml.html.fromstring(resp.text)
    content <span class="op">=</span> tree.xpath(<span class="st">&quot;//p&quot;</span>)[<span class="dv">0</span>].text.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)
    cfid <span class="op">=</span> [l <span class="cf">for</span> l <span class="kw">in</span> content <span class="cf">if</span> <span class="st">&#39;Cf-Request-Id&#39;</span> <span class="kw">in</span> l][<span class="dv">0</span>].split()[<span class="dv">1</span>]
    <span class="cf">return</span> cfid</code></pre></div>
</div>
<div id="you-can-test-it-out" class="section level5">
<h5>You can test it out:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">scrape_cf_request_id(<span class="st">&quot;https://project5-rate-limit.tdm.wiki&quot;</span>)</code></pre></div>
</div>
<div id="write-code-to-scrape-10-unique-cf-request-ids-in-a-loop-and-save-them-to-a-list-called-my_ids.-what-happens-when-you-run-the-code-this-is-caused-by-our-expected-text-not-being-present.-instead-text-with-too-many-requests-is.-while-normally-this-error-would-be-something-that-makes-more-sense-like-an-httperror-or-a-timeout-exception-it-could-be-anything-depending-on-your-code." class="section level5">
<h5>Write code to scrape 10 unique <code>Cf-Request-Id</code>s (in a loop), and save them to a list called <code>my_ids</code>. What happens when you run the code? This is caused by our expected text not being present. Instead text with &quot;Too Many Requests&quot; is. While normally this error would be something that makes more sense, like an HTTPError or a Timeout Exception, it <em>could</em> be anything, depending on your code.</h5>
</div>
<div id="one-solution-that-might-come-to-mind-is-to-wait-between-each-loop-using-time.sleep.-while-yes-this-may-work-it-is-not-a-robust-solution.-other-users-from-your-ip-address-may-count-towards-your-rate-limit-and-cause-your-function-to-fail-the-amount-of-sleep-time-may-change-dynamically-or-even-be-manually-adjusted-to-be-longer-etc.-the-best-way-to-handle-this-is-to-used-something-called-exponential-backoff." class="section level5">
<h5>One solution that might come to mind is to &quot;wait&quot; between each loop using <code>time.sleep()</code>. While yes, this may work, it is not a robust solution. Other users from your IP address may count towards your rate limit and cause your function to fail, the amount of sleep time may change dynamically, or even be manually adjusted to be longer, etc. The best way to handle this is to used something called exponential backoff.</h5>
</div>
<div id="in-a-nutshell-exponential-backoff-is-a-way-to-increase-the-wait-time-exponentially-until-an-acceptable-rate-is-found.-backoff-is-an-excellent-package-to-do-just-that.-backoff-upon-being-triggered-from-a-specified-error-or-exception-will-wait-to-try-again-until-a-certain-amount-of-time-has-passed.-upon-receving-the-same-error-or-exception-the-time-to-wait-will-increase-exponentially.-use-backoff-to-modify-the-provided-scrape_cf_request_id-function-to-use-exponential-backoff-when-the-we-alluded-to-occurs.-test-out-the-modified-function-in-a-loop-and-print-the-resulting-10-cf-request-ids." class="section level5">
<h5>In a nutshell, exponential backoff is a way to increase the wait time (exponentially) until an acceptable rate is found. <a href="https://pypi.org/project/backoff/"><code>backoff</code></a> is an excellent package to do just that. <code>backoff</code>, upon being triggered from a specified error or exception, will wait to &quot;try again&quot; until a certain amount of time has passed. Upon receving the same error or exception, the time to wait will increase exponentially. Use <code>backoff</code> to modify the provided <code>scrape_cf_request_id</code> function to use exponential backoff when the we alluded to occurs. Test out the modified function in a loop and print the resulting 10 <code>Cf-Request-Id</code>s.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_p0ioevlc">Click here for video</a></p>
<p><strong>Note:</strong> <code>backoff</code> utilizes decorators. For those interested in learning about decorators, <a href="https://realpython.com/primer-on-python-decorators/">this</a> is an excellent article.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-requests">requests</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
What happens when you run the function 10 times in a row?
</li>
<li>
Fixed code that will work regardless of the rate limiting.
</li>
<li>
10 unique <code>Cf-Request-Id</code>s printed.
</li>
</ul>
</div>
</div>
<div id="solution-55" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">import</span> requests
<span class="im">import</span> lxml.html

<span class="co"># function to scrape the Cf-Request-Id</span>
<span class="kw">def</span> scrape_cf_request_id(url):
    resp <span class="op">=</span> requests.get(url)
    tree <span class="op">=</span> lxml.html.fromstring(resp.text)
    content <span class="op">=</span> tree.xpath(<span class="st">&quot;//p&quot;</span>)[<span class="dv">0</span>].text.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)
    cfid <span class="op">=</span> [l <span class="cf">for</span> l <span class="kw">in</span> content <span class="cf">if</span> <span class="st">&#39;Cf-Request-Id&#39;</span> <span class="kw">in</span> l][<span class="dv">0</span>].split()[<span class="dv">1</span>]
    <span class="bu">print</span>(cfid)
    
my_list <span class="op">=</span> []
<span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):
    my_list.append(scrape_cf_request_id(<span class="st">&quot;https://project5-rate-limit.tdm.wiki&quot;</span>))</code></pre></div>
<div class="solution">
<p>
This will cause an IndexError because the expected content containing the <code>Cf-Request-Id</code> is not present, instead &quot;Too Many Requests&quot; is.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">import</span> backoff
<span class="im">from</span> lxml <span class="im">import</span> etree

<span class="at">@backoff.on_exception</span>(backoff.expo,
                      <span class="pp">IndexError</span>)
<span class="kw">def</span> scrape_cf_request_id(url):
    resp <span class="op">=</span> requests.get(url, headers<span class="op">=</span>{<span class="st">&quot;User-Agent&quot;</span>: <span class="st">&quot;something&quot;</span>})
    tree <span class="op">=</span> lxml.html.fromstring(resp.text)
    content <span class="op">=</span> tree.xpath(<span class="st">&quot;//p&quot;</span>)[<span class="dv">0</span>].text.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)
    cfid <span class="op">=</span> [l <span class="cf">for</span> l <span class="kw">in</span> content <span class="cf">if</span> <span class="st">&#39;Cf-Request-Id&#39;</span> <span class="kw">in</span> l][<span class="dv">0</span>].split()[<span class="dv">1</span>]
    <span class="bu">print</span>(cfid)

my_list <span class="op">=</span> []
<span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):
    my_list.append(scrape_cf_request_id(<span class="st">&quot;https://project5-rate-limit.tdm.wiki&quot;</span>))
    
<span class="bu">print</span>(my_list)</code></pre></div>
</div>
<div id="you-now-have-a-great-set-of-tools-to-be-able-to-scrape-pretty-much-anything-you-want-from-the-internet.-now-all-that-is-left-to-do-is-practice.-find-a-course-appropriate-website-containing-data-you-would-like-to-scrape.-utilize-the-tools-youve-learned-about-to-scrape-at-least-100-units-of-data.-a-unit-is-just-a-representation-of-what-you-are-scraping.-for-example-a-unit-could-be-a-tweet-from-twitter-a-basketball-players-statistics-from-sportsreference-a-product-from-amazon-a-blog-post-from-your-favorite-blogger-etc." class="section level5">
<h5>3. You now have a great set of tools to be able to scrape pretty much anything you want from the internet. Now all that is left to do is practice. Find a course appropriate website containing data you would like to scrape. Utilize the tools you've learned about to scrape at least 100 &quot;units&quot; of data. A &quot;unit&quot; is just a representation of what you are scraping. For example, a unit could be a tweet from Twitter, a basketball player's statistics from sportsreference, a product from Amazon, a blog post from your favorite blogger, etc.</h5>
</div>
<div id="the-hard-requirements-are" class="section level5">
<h5>The hard requirements are:</h5>
<ul>
<li>Documented code with thorough comments explaining what the code does.</li>
<li>At least 100 &quot;units&quot; scraped.</li>
<li>The data must be from multiple web pages.</li>
<li>Write at least 1 function (with a docstring) to help you scrape.</li>
<li>A clear explanation of what your scraper scrapes, challenges you encountered (if any) and how you overcame them, and a sample of your data printed out (for example a <code>head</code> of a pandas dataframe containing the data).</li>
</ul>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code that scrapes 100 unites of data (with thorough comments explaining what the code does).
</li>
<li>
The data must be from more than a single web page.
</li>
<li>
1 or more functions (with docstrings) used to help you scrape/parse data.
</li>
<li>
Clear documentation and explanation of what your scraper scrapes, challenges you encountered (if any) and how you overcame them, and a sample of your data printed out (for example using the <code>head</code> of a dataframe containing the data).
</li>
</ul>
</div>
</div>
<div id="solution-56" class="section level5">
<h5>Solution</h5>
<div class="solution">
<ul>
<li>
Python code with comments
</li>
<li>
Sample of scraped data (must be from multiple pages)
</li>
<li>
At least 100 &quot;units&quot; of scraped data (for example 1 tweet == 1 unit, 1 product from amazon == 1 unit, etc.)
</li>
<li>
At least 1 helper function with a docstring
</li>
<li>
A paragraph explaining things
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="p06-290" class="section level3">
<h3>Project 6</h3>
<hr />
<p><strong>Motivation:</strong> Being able to analyze and create good visualizations is a skill that is invaluable in <em>many</em> fields. It can be pretty fun too! In this project, we are going to dive into <code>matplotlib</code> with an open project.</p>
<p><strong>Context:</strong> We've been working hard all semester and learning a lot about web scraping. In this project we are going to ask you to examine some plots, write a little bit, and use your creative energies to create good visualizations about the flight data using the go-to plotting library for many, <code>matplotlib</code>. In the next project, we will continue to learn about and become comfortable using <code>matplotlib</code>.</p>
<p><strong>Scope:</strong> python, visualizing data</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Demonstrate the ability to create basic graphs with default settings.
</li>
<li>
Demonstrate the ability to modify axes labels and titles.
</li>
<li>
Demonstrate the ability to customize a plot (color, shape/linetype).
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset-15" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/flights/*.csv</code> (all csv files)</p>
</div>
<div id="questions-18" class="section level4">
<h4>Questions</h4>
<div id="here-are-the-results-from-the-2009-data-expo-poster-competition.-the-object-of-the-competition-was-to-visualize-interesting-information-from-the-flights-dataset.-examine-all-8-posters-and-write-a-single-sentence-for-each-poster-with-your-first-impressions.-an-example-of-an-impression-that-will-not-get-full-credit-would-be-my-first-impression-is-that-this-poster-is-bad-and-doesnt-look-organized..-an-example-of-an-impression-that-will-get-full-credit-would-be-my-first-impression-is-that-the-author-had-a-good-visualization-to-text-ratio-and-it-seems-easy-to-follow-along..-1" class="section level5">
<h5>1. <a href="http://stat-computing.org/dataexpo/2009/posters/">Here</a> are the results from the 2009 Data Expo poster competition. The object of the competition was to visualize interesting information from the flights dataset. Examine all 8 posters and write a single sentence for each poster with your first impression(s). An example of an impression that will not get full credit would be: &quot;My first impression is that this poster is bad and doesn't look organized.&quot;. An example of an impression that will get full credit would be: &quot;My first impression is that the author had a good visualization-to-text ratio and it seems easy to follow along.&quot;.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_43j9xh4d">Click here for video</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
8 bullets, each containing a sentence with the first impression of the 8 visualizations. Order should be &quot;first place&quot;, to &quot;honourable mention&quot;, followed by &quot;other posters&quot; in the given order. Or, label which graphic each sentence is about.
</li>
</ul>
</div>
</div>
<div id="creating-more-effective-graphs-by-dr.-naomi-robbins-and-the-elements-of-graphing-data-by-dr.-william-cleveland-at-purdue-university-are-two-excellent-books-about-data-visualization.-read-the-following-excerpts-from-the-books-respectively-and-list-2-things-you-learned-or-found-interesting-from-each-book.-1" class="section level5">
<h5>2. <a href="https://www.amazon.com/dp/0985911123/">Creating More Effective Graphs</a> by Dr. Naomi Robbins and <a href="https://www.amazon.com/Elements-Graphing-Data-William-Cleveland/dp/0963488414/ref=sr_1_1?dchild=1&amp;keywords=elements+of+graphing+data&amp;qid=1614013761&amp;sr=8-1">The Elements of Graphing Data</a> by Dr. William Cleveland at Purdue University, are two excellent books about data visualization. Read the following excerpts from the books (respectively), and list 2 things you learned, or found interesting from <em>each</em> book.</h5>
<ul>
<li><a href="./files/CreatingMoreEffectiveGraphs.pdf">Excerpt 1</a></li>
<li><a href="./files/ElementsOfGraphingData.pdf">Excerpt 2</a></li>
</ul>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_6c1ge176">Click here for video</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Two bullets for each book with items you learned or found interesting.
</li>
</ul>
</div>
</div>
<div id="of-the-7-posters-with-at-least-3-plots-andor-maps-choose-1-poster-that-you-think-you-could-improve-upon-or-out-plot.-create-4-plotsmaps-that-either-1" class="section level5">
<h5>3. Of the 7 posters with at least 3 plots and/or maps, choose 1 poster that you think you could improve upon or &quot;out plot&quot;. Create 4 plots/maps that either:</h5>
<ol style="list-style-type: decimal">
<li>Improve upon a plot from the poster you chose, or</li>
<li>Show a completely different plot that does a good job of getting an idea or observation across, or</li>
<li>Ruin a plot. Purposefully break the best practices you've learned about in order to make the visualization misleading. (limited to 1 of the 4 plots)</li>
</ol>
</div>
<div id="for-each-plotmap-where-you-choose-to-do-1-include-1-2-sentences-explaining-what-exactly-you-improved-upon-and-how.-point-out-some-of-the-best-practices-from-the-2-provided-texts-that-you-followed.-for-each-plotmap-where-you-choose-to-do-2-include-1-2-sentences-explaining-your-graphic-and-outlining-the-best-practices-from-the-2-texts-that-you-followed.-for-each-plotmap-where-you-choose-to-do-3-include-1-2-sentences-explaining-what-you-changed-what-principle-it-broke-and-how-it-made-the-plot-misleading-or-worse.-1" class="section level5">
<h5>For each plot/map where you choose to do (1), include 1-2 sentences explaining what exactly you improved upon and how. Point out some of the best practices from the 2 provided texts that you followed. For each plot/map where you choose to do (2), include 1-2 sentences explaining your graphic and outlining the best practices from the 2 texts that you followed. For each plot/map where you choose to do (3), include 1-2 sentences explaining what you changed, what principle it broke, and how it made the plot misleading or worse.</h5>
</div>
<div id="while-we-are-not-asking-you-to-create-a-poster-please-use-rmarkdown-to-keep-your-plots-code-and-text-nicely-formatted-and-organized.-the-more-like-a-story-your-project-reads-the-better.-in-this-project-we-are-restricting-you-to-use-matplotlib-in-python.-while-there-are-many-interesting-plotting-packages-like-plotly-and-plotnine-we-really-want-you-to-take-the-time-to-dig-into-matplotlib-and-learn-as-much-as-you-can." class="section level5">
<h5>While we are not asking you to create a poster, please use RMarkdown to keep your plots, code, and text nicely formatted and organized. The more like a story your project reads, the better. In this project, we are restricting you to use <code>matplotlib</code> in Python. While there are many interesting plotting packages like <code>plotly</code> and <code>plotnine</code>, we really want you to take the time to dig into <code>matplotlib</code> and learn as much as you can.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_w3r8yhb2">Click here for video</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
All associated Python code you used to wrangling the data and create your graphics.
</li>
<li>
4 plots, with at least 4 associated RMarkdown code chunks.
</li>
<li>
1-2 sentences per plot explaining what exactly you improved upon, what best practices from the texts you used, and how. If it is a brand new visualization, describe and explain your graphic, outlining the best practices from the 2 texts that you followed. If it is the ruined plot you chose, explain what you changed, what principle it broke, and how it made the plot misleading or worse.
</li>
</ul>
</div>
</div>
<div id="now-that-youve-been-exploring-data-visualization-copy-paste-and-update-your-first-impressions-from-question-1-with-your-updated-impressions.-which-impression-changed-the-most-and-why-1" class="section level5">
<h5>4. Now that you've been exploring data visualization, copy, paste, and update your first impressions from question (1) with your updated impressions. Which impression changed the most, and why?</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_3fkl4ln3">Click here for video</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
8 bullets with updated impressions (still just a sentence or two) from question (1).
</li>
<li>
A sentence explaining which impression changed the most and why.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="p07-290" class="section level3">
<h3>Project 7</h3>
<hr />
<p><strong>Motivation:</strong> Being able to analyze and create good visualizations is a skill that is invaluable in <em>many</em> fields. It can be pretty fun too! As you probably noticed in the previous project, <code>matplotlib</code> can be finicky -- certain types of plots are really easy to create, while others are not. For example, you would think changing the color of a boxplot would be easy to do in <code>matplotlib</code>, perhaps we just need to add an option to the function call. As it turns out, this isn't so straightforward (as illustrated at the end of <a href="python.html#p-matplotlib-boxplot">this section</a>). Occasionally this will happen and that is when packages like <code>seaborn</code> or <code>plotnine</code> (both are packages built using <code>matplotlib</code>) can be good. In this project we will explore this a little bit, and learn about some useful <code>pandas</code> functions to help shape your data in a format that any given package requires.</p>
<p><strong>Context:</strong> In the next project, we will continue to learn about and become comfortable using <code>matplotlib</code>, <code>seaborn</code>, and <code>plotnine</code>.</p>
<p><strong>Scope:</strong> python, visualizing data</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Demonstrate the ability to create basic graphs with default settings.
</li>
<li>
Demonstrate the ability to modify axes labels and titles.
</li>
<li>
Demonstrate the ability to customize a plot (color, shape/linetype).
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset-16" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/apple/health/watch_dump.xml</code></p>
</div>
<div id="questions-19" class="section level4">
<h4>Questions</h4>
<div id="in-an-earlier-project-we-explored-some-xml-data-in-the-form-of-an-apple-watch-data-dump.-most-health-related-apps-give-you-some-sort-of-graph-or-set-of-graphs-as-an-output.-use-any-package-you-want-to-parse-the-xml-data.-there-are-a-lot-of-records-in-this-dataset.-each-record-has-an-attribute-called-creationdate.-create-a-barplot-of-the-number-of-records-per-day.-make-sure-your-plot-is-polished-containing-proper-labels-and-good-colors." class="section level5">
<h5>1. In an earlier project we explored some XML data in the form of an Apple Watch data dump. Most health-related apps give you some sort of graph or set of graphs as an output. Use any package you want to parse the XML data. There are a lot of <code>Record</code>s in this dataset. Each <code>Record</code> has an attribute called <code>creationDate</code>. Create a barplot of the number of <code>Record</code>s per day. Make sure your plot is polished, containing proper labels and good colors.</h5>
<p><strong>Hint:</strong> You could start by parsing out the required data into a <code>pandas</code> dataframe or series.</p>
<p><strong>Hint:</strong> The <code>groupby</code> method is one of the most useful <code>pandas</code> methods. It allows you to quickly perform operations on groups of data.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_69sdl8rk">Click here for video</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_ho5ej4gy">Click here for another video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-lxml">lxml</a>, <a href="python.html#p-pandas-groupby">groupby</a>, <a href="python.html#p-matplotlib-barplot">barplot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code (including the graphic).
</li>
</ul>
</div>
</div>
<div id="the-plot-in-question-1-should-look-bimodal.-lets-focus-only-on-the-first-apparent-group-of-readings.-create-a-new-dataframe-containing-only-the-readings-for-the-time-period-from-912017-to-5312019.-how-many-records-are-there-in-that-time-period" class="section level5">
<h5>2. The plot in question 1 should look bimodal. Let's focus only on the first apparent group of readings. Create a new dataframe containing only the readings for the time period from 9/1/2017 to 5/31/2019. How many <code>Record</code>s are there in that time period?</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_wlkijwnv">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-lxml">lxml</a>, <a href="python.html#p-pandas-groupby">groupby</a>, <a href="python.html#p-matplotlib-barplot">barplot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="it-is-hard-to-discern-weekly-patterns-if-any-based-on-the-graphics-created-so-far.-for-the-period-of-time-in-question-2-create-a-labeled-bar-plot-for-the-count-of-records-by-day-of-the-week.-what-if-any-discernable-patterns-are-there-make-sure-to-include-the-labels-provided-below" class="section level5">
<h5>3. It is hard to discern weekly patterns (if any) based on the graphics created so far. For the period of time in question 2, create a labeled bar plot for the count of <code>Record</code>s by day of the week. What (if any) discernable patterns are there? Make sure to include the labels provided below:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">labels <span class="op">=</span> [<span class="st">&quot;Mon&quot;</span>, <span class="st">&quot;Tue&quot;</span>, <span class="st">&quot;Wed&quot;</span>, <span class="st">&quot;Thu&quot;</span>, <span class="st">&quot;Fri&quot;</span>, <span class="st">&quot;Sat&quot;</span>, <span class="st">&quot;Sun&quot;</span>]</code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_e7d9ve0o">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-lxml">lxml</a>, <a href="python.html#p-pandas-groupby">groupby</a>, <a href="python.html#p-matplotlib-barplot">barplot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code (including the graphic).
</li>
</ul>
</div>
</div>
<div id="create-a-pandas-dataframe-containing-the-following-data-from-watch_dump.xml" class="section level5">
<h5>4. Create a <code>pandas</code> dataframe containing the following data from <code>watch_dump.xml</code>:</h5>
<ul>
<li>A column called <code>bpm</code> with the <code>bpm</code> (beats per minute) of the <code>InstantaneousBeatsPerMinute</code>.</li>
<li>A column called <code>time</code> with the <code>time</code> of each individual <code>bpm</code> reading in <code>InstantaneousBeatsPerMinute</code>.</li>
<li>A column called <code>date</code> with the date.</li>
<li>A column called <code>dayofweek</code> with the day of the week.</li>
</ul>
<p><strong>Hint:</strong> You may want to use <code>pd.to_numeric</code> to convert the <code>bpm</code> column to a numeric type.</p>
<p><strong>Hint:</strong> This is one way to convert the numbers 0-6 to days of the week:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">myDF[<span class="st">&#39;dayofweek&#39;</span>] <span class="op">=</span> myDF[<span class="st">&#39;dayofweek&#39;</span>].<span class="bu">map</span>({<span class="dv">0</span>:<span class="st">&quot;Mon&quot;</span>, <span class="dv">1</span>:<span class="st">&quot;Tue&quot;</span>, <span class="dv">2</span>:<span class="st">&quot;Wed&quot;</span>, <span class="dv">3</span>:<span class="st">&quot;Thu&quot;</span>, <span class="dv">4</span>:<span class="st">&quot;Fri&quot;</span>, <span class="dv">5</span>: <span class="st">&quot;Sat&quot;</span>, <span class="dv">6</span>: <span class="st">&quot;Sun&quot;</span>})</code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_h8crbise">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-lxml">lxml</a>, <a href="python.html#p-pandas-groupby">groupby</a>, <a href="python.html#p-matplotlib-barplot">barplot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="create-a-heatmap-using-seaborn-where-the-y-axis-shows-the-day-of-the-week-mon---sun-the-x-axis-shows-the-hour-and-the-values-on-the-interior-of-the-plot-are-the-average-bpm-by-hour-by-day-of-the-week." class="section level5">
<h5>5. Create a heatmap using <code>seaborn</code>, where the y-axis shows the day of the week (&quot;Mon&quot; - &quot;Sun&quot;), the x-axis shows the hour, and the values on the interior of the plot are the average <code>bpm</code> by hour by day of the week.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_rl5iu9am">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-lxml">lxml</a>, <a href="python.html#p-pandas-groupby">groupby</a>, <a href="python.html#p-pandas-pivot">pivot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code (including the graphic).
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="p08-290" class="section level3">
<h3>Project 8</h3>
<hr />
<p><strong>Motivation:</strong> Python is an <a href="https://www.geeksforgeeks.org/internal-working-of-python/">interpreted language</a> (as opposed to a compiled language). In a compiled language, you are (mostly) unable to run and evaluate a single instruction at a time. In Python (and R -- also an interpreted language), we can run and evaluate a line of code easily using a <a href="https://en.wikipedia.org/wiki/Read-eval-print_loop">repl</a>. In fact, this is the way you've been using Python to date -- selecting and running pieces of Python code. Other ways to use Python include creating a package (like numpy, pandas, and pytorch), and creating scripts. You can create powerful CLI's (command line interface) tools using Python. In this project, we will explore this in detail and learn how to create scripts that accept options and input and perform tasks.</p>
<p><strong>Context:</strong> This is the first (of two) projects where we will learn about creating and using Python scripts.</p>
<p><strong>Scope:</strong> python</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Write a python script that accepts user inputs and returns something useful.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="questions-20" class="section level4">
<h4>Questions</h4>
<div id="often-times-the-deliverable-part-of-a-project-isnt-custom-built-packages-or-modules-but-a-script.-a-script-is-a-.py-file-with-python-code-written-inside-to-perform-actions.-python-scripts-are-incredibly-easy-to-run-for-example-if-you-had-a-python-script-called-question01.py-you-could-run-it-by-opening-a-terminal-and-typing" class="section level5">
<h5>1. Often times the deliverable part of a project isn’t custom built packages or modules, but a script. A script is a .py file with python code written inside to perform action(s). Python scripts are incredibly easy to run, for example, if you had a python script called <code>question01.py</code>, you could run it by opening a terminal and typing:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">python3</span> /path/to/question01.py</code></pre></div>
</div>
<div id="the-python-interpreter-then-looks-for-the-scripts-entrypoint-and-starts-executing.-you-should-read-this-article-about-the-main-function-and-python-scripts.-in-addition-read-this-section-paying-special-attention-to-the-shebang." class="section level5">
<h5>The python interpreter then looks for the scripts entrypoint, and starts executing. You should read <a href="https://realpython.com/python-main-function/">this</a> article about the main function and python scripts. In addition, read <a href="https://realpython.com/run-python-scripts/#using-the-script-filename">this</a> section, paying special attention to the shebang.</h5>
</div>
<div id="create-a-python-script-called-question01.py-in-your-home-directory.-use-the-second-shebang-from-the-article-usrbinenv-python3.-when-run-question01.py-should-use-the-sys-package-to-print-the-location-of-the-interpreter-being-used-to-run-the-script.-for-example-if-we-started-a-python-interpreter-in-rstudio-using-the-following-code" class="section level5">
<h5>Create a Python script called <code>question01.py</code> in your <code>$HOME</code> directory. Use the second shebang from the article: <code>#!/usr/bin/env python3</code>. When run, <code>question01.py</code> should use the <code>sys</code> package to print the location of the interpreter being used to run the script. For example, if we started a Python interpreter in RStudio using the following code:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">datamine_py</span>()
reticulate<span class="op">::</span><span class="kw">repl_python</span>()</code></pre></div>
</div>
<div id="then-we-could-print-the-interpreter-by-running-the-following-python-code-one-line-at-a-time" class="section level5">
<h5>Then, we could print the interpreter by running the following Python code one line at a time:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> sys
<span class="bu">print</span>(sys.executable)</code></pre></div>
</div>
<div id="since-we-are-using-our-python-environment-you-should-see-this-result-classdatamineappspythonf2020-s2021envbinpython3.-this-is-the-fully-qualified-path-of-the-python-interpreter-weve-been-using-for-this-course." class="section level5">
<h5>Since we are using our Python environment, you should see this result: <code>/class/datamine/apps/python/f2020-s2021/env/bin/python3</code>. This is the fully qualified path of the Python interpreter we've been using for this course.</h5>
</div>
<div id="restart-your-r-session-by-clicking-session-restart-r-navigate-to-the-terminal-tab-in-rstudio-and-run-the-following-lines-in-the-terminal.-what-is-the-output" class="section level5">
<h5>Restart your R session by clicking <code>Session &gt; Restart R</code>, navigate to the &quot;Terminal&quot; tab in RStudio, and run the following lines in the terminal. What is the output?</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># this command gives execute permissions to your script -- this only needs to be run once</span>
<span class="fu">chmod</span> +x <span class="va">$HOME</span>/question01.py

<span class="co"># execute your script </span>
<span class="va">$HOME</span><span class="ex">/question01.py</span></code></pre></div>
<p><strong>Important note:</strong> You can run bash code using a bash code chunk just like you would an R or Python code chunk. Simply replace &quot;python&quot; with &quot;bash&quot; in the code chunk options.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_zu7ezftg">Click here for video</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_3q4cpan4">Click here for another video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-shebang">shebang</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The entire <code>question01.py</code> script's contents in a Python code chunk with chunk option &quot;eval=F&quot;.
</li>
<li>
Output from running your code copy and pasted as text.
</li>
</ul>
</div>
</div>
<div id="was-your-output-in-question-1-expected-why-or-why-not" class="section level5">
<h5>2. Was your output in question (1) expected? Why or why not?</h5>
</div>
<div id="when-we-restarted-the-r-session-our-datamine_pys-effects-were-reversed-and-the-default-python-interpreter-is-no-longer-our-default-when-running-python3.-it-is-very-common-to-have-a-multitude-of-python-environments-available-to-use.-but-when-we-are-running-a-python-script-it-is-not-convenient-to-have-to-run-various-commands-in-our-case-the-single-datamine_py-command-in-order-to-get-our-script-to-run-the-way-we-want-it-to-run.-in-addition-if-our-script-used-a-set-of-packages-that-were-not-installed-outside-of-our-course-environment-the-script-would-fail." class="section level5">
<h5>When we restarted the R session, our <code>datamine_py</code>'s effects were reversed, and the default Python interpreter is no longer our default when running <code>python3</code>. It is very common to have a multitude of Python environments available to use. But, when we are running a Python script it is <em>not</em> convenient to have to run various commands (in our case, the single <code>datamine_py</code> command) in order to get our script to run the way we want it to run. In addition, if our script used a set of packages that were not installed outside of our course environment, the script would fail.</h5>
</div>
<div id="in-this-project-since-our-focus-is-more-on-how-to-write-scripts-and-make-them-work-as-expected-we-will-have-some-fun-and-experiment-with-some-pre-trained-state-of-the-art-machine-learning-models." class="section level5">
<h5>In this project, since our focus is more on how to write scripts and make them work as expected, we will have some fun and experiment with some pre-trained state of the art machine learning models.</h5>
</div>
<div id="the-following-function-accepts-a-string-called-sentence-as-an-input-and-returns-the-sentiment-of-the-sentence-positive-or-negative." class="section level5">
<h5>The following function accepts a string called <code>sentence</code> as an input and returns the sentiment of the sentence, &quot;POSITIVE&quot; or &quot;NEGATIVE&quot;.</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> transformers <span class="im">import</span> pipeline

<span class="kw">def</span> get_sentiment(model, sentence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:
    result <span class="op">=</span> model(sentence)
    
    <span class="cf">return</span> result[<span class="dv">0</span>].get(<span class="st">&#39;label&#39;</span>)

model <span class="op">=</span> pipeline(<span class="st">&#39;sentiment-analysis&#39;</span>)

<span class="bu">print</span>(get_sentiment(model, <span class="st">&#39;This is really great!&#39;</span>))
<span class="bu">print</span>(get_sentiment(model, <span class="st">&#39;Oh no! Thats horrible!&#39;</span>))</code></pre></div>
</div>
<div id="include-get_sentiment-including-the-import-statement-in-a-new-script-question02.py-script.-note-that-you-do-not-have-to-use-get_sentiment-anywhere-just-include-it-for-now.-go-to-the-terminal-in-rstudio-and-execute-your-script.-what-happens" class="section level5">
<h5>Include <code>get_sentiment</code> (including the import statement) in a new script, <code>question02.py</code> script. Note that you do not have to <em>use</em> <code>get_sentiment</code> anywhere, just include it for now. Go to the terminal in RStudio and execute your script. What happens?</h5>
</div>
<div id="remember-since-our-current-shebang-is-usrbinenv-python3-if-our-script-uses-one-or-more-packages-that-are-not-installed-in-the-current-environment-environment-the-script-will-fail.-this-is-what-is-happening.-the-transformers-package-that-we-use-is-not-installed-in-the-current-environment.-we-do-however-have-an-environment-that-does-have-it-installed-and-it-is-located-on-scholar-at-classdatamineappspythonpytorch2021envbinpython.-update-the-scripts-shebang-and-try-to-run-it-again.-does-it-work-now" class="section level5">
<h5>Remember, since our current shebang is <code>#!/usr/bin/env python3</code>, if our script uses one or more packages that are not installed in the current environment environment, the script will fail. This is what is happening. The <code>transformers</code> package that we use is not installed in the current environment. We do, however, have an environment that <em>does</em> have it installed, and it is located on Scholar at: <code>/class/datamine/apps/python/pytorch2021/env/bin/python</code>. Update the script's shebang and try to run it again. Does it work now?</h5>
<p><strong>Explanation:</strong> Depending on the state of your current environment, the original shebang, <code>#!/usr/bin/env python3</code> will use the same Python interpreter and environment that is currently set to <code>python3</code> (run <code>which python3</code> to see). If you haven't run <code>datamine_py</code>, this will be something like: <code>/apps/spack/scholar/fall20/apps/anaconda/2020.11-py38-gcc-4.8.5-djkvkvk/bin/python</code> or <code>/usr/bin/python</code>, if you <em>have</em> run <code>datamine_py</code>, this will be: <code>/class/datamine/apps/python/f2020-s2021/env/bin/python</code>. <em>Both</em> environments lack the <code>transformers</code> package. Our other environment whose interpreter lives here: <code>/class/datamine/apps/python/pytorch2021/env/bin/python</code> <em>does</em> have this package. The shebang is then critically important for any scripts that want to utilize packages from a specific environment.</p>
<p><strong>Important note:</strong> You can run bash code using a bash code chunk just like you would an R or Python code chunk. Simply replace &quot;python&quot; with &quot;bash&quot; in the code chunk options.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_njfnysr8">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-scripts">writing scripts</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Sentence explaining why or why not the output from question (1) was expected.
</li>
<li>
Sentence explaining what happens when you include <code>get_sentiment</code> in your script and try to execute it.
</li>
<li>
The entirety of the updated (working) script's content in a Python code chunk with chunk option &quot;eval=F&quot;.
</li>
</ul>
</div>
</div>
<div id="okay-great.-we-now-understand-that-if-we-want-to-use-packages-from-a-specific-environment-we-need-to-modify-our-shebang-accordingly.-as-it-currently-stands-our-script-is-pretty-useless.-modify-the-script-in-a-new-script-called-question03.py-to-accept-a-single-argument.-this-argument-should-be-a-sentence.-your-script-should-then-print-the-sentence-and-whether-or-not-the-sentence-is-positive-or-negative.-use-sys.argv-to-accomplish-this.-make-sure-the-script-functions-in-the-following-way" class="section level5">
<h5>3. Okay, great. We now understand that if we want to use packages from a specific environment, we need to modify our shebang accordingly. As it currently stands, our script is pretty useless. Modify the script, in a new script called <code>question03.py</code> to accept a single argument. This argument should be a sentence. Your script should then print the sentence, and whether or not the sentence is &quot;POSITIVE&quot; or &quot;NEGATIVE&quot;. Use <code>sys.argv</code> to accomplish this. Make sure the script functions in the following way:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question03.py</span> This is a happy sentence, yay!</code></pre></div>
<pre><code>Too many arguments.</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question03.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span></code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question03.py</span></code></pre></div>
<pre><code>./question03.py requires at least 1 argument, &quot;sentence&quot;.</code></pre>
<p><strong>Hint:</strong> One really useful way to exit the script and print a message is like this:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> sys

sys.exit(<span class="ss">f&quot;</span><span class="sc">{</span><span class="va">__file__</span><span class="sc">}</span><span class="ss"> requires at least 1 argument, &#39;sentence&#39;&quot;</span>)</code></pre></div>
<p><strong>Important note:</strong> You can run bash code using a bash code chunk just like you would an R or Python code chunk. Simply replace &quot;python&quot; with &quot;bash&quot; in the code chunk options.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_idex90v8">Click here for video</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_c6qljtb5">Click here for another video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-scripts">writing scripts</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The entirety of the updated (working) script's content in a Python code chunk with chunk option &quot;eval=F&quot;.
</li>
<li>
Output from running your script with the given examples.
</li>
</ul>
</div>
</div>
<div id="if-you-look-at-the-man-pages-for-a-command-line-tool-like-awk-or-grep-you-can-get-these-by-running-man-awk-or-man-grep-in-the-terminal-you-will-see-that-typically-clis-have-a-variety-of-options.-options-usually-follow-the-following-format" class="section level5">
<h5>4. If you look at the man pages for a command line tool like <code>awk</code> or <code>grep</code> (you can get these by running <code>man awk</code> or <code>man grep</code> in the terminal), you will see that typically CLI's have a variety of options. Options usually follow the following format:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">grep</span> -i <span class="st">&#39;ok&#39;</span> some_file.txt</code></pre></div>
</div>
<div id="however-often-times-you-have-2-ways-you-can-use-an-option----either-with-the-short-form-for-example--i-or-long-form-for-example--i-is-the-same-as---ignore-case.-sometimes-options-can-get-values.-if-options-dont-have-values-you-can-assume-that-the-presence-of-the-flag-means-true-and-the-lack-means-false.-when-using-short-form-the-value-for-the-option-is-separated-by-a-space-for-example-grep--f-my_file.txt.-when-using-long-form-the-value-for-the-option-is-separated-by-an-equals-sign-for-example-grep---filemy_file.txt." class="section level5">
<h5>However, often times you have 2 ways you can use an option -- either with the short form (for example <code>-i</code>), or long form (for example <code>-i</code> is the same as <code>--ignore-case</code>). Sometimes options can get values. If options don't have values, you can assume that the presence of the flag means <code>TRUE</code> and the lack means <code>FALSE</code>. When using short form, the value for the option is separated by a space (for example <code>grep -f my_file.txt</code>). When using long form, the value for the option is separated by an equals sign (for example <code>grep --file=my_file.txt</code>).</h5>
</div>
<div id="modify-your-script-as-a-new-question04.py-to-include-an-option-called-score.-when-active-question04.py---score-or-question04.py--s-the-script-should-return-both-the-sentiment-positive-or-negative-and-the-probability-of-being-accurate.-make-sure-that-you-modify-your-checks-from-question-3-to-continue-to-work-whenever-we-use---score-or--s.-some-examples-below" class="section level5">
<h5>Modify your script (as a new <code>question04.py</code>) to include an option called <code>score</code>. When active (<code>question04.py --score</code> or <code>question04.py -s</code>), the script should return both the sentiment, &quot;POSITIVE&quot; or &quot;NEGATIVE&quot; and the probability of being accurate. Make sure that you modify your checks from question 3 to continue to work whenever we use <code>--score</code> or <code>-s</code>. Some examples below:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question04.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span></code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question04.py</span> --score <span class="st">&#39;This is a happy sentence, yay!&#39;</span></code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE: 0.999848484992981</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question04.py</span> -s <span class="st">&#39;This is a happy sentence, yay!&#39;</span></code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE: 0.999848484992981</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question04.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span> -s</code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE: 0.999848484992981</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question04.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span> --score</code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE: 0.999848484992981</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question04.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span> --value</code></pre></div>
<pre><code>Unknown option(s): [&#39;--value&#39;]</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question04.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span> --value --score</code></pre></div>
<pre><code>Too many arguments.</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question04.py</span></code></pre></div>
<pre><code>question04.py requires at least 1 argument, &quot;sentence&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question04.py</span> --score</code></pre></div>
<pre><code>./question04.py requires at least 1 argument, &quot;sentence&quot;. No sentence provided.</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question04.py</span> <span class="st">&#39;This is one sentence&#39;</span> <span class="st">&#39;This is another&#39;</span></code></pre></div>
<pre><code>./question04.py requires only 1 sentence, but 2 were provided.</code></pre>
<p><strong>Important note:</strong> You can run bash code using a bash code chunk just like you would an R or Python code chunk. Simply replace &quot;python&quot; with &quot;bash&quot; in the code chunk options.</p>
<p><strong>Hint:</strong> Experiment with the provided function. You will find the probability of being accurate is already returned by the model.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_hxx5pgtp">Click here for video</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_vqwmjvt4">Click here for another video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-scripts">writing scripts</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The entirety of the updated (working) script's content in a Python code chunk with chunk option &quot;eval=F&quot;.
</li>
<li>
Output from running your script with the given examples.
</li>
</ul>
</div>
</div>
<div id="wow-that-is-an-extensive-amount-of-logic-for-for-a-single-option.-luckily-python-has-the-argparse-package-to-help-you-build-clis-and-handle-situations-like-this.-you-can-find-the-documentation-for-argparse-here-and-a-nice-little-tutorial-here.-update-your-script-as-a-new-question05.py-using-argparse-instead-of-custom-logic.-specifically-add-1-positional-argument-called-sentence-and-1-optional-argument---score-or--s.-you-should-handle-the-following-scenarios" class="section level5">
<h5>5. Wow, that is an extensive amount of logic for for a single option. Luckily, Python has the <code>argparse</code> package to help you build CLI's and handle situations like this. You can find the documentation for argparse <a href="https://docs.python.org/3/library/argparse.html">here</a> and a nice little tutorial <a href="https://docs.python.org/3/howto/argparse.html">here</a>. Update your script (as a new <code>question05.py</code>) using <code>argparse</code> instead of custom logic. Specifically, add 1 positional argument called &quot;sentence&quot;, and 1 optional argument &quot;--score&quot; or &quot;-s&quot;. You should handle the following scenarios:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question05.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span></code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question05.py</span> --score <span class="st">&#39;This is a happy sentence, yay!&#39;</span></code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE: 0.999848484992981</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question05.py</span> -s <span class="st">&#39;This is a happy sentence, yay!&#39;</span></code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE: 0.999848484992981</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question05.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span> -s</code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE: 0.999848484992981</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question05.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span> --score</code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE: 0.999848484992981</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question05.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span> --value</code></pre></div>
<pre><code>usage: question05.py [-h] [-s] sentence
question05.py: error: unrecognized arguments: --value</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question05.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span> --value --score</code></pre></div>
<pre><code>usage: question05.py [-h] [-s] sentence
question05.py: error: unrecognized arguments: --value</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question05.py</span></code></pre></div>
<pre><code>usage: question05.py [-h] [-s] sentence

positional arguments:
  sentence

optional arguments:
  -h, --help   show this help message and exit
  -s, --score  display the probability of accuracy</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question05.py</span> --score</code></pre></div>
<pre><code>usage: question05.py [-h] [-s] sentence
question05.py: error: too few arguments</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question05.py</span> <span class="st">&#39;This is one sentence&#39;</span> <span class="st">&#39;This is another&#39;</span></code></pre></div>
<pre><code>usage: question05.py [-h] [-s] sentence
question05.py: error: unrecognized arguments: This is another</code></pre>
<p><strong>Hint:</strong> A good way to print the help information if no arguments are provided is:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">if</span> <span class="bu">len</span>(sys.argv) <span class="op">==</span> <span class="dv">1</span>:
    parser.print_help()
    parser.exit()</code></pre></div>
<p><strong>Important note:</strong> Include the bash code chunk option <code>error=T</code> to enable RMarkdown to knit and output errors.</p>
<p><strong>Important note:</strong> You can run bash code using a bash code chunk just like you would an R or Python code chunk. Simply replace &quot;python&quot; with &quot;bash&quot; in the code chunk options.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_n89f70ts">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-scripts">writing scripts</a>, <a href="python.html#p-argparse">argparse</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="p09-290" class="section level3">
<h3>Project 9</h3>
<hr />
<p><strong>Motivation:</strong> In the previous project you worked through some common logic needed to make a good script. By the end of the project <code>argparse</code> was (hopefully) a welcome package to be able to use. In this project, we are going to continue to learn about <code>argparse</code> and create a CLI for the <a href="https://data.whin.org">WHIN Data Portal</a>. In doing so, not only will we get to practice using <code>argparse</code>, but you will also get to learn about using an API to retrieve data. An API (application programming interface) is a common way to retrieve structured data from a company or resource. It is common for large companies like Twitter, Facebook, Google, etc. to make certain data available via API's, so it is important to get some exposure.</p>
<p><strong>Context:</strong> This is the second (of two) projects where we will learn about creating and using Python scripts.</p>
<p><strong>Scope:</strong> python</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Write a python script that accepts user inputs and returns something useful.
</li>
<li>
Interact with an API to retrieve data.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset-17" class="section level4">
<h4>Dataset</h4>
<p>The following questions will involve retrieving data using an API. Instructions and hints will be provided as we go.</p>
</div>
<div id="questions-21" class="section level4">
<h4>Questions</h4>
<div id="whin-wabash-heartland-innovation-network-has-deployed-hundreds-of-weather-stations-across-the-region-so-farmers-can-use-the-data-collected-to-become-more-efficient-save-time-and-increase-yields.-whin-has-kindly-granted-access-to-20-public-facing-weather-stations-for-educational-purposes." class="section level5">
<h5>1. WHIN (Wabash Heartland Innovation Network) has deployed hundreds of weather stations across the region so farmers can use the data collected to become more efficient, save time, and increase yields. WHIN has kindly granted access to 20+ public-facing weather stations for educational purposes.</h5>
</div>
<div id="navigate-to-httpsdata.whin.orgdatacurrent-conditions-and-click-on-the-create-account-button-in-the-middle-of-the-screen" class="section level5">
<h5>Navigate to <a href="https://data.whin.org/data/current-conditions" class="uri">https://data.whin.org/data/current-conditions</a>, and click on the &quot;CREATE ACCOUNT&quot; button in the middle of the screen:</h5>
<div class="figure">
<img src="images/p9_01.png" />

</div>
</div>
<div id="click-on-im-a-student-or-educator" class="section level5">
<h5>Click on &quot;I'm a student or educator&quot;:</h5>
<div class="figure">
<img src="images/p9_02.png" />

</div>
</div>
<div id="enter-your-information.-for-school-or-organization-please-enter-purdue-university.-for-class-or-project-please-put-the-data-mine-project-9.-for-the-description-please-put-we-are-learning-about-writing-scripts-by-writing-a-cli-to-fetch-data-from-the-whin-api.-please-use-your-purdue.edu-email-address.-once-complete-click-next." class="section level5">
<h5>Enter your information. For &quot;School or Organization&quot; please enter &quot;Purdue University&quot;. For &quot;Class or project&quot;, please put &quot;The Data Mine Project 9&quot;. For the description, please put &quot;We are learning about writing scripts by writing a CLI to fetch data from the WHIN API.&quot; Please use your purdue.edu email address. Once complete, click &quot;Next&quot;.</h5>
</div>
<div id="carefully-read-the-license-terms-before-accepting-and-confirm-your-email-address-if-needed.-upon-completion-navigate-here-httpsdata.whin.orgdatacurrent-conditions" class="section level5">
<h5>Carefully read the LICENSE TERMS before accepting, and confirm your email address if needed. Upon completion, navigate here: <a href="https://data.whin.org/data/current-conditions" class="uri">https://data.whin.org/data/current-conditions</a></h5>
</div>
<div id="read-about-the-api-under-api-usage.-an-endpoint-is-the-place-in-this-case-the-end-of-a-url-which-can-be-referred-to-as-the-uri-that-you-can-use-to-accessdeleteupdateetc.-a-given-resource-depending-on-the-http-method-used.-what-are-the-3-endpoints-of-this-api" class="section level5">
<h5>Read about the API under &quot;API Usage&quot;. An endpoint is the place (in this case the end of a URL (which can be referred to as the URI)) that you can use to access/delete/update/etc. a given resource depending on the HTTP method used. What are the 3 endpoints of this API?</h5>
</div>
<div id="write-and-run-a-script-called-question01.py-that-when-run-tries-to-print-the-current-listing-of-the-weather-stations.-instead-of-printing-what-you-think-it-should-print-it-will-print-something-else.-what-happened" class="section level5">
<h5>Write and run a script called <code>question01.py</code> that, when run, tries to print the current listing of the weather stations. Instead of printing what you think it should print, it will print something else. What happened?</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question01.py</span></code></pre></div>
<p><strong>Hint:</strong> You can use the <code>requests</code> library to run the HTTP GET method on the endpoint. For example:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> requests

response <span class="op">=</span> requests.get(<span class="st">&quot;https://datamine.purdue.edu/&quot;</span>)
<span class="bu">print</span>(response.json())</code></pre></div>
<p><strong>Hint:</strong> We want to use our regular course environment, therefore, make sure to use the following shebang: <code>#!/class/datamine/apps/python/f2020-s2021/env/bin/python</code></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_3pwhon32">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-scripts">writing scripts</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
List the 3 endpoints for this API.
</li>
<li>
The entirety of the updated (working) script's content in a Python code chunk with chunk option &quot;eval=F&quot;.
</li>
<li>
Output from running your script with the given examples.
</li>
</ul>
</div>
</div>
<div id="in-question-1-we-quickly-realize-that-we-are-missing-a-critical-step----authentication-recall-that-authentication-is-the-process-of-a-system-understanding-who-a-person-is-authorization-is-the-process-of-telling-whether-or-not-somebody-or-something-has-permissions-to-accessmodifydeleteetc.-a-resource.-when-we-make-get-requests-to-httpsdata.whin.orgapiweatherstations-or-any-other-endpoint-the-server-that-returns-the-data-we-are-trying-to-access-has-no-clue-who-we-are-which-explains-the-result-from-question-1." class="section level5">
<h5>2. In question 1, we quickly realize that we are missing a critical step -- authentication! Recall that authentication is the process of a system understanding <em>who</em> a person is, authorization is the process of telling whether or not somebody (or something) has permissions to access/modify/delete/etc. a resource. When we make GET requests to <a href="https://data.whin.org/api/weather/stations" class="uri">https://data.whin.org/api/weather/stations</a>, or any other endpoint, the server that returns the data we are trying to access has no clue who we are, which explains the result from question 1.</h5>
</div>
<div id="while-there-are-many-methods-of-authentication-whin-is-using-bearer-tokens.-navigate-here.-take-a-look-at-your-account-info.-you-should-see-a-large-chunk-of-random-numbers-and-text.-this-is-your-bearer-token-that-you-can-use-for-authentication.-the-bearer-token-is-to-be-sent-in-the-authorization-header-of-the-request.-for-example" class="section level5">
<h5>While there are many methods of authentication, WHIN is using Bearer tokens. Navigate <a href="https://data.whin.org/account">here</a>. Take a look at your account info. You should see a large chunk of random numbers and text. This is your bearer token that you can use for authentication. The bearer token is to be sent in the &quot;Authorization&quot; header of the request. For example:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> requests

my_headers <span class="op">=</span> {<span class="st">&quot;Authorization&quot;</span>: <span class="st">&quot;Bearer LDFKGHSOIDFRUTRLKJNXDFGT&quot;</span>}
response <span class="op">=</span> requests.get(<span class="st">&quot;my_url&quot;</span>, headers <span class="op">=</span> my_headers)</code></pre></div>
</div>
<div id="update-your-script-as-a-new-script-called-question02.py-and-test-it-out-again-to-see-if-we-get-the-expected-results-now.-question02.py-should-only-print-the-first-5-results." class="section level5">
<h5>Update your script (as a new script called <code>question02.py</code>), and test it out again to see if we get the expected results now. <code>question02.py</code> should only print the first 5 results.</h5>
</div>
<div id="a-couple-important-notes" class="section level5">
<h5>A couple important notes:</h5>
<ul>
<li>The bearer token should be taken care of like a password. You do NOT want to share this, ever.</li>
<li>There is an inherent risk in saving code like the code shown above. What if you accidentally upload it to GitHub? Then anyone with access could potentially read and use your token.</li>
</ul>
</div>
<div id="how-can-we-include-the-token-in-our-code-without-typing-it-in-our-code-the-typical-way-to-handle-this-is-to-use-environment-variables-andor-a-file-containing-the-information-that-is-specifically-not-shared-unless-necessary.-for-example-create-a-file-called-.env-in-your-home-directory-with-the-following-contents" class="section level5">
<h5>How can we include the token in our code without typing it in our code? The typical way to handle this is to use environment variables and/or a file containing the information that is specifically NOT shared unless necessary. For example, create a file called <code>.env</code> in your home directory, with the following contents:</h5>
<pre><code>MY_BEARER_TOKEN=aslgdkjn304iunglsejkrht09
SOME_OTHER_VARIABLE=some_other_value</code></pre>
</div>
<div id="in-this-file-replace-the-aslgdkj...-part-with-you-actual-token-and-save-the-file.-then-make-sure-only-you-can-read-and-write-to-this-file-by-running-the-following-in-a-terminal" class="section level5">
<h5>In this file, replace the &quot;aslgdkj...&quot; part with you actual token and save the file. Then make sure only YOU can read and write to this file by running the following in a terminal:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">chmod</span> 600 <span class="va">$HOME</span>/.env</code></pre></div>
</div>
<div id="now-we-can-use-a-package-called-dotenv-to-load-the-variables-in-the-home.env-file-into-the-environment.-we-can-then-use-the-os-package-to-get-the-environment-variables.-for-example" class="section level5">
<h5>Now, we can use a package called <code>dotenv</code> to load the variables in the <code>$HOME/.env</code> file into the environment. We can then use the <code>os</code> package to get the environment variables. For example:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> os
<span class="im">from</span> dotenv <span class="im">import</span> load_dotenv

<span class="co"># This function will load the .env file variables from the same directory as the script into the environment</span>
load_dotenv()

<span class="co"># We can now use os.getenv to get the important information without showing anything.</span>
<span class="co"># Now, all anybody reading the code sees is &quot;os.getenv(&#39;MY_BEARER_TOKEN&#39;)&quot; even though that is replaced by the actual</span>
<span class="co"># token when the code is run, cool!</span>
my_headers <span class="op">=</span> {<span class="st">&quot;Authorization&quot;</span>: <span class="ss">f&quot;Bearer </span><span class="sc">{os.</span>getenv(<span class="st">&#39;MY_BEARER_TOKEN&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span>}</code></pre></div>
</div>
<div id="update-question02.py-to-use-dotenv-and-os.getenv-to-get-the-token-from-the-local-home.env-file.-test-out-your-script" class="section level5">
<h5>Update <code>question02.py</code> to use <code>dotenv</code> and <code>os.getenv</code> to get the token from the local <code>$HOME/.env</code> file. Test out your script:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question02.py</span> </code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_fotbs2kc">Click here for video</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_fq0pqm2c">Click here for another video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-scripts">writing scripts</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The entirety of the updated (working) script's content in a Python code chunk with chunk option &quot;eval=F&quot;.
</li>
<li>
Output from running your script with the given example.
</li>
</ul>
</div>
</div>
<div id="thats-not-so-bad-we-now-know-how-to-retrieve-data-from-the-api-as-well-as-load-up-variables-from-our-environment-rather-than-insecurely-just-pasting-them-in-our-code-great" class="section level5">
<h5>3. That's not so bad! We now know how to retrieve data from the API as well as load up variables from our environment rather than insecurely just pasting them in our code, great!</h5>
</div>
<div id="a-query-parameter-is-more-or-less-some-extra-information-added-at-the-end-of-the-endpoint.-for-example-the-following-url-has-a-query-parameter-called-param-and-value-called-value-httpsexample.comsome_resourceparamvalue.-you-could-even-add-more-than-one-query-parameter-as-follows-httpsexample.comsome_resourceparamvaluesecond_paramsecond_value----as-you-can-see-now-we-have-another-parameter-called-second_param-with-a-value-of-second_value.-while-the-query-parameters-begin-with-a-each-subsequent-parameter-is-added-using-." class="section level5">
<h5>A query parameter is (more or less) some extra information added at the end of the endpoint. For example, the following url has a query parameter called <code>param</code> and value called <code>value</code>: <a href="https://example.com/some_resource?param=value" class="uri">https://example.com/some_resource?param=value</a>. You could even add more than one query parameter as follows: <a href="https://example.com/some_resource?param=value&amp;second_param=second_value" class="uri">https://example.com/some_resource?param=value&amp;second_param=second_value</a> -- as you can see, now we have another parameter called <code>second_param</code> with a value of <code>second_value</code>. While the query parameters begin with a <code>?</code>, each subsequent parameter is added using <code>&amp;</code>.</h5>
</div>
<div id="query-parameters-can-be-optional-or-required.-apis-will-sometimes-utilize-query-parameters-to-filter-or-fine-tune-the-returned-results.-look-at-the-documentation-for-the-apiweatherstation-daily-endpoint.-use-your-newfound-knowledge-of-query-parameters-to-update-your-script-as-a-new-script-called-question03.py-to-retrieve-the-data-for-station-with-id-150-on-2021-01-05-and-print-the-first-5-results.-test-out-your-script" class="section level5">
<h5>Query parameters can be optional or required. API's will sometimes utilize query parameters to filter or fine-tune the returned results. Look at the documentation for the <code>/api/weather/station-daily</code> endpoint. Use your newfound knowledge of query parameters to update your script (as a new script called <code>question03.py</code>) to retrieve the data for station with id <code>150</code> on <code>2021-01-05</code>, and print the first 5 results. Test out your script:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question03.py</span></code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_xjcywy0i">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-scripts">writing scripts</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The entirety of the updated (working) script's content in a Python code chunk with chunk option &quot;eval=F&quot;.
</li>
<li>
Output from running your script with the given example.
</li>
</ul>
</div>
</div>
<div id="excellent-now-lets-build-our-cli.-call-the-script-whin.py.-use-your-knowledge-of-requests-argparse-and-apis-to-write-a-cli-that-replicates-the-behavior-shown-below.-for-convenience-only-print-the-first-2-results-for-all-output." class="section level5">
<h5>4. Excellent, now let's build our CLI. Call the script <code>whin.py</code>. Use your knowledge of <code>requests</code>, <code>argparse</code>, and API's to write a CLI that replicates the behavior shown below. For convenience, only print the first 2 results for all output.</h5>
<p><strong>Hints:</strong></p>
<ul>
<li>In general, there will be 3 commands: <code>stations</code>, <code>daily</code>, and <code>cc</code> (for current condition).</li>
<li>You will want to create a subparser for each command: <code>stations_parser</code>, <code>current_conditions_parser</code>, and <code>daily_parser</code>.</li>
<li>The <code>daily_parser</code> will have 2 <em>position</em>, <em>required</em> arguments: <code>station_id</code> and <code>date</code>.</li>
<li>The <code>current_conditions_parser</code> will have 2 <em>optional</em> arguments of type <code>str</code>: <code>--center</code>/<code>-c</code> and <code>--radius</code>/<code>-r</code>.</li>
<li>If only one of <code>--center</code> or <code>--radius</code> is present, you should use <code>sys.exit</code> to print a message saying &quot;Need both center AND radius, or neither.&quot;.</li>
<li>To create a subparser, just do the following:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">parser <span class="op">=</span> argparse.ArgumentParser()
subparsers <span class="op">=</span> parser.add_subparsers(<span class="bu">help</span><span class="op">=</span><span class="st">&quot;possible commands&quot;</span>, dest<span class="op">=</span><span class="st">&quot;command&quot;</span>)

my_subparser <span class="op">=</span> subparsers.add_parser(<span class="st">&quot;my_command&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;my help message&quot;</span>)
my_subparser.add_argument(<span class="st">&quot;--my-option&quot;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">str</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;some option&quot;</span>)

args <span class="op">=</span> parser.parse_args()</code></pre></div>
<ul>
<li>Then, you can access which command was run with <code>args.command</code> (which in this case would only have 1 possible value of <code>my_command</code>), and access any parser or subparsers options with <code>args</code>, for example, <code>args.my_option</code>.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/whin.py</span></code></pre></div>
<pre><code>usage: whin.py [-h] {stations,cc,daily} ...

positional arguments:
  {stations,cc,daily}  possible commands
    stations           list the stations
    cc                 list the most recent data from each weather station
    daily              list data from a given day and station

optional arguments:
  -h, --help           show this help message and exit</code></pre>
<p><strong>Hint:</strong> A good way to print the help information if no arguments are provided is:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">if</span> <span class="bu">len</span>(sys.argv) <span class="op">==</span> <span class="dv">1</span>:
    parser.print_help()
    parser.exit()</code></pre></div>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/whin.py</span> stations -h</code></pre></div>
<pre><code>usage: whin.py stations [-h]

optional arguments:
  -h, --help  show this help message and exit</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/whin.py</span> cc -h</code></pre></div>
<pre><code>usage: whin.py cc [-h] [-c CENTER] [-r RADIUS]

optional arguments:
  -h, --help            show this help message and exit
  -c CENTER, --center CENTER
                        return results near this center coordinate, given as a
                        latitude,longitude pair
  -r RADIUS, --radius RADIUS
                        search distance, in meters, from the center</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/whin.py</span> cc</code></pre></div>
<pre><code>[{&#39;humidity&#39;: 90, &#39;latitude&#39;: 40.93894, &#39;longitude&#39;: -86.47418, &#39;name&#39;: &#39;WHIN001-PULA001&#39;, &#39;observation_time&#39;: &#39;2021-03-16T18:45:00Z&#39;, &#39;pressure&#39;: &#39;30.051&#39;, &#39;rain&#39;: &#39;0&#39;, &#39;rain_inches_last_hour&#39;: &#39;0&#39;, &#39;soil_moist_1&#39;: 6, &#39;soil_moist_2&#39;: 11, &#39;soil_moist_3&#39;: 14, &#39;soil_moist_4&#39;: 9, &#39;soil_temp_1&#39;: 42, &#39;soil_temp_2&#39;: 40, &#39;soil_temp_3&#39;: 40, &#39;soil_temp_4&#39;: 41, &#39;solar_radiation&#39;: 203, &#39;solar_radiation_high&#39;: 244, &#39;station_id&#39;: 1, &#39;temperature&#39;: 40, &#39;temperature_high&#39;: 40, &#39;temperature_low&#39;: 40, &#39;wind_direction_degrees&#39;: &#39;337.5&#39;, &#39;wind_gust_direction_degrees&#39;: &#39;22.5&#39;, &#39;wind_gust_speed_mph&#39;: 6, &#39;wind_speed_mph&#39;: 3}, {&#39;humidity&#39;: 88, &#39;latitude&#39;: 40.73083, &#39;longitude&#39;: -86.98467, &#39;name&#39;: &#39;WHIN003-WHIT001&#39;, &#39;observation_time&#39;: &#39;2021-03-16T18:45:00Z&#39;, &#39;pressure&#39;: &#39;30.051&#39;, &#39;rain&#39;: &#39;0&#39;, &#39;rain_inches_last_hour&#39;: &#39;0&#39;, &#39;soil_moist_1&#39;: 6, &#39;soil_moist_2&#39;: 5, &#39;soil_moist_3&#39;: 6, &#39;soil_moist_4&#39;: 4, &#39;soil_temp_1&#39;: 40, &#39;soil_temp_2&#39;: 39, &#39;soil_temp_3&#39;: 39, &#39;soil_temp_4&#39;: 40, &#39;solar_radiation&#39;: 156, &#39;solar_radiation_high&#39;: 171, &#39;station_id&#39;: 3, &#39;temperature&#39;: 40, &#39;temperature_high&#39;: 40, &#39;temperature_low&#39;: 39, &#39;wind_direction_degrees&#39;: &#39;337.5&#39;, &#39;wind_gust_direction_degrees&#39;: &#39;337.5&#39;, &#39;wind_gust_speed_mph&#39;: 8, &#39;wind_speed_mph&#39;: 3}]</code></pre>
<p><strong>Important note:</strong> Your values may be different because they are <em>current</em> conditions.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/whin.py</span> cc --radius=10000</code></pre></div>
<pre><code>Need both center AND radius, or neither.</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/whin.py</span> cc --center=40.4258686,-86.9080654</code></pre></div>
<pre><code>Need both center AND radius, or neither.</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/whin.py</span> cc --center=40.4258686,-86.9080654 --radius=10000</code></pre></div>
<pre><code>[{&#39;humidity&#39;: 86, &#39;latitude&#39;: 40.42919, &#39;longitude&#39;: -86.84547, &#39;name&#39;: &#39;WHIN008-TIPP005 Chatham Square&#39;, &#39;observation_time&#39;: &#39;2021-03-16T18:45:00Z&#39;, &#39;pressure&#39;: &#39;30.012&#39;, &#39;rain&#39;: &#39;0&#39;, &#39;rain_inches_last_hour&#39;: &#39;0&#39;, &#39;soil_moist_1&#39;: 5, &#39;soil_moist_2&#39;: 5, &#39;soil_moist_3&#39;: 5, &#39;soil_moist_4&#39;: 5, &#39;soil_temp_1&#39;: 42, &#39;soil_temp_2&#39;: 41, &#39;soil_temp_3&#39;: 41, &#39;soil_temp_4&#39;: 42, &#39;solar_radiation&#39;: 191, &#39;solar_radiation_high&#39;: 220, &#39;station_id&#39;: 8, &#39;temperature&#39;: 42, &#39;temperature_high&#39;: 42, &#39;temperature_low&#39;: 42, &#39;wind_direction_degrees&#39;: &#39;0&#39;, &#39;wind_gust_direction_degrees&#39;: &#39;22.5&#39;, &#39;wind_gust_speed_mph&#39;: 9, &#39;wind_speed_mph&#39;: 3}, {&#39;humidity&#39;: 86, &#39;latitude&#39;: 40.38494, &#39;longitude&#39;: -86.84577, &#39;name&#39;: &#39;WHIN027-TIPP003 EXT&#39;, &#39;observation_time&#39;: &#39;2021-03-16T18:45:00Z&#39;, &#39;pressure&#39;: &#39;29.515&#39;, &#39;rain&#39;: &#39;0&#39;, &#39;rain_inches_last_hour&#39;: &#39;0&#39;, &#39;soil_moist_1&#39;: 5, &#39;soil_moist_2&#39;: 4, &#39;soil_moist_3&#39;: 4, &#39;soil_moist_4&#39;: 5, &#39;soil_temp_1&#39;: 43, &#39;soil_temp_2&#39;: 42, &#39;soil_temp_3&#39;: 42, &#39;soil_temp_4&#39;: 42, &#39;solar_radiation&#39;: 221, &#39;solar_radiation_high&#39;: 244, &#39;station_id&#39;: 27, &#39;temperature&#39;: 43, &#39;temperature_high&#39;: 43, &#39;temperature_low&#39;: 43, &#39;wind_direction_degrees&#39;: &#39;337.5&#39;, &#39;wind_gust_direction_degrees&#39;: &#39;337.5&#39;, &#39;wind_gust_speed_mph&#39;: 6, &#39;wind_speed_mph&#39;: 3}]</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/whin.py</span> daily</code></pre></div>
<pre><code>usage: whin.py daily [-h] station_id date
whin.py daily: error: too few arguments</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/whin.py</span> daily 150 2021-01-05</code></pre></div>
<pre><code>[{&#39;humidity&#39;: 96, &#39;latitude&#39;: 41.00467, &#39;longitude&#39;: -86.68428, &#39;name&#39;: &#39;WHIN058-PULA007&#39;, &#39;observation_time&#39;: &#39;2021-01-05T05:00:00Z&#39;, &#39;pressure&#39;: &#39;29.213&#39;, &#39;rain&#39;: &#39;0&#39;, &#39;rain_inches_last_hour&#39;: &#39;0&#39;, &#39;soil_moist_1&#39;: 5, &#39;soil_moist_2&#39;: 6, &#39;soil_moist_3&#39;: 7, &#39;soil_moist_4&#39;: 5, &#39;soil_temp_1&#39;: 33, &#39;soil_temp_2&#39;: 34, &#39;soil_temp_3&#39;: 35, &#39;soil_temp_4&#39;: 35, &#39;solar_radiation&#39;: 0, &#39;solar_radiation_high&#39;: 0, &#39;station_id&#39;: 150, &#39;temperature&#39;: 31, &#39;temperature_high&#39;: 31, &#39;temperature_low&#39;: 31, &#39;wind_direction_degrees&#39;: &#39;270&#39;, &#39;wind_gust_direction_degrees&#39;: &#39;292.5&#39;, &#39;wind_gust_speed_mph&#39;: 13, &#39;wind_speed_mph&#39;: 8}, {&#39;humidity&#39;: 96, &#39;latitude&#39;: 41.00467, &#39;longitude&#39;: -86.68428, &#39;name&#39;: &#39;WHIN058-PULA007&#39;, &#39;observation_time&#39;: &#39;2021-01-05T05:15:00Z&#39;, &#39;pressure&#39;: &#39;29.207&#39;, &#39;rain&#39;: &#39;1&#39;, &#39;rain_inches_last_hour&#39;: &#39;0&#39;, &#39;soil_moist_1&#39;: 5, &#39;soil_moist_2&#39;: 6, &#39;soil_moist_3&#39;: 7, &#39;soil_moist_4&#39;: 5, &#39;soil_temp_1&#39;: 33, &#39;soil_temp_2&#39;: 34, &#39;soil_temp_3&#39;: 35, &#39;soil_temp_4&#39;: 35, &#39;solar_radiation&#39;: 0, &#39;solar_radiation_high&#39;: 0, &#39;station_id&#39;: 150, &#39;temperature&#39;: 31, &#39;temperature_high&#39;: 31, &#39;temperature_low&#39;: 31, &#39;wind_direction_degrees&#39;: &#39;270&#39;, &#39;wind_gust_direction_degrees&#39;: &#39;292.5&#39;, &#39;wind_gust_speed_mph&#39;: 14, &#39;wind_speed_mph&#39;: 9}]</code></pre>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_rej7d8oo">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-scripts">writing scripts</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The entirety of the updated (working) script's content in a Python code chunk with chunk option &quot;eval=F&quot;.
</li>
<li>
Output from running your script with the given examples.
</li>
</ul>
</div>
</div>
<div id="there-are-a-multitude-of-improvements-andor-features-that-we-could-add-to-whin.py.-customize-your-script-as-a-new-script-called-question05.py-to-either-do-something-new-or-fix-a-scenario-that-wasnt-covered-in-question-4.-be-sure-to-include-1-2-sentences-that-explains-exactly-what-your-modification-does.-demonstrate-the-feature-by-running-it-in-a-bash-code-chunk." class="section level5">
<h5>5. There are a multitude of improvements and/or features that we could add to <code>whin.py</code>. Customize your script (as a new script called <code>question05.py</code>), to either do something new, or fix a scenario that wasn't covered in question 4. Be sure to include 1-2 sentences that explains exactly what your modification does. Demonstrate the feature by running it in a bash code chunk.</h5>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-scripts">writing scripts</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The entirety of the updated (working) script's content in a Python code chunk with chunk option &quot;eval=F&quot;.
</li>
<li>
Output from running your script with the given examples.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="p10-290" class="section level3">
<h3>Project 10</h3>
<hr />
<p><strong>Motivation:</strong> The use of a suite of packages referred to as the <code>tidyverse</code> is popular with many R users. It is apparent just by looking at <code>tidyverse</code> R code, that it varies greatly in style from typical R code. It is useful to gain some familiarity with this collection of packages, in case you run into a situation where these packages are needed -- you may even find that you enjoy using them!</p>
<p><strong>Context:</strong> We've covered a lot of ground so far this semester, and almost completely using Python. In this next series of projects we are going to switch back to R with a strong focus on the <code>tidyverse</code> (including <code>ggplot</code>) and data wrangling tasks.</p>
<p><strong>Scope:</strong> R, tidyverse, ggplot</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Explain the differences between regular data frames and tibbles.
</li>
<li>
Use mutate, pivot, unite, filter, and arrange to wrangle data and solve data-driven problems.
</li>
<li>
Combine different data using joins (left_join, right_join, semi_join, anti_join), and bind_rows.
</li>
<li>
Group data and calculate aggregated statistics using group_by, mutate, and transform functions.
</li>
<li>
Demonstrate the ability to create basic graphs with default settings, in <code>ggplot</code>.
</li>
<li>
Demonstrate the ability to modify axes labels and titles.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<p>The <code>tidyverse</code> consists of a variety of packages, including, but not limited to: <code>ggplot2</code>, <code>dplyr</code>, <code>tidyr</code>, <code>readr</code>, <code>purrr</code>, <code>tibble</code>, <code>stringr</code>, and <code>lubridate</code>.</p>
<p>One of the underlying premises of the <code>tidyverse</code> is getting the data to be <a href="https://r4ds.had.co.nz/tidy-data.html#tidy-data-1">tidy</a>. You can read a lot more about this in Hadley Wickham's excellent book, <a href="https://r4ds.had.co.nz">R for Data Science</a>.</p>
<p>There is an excellent graphic <a href="https://r4ds.had.co.nz/introduction.html#what-you-will-learn">here</a> that illustrates a general workflow for data science projects:</p>
<ol style="list-style-type: decimal">
<li>Import</li>
<li>Tidy</li>
<li>Iterate on, to gain understanding:
<ol style="list-style-type: decimal">
<li>Transform</li>
<li>Visualize</li>
<li>Model</li>
</ol></li>
<li>Communicate</li>
</ol>
<p>This is a good general outline of how a project could be organized, but depending on the project or company, this could vary greatly and change as the goals of a project change.</p>
<div id="dataset-18" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/okcupid/filtered/*.csv</code></p>
</div>
<div id="questions-22" class="section level4">
<h4>Questions</h4>
<div id="lets-more-or-less-follow-the-guidelines-given-above.-the-first-step-is-to-import-the-data.-there-are-two-files-questions.csv-and-users.csv.-read-this-section-and-use-what-you-learn-to-read-in-the-two-files-into-questions-and-users-respectively.-which-functions-from-the-tidyverse-did-you-use-and-why" class="section level5">
<h5>1. Let's (more or less) follow the guidelines given above. The first step is to <a href="https://r4ds.had.co.nz/data-import.html">import</a> the data. There are two files: <code>questions.csv</code>, and <code>users.csv</code>. Read <a href="https://r4ds.had.co.nz/data-import.html">this section</a>, and use what you learn to read in the two files into <code>questions</code> and <code>users</code>, respectively. Which functions from the <code>tidyverse</code> did you use and why?</h5>
<p><strong>Hint:</strong> Its easy to load up the <code>tidyverse</code> packages:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre></div>
<p><strong>Hint:</strong> Just because a file has the <code>.csv</code> extension does <em>not</em> mean that is it comma separated.</p>
<p><strong>Hint:</strong> Make sure to print the <code>tibble</code>s after reading them in to ensure that they were read in correctly. If they were not, use a different function (from <code>tidyverse</code>) to read in the data.</p>
<p><strong>Hint:</strong> <code>questions</code> should be 2281x10 and <code>users</code> should be 68371 x 2284</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
<code>head</code> of each dataset, <code>users</code> and <code>questions</code>.
</li>
<li>
1 sentence explaining which functions you used (from <code>tidyverse</code>) and why.
</li>
</ul>
</div>
</div>
<div id="you-may-recall-that-the-function-read.csv-from-base-r-reads-data-into-a-data.frame-by-default.-in-the-tidyverse-readrs-functions-read-the-data-into-a-tibbles-instead.-read-this-section.-to-summarize-some-important-features-that-are-true-for-tibbles-but-not-necessarily-for-data.frames-are" class="section level5">
<h5>2. You may recall that the function <code>read.csv</code> from base R reads data into a data.frame by default. In the <code>tidyverse</code>, <code>readr</code>'s functions read the data into a <code>tibble</code>'s, instead. Read <a href="https://r4ds.had.co.nz/tibbles.html">this section</a>. To summarize, some important features that are true for <code>tibble</code>'s but not necessarily for data.frames are:</h5>
<ul>
<li>Non-syntactic variable names (surrounded by backticks <code>`</code> )</li>
<li>Never changes the type of the inputs (for example converting strings to factors)</li>
<li>More informative output from printing</li>
<li>No partial matching</li>
<li>Simple <a href="https://r4ds.had.co.nz/tibbles.html#subsetting">subsetting</a></li>
</ul>
</div>
<div id="great-the-next-step-in-our-outline-is-to-make-the-data-tidy.-read-this-section.-okay-lets-say-for-instance-that-we-wanted-to-create-a-tibble-with-the-following-columns-user-question-question_text-selected_option-race-gender2-gender_orientation-n-and-keywords.-as-you-can-imagine-the-tidy-format-while-great-for-analysis-would-not-be-great-for-storage-as-there-would-be-a-row-for-each-question-for-each-user-at-least.-columns-like-gender2-and-race-dont-change-for-a-user-so-we-end-up-with-a-lot-of-repeated-values." class="section level5">
<h5>Great, the next step in our outline is to make the data &quot;tidy&quot;. Read <a href="https://r4ds.had.co.nz/tidy-data.html#tidy-data-1">this section</a>. Okay, let's say, for instance, that we wanted to create a <code>tibble</code> with the following columns: <code>user</code>, <code>question</code>, <code>question_text</code>, <code>selected_option</code>, <code>race</code>, <code>gender2</code>, <code>gender_orientation</code>, <code>n</code>, and <code>keywords</code>. As you can imagine, the &quot;tidy&quot; format, while great for analysis, would <em>not</em> be great for storage as there would be a row for each question for each user, at least. Columns like <code>gender2</code> and <code>race</code> don't change for a user, so we end up with a lot of repeated values.</h5>
</div>
<div id="okay-we-dont-need-to-analyze-all-68000-users-at-once-lets-instead-take-a-random-sample-of-2200-users-and-create-a-tidy-tibble-as-described-above.-after-all-we-want-to-see-why-this-format-is-useful-while-trying-to-figure-out-how-to-do-this-may-seem-daunting-at-first-it-is-actually-not-so-bad" class="section level5">
<h5>Okay, we don't need to analyze all 68000 users at once, let's instead, take a random sample of 2200 users, and create a &quot;tidy&quot; <code>tibble</code> as described above. After all, we want to see why this format is useful! While trying to figure out how to do this may seem daunting at first, it is actually not <em>so</em> bad:</h5>
</div>
<div id="first-we-convert-the-users-tibble-to-long-form-so-each-row-represents-1-answer-to-1-questions-from-1-user" class="section level5">
<h5>First, we convert the <code>users</code> tibble to long form, so each row represents 1 answer to 1 questions from 1 user:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Add an &quot;id&quot; columns to the users data</span>
users<span class="op">$</span>id &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(users)
<span class="co"># To ensure we get the same random sample, run the set.seed line</span>
<span class="co"># before every time you run the following line</span>
<span class="kw">set.seed</span>(<span class="dv">12345</span>) 
columns_to_pivot &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">2278</span>
users_sample_long &lt;-<span class="st"> </span>users[<span class="kw">sample</span>(<span class="kw">nrow</span>(users), <span class="dv">2200</span>),] <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate_at</span>(columns_to_pivot, as.character) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># This converts all of our columns in columns_to_pivot to strings</span>
<span class="st">    </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> columns_to_pivot, <span class="dt">names_to=</span><span class="st">&quot;question&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;selected_option&quot;</span>) <span class="co"># The old qXXXX columns are now values in the &quot;question&quot; column.</span></code></pre></div>
</div>
<div id="next-we-want-to-merge-our-data-from-the-questions-tibble-with-our-users_sample_long-tibble-into-a-new-table-we-will-call-mydf.-how-many-rows-and-columns-are-in-mydf" class="section level5">
<h5>Next, we want to merge our data from the <code>questions</code> tibble with our <code>users_sample_long</code> tibble, into a new table we will call <code>myDF</code>. How many rows and columns are in <code>myDF</code>?</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myDF &lt;-<span class="st"> </span><span class="kw">merge</span>(users_sample_long, questions, <span class="dt">by.x =</span> <span class="st">&quot;question&quot;</span>, <span class="dt">by.y =</span> <span class="st">&quot;X&quot;</span>)</code></pre></div>
<p><strong>Challenge:</strong> (0 pts, for fun) If you are looking for a challenge, try to do this in excel or without <code>tidyverse</code>.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The number of rows and columns in <code>myDF</code>.
</li>
<li>
The <code>head</code> of <code>myDF</code>.
</li>
</ul>
</div>
</div>
<div id="excellent-now-we-have-a-nice-tidy-dataset-that-we-can-work-with.-you-may-have-noticed-some-odd-syntax-in-the-code-provided-in-the-previous-question.-is-the-piping-operator-in-r-added-by-the-magittr-package.-it-works-pretty-much-just-like-does-in-bash.-it-feeds-the-output-from-the-previous-bit-of-code-to-the-next-bit-of-code.-it-is-extremely-common-practice-to-use-this-operator-in-the-tidyverse." class="section level5">
<h5>3. Excellent! Now, we have a nice tidy dataset that we can work with. You may have noticed some odd syntax <code>%&gt;%</code> in the code provided in the previous question. <code>%&gt;%</code> is the piping operator in R added by the <code>magittr</code> package. It works pretty much just like <code>|</code> does in bash. It &quot;feeds&quot; the output from the previous bit of code to the next bit of code. It is extremely common practice to use this operator in the <code>tidyverse</code>.</h5>
</div>
<div id="observe-the-head-of-mydf.-notice-how-our-question-column-has-the-value-d_age-text-has-the-content-age-and-selected_option-the-column-that-shows-the-answer-the-user-gave-has-the-actual-age-of-the-user.-wouldnt-it-be-better-if-our-mydf-had-a-new-column-called-age-instead-of-age-being-an-answer-to-a-question" class="section level5">
<h5>Observe the <code>head</code> of <code>myDF</code>. Notice how our <code>question</code> column has the value <code>d_age</code>, <code>text</code> has the content &quot;Age&quot;, and <code>selected_option</code> (the column that shows the &quot;answer&quot; the user gave), has the actual age of the user. Wouldn't it be better if our <code>myDF</code> had a new column called <code>age</code> instead of <code>age</code> being an answer to a question?</h5>
</div>
<div id="modify-the-code-provided-in-question-2-so-age-ends-up-being-a-column-in-mydf-with-the-value-being-the-actual-age-of-the-user." class="section level5">
<h5>Modify the code provided in question 2 so <code>age</code> ends up being a column in <code>myDF</code> with the value being the actual age of the user.</h5>
<p><strong>Hint:</strong> Pay close attention to <a href="https://tidyr.tidyverse.org/reference/pivot_longer.html"><code>pivot_longer</code></a>. You will need to understand what this function is doing to fix this.</p>
<p><strong>Hint:</strong> You can make a single modification to 1 line to accomplish this. Pay close attention to the <code>cols</code> option in <code>pivot_longer</code>. If you include a column in <code>cols</code> what happens? If you exclude a columns from <code>cols</code> what happens? Experiment on the following <code>tibble</code>, using different values for <code>cols</code>, as well as <code>names_to</code>, and <code>values_to</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myDF &lt;-<span class="st"> </span><span class="kw">tibble</span>(
    <span class="dt">x=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,
    <span class="dt">y=</span><span class="dv">1</span>,
    <span class="dt">question1=</span><span class="kw">c</span>(<span class="st">&quot;How&quot;</span>, <span class="st">&quot;What&quot;</span>, <span class="st">&quot;Why&quot;</span>),
    <span class="dt">question2=</span><span class="kw">c</span>(<span class="st">&quot;Really&quot;</span>, <span class="st">&quot;You sure&quot;</span>, <span class="st">&quot;When&quot;</span>),
    <span class="dt">question3=</span><span class="kw">c</span>(<span class="st">&quot;Who&quot;</span>, <span class="st">&quot;Seriously&quot;</span>, <span class="st">&quot;Right now&quot;</span>)
)</code></pre></div>
<p><strong>Challenge:</strong> (0 pts, for fun) If you are looking for a challenge, try to do this in excel or without <code>tidyverse</code>.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-indexing">Negative Indexing</a>, <a href="r.html#r-which">which</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The number of rows and columns in <code>myDF</code>.
</li>
<li>
The <code>head</code> of <code>myDF</code>.
</li>
</ul>
</div>
</div>
<div id="wow-that-is-pretty-powerful-okay-it-is-clear-that-there-are-question-questions-where-the-column-starts-with-q-and-other-questions-where-the-column-starts-with-something-else.-modify-question-3-so-all-of-the-questions-that-dont-start-with-q-have-their-own-column-in-mydf.-like-before-show-the-number-of-rows-and-columns-for-the-new-mydf-as-well-as-print-the-head." class="section level5">
<h5>4. Wow! That is pretty powerful! Okay, it is clear that there are question questions, where the column starts with &quot;q&quot;, and other questions, where the column starts with something else. Modify question (3) so all of the questions that <em>don't</em> start with &quot;q&quot; have their own column in <code>myDF</code>. Like before, show the number of rows and columns for the new <code>myDF</code>, as well as print the <code>head</code>.</h5>
<p><strong>Challenge:</strong> (0 pts, for fun) If you are looking for a challenge, try to do this in excel or without <code>tidyverse</code>.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-indexing">Negative Indexing</a>, <a href="r.html#r-which">which</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The number of rows and columns in <code>myDF</code>.
</li>
<li>
The <code>head</code> of <code>myDF</code>.
</li>
</ul>
</div>
</div>
<div id="it-seems-like-weve-spent-the-majority-of-the-project-just-wrangling-our-dataset----that-is-normal-youd-be-incredibly-lucky-to-work-in-an-environment-where-you-recieve-data-in-a-nice-neat-perfect-format.-lets-do-a-couple-basic-operations-now-to-practice." class="section level5">
<h5>5. It seems like we've spent the majority of the project just wrangling our dataset -- that is normal! You'd be incredibly lucky to work in an environment where you recieve data in a nice, neat, perfect format. Let's do a couple basic operations now, to practice.</h5>
</div>
<div id="mutate-is-a-powerful-function-in-dplyr-that-is-not-easy-to-mimic-in-pythons-pandas-package.-mutate-adds-new-columns-to-your-tibble-while-preserving-your-existing-columns.-it-doesnt-sound-very-powerful-but-it-is." class="section level5">
<h5><a href="https://dplyr.tidyverse.org/reference/mutate.html"><code>mutate</code></a> is a powerful function in <code>dplyr</code>, that is not easy to mimic in Python's <code>pandas</code> package. <code>mutate</code> adds new columns to your tibble, while preserving your existing columns. It doesn't sound very powerful, but it is.</h5>
</div>
<div id="use-mutate-to-create-a-new-column-called-generation.-generation-should-contain-gen-z-for-ages-0-24-millenial-for-ages-25-40-gen-x-for-ages-41-56-and-boomers-ii-for-ages-57-66-and-older-for-all-other-ages." class="section level5">
<h5>Use mutate to create a new column called <code>generation</code>. <code>generation</code> should contain &quot;Gen Z&quot; for ages [0, 24], &quot;Millenial&quot; for ages [25-40], &quot;Gen X&quot; for ages [41-56], and &quot;Boomers II&quot; for ages [57-66], and &quot;Older&quot; for all other ages.</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-mutate">mutate</a>, <a href="r.html#r-case_when">case_when</a>, <a href="r.html#r-between">between</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The number of rows and columns in <code>myDF</code>.
</li>
<li>
The <code>head</code> of <code>myDF</code>.
</li>
</ul>
</div>
</div>
<div id="use-ggplot-to-create-a-scatterplot-showing-d_age-on-the-x-axis-and-lf_min_age-on-the-y-axis.-lf_min_age-is-the-minimum-age-a-user-is-okay-dating.-color-the-points-based-on-gender2.-add-a-proper-title-and-labels-for-the-x-and-y-axes.-use-alpha.6." class="section level5">
<h5>6. Use <code>ggplot</code> to create a scatterplot showing <code>d_age</code> on the x-axis, and <code>lf_min_age</code> on the y-axis. <code>lf_min_age</code> is the minimum age a user is okay dating. Color the points based on <code>gender2</code>. Add a proper title, and labels for the X and Y axes. Use <code>alpha=.6</code>.</h5>
<p><strong>Note:</strong> This may take quite a few minutes to create. Before creating a plot with the entire <code>myDF</code>, use <code>myDF[1:10,]</code>. If you are in a time crunch, the minimum number of points to plot to get full credit is 100, but if you wait, the plot is a bit more telling.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-scatterplot">ggplot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
The plot produced.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="p11-290" class="section level3">
<h3>Project 11</h3>
<hr />
<p><strong>Motivation:</strong> Data wrangling is the process of gathering, cleaning, structuring, and transforming data. Data wrangling is a big part in any data driven project, and sometimes can take a great deal of time. <code>tidyverse</code> is a great, but opinionated, suite of integrated packages to wrangle, tidy and visualize data. It is useful to gain some familiarity with this collection of packages, in case you run into a situation where these packages are needed -- you may even find that you enjoy using them!</p>
<p><strong>Context:</strong> We have covered a few topics on the <code>tidyverse</code> packages, but there is a lot more to learn! We will continue our strong focus on the <code>tidyverse</code> (including <code>ggplot</code>) and data wrangling tasks.</p>
<p><strong>Scope:</strong> R, tidyverse, ggplot</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Explain the differences between regular data frames and tibbles.
</li>
<li>
Use mutate, pivot, unite, filter, and arrange to wrangle data and solve data-driven problems.
</li>
<li>
Combine different data using joins (left_join, right_join, semi_join, anti_join), and bind_rows.
</li>
<li>
Group data and calculate aggregated statistics using group_by, mutate, and transform functions.
</li>
<li>
Demonstrate the ability to create basic graphs with default settings, in <code>ggplot</code>.
</li>
<li>
Demonstrate the ability to modify axes labels and titles.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<p>The <code>tidyverse</code> consists of a variety of packages, including, but not limited to: <code>ggplot2</code>, <code>dplyr</code>, <code>tidyr</code>, <code>readr</code>, <code>purrr</code>, <code>tibble</code>, <code>stringr</code>, and <code>lubridate</code>.</p>
<p>One of the underlying premises of the <code>tidyverse</code> is getting the data to be <a href="https://r4ds.had.co.nz/tidy-data.html#tidy-data-1">tidy</a>. You can read a lot more about this in Hadley Wickham's excellent book, <a href="https://r4ds.had.co.nz">R for Data Science</a>.</p>
<p>There is an excellent graphic <a href="https://r4ds.had.co.nz/introduction.html#what-you-will-learn">here</a> that illustrates a general workflow for data science projects:</p>
<ol style="list-style-type: decimal">
<li>Import</li>
<li>Tidy</li>
<li>Iterate on, to gain understanding:
<ol style="list-style-type: decimal">
<li>Transform</li>
<li>Visualize</li>
<li>Model</li>
</ol></li>
<li>Communicate</li>
</ol>
<p>This is a good general outline of how a project could be organized, but depending on the project or company, this could vary greatly and change as the goals of a project change.</p>
<div id="dataset-19" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/okcupid/filtered/*.csv</code></p>
</div>
<div id="questions-23" class="section level4">
<h4>Questions</h4>
<div class="sourceCode"><pre class="sourceCode r solution"><code class="sourceCode r"><span class="kw">datamine_py</span>()
<span class="kw">library</span>(tidyverse)

questions &lt;-<span class="st"> </span><span class="kw">read_csv2</span>(<span class="st">&quot;/class/datamine/data/okcupid/filtered/questions.csv&quot;</span>)
users &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;/class/datamine/data/okcupid/filtered/users.csv&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r solution"><code class="sourceCode r">users<span class="op">$</span>id &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(users)
<span class="kw">set.seed</span>(<span class="dv">12345</span>)
columns_to_pivot &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">2278</span>
users_sample_long &lt;-<span class="st"> </span>users[<span class="kw">sample</span>(<span class="kw">nrow</span>(users), <span class="dv">2200</span>),] <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate_at</span>(columns_to_pivot, as.character) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> columns_to_pivot, <span class="dt">names_to=</span><span class="st">&quot;question&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;selected_option&quot;</span>)

myDF &lt;-<span class="st"> </span><span class="kw">merge</span>(users_sample_long, questions, <span class="dt">by.x =</span> <span class="st">&quot;question&quot;</span>, <span class="dt">by.y =</span> <span class="st">&quot;X&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r solution"><code class="sourceCode r">users<span class="op">$</span>id &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(users)
<span class="kw">set.seed</span>(<span class="dv">12345</span>)
columns_to_pivot &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">2278</span>
users_sample_long &lt;-<span class="st"> </span>users[<span class="kw">sample</span>(<span class="kw">nrow</span>(users), <span class="dv">2200</span>),] <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate_at</span>(columns_to_pivot, as.character) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> columns_to_pivot[<span class="op">-</span><span class="dv">1242</span>], <span class="dt">names_to=</span><span class="st">&quot;question&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;selected_option&quot;</span>)

myDF &lt;-<span class="st"> </span><span class="kw">merge</span>(users_sample_long, questions, <span class="dt">by.x =</span> <span class="st">&quot;question&quot;</span>, <span class="dt">by.y =</span> <span class="st">&quot;X&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r solution"><code class="sourceCode r">users<span class="op">$</span>id &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(users)
<span class="kw">set.seed</span>(<span class="dv">12345</span>)
columns_to_pivot &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">2278</span>
users_sample_long &lt;-<span class="st"> </span>users[<span class="kw">sample</span>(<span class="kw">nrow</span>(users), <span class="dv">2200</span>),] <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate_at</span>(columns_to_pivot, as.character) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> columns_to_pivot[<span class="op">-</span>(<span class="kw">which</span>(<span class="kw">substr</span>(<span class="kw">names</span>(users), <span class="dv">1</span>, <span class="dv">1</span>) <span class="op">!=</span><span class="st"> &quot;q&quot;</span>))], <span class="dt">names_to=</span><span class="st">&quot;question&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;selected_option&quot;</span>)

myDF &lt;-<span class="st"> </span><span class="kw">merge</span>(users_sample_long, questions, <span class="dt">by.x =</span> <span class="st">&quot;question&quot;</span>, <span class="dt">by.y =</span> <span class="st">&quot;X&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r solution"><code class="sourceCode r">myDF &lt;-<span class="st"> </span>myDF <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">generation=</span><span class="kw">case_when</span>(d_age<span class="op">&lt;=</span><span class="dv">24</span> <span class="op">~</span><span class="st"> &quot;Gen Z&quot;</span>,
                                     <span class="kw">between</span>(d_age, <span class="dv">25</span>, <span class="dv">40</span>) <span class="op">~</span><span class="st"> &quot;Millenial&quot;</span>,
                                     <span class="kw">between</span>(d_age, <span class="dv">41</span>, <span class="dv">56</span>) <span class="op">~</span><span class="st"> &quot;Gen X&quot;</span>,
                                     <span class="kw">between</span>(d_age, <span class="dv">57</span>, <span class="dv">66</span>) <span class="op">~</span><span class="st"> &quot;Boomers II&quot;</span>,
                                     <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Other&quot;</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r solution"><code class="sourceCode r"><span class="kw">ggplot</span>(myDF[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,]) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>d_age, <span class="dt">y =</span> lf_min_age, <span class="dt">col=</span>gender2), <span class="dt">alpha=</span>.<span class="dv">6</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Minimum dating age by gender&quot;</span>, <span class="dt">x=</span><span class="st">&quot;User age&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Minimum date age&quot;</span>)</code></pre></div>
<div id="lets-pick-up-where-we-left-in-project-10.-for-those-who-struggled-with-project-10-i-will-post-the-solutions-above-either-on-saturday-morning-or-at-the-latest-monday.-re-run-your-code-from-project-10-so-we-once-again-have-our-tibble-mydf." class="section level5">
<h5>1. Let's pick up where we left in project 10. For those who struggled with project 10, I will post the solutions above either on Saturday morning, or at the latest Monday. Re-run your code from project 10 so we, once again, have our <code>tibble</code>, <code>myDF</code>.</h5>
</div>
<div id="at-the-end-of-project-10-we-created-a-scatterplot-showing-d_age-on-the-x-axis-and-lf_min_age-on-the-y-axis.-in-addition-we-colored-the-points-by-gender2.-in-many-cases-instead-of-just-coloring-the-different-dots-we-may-want-to-do-the-exact-same-plot-for-different-groups.-this-can-easily-be-accomplished-using-ggplot." class="section level5">
<h5>At the end of project 10 we created a scatterplot showing <code>d_age</code> on the x-axis, and <code>lf_min_age</code> on the y-axis. In addition, we colored the points by <code>gender2</code>. In many cases, instead of just coloring the different dots, we may want to do the exact <em>same</em> plot for <em>different</em> groups. This can easily be accomplished using <code>ggplot</code>.</h5>
</div>
<div id="without-splitting-or-filtering-your-data-prior-to-creating-the-plots-create-a-graphic-with-plots-for-each-generation-where-we-show-d_age-on-the-x-axis-and-lf_min_age-on-the-y-axis-colored-by-gender2." class="section level5">
<h5><strong>Without</strong> splitting or filtering your data prior to creating the plots, create a graphic with plots for each <code>generation</code> where we show <code>d_age</code> on the x-axis and <code>lf_min_age</code> on the y-axis, colored by <code>gender2</code>.</h5>
<p><strong>Important note:</strong> You do not need to modify <code>myDF</code> at all.</p>
<p><strong>Important note:</strong> This may take quite a few minutes to create. Before creating a plot with the entire myDF, use myDF[1:50,]. If you are in a time crunch, the minimum number of points to plot to get full credit is 500, but if you wait, the plot is a bit more telling.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-facet_wrap">facet_wrap</a>, <a href="r.html#r-facet_grid">facet_grid</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
The plot produced.
</li>
</ul>
</div>
</div>
<div id="by-default-facet_wrap-and-facet_grid-maintain-the-same-scale-for-the-x-and-y-axes-across-the-various-plots.-this-makes-it-easier-to-compare-visually.-in-this-case-it-may-make-it-harder-to-see-the-patterns-that-emerge.-modify-your-code-from-question-1-to-allow-each-facet-to-have-its-own-x-and-y-axis-limits." class="section level5">
<h5>2. By default, <code>facet_wrap</code> and <code>facet_grid</code> maintain the same scale for the x and y axes across the various plots. This makes it easier to compare visually. In this case, it may make it harder to see the patterns that emerge. Modify your code from question (1) to allow each facet to have its own x and y axis limits.</h5>
<p><strong>Hint:</strong> Look at the argument <code>scales</code> in the <code>facet_wrap</code>/<code>facet_grid</code> functions.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-facet_wrap">facet_wrap</a>, <a href="r.html#r-facet_grid">facet_grid</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
The plot produced.
</li>
</ul>
</div>
</div>
<div id="lets-say-we-have-a-theory-that-the-older-generations-tend-to-smoke-more.-you-decided-you-want-to-create-a-plot-that-compares-the-percentage-of-smokers-per-generation.-before-we-do-this-we-need-to-wrangle-the-data-a-bit." class="section level5">
<h5>3. Let's say we have a theory that the older generations tend to smoke more. You decided you want to create a plot that compares the percentage of smokers per <code>generation</code>. Before we do this, we need to wrangle the data a bit.</h5>
</div>
<div id="what-are-the-possible-values-of-d_smokes-create-a-new-column-in-mydf-called-is_smoker-that-has-values-true-false-or-na-when-applicable.-you-will-need-to-determine-how-you-will-assign-a-user-as-a-smoker-or-not----this-is-up-to-you-explain-your-cutoffs.-make-sure-you-stay-in-the-tidyverse-to-solve-this-problem." class="section level5">
<h5>What are the possible values of <code>d_smokes</code>? Create a new column in <code>myDF</code> called <code>is_smoker</code> that has values <code>TRUE</code>, <code>FALSE</code>, or <code>NA</code> when applicable. You will need to determine how you will assign a user as a smoker or not -- this is up to you! Explain your cutoffs. Make sure you stay in the <code>tidyverse</code> to solve this problem.</h5>
<p><strong>Relevant topics:</strong> <a href="">unique</a>, <a href="">mutate</a>, <a href="">case_when</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
1-2 sentences explaining your logic and cutoffs for the new <code>is_smoker</code> column.
</li>
<li>
The <code>table</code> of the <code>is_smoker</code> column.
</li>
</ul>
</div>
</div>
<div id="great-now-that-we-have-our-new-is_smoker-column-create-a-new-tibble-called-smokers_per_gen.-smokers_per_gen-should-be-a-summary-of-mydf-containing-the-percentage-of-smokers-per-generation." class="section level5">
<h5>4. Great! Now that we have our new <code>is_smoker</code> column, create a new <code>tibble</code> called <code>smokers_per_gen</code>. <code>smokers_per_gen</code> should be a summary of <code>myDF</code> containing the percentage of smokers per <code>generation</code>.</h5>
<p><strong>Hint:</strong> The result, <code>smokers_per_gen</code> should have 2 columns: <code>generation</code> and <code>percentage_of_smokers</code>. It should have the same number of rows as there are <code>generation</code>s.</p>
<p><strong>Relevant topics:</strong> <a href="">group_by</a>, <a href="">summarize</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="create-a-cleveland-dot-plot-using-ggplot-to-show-the-percentage-of-smokers-for-the-different-generations.-use-ggthemr-to-give-your-plot-a-new-look-you-can-choose-any-theme-youd-like" class="section level5">
<h5>5. Create a Cleveland dot plot using <code>ggplot</code> to show the percentage of smokers for the different <code>generation</code>s. Use <code>ggthemr</code> to give your plot a new look! You can choose any theme you'd like!</h5>
</div>
<div id="is-our-theory-from-question-3-correct-explain-why-you-think-so-or-not." class="section level5">
<h5>Is our theory from question (3) correct? Explain why you think so, or not.</h5>
</div>
<div id="optional-i-0-points-to-make-the-plot-have-a-more-aesthetic-look-consider-reordering-the-data-by-percentage-of-smokers-or-even-by-the-generations-age.-you-can-do-that-before-passing-the-data-using-the-arrange-function-or-inside-the-geom_point-function-using-the-reorder-function.-to-re-order-by-generation-you-can-either-use-brute-force-or-you-can-create-a-new-column-called-avg_age-while-using-summarize.-avg_age-should-be-the-average-age-for-each-group-using-the-variable-d_age.-you-can-use-this-new-column-avg_age-to-re-order-the-data." class="section level5">
<h5>(OPTIONAL I, 0 points) To make the plot have a more aesthetic look, consider reordering the data by percentage of smokers, or even by the <code>generation</code>'s age. You can do that before passing the data using the <code>arrange</code> function, or inside the <code>geom_point</code> function, using the <code>reorder</code> function. To re-order by <code>generation</code>, you can either use brute force, or you can create a new column called <code>avg_age</code> while using <code>summarize</code>. <code>avg_age</code> should be the average age for each group (using the variable <code>d_age</code>). You can use this new column, <code>avg_age</code> to re-order the data.</h5>
</div>
<div id="optional-ii-0-points-improve-our-plot-change-the-x-axis-to-be-displayed-as-a-percentage.-you-can-use-the-scales-package-and-the-function-scale_x_continuous-to-accomplish-this." class="section level5">
<h5>(OPTIONAL II, 0 points) Improve our plot, change the x-axis to be displayed as a percentage. You can use the <code>scales</code> package and the function <code>scale_x_continuous</code> to accomplish this.</h5>
<p><strong>Hint:</strong> Use <code>geom_point</code> <strong>not</strong> <code>geom_dotplot</code> to solve this problem.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-geom_point">geom_point</a>, <a href="">ggthemr</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
The plot produced.
</li>
<li>
1-2 sentences commenting on the theory, and what are your conclusions based on your plot (if any).
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="p12-290" class="section level3">
<h3>Project 12</h3>
<hr />
<p><strong>Motivation:</strong> As we mentioned before, data wrangling is a big part in any data driven project. <a href="https://www.amazon.com/Exploratory-Data-Mining-Cleaning/dp/0471268518">&quot;Data Scientists spend up to 80% of the time on data cleaning and 20 percent of their time on actual data analysis.&quot;</a> Therefore, it is worth to spend some time mastering how to best tidy up our data.</p>
<p><strong>Context:</strong> We are continuing to practice using various <code>tidyverse</code> packages, in order to wrangle data.</p>
<p><strong>Scope:</strong> python</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Explain the differences between regular data frames and tibbles.
</li>
<li>
Use mutate, pivot, unite, filter, and arrange to wrangle data and solve data-driven problems.
</li>
<li>
Combine different data using joins (left_join, right_join, semi_join, anti_join), and bind_rows.
</li>
<li>
Group data and calculate aggregated statistics using group_by, mutate, and transform functions.
</li>
<li>
Demonstrate the ability to create basic graphs with default settings, in <code>ggplot</code>.
</li>
<li>
Demonstrate the ability to modify axes labels and titles.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<p>The first step in any data science project is to define our problem statement. In this project, our goal is to gain insights into customers' behaviours with regards to online orders and restaurant ratings.</p>
<div id="dataset-20" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/restaurant_recommendation/*.csv</code></p>
</div>
<div id="questions-24" class="section level4">
<h4>Questions</h4>
<div id="load-the-tidyverse-suite-a-packages-and-read-the-data-from-files-orders.csv-train_customers.csv-and-vendors.csv-into-tibbles-named-orders-customers-and-vendors-respectively." class="section level5">
<h5>1. Load the <code>tidyverse</code> suite a packages, and read the data from files <code>orders.csv</code>, <code>train_customers.csv</code>, and <code>vendors.csv</code> into <code>tibble</code>s named <code>orders</code>, <code>customers</code>, and <code>vendors</code> respectively.</h5>
</div>
<div id="take-a-look-the-tibbles-and-describe-in-a-few-sentences-the-type-of-information-contained-in-each-dataset.-although-the-name-can-be-self-explanatory-it-is-important-to-get-an-idea-of-what-exactly-we-are-looking-at.-for-each-combination-of-2-datasets-which-column-would-you-use-to-join-them" class="section level5">
<h5>Take a look the <code>tibble</code>s and describe in a few sentences the type of information contained in each dataset. Although the name can be self-explanatory, it is important to get an idea of what exactly we are looking at. For each combination of 2 datasets, which column would you use to join them?</h5>
<p><strong>Relevant topics:</strong> <a href="https://www.rdocumentation.org/packages/qtl2/versions/0.24/topics/read_csv">read_csv</a>, <a href="r.html#r-str">str</a>, <a href="https://www.rdocumentation.org/packages/dplyr/versions/0.3/topics/glimpse">glimpse</a>, <a href="r.html#r-head">head</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
1-2 sentences explaining each dataset (<code>orders</code>, <code>customers</code>, and <code>vendors</code>).
</li>
<li>
1-2 sentences for each combination of 2 datasets describing if we could combine the datasets or not, and which column you would you use to join them.
</li>
</ul>
</div>
</div>
<div id="lets-tidy-up-our-datasets-a-bit-prior-to-joining-them.-for-each-dataset-complete-the-tasks-below." class="section level5">
<h5>2. Let's tidy up our datasets a bit prior to joining them. For each dataset, complete the tasks below.</h5>
<ul>
<li><code>orders</code>: remove columns from and between <code>preparationtime</code> to <code>delivered_time</code> (inclusive).</li>
<li><code>customers</code>: take a look at the column <code>dob</code>. Based on its values, what do you believe it was supposed to contain? Can we rely on the numbers selected? Why or why not? Based on your answer, keep the columns <code>akeed_customer_id</code>, <code>gender</code>, and <code>dob</code>, OR just <code>akeed_customer_id</code> and <code>gender</code>.</li>
<li><code>vendors</code>: take a look at columns <code>country_id</code> and <code>city_id</code>. Would they be useful to compare the vendors in our dataset? Why or why not? If not, remove the columns from the dataset.</li>
</ul>
<p><strong>Relevant topics:</strong></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
1-2 sentences describing what columns you kept for <code>vendors</code> and <code>customers</code> and why.
</li>
</ul>
</div>
</div>
<div id="use-your-solutions-from-questions-1-and-2-and-the-join-functions-from-tidyverse-inner_join-left_join-right_join-and-full_join-to-create-a-single-tibble-called-mydf-containing-information-only-where-all-3-tibbles-intersect." class="section level5">
<h5>3. Use your solutions from questions (1) and (2), and the join functions from tidyverse (<code>inner_join</code>, <code>left_join</code>, <code>right_join</code>, and <code>full_join</code>) to create a single <code>tibble</code> called <code>myDF</code> containing information only where all 3 <code>tibble</code>s intersect.</h5>
</div>
<div id="for-example-we-do-not-want-mydf-to-contain-orders-from-customers-that-are-not-in-customers-tibble.-which-functions-from-the-tidyverse-did-you-use-to-merge-the-datasets-and-why" class="section level5">
<h5>For example, we do not want <code>myDF</code> to contain orders from customers that are not in <code>customers</code> tibble. Which function(s) from the tidyverse did you use to merge the datasets and why?</h5>
<p><strong>Hint:</strong> <code>myDF</code> should have 132,226 rows.</p>
<p><strong>Hint:</strong> When combining two datasets, you may want to change the argument <code>suffix</code> in the join function to specify from which dataset it came from. For example, when joining <code>customers</code> and <code>orders</code>: <code>*_join(customers, orders, suffix = c('_customers', '_orders'))</code>.</p>
<p><strong>Relevant topics:</strong> <a href="">inner_join</a>, <a href="">left_join</a>, <a href="">right_join</a>, <a href="">full_join</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
1-2 sentences describing which function you used, and why.
</li>
</ul>
</div>
</div>
<div id="great-now-we-have-a-single-tidy-dataset-to-work-with.-there-are-2-vendor-categories-in-mydf-restaurants-and-sweets-bakes.-we-would-expect-there-to-be-some-differences.-lets-compare-them-using-the-following-variables-deliverydistance-item_count-grand_total-and-vendor_discount_amount.-our-end-goal-by-the-end-of-question-5-is-to-create-a-histogram-colored-by-the-vendors-category-vendor_category_en-for-each-variable." class="section level5">
<h5>4. Great, now we have a single, tidy dataset to work with. There are 2 vendor categories in myDF, <code>Restaurants</code> and <code>Sweets &amp; Bakes</code>. We would expect there to be some differences. Let's compare them using the following variables: <code>deliverydistance</code>, <code>item_count</code>, <code>grand_total</code>, and <code>vendor_discount_amount</code>. Our end goal (by the end of question 5) is to create a histogram colored by the vendor's category (<code>vendor_category_en</code>), for each variable.</h5>
</div>
<div id="to-accomplish-this-easily-using-ggplot-we-will-take-advantage-of-pivot_longer.-pivot-columns-deliverydistance-item_count-grand_total-and-vendor_discount_amount-in-mydf.-the-end-result-should-be-a-tibble-with-columns-variable-and-values-which-contain-the-name-of-the-pivoted-column-variable-and-values-of-those-columns-values-call-this-modified-dataset-mydf_long." class="section level5">
<h5>To accomplish this easily using <code>ggplot</code>, we will take advantage of <code>pivot_longer</code>. Pivot columns <code>deliverydistance</code>, <code>item_count</code>, <code>grand_total</code>, and <code>vendor_discount_amount</code> in <code>myDF</code>. The end result should be a <code>tibble</code> with columns <code>variable</code> and <code>values</code>, which contain the name of the pivoted column (<code>variable</code>), and values of those columns (<code>values</code>) Call this modified dataset <code>myDF_long</code>.</h5>
<p><strong>Relevant topics:</strong> <a href="#r-pivot_longer">pivot_longer</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="now-that-we-have-the-data-in-the-ideal-format-for-our-plot-create-a-histogram-for-each-variable.-make-sure-to-color-them-by-vendor-category-vendor_category_en.-how-do-the-two-types-of-vendors-compare-in-these-4-variables" class="section level5">
<h5>5. Now that we have the data in the ideal format for our plot, create a histogram for each variable. Make sure to color them by vendor category (<code>vendor_category_en</code>). How do the two types of vendors compare in these 4 variables?</h5>
<p><strong>Hint:</strong> Use the argument <code>fill</code> instead of <code>color</code> in <code>geom_histogram</code>.</p>
<p><strong>Hint:</strong> You may want to add some transparency to your plot. Add it using <code>alpha</code> argument in <code>geom_histogram</code>.</p>
<p><strong>Hint:</strong> You may want to change the argument <code>scales</code> in <code>facet_*</code>.</p>
<p><strong>Relevant topics:</strong> <a href="">geom_histogram</a>, <a href="r.html#r-facet_wrap">facet_wrap</a>, <a href="r.html#r-facet_grid">facet_grid</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
2-3 sentences comparing <code>Restaurants</code> and <code>Sweets &amp; Bakes</code> for <code>deliverydistance</code>, <code>item_count</code>, <code>grand_total</code> and <code>vendor_discount_amount</code>.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
</div>
<div id="stat-39000" class="section level2">
<h2>STAT 39000</h2>
<div id="topics-2" class="section level3">
<h3>Topics</h3>
<p>The following table roughly highlights the topics and projects for the semester. This is slightly adjusted throughout the semester as student performance and feedback is taken into consideration.</p>
<table style="width:43%;">
<colgroup>
<col width="12%" />
<col width="13%" />
<col width="6%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th>Language</th>
<th>Project #</th>
<th>Name</th>
<th>Topics</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Python</td>
<td>1</td>
<td>Web scraping: part I</td>
<td>xml, lxml, pandas, etc.</td>
</tr>
<tr class="even">
<td>Python</td>
<td>2</td>
<td>Web scraping: part II</td>
<td>requests, functions, xml, loops, if statements, etc.</td>
</tr>
<tr class="odd">
<td>Python</td>
<td>3</td>
<td>Web scraping: part III</td>
<td>selenium, lxml, lists, pandas, etc.</td>
</tr>
<tr class="even">
<td>Python</td>
<td>4</td>
<td>Web scraping: part IV</td>
<td>requests, beautifulsoup4, lxml, selenium, xml, cronjobs, loops, etc.</td>
</tr>
<tr class="odd">
<td>Python</td>
<td>5</td>
<td>Web scraping: part V</td>
<td>web scraping + related topics</td>
</tr>
<tr class="even">
<td>Python</td>
<td>6</td>
<td>Plotting in Python: part I</td>
<td>ways to plot in Python, more work with pandas, etc.</td>
</tr>
<tr class="odd">
<td>Python</td>
<td>7</td>
<td>Plotting in Python: part II</td>
<td>ways to plot in Python, more work with pandas, etc.</td>
</tr>
<tr class="even">
<td>Python</td>
<td>8</td>
<td>Writing scripts: part I</td>
<td>how to write scripts in Python, more work with pandas, matplotlib, etc.</td>
</tr>
<tr class="odd">
<td>Python</td>
<td>9</td>
<td>Writing scripts: part II</td>
<td>how to write scripts in Python, argparse, more work with pandas, matplotlib, etc.</td>
</tr>
<tr class="even">
<td>R</td>
<td>10</td>
<td>ggplot: part I</td>
<td>ggplot basics</td>
</tr>
<tr class="odd">
<td>R</td>
<td>11</td>
<td>ggplot: part II</td>
<td>more ggplot</td>
</tr>
<tr class="even">
<td>R</td>
<td>12</td>
<td>tidyverse &amp; data.table: part I</td>
<td>data wrangling and computation using tidyverse packages and data.table, maybe some slurm?</td>
</tr>
<tr class="odd">
<td>R</td>
<td>13</td>
<td>tidyverse &amp; data.table: part II</td>
<td>data wrangling and computation using tidyverse packages and data.table, maybe some slurm?</td>
</tr>
<tr class="even">
<td>R</td>
<td>14</td>
<td>tidyverse &amp; data.table: part III</td>
<td>data wrangling and computation using tidyverse packages and data.table, maybe some slurm?</td>
</tr>
</tbody>
</table>
</div>
<div id="p01-390" class="section level3">
<h3>Project 1</h3>
<hr />
<p><strong>Motivation:</strong> Extensible Markup Language or XML is a very important file format for storing structured data. Even though formats like JSON, and csv tend to be more prevalent, many, many legacy systems still use XML, and it remains an appropriate format for storing complex data. In fact, JSON and csv are quickly becoming less relevant as new formats and serialization methods like <a href="https://arrow.apache.org/faq/">parquet</a> and <a href="https://developers.google.com/protocol-buffers">protobufs</a> are becoming more common.</p>
<p><strong>Context:</strong> In previous semesters we've explored XML. In this project we will refresh our skills and, rather than exploring XML in R, we will use the <code>lxml</code> package in Python. This is the first project in a series of 5 projects focused on web scraping in R and Python.</p>
<p><strong>Scope:</strong> python, XML</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Review and summarize the differences between XML and HTML/CSV.
</li>
<li>
Match XML terms to sections of XML demonstrating working knowledge.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset-21" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/apple/health/watch_dump.xml</code></p>
</div>
<div id="resources-1" class="section level4">
<h4>Resources</h4>
<p>We realize that it may be a while since you've used Python. That's okay! We are going to be taking things at a much more reasonable pace than Spring 2020.</p>
<p>Some potentially useful resources for the semester include:</p>
<ul>
<li>The STAT 19000 projects. We are easing 19000 students into Python and will post solutions each week. It would be well worth 10 minutes to look over the questions and solutions each week.</li>
<li><a href="https://towardsdatascience.com/cheat-sheet-for-python-dataframe-r-dataframe-syntax-conversions-450f656b44ca">Here</a> is a decent cheat sheet that helps you quickly get an idea of how to do something you know how to do in R, in Python.</li>
<li><a href="https://thedatamine.github.io/the-examples-book/">The Examples Book</a> -- updating daily with more examples and videos. Be sure to click on the &quot;relevant topics&quot; links as we try to point you to topics with examples that should be particularly useful to solve the problems we assign.</li>
</ul>
</div>
<div id="questions-25" class="section level4">
<h4>Questions</h4>
<p><strong>Important note:</strong> It would be well worth your time to read through the <a href="data-formats.html#xml">xml section</a> of the book, as well as take the time to work through <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/10min.html">pandas 10 minute intro</a>.</p>
<div id="a-good-first-step-when-working-with-xml-is-to-get-an-idea-how-your-document-is-structured.-normally-there-should-be-good-documentation-that-spells-this-out-for-you-but-it-is-good-to-know-what-to-do-when-you-dont-have-the-documentation.-start-by-finding-the-root-node.-what-is-the-name-of-the-root-node-of-the-provided-dataset-1" class="section level5">
<h5>1. A good first step when working with XML is to get an idea how your document is structured. Normally, there should be good documentation that spells this out for you, but it is good to know what to do when you <em>don't</em> have the documentation. Start by finding the &quot;root&quot; node. What is the name of the root node of the provided dataset?</h5>
<p><strong>Hint:</strong> Make sure to import the <code>lxml</code> package first:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> lxml <span class="im">import</span> etree</code></pre></div>
<p>Here are two videos about running Python in RStudio:</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_nhkygxg9">Click here for video</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_tdz3wmim">Click here for video</a></p>
<p>and here is a video about XML scraping in Python:</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_1ywsbxyp">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-lxml">lxml</a>, <a href="data-formats.html#xml">xml</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-57" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">from</span> lxml <span class="im">import</span> etree

tree <span class="op">=</span> etree.parse(<span class="st">&quot;/class/datamine/data/apple/health/watch_dump.xml&quot;</span>)

tree.xpath(<span class="st">&quot;/*&quot;</span>)[<span class="dv">0</span>].tag</code></pre></div>
</div>
<div id="remember-xml-can-be-nested.-in-question-1-we-figured-out-what-the-root-node-was-called.-what-are-the-names-of-the-next-tier-of-elements-1" class="section level5">
<h5>2. Remember, XML can be nested. In question (1) we figured out what the root node was called. What are the names of the next &quot;tier&quot; of elements?</h5>
<p><strong>Hint:</strong> Now that we know the root node, you could use the root node name as a part of your xpath expression.</p>
<p><strong>Hint:</strong> As you may have noticed in question (1) the <code>xpath</code> method returns a list. Sometimes this list can contain many repeated tag names. Since our goal is to see the names of the second &quot;tier&quot; elements, you could convert the resulting <code>list</code> to a <code>set</code> to quickly see the unique list as <code>set</code>'s only contain unique values.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-for-loops">for loops</a>, <a href="python.html#p-lxml">lxml</a>, <a href="data-formats.html#xml">xml</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-58" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/*&quot;</span>)])</code></pre></div>
</div>
<div id="continue-to-explore-each-tier-of-data-until-there-isnt-any-left.-name-the-full-paths-of-all-of-the-last-tier-tags.-1" class="section level5">
<h5>3. Continue to explore each &quot;tier&quot; of data until there isn't any left. Name the &quot;full paths&quot; of all of the &quot;last tier&quot; tags.</h5>
<p><strong>Hint:</strong> Let's say a &quot;last tier&quot; tag is just a path where there are no more nested elements. For example, <code>/HealthData/Workout/WorkoutRoute/FileReference</code> is a &quot;last tier&quot; tag. If you try and get the nested elements for it, they don't exist:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">tree.xpath(<span class="st">&quot;/HealthData/Workout/WorkoutRoute/FileReference/*&quot;</span>)</code></pre></div>
<p><strong>Hint:</strong> Here are 3 of the 7 &quot;full paths&quot;:</p>
<pre><code>/HealthData/Workout/WorkoutRoute/FileReference
/HealthData/Record/MetadataEntry
/HealthData/ActivitySummary</code></pre>
<p><strong>Relevant topics:</strong> <a href="python.html#p-lxml">lxml</a>, <a href="data-formats.html#xml">xml</a>, <a href="python.html#p-for-loops">for loops</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-59" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/*&quot;</span>)]))

<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/ActivitySummary/*&quot;</span>)]))
<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/Record/*&quot;</span>)]))
<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/Workout/*&quot;</span>)]))

<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/Record/HeartRateVariabilityMetadataList/*&quot;</span>)]))
<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/Record/MetadataEntry/*&quot;</span>)]))
<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/Workout/WorkoutEvent/*&quot;</span>)]))
<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/Workout/WorkoutRoute/*&quot;</span>)]))
<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/Workout/WorkoutEntry/*&quot;</span>)]))

<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/Record/HeartRateVariabilityMetadataList/InstantaneousBeatsPerMinute/*&quot;</span>)]))
<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/Workout/WorkoutRoute/FileReference/*&quot;</span>)]))
<span class="bu">print</span>(<span class="bu">set</span>([x.tag <span class="cf">for</span> x <span class="kw">in</span> tree.xpath(<span class="st">&quot;/HealthData/Workout/WorkoutRoute/MetadataEntry/*&quot;</span>)]))</code></pre></div>
<div class="solution">
<p>
/HealthData/Record/HeartRateVariabilityMetadataList/InstantaneousBeatsPerMinute /HealthData/Workout/WorkoutRoute/FileReference /HealthData/Workout/WorkoutRoute/MetadataEntry /HealthData/Record/MetadataEntry /HealthData/Workout/WorkoutEvent /HealthData/Workout/WorkoutEntry /HealthData/ActivitySummary
</p>
</div>
</div>
<div id="at-this-point-in-time-you-may-be-asking-yourself-but-where-is-the-data-depending-on-the-structure-of-the-xml-file-the-data-could-either-be-between-tags-like-1" class="section level5">
<h5>4. At this point in time you may be asking yourself &quot;but where is the data&quot;? Depending on the structure of the XML file, the data could either be between tags like:</h5>
<div class="sourceCode"><pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;some_tag&gt;</span>mydata<span class="kw">&lt;/some_tag&gt;</span></code></pre></div>
</div>
<div id="or-it-could-be-in-an-attribute-1" class="section level5">
<h5>Or, it could be in an attribute:</h5>
<div class="sourceCode"><pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;question</span><span class="ot"> answer=</span><span class="st">&quot;tac&quot;</span><span class="kw">&gt;</span>What is cat spelled backwards?<span class="kw">&lt;/question&gt;</span></code></pre></div>
</div>
<div id="collect-the-activitysummary-data-and-convert-the-list-of-dicts-to-a-pandas-dataframe.-the-following-is-an-example-of-converting-a-list-of-dicts-to-a-pandas-dataframe-called-mydf-1" class="section level5">
<h5>Collect the &quot;ActivitySummary&quot; data, and convert the list of dicts to a <code>pandas</code> DataFrame. The following is an example of converting a list of dicts to a <code>pandas</code> DataFrame called <code>myDF</code>:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> pandas <span class="im">as</span> pd

list_of_dicts <span class="op">=</span> []
list_of_dicts.append({<span class="st">&#39;columnA&#39;</span>: <span class="dv">1</span>, <span class="st">&#39;columnB&#39;</span>: <span class="dv">2</span>})
list_of_dicts.append({<span class="st">&#39;columnB&#39;</span>: <span class="dv">4</span>, <span class="st">&#39;columnA&#39;</span>: <span class="dv">1</span>}) 

myDF <span class="op">=</span> pd.DataFrame(list_of_dicts)</code></pre></div>
<p><strong>Hint:</strong> It is important to note that an element's &quot;attrib&quot; attribute looks and feels like a <code>dict</code>, but it is actually a <code>lxml.etree._Attrib</code>. If you try to convert a list of <code>lxml.etree._Attrib</code> to a <code>pandas</code> DataFrame, it will not work out as you planned. Make sure to first convert each <code>lxml.etree._Attrib</code> to a <code>dict</code> before converting to a DataFrame. You can do so like:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co"># this will convert a single `lxml.etree._Attrib` to a dict</span>
my_dict <span class="op">=</span> <span class="bu">dict</span>(my_lxml_etree_attrib)</code></pre></div>
<p><strong>Relevant topics:</strong> <a href="python.html#p-dicts">dicts</a>, <a href="#p-lists">lists</a>, <a href="python.html#p-lxml">lxml</a>, <a href="data-formats.html#xml">xml</a>, <a href="python.html#p-for-loops">for loops</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-60" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">dat <span class="op">=</span> tree.xpath(<span class="st">&quot;/HealthData/ActivitySummary&quot;</span>)
list_of_dicts <span class="op">=</span> []

<span class="cf">for</span> e <span class="kw">in</span> dat:
    list_of_dicts.append(<span class="bu">dict</span>(e.attrib))
    
myDF <span class="op">=</span> pd.DataFrame(data<span class="op">=</span>list_of_dicts)
myDF.sort_values([<span class="st">&#39;activeEnergyBurned&#39;</span>], ascending<span class="op">=</span><span class="va">False</span>).head()</code></pre></div>
</div>
<div id="pandas-is-a-python-package-that-provides-the-dataframe-and-series-classes.-a-dataframe-is-very-similar-to-a-data.frame-in-r-and-can-be-used-to-manipulate-the-data-within-very-easily.-a-series-is-the-class-that-handles-a-single-column-of-a-dataframe.-go-through-the-pandas-in-10-minutes-page-from-the-official-documentation.-sort-find-and-print-the-top-5-rows-of-data-based-on-the-activeenergyburned-column.-1" class="section level5">
<h5>5. <code>pandas</code> is a Python package that provides the DataFrame and Series classes. A DataFrame is very similar to a data.frame in R and can be used to manipulate the data within very easily. A Series is the class that handles a single column of a DataFrame. Go through the <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/10min.html">pandas in 10 minutes</a> page from the official documentation. Sort, find, and print the top 5 rows of data based on the &quot;activeEnergyBurned&quot; column.</h5>
<p><strong>Relevant topics:</strong> <a href="python.html#p-pandas">pandas</a>, <a href="python.html#p-dicts">dicts</a>, <a href="#p-lists">lists</a>, <a href="python.html#p-lxml">lxml</a>, <a href="data-formats.html#xml">xml</a>, <a href="python.html#p-for-loops">for loops</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-61" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="co"># could be anything</span></code></pre></div>
<hr />
</div>
</div>
</div>
<div id="p02-390" class="section level3">
<h3>Project 2</h3>
<hr />
<p><strong>Motivation:</strong> Web scraping is is the process of taking content off of the internet. Typically this goes hand-in-hand with parsing or processing the data. Depending on the task at hand, web scraping can be incredibly simple. With that being said, it can quickly become difficult. Typically, students find web scraping fun and empowering.</p>
<p><strong>Context:</strong> In the previous project we gently introduced XML and xpath expressions. In this project, we will learn about web scraping, scrape data from The New York Times, and parse through our newly scraped data using xpath expressions.</p>
<p><strong>Scope:</strong> python, web scraping, xml</p>
<p><strong>Learning objectives:</strong> <a href="data-formats.html#html">html</a></p>
<div class="bbox">
<ul>
<li>
Review and summarize the differences between XML and HTML/CSV.
</li>
<li>
Use the requests package to scrape a web page.
</li>
<li>
Use the lxml package to filter and parse data from a scraped web page.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset-22" class="section level4">
<h4>Dataset</h4>
<p>You will be extracting your own data from online in this project. There is no base dataset.</p>
</div>
<div id="questions-26" class="section level4">
<h4>Questions</h4>
<div id="the-new-york-times-is-one-of-the-most-popular-newspapers-in-the-united-states.-open-a-modern-browser-preferably-firefox-or-chrome-and-navigate-to-httpsnytimes.com.-1" class="section level5">
<h5>1. The New York Times is one of the most popular newspapers in the United States. Open a modern browser (preferably Firefox or Chrome), and navigate to <a href="https://nytimes.com" class="uri">https://nytimes.com</a>.</h5>
</div>
<div id="by-the-end-of-this-project-you-will-be-able-to-scrape-some-data-from-this-website-the-first-step-is-to-explore-the-structure-of-the-website.-you-can-either-right-click-and-click-on-view-page-source-which-will-pull-up-a-page-full-of-html-used-to-render-the-page.-alternatively-if-you-want-to-focus-on-a-single-element-an-article-title-for-example-right-click-on-the-article-title-and-click-on-inspect-element.-this-will-pull-up-an-inspector-that-allows-you-to-see-portions-of-the-html.-1" class="section level5">
<h5>By the end of this project you will be able to scrape some data from this website! The first step is to explore the structure of the website. You can either right click and click on &quot;view page source&quot;, which will pull up a page full of HTML used to render the page. Alternatively, if you want to focus on a single element, an article title, for example, right click on the article title and click on &quot;inspect element&quot;. This will pull up an inspector that allows you to see portions of the HTML.</h5>
</div>
<div id="click-around-the-website-and-explore-the-html-however-you-see-fit.-open-a-few-front-page-articles-and-notice-how-most-articles-start-with-a-bunch-of-really-important-information-namely-an-article-title-summary-picture-picture-caption-picture-source-author-portraits-authors-and-article-datetime.-1" class="section level5">
<h5>Click around the website and explore the HTML however you see fit. Open a few front page articles and notice how most articles start with a bunch of really important information, namely: an article title, summary, picture, picture caption, picture source, author portraits, authors, and article datetime.</h5>
</div>
<div id="for-example-1" class="section level5">
<h5>For example:</h5>
<p><a href="https://www.nytimes.com/2021/01/19/us/politics/trump-china-xinjiang.html" class="uri">https://www.nytimes.com/2021/01/19/us/politics/trump-china-xinjiang.html</a></p>
<div class="figure">
<img src="images/nytimes_image.jpg" />

</div>
</div>
<div id="copy-and-paste-the-h1-element-in-its-entirety-containing-the-article-title-for-the-article-provided-in-an-html-code-chunk.-do-the-same-for-the-same-articles-summary.-1" class="section level5">
<h5>Copy and paste the <strong>h1</strong> element (in its entirety) containing the article title (for the article provided) in an HTML code chunk. Do the same for the same article's summary.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_eew0i16y">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="data-formats.html#html">html</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
2 code chunks containing the HTML requested.
</li>
</ul>
</div>
</div>
<div id="solution-62" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode html solution"><code class="sourceCode html"><span class="kw">&lt;h1</span><span class="ot"> id=</span><span class="st">&quot;link-4686dc8b&quot;</span><span class="ot"> class=</span><span class="st">&quot;css-rsa88z e1h9rw200&quot;</span><span class="ot"> data-test-id=</span><span class="st">&quot;headline&quot;</span><span class="kw">&gt;</span>U.S. Says China’s Repression of Uighurs Is ‘Genocide’<span class="kw">&lt;/h1&gt;</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode html solution"><code class="sourceCode html"><span class="kw">&lt;p</span><span class="ot"> id=</span><span class="st">&quot;article-summary&quot;</span><span class="ot"> class=</span><span class="st">&quot;css-w6ymp8 e1wiw3jv0&quot;</span><span class="kw">&gt;</span>The finding by the Trump administration is the strongest denunciation by any government of China’s actions and follows a Biden campaign statement with the same declaration.<span class="kw">&lt;/p&gt;</span></code></pre></div>
</div>
<div id="in-question-1-we-copied-two-elements-of-an-article.-when-scraping-data-from-a-website-it-is-important-to-continually-consider-the-patterns-in-the-structure.-specifically-it-is-important-to-consider-whether-or-not-the-defining-characteristics-you-use-to-parse-the-scraped-data-will-continue-to-be-in-the-same-format-for-new-data.-what-do-i-mean-by-defining-characterstic-i-mean-some-combination-of-tag-attribute-and-content-from-which-you-can-isolate-the-data-of-interest.-1" class="section level5">
<h5>2. In question (1) we copied two elements of an article. When scraping data from a website, it is important to continually consider the patterns in the structure. Specifically, it is important to consider whether or not the defining characteristics you use to parse the scraped data will continue to be in the same format for <em>new</em> data. What do I mean by defining characterstic? I mean some combination of tag, attribute, and content from which you can isolate the data of interest.</h5>
</div>
<div id="for-example-given-a-link-to-a-new-nytimes-article-do-you-think-you-could-isolate-the-article-title-by-using-the-idlink-4686dc8b-attribute-of-the-h1-tag-maybe-or-maybe-not-but-it-sure-seems-like-link-4686dc8b-might-be-unique-to-the-article-and-not-able-to-be-used-given-a-new-article.-1" class="section level5">
<h5>For example, given a link to a new nytimes article, do you think you could isolate the article title by using the <code>id=&quot;link-4686dc8b&quot;</code> attribute of the <strong>h1</strong> tag? Maybe, or maybe not, but it sure seems like &quot;link-4686dc8b&quot; might be unique to the article and not able to be used given a new article.</h5>
</div>
<div id="write-an-xpath-expression-to-isolate-the-article-title-and-another-xpath-expression-to-isolate-the-article-summary.-1" class="section level5">
<h5>Write an xpath expression to isolate the article title, and another xpath expression to isolate the article summary.</h5>
<p><strong>Important note:</strong> You do <em>not</em> need to test your xpath expression yet, we will be doing that shortly.</p>
<p><strong>Relevant topics:</strong> <a href="data-formats.html#html">html</a>, <a href="data-formats.html#xml">xml</a>, <a href="data-formats.html#xml-xpath">xpath expressions</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Two xpath expressions in an HTML code chunk.
</li>
</ul>
</div>
</div>
<div id="solution-63" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode html solution"><code class="sourceCode html">//h1[@data-test-id=&quot;headline&quot;]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode html solution"><code class="sourceCode html">//p[@id=&quot;article-summary&quot;]</code></pre></div>
</div>
<div id="use-the-requests-package-to-scrape-the-webpage-containing-our-article-from-questions-1-and-2.-use-the-lxml.html-package-and-the-xpath-method-to-test-out-your-xpath-expressions-from-question-2.-did-they-work-print-the-content-of-the-elements-to-confirm.-1" class="section level5">
<h5>3. Use the <code>requests</code> package to scrape the webpage containing our article from questions (1) and (2). Use the <code>lxml.html</code> package and the <code>xpath</code> method to test out your xpath expressions from question (2). Did they work? Print the content of the elements to confirm.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_qw2xb058">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="data-formats.html#html">html</a>, <a href="data-formats.html#xml">xml</a>, <a href="data-formats.html#xml-xpath">xpath expressions</a>, <a href="python.html#p-lxml">lxml</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-64" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">import</span> lxml.html
<span class="im">import</span> requests

url <span class="op">=</span>  <span class="st">&quot;https://www.nytimes.com/2021/01/19/us/politics/trump-china-xinjiang.html&quot;</span>
response <span class="op">=</span> requests.get(url, stream<span class="op">=</span><span class="va">True</span>)
response.raw.decode_content <span class="op">=</span> <span class="va">True</span>
tree <span class="op">=</span> lxml.html.parse(response.raw)

<span class="bu">print</span>(tree.xpath(<span class="st">&#39;//p[@id=&quot;article-summary&quot;]&#39;</span>)[<span class="dv">0</span>].text)
<span class="bu">print</span>(tree.xpath(<span class="st">&#39;//h1[@data-test-id=&quot;headline&quot;]&#39;</span>)[<span class="dv">0</span>].text)</code></pre></div>
</div>
<div id="here-are-a-list-of-article-links-from-httpsnytimes.com-1" class="section level5">
<h5>4. Here are a list of article links from <a href="https://nytimes.com" class="uri">https://nytimes.com</a>:</h5>
<p><a href="https://www.nytimes.com/2021/01/19/us/politics/trump-china-xinjiang.html" class="uri">https://www.nytimes.com/2021/01/19/us/politics/trump-china-xinjiang.html</a></p>
<p><a href="https://www.nytimes.com/2021/01/06/technology/personaltech/tech-2021-augmented-reality-chatbots-wifi.html" class="uri">https://www.nytimes.com/2021/01/06/technology/personaltech/tech-2021-augmented-reality-chatbots-wifi.html</a></p>
<p><a href="https://www.nytimes.com/2021/01/13/movies/letterboxd-growth.html" class="uri">https://www.nytimes.com/2021/01/13/movies/letterboxd-growth.html</a></p>
</div>
<div id="write-a-function-called-get_article_and_summary-that-accepts-a-string-called-link-as-an-argument-and-returns-both-the-article-title-and-summary.-test-get_article_and_summary-out-on-each-of-the-provided-links-1" class="section level5">
<h5>Write a function called <code>get_article_and_summary</code> that accepts a string called <code>link</code> as an argument, and returns both the article title and summary. Test <code>get_article_and_summary</code> out on each of the provided links:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">title, summary <span class="op">=</span> get_article_and_summary(<span class="st">&#39;https://www.nytimes.com/2021/01/19/us/politics/trump-china-xinjiang.html&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;Title: </span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">, Summary: </span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&#39;</span>)
title, summary <span class="op">=</span> get_article_and_summary(<span class="st">&#39;https://www.nytimes.com/2021/01/06/technology/personaltech/tech-2021-augmented-reality-chatbots-wifi.html&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;Title: </span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">, Summary: </span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&#39;</span>)
title, summary <span class="op">=</span> get_article_and_summary(<span class="st">&#39;https://www.nytimes.com/2021/01/13/movies/letterboxd-growth.html&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;Title: </span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">, Summary: </span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&#39;</span>)</code></pre></div>
<p><strong>Hint:</strong> The first line of your function should look like this:</p>
<p><code>def get_article_and_summary(myURL: str) -&gt; (str, str):</code></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_jrtrt5fo">Click here for video</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_7yhabkeg">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="data-formats.html#html">html</a>, <a href="data-formats.html#xml">xml</a>, <a href="data-formats.html#xml-xpath">xpath expressions</a>, <a href="python.html#p-lxml">lxml</a>, <a href="python.html#p-writing-functions">functions</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-65" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">from</span> typing <span class="im">import</span> Tuple
<span class="im">import</span> lxml.html
<span class="im">import</span> requests

<span class="kw">def</span> get_article_and_summary(link: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">str</span>]:
    <span class="co">&quot;&quot;&quot;</span>
<span class="co">    Given a link to a new york times article, return the article title and summary.</span>

<span class="co">    Args:</span>
<span class="co">        link (str): The link to the new york times article.</span>

<span class="co">    Returns:</span>
<span class="co">        Tuple[str, str]: A tuple first containing the article title, and then the article summary.</span>
<span class="co">    &quot;&quot;&quot;</span>
    
    <span class="co"># scrape the web page</span>
    response <span class="op">=</span> requests.get(link, stream<span class="op">=</span><span class="va">True</span>)
    response.raw.decode_content <span class="op">=</span> <span class="va">True</span>
    tree <span class="op">=</span> lxml.html.parse(response.raw)
    
    title <span class="op">=</span> tree.xpath(<span class="st">&#39;//p[@id=&quot;article-summary&quot;]&#39;</span>)[<span class="dv">0</span>].text
    summary <span class="op">=</span> tree.xpath(<span class="st">&#39;//h1[@data-test-id=&quot;headline&quot;]&#39;</span>)[<span class="dv">0</span>].text
    
    <span class="cf">return</span> title, summary</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">title, summary <span class="op">=</span> get_article_and_summary(<span class="st">&#39;https://www.nytimes.com/2021/01/19/us/politics/trump-china-xinjiang.html&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;Title: </span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">, Summary: </span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&#39;</span>)
title, summary <span class="op">=</span> get_article_and_summary(<span class="st">&#39;https://www.nytimes.com/2021/01/06/technology/personaltech/tech-2021-augmented-reality-chatbots-wifi.html&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;Title: </span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">, Summary: </span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&#39;</span>)
title, summary <span class="op">=</span> get_article_and_summary(<span class="st">&#39;https://www.nytimes.com/2021/01/13/movies/letterboxd-growth.html&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;Title: </span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">, Summary: </span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&#39;</span>)</code></pre></div>
</div>
<div id="in-question-1-we-mentioned-a-myriad-of-other-important-information-given-at-the-top-of-most-new-york-times-articles.-choose-two-other-listed-pieces-of-information-and-copy-paste-and-update-your-solution-to-question-4-to-scrape-and-return-those-chosen-pieces-of-information." class="section level5">
<h5>5. In question (1) we mentioned a myriad of other important information given at the top of most New York Times articles. Choose <strong>two</strong> other listed pieces of information and copy, paste, and update your solution to question (4) to scrape and return those chosen pieces of information.</h5>
<p><strong>Important note:</strong> If you choose to scrape non-textual data, be sure to return data of an appropriate type. For example, if you choose to scrape one of the images, either print the image or return a PIL object.</p>
<p><strong>Relevant topics:</strong> <a href="data-formats.html#html">html</a>, <a href="data-formats.html#xml">xml</a>, <a href="data-formats.html#xml-xpath">xpath expressions</a>, <a href="python.html#p-lxml">lxml</a>, <a href="python.html#p-writing-functions">functions</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-66" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">from</span> typing <span class="im">import</span> Tuple
<span class="im">import</span> lxml.html
<span class="im">import</span> requests
<span class="im">import</span> io
<span class="im">from</span> PIL <span class="im">import</span> Image
<span class="im">from</span> IPython.display <span class="im">import</span> display

<span class="kw">def</span> get_article_and_summary(link: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">str</span>]:
    <span class="co">&quot;&quot;&quot;</span>
<span class="co">    Given a link to a new york times article, return the article title and summary.</span>

<span class="co">    Args:</span>
<span class="co">        link (str): The link to the new york times article.</span>

<span class="co">    Returns:</span>
<span class="co">        Tuple[str, str]: A tuple first containing the article title, and then the article summary.</span>
<span class="co">    &quot;&quot;&quot;</span>
    
    <span class="co"># scrape the web page</span>
    response <span class="op">=</span> requests.get(link, stream<span class="op">=</span><span class="va">True</span>)
    response.raw.decode_content <span class="op">=</span> <span class="va">True</span>
    tree <span class="op">=</span> lxml.html.parse(response.raw)
    
    <span class="co"># parse out the title</span>
    title <span class="op">=</span> tree.xpath(<span class="st">&#39;//p[@id=&quot;article-summary&quot;]&#39;</span>)[<span class="dv">0</span>].text
    
    <span class="co"># parse out the summary</span>
    summary <span class="op">=</span> tree.xpath(<span class="st">&#39;//h1[@data-test-id=&quot;headline&quot;]&#39;</span>)[<span class="dv">0</span>].text
    
    <span class="co"># parse out the url to the image</span>
    photo_src <span class="op">=</span> tree.xpath(<span class="st">&#39;//picture/img&#39;</span>)[<span class="dv">0</span>].attrib.get(<span class="st">&quot;src&quot;</span>)
    
    <span class="co"># scrape image</span>
    photo_content <span class="op">=</span> requests.get(photo_src).content
    
    <span class="co"># convert image format </span>
    photo_file <span class="op">=</span> io.BytesIO(photo_content)
    photo <span class="op">=</span> Image.<span class="bu">open</span>(photo_file).convert(<span class="st">&#39;RGB&#39;</span>)    
    
    <span class="co"># parse out photo caption</span>
    caption <span class="op">=</span> tree.xpath(<span class="st">&#39;//figcaption/span&#39;</span>)[<span class="dv">0</span>].text
    
    <span class="co"># parse out the photo credits</span>
    credits <span class="op">=</span> tree.xpath(<span class="st">&#39;//figcaption/span/span[contains(text(), &quot;Credit&quot;)]/following-sibling::span/span&#39;</span>)
    
    credits_list <span class="op">=</span> []
    <span class="cf">for</span> c <span class="kw">in</span> credits:
        credits_list.append(c.text)
        
    <span class="co"># parse author photo url</span>
    <span class="co"># only gets if &quot;author&quot; in photo src attribute</span>
    photo_src_elements <span class="op">=</span> tree.xpath(<span class="st">&#39;//img[contains(@src, &quot;author&quot;)]&#39;</span>)
    
    <span class="co"># if &quot;author&quot; in photo src attribute</span>
    photo_srcs <span class="op">=</span> []
    <span class="cf">for</span> p <span class="kw">in</span> photo_src_elements:
        photo_srcs.append(p.attrib.get(<span class="st">&quot;src&quot;</span>))
    
    <span class="co"># scrape image</span>
    author_images <span class="op">=</span> []
    <span class="cf">for</span> img <span class="kw">in</span> photo_srcs:
        photo_content <span class="op">=</span> requests.get(img).content
    
        <span class="co"># convert image format </span>
        photo_file <span class="op">=</span> io.BytesIO(photo_content)
        photo <span class="op">=</span> Image.<span class="bu">open</span>(photo_file).convert(<span class="st">&#39;RGB&#39;</span>)    
        
        author_images.append(photo)
        
    <span class="co"># parse out authors</span>
    authors_elements <span class="op">=</span> tree.xpath(<span class="st">&quot;//span[@class=&#39;byline-prefix&#39;]/following-sibling::a/span&quot;</span>)
    authors <span class="op">=</span> []
    <span class="cf">for</span> a <span class="kw">in</span> authors_elements:
        authors.append(a.text)
        
    <span class="co"># parse out article publish date/time</span>
    dt <span class="op">=</span> tree.xpath(<span class="st">&quot;//time&quot;</span>)[<span class="dv">0</span>].attrib.get(<span class="st">&quot;datetime&quot;</span>)
    
    <span class="cf">return</span> title, summary, photo, caption, credits, author_images, authors, dt



title, summary, photo, caption, credits, author_images, authors, dt <span class="op">=</span> get_article_and_summary(<span class="st">&#39;https://www.nytimes.com/2021/01/19/us/politics/trump-china-xinjiang.html&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;Title:</span><span class="ch">\n</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">, Summary:</span><span class="ch">\n</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">, Caption:</span><span class="ch">\n</span><span class="sc">{</span>caption<span class="sc">}</span><span class="ss">&#39;</span>)
title, summary, photo, caption, credits, author_images, authors, dt <span class="op">=</span> get_article_and_summary(<span class="st">&#39;https://www.nytimes.com/2021/01/06/technology/personaltech/tech-2021-augmented-reality-chatbots-wifi.html&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;Title:</span><span class="ch">\n</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">, Summary:</span><span class="ch">\n</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">, Caption:</span><span class="ch">\n</span><span class="sc">{</span>caption<span class="sc">}</span><span class="ss">&#39;</span>)
title, summary, photo, caption, credits, author_images, authors, dt <span class="op">=</span> get_article_and_summary(<span class="st">&#39;https://www.nytimes.com/2021/01/13/movies/letterboxd-growth.html&#39;</span>)
<span class="bu">print</span>(<span class="ss">f&#39;Title:</span><span class="ch">\n</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">, Summary:</span><span class="ch">\n</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">, Caption:</span><span class="ch">\n</span><span class="sc">{</span>caption<span class="sc">}</span><span class="ss">&#39;</span>)</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="p03-390" class="section level3">
<h3>Project 3</h3>
<hr />
<p><strong>Motivation:</strong> Web scraping takes practice, and it is important to work through a variety of common tasks in order to know how to handle those tasks when you next run into them. In this project, we will use a variety of scraping tools in order to scrape data from <a href="https://trulia.com" class="uri">https://trulia.com</a>.</p>
<p><strong>Context:</strong> In the previous project, we got our first taste at actually scraping data from a website, and using a parser to extract the information we were interested in. In this project, we will introduce some tasks that will require you to use a tool that let's you interact with a browser, selenium.</p>
<p><strong>Scope:</strong> python, web scraping, selenium</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Review and summarize the differences between XML and HTML/CSV.
</li>
<li>
Use the requests package to scrape a web page.
</li>
<li>
Use the lxml package to filter and parse data from a scraped web page.
</li>
<li>
Use selenium to interact with a browser in order to get a web page to a desired state for scraping.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="questions-27" class="section level4">
<h4>Questions</h4>
<div id="visit-httpstrulia.com.-many-websites-have-a-similar-interface-i.e.-a-bold-and-centered-search-bar-for-a-user-to-interact-with.-using-selenium-write-python-code-that-that-first-finds-the-input-element-and-then-types-west-lafayette-in-followed-by-an-emulated-enterreturn.-confirm-you-code-works-by-printing-the-url-after-that-process-completes.-1" class="section level5">
<h5>1. Visit <a href="https://trulia.com" class="uri">https://trulia.com</a>. Many websites have a similar interface, i.e. a bold and centered search bar for a user to interact with. Using <code>selenium</code> write Python code that that first finds the <code>input</code> element, and then types &quot;West Lafayette, IN&quot; followed by an emulated &quot;Enter/Return&quot;. Confirm you code works by printing the url after that process completes.</h5>
<p><strong>Hint:</strong> You will want to use <code>time.sleep</code> to pause a bit after the search so the updated url is returned.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_ztju698f">Click here for video</a></p>
<p>That video is already relevant for Question 2 too.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-selenium">selenium</a>, <a href="data-formats.html#xml">xml</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-67" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">from</span> selenium <span class="im">import</span> webdriver
<span class="im">from</span> selenium.webdriver.common.keys <span class="im">import</span> Keys
<span class="im">from</span> selenium.webdriver.firefox.options <span class="im">import</span> Options
<span class="im">from</span> selenium.common.exceptions <span class="im">import</span> NoSuchElementException

<span class="im">import</span> time</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">firefox_options <span class="op">=</span> Options()
firefox_options.add_argument(<span class="st">&quot;window-size=1920,1080&quot;</span>)
firefox_options.add_argument(<span class="st">&quot;--headless&quot;</span>) <span class="co"># Headless mode means no GUI</span>
firefox_options.add_argument(<span class="st">&quot;start-maximized&quot;</span>)
firefox_options.add_argument(<span class="st">&quot;disable-infobars&quot;</span>)
firefox_options.add_argument(<span class="st">&quot;--disable-extensions&quot;</span>)
firefox_options.add_argument(<span class="st">&quot;--no-sandbox&quot;</span>)
firefox_options.add_argument(<span class="st">&quot;--disable-dev-shm-usage&quot;</span>)
firefox_options.binary_location <span class="op">=</span> <span class="st">&#39;/class/datamine/apps/firefox/firefox&#39;</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">driver <span class="op">=</span> webdriver.Firefox(options<span class="op">=</span>firefox_options, executable_path<span class="op">=</span><span class="st">&#39;/class/datamine/apps/geckodriver&#39;</span>)
url <span class="op">=</span> <span class="st">&#39;https://www.trulia.com&#39;</span>
driver.get(url)

search_input <span class="op">=</span> driver.find_element_by_id(<span class="st">&quot;banner-search&quot;</span>)
search_input.send_keys(<span class="st">&quot;West Lafayette, IN&quot;</span>)
search_input.send_keys(Keys.RETURN)
time.sleep(<span class="dv">3</span>)
<span class="bu">print</span>(driver.current_url)</code></pre></div>
</div>
<div id="use-your-code-from-question-1-to-test-out-the-following-queries-1" class="section level5">
<h5>2. Use your code from question (1) to test out the following queries:</h5>
<ul>
<li>West Lafayette, IN (City, State)</li>
<li>47906 (Zip)</li>
<li>4505 Kahala Ave, Honolulu, HI 96816 (Full address)</li>
</ul>
</div>
<div id="if-you-look-closely-you-will-see-that-there-are-patterns-in-the-url.-for-example-the-following-link-would-probably-bring-up-homes-in-crawfordsville-in-httpstrulia.comincrawfordsville.-with-that-being-said-if-you-only-had-a-zip-code-like-47933-it-wouldnt-be-easy-to-guess-httpswww.trulia.comincrawfordsville47933-hence-one-reason-why-the-search-bar-is-useful.-1" class="section level5">
<h5>If you look closely you will see that there are patterns in the url. For example, the following link would probably bring up homes in Crawfordsville, IN: <a href="https://trulia.com/IN/Crawfordsville" class="uri">https://trulia.com/IN/Crawfordsville</a>. With that being said, if you only had a zip code, like 47933, it wouldn't be easy to guess <a href="https://www.trulia.com/IN/Crawfordsville/47933/" class="uri">https://www.trulia.com/IN/Crawfordsville/47933/</a>, hence, one reason why the search bar is useful.</h5>
</div>
<div id="if-you-used-xpath-expressions-to-complete-question-1-instead-use-a-different-method-to-find-the-input-element.-if-you-used-a-different-method-use-xpath-expressions-to-complete-question-1.-1" class="section level5">
<h5>If you used xpath expressions to complete question (1), instead use a <a href="https://selenium-python.readthedocs.io/locating-elements.html#locating-elements">different method</a> to find the <code>input</code> element. If you used a different method, use xpath expressions to complete question (1).</h5>
<p><strong>Relevant topics:</strong> <a href="python.html#p-selenium">selenium</a>, <a href="data-formats.html#xml">xml</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-68" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">driver <span class="op">=</span> webdriver.Firefox(options<span class="op">=</span>firefox_options, executable_path<span class="op">=</span><span class="st">&#39;/class/datamine/apps/geckodriver&#39;</span>)
url <span class="op">=</span> <span class="st">&#39;https://www.trulia.com&#39;</span>
driver.get(url)

search_input <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//input[@id=&#39;banner-search&#39;]&quot;</span>)
search_input.send_keys(<span class="st">&quot;West Lafayette, IN&quot;</span>)
search_input.send_keys(Keys.RETURN)
time.sleep(<span class="dv">3</span>)
<span class="bu">print</span>(driver.current_url)</code></pre></div>
</div>
<div id="lets-call-the-page-after-a-citystate-or-zipcode-search-a-sales-page.-for-example-1" class="section level5">
<h5>3. Let's call the page after a city/state or zipcode search a &quot;sales page&quot;. For example:</h5>
<div class="figure">
<img src="images/trulia.png" />

</div>
</div>
<div id="use-requests-to-scrape-the-entire-page-httpswww.trulia.cominwest_lafayette47906.-use-lxml.html-to-parse-the-page-and-get-all-of-the-img-elements-that-make-up-the-house-pictures-on-the-left-side-of-the-website.-1" class="section level5">
<h5>Use <code>requests</code> to scrape the entire page: <a href="https://www.trulia.com/IN/West_Lafayette/47906/" class="uri">https://www.trulia.com/IN/West_Lafayette/47906/</a>. Use <code>lxml.html</code> to parse the page and get all of the <code>img</code> elements that make up the house pictures on the left side of the website.</h5>
<p><strong>Important note:</strong> Make sure you are actually scraping what you think you are scraping! Try printing your html to confirm it has the content you think it should have:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> requests
response <span class="op">=</span> requests.get(...)
<span class="bu">print</span>(response.text)</code></pre></div>
<p><strong>Hint:</strong> Are you human? Depends. Sometimes if you add a header to your request, it won't ask you if you are human. Let's pretend we are Firefox:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> requests
my_headers <span class="op">=</span> {<span class="st">&#39;User-Agent&#39;</span>: <span class="st">&#39;Mozilla/5.0&#39;</span>}
response <span class="op">=</span> requests.get(..., headers<span class="op">=</span>my_headers)</code></pre></div>
</div>
<div id="okay-after-all-of-that-work-you-may-have-discovered-that-only-a-few-images-have-actually-been-scraped.-if-you-cycle-through-all-of-the-img-elements-and-try-to-print-the-value-of-the-src-attribute-this-will-be-clear-1" class="section level5">
<h5>Okay, after all of that work you may have discovered that only a few images have actually been scraped. If you cycle through all of the <code>img</code> elements and try to print the value of the <code>src</code> attribute, this will be clear:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> lxml.html
tree <span class="op">=</span> lxml.html.fromstring(response.text)
elements <span class="op">=</span> tree.xpath(<span class="st">&quot;//img&quot;</span>)
<span class="cf">for</span> element <span class="kw">in</span> elements:
    <span class="bu">print</span>(element.attrib.get(<span class="st">&quot;src&quot;</span>))</code></pre></div>
</div>
<div id="this-is-because-the-webpage-is-not-immediately-completely-loaded.-this-is-a-common-website-behavior-to-make-things-appear-faster.-if-you-pay-close-to-when-you-load-httpswww.trulia.comincrawfordsville47933-and-you-quickly-scroll-down-you-will-see-images-still-needing-to-finish-rendering-all-of-the-way-slowly.-what-we-need-to-do-to-fix-this-is-use-selenium-instead-of-lxml.html-to-behave-like-a-human-and-scroll-prior-to-scraping-the-page-try-using-the-following-code-to-slowly-scroll-down-the-page-before-finding-the-elements-1" class="section level5">
<h5>This is because the webpage is not immediately, <em>completely</em> loaded. This is a common website behavior to make things appear faster. If you pay close to when you load <a href="https://www.trulia.com/IN/Crawfordsville/47933/" class="uri">https://www.trulia.com/IN/Crawfordsville/47933/</a>, and you quickly scroll down, you will see images still needing to finish rendering all of the way, slowly. What we need to do to fix this, is use <code>selenium</code> (instead of <code>lxml.html</code>) to behave like a human and scroll prior to scraping the page! Try using the following code to slowly scroll down the page before finding the elements:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co"># driver setup and get the url</span>

<span class="co"># Needed to get the window size set right and scroll in headless mode</span>
myheight <span class="op">=</span> driver.execute_script(<span class="st">&#39;return document.body.scrollHeight&#39;</span>)
driver.set_window_size(<span class="dv">1080</span>,myheight<span class="op">+</span><span class="dv">100</span>)

<span class="kw">def</span> scroll(driver, scroll_point):  
    driver.execute_script(<span class="ss">f&#39;window.scrollTo(0, </span><span class="sc">{</span>scroll_point<span class="sc">}</span><span class="ss">);&#39;</span>)
    time.sleep(<span class="dv">5</span>) 
    
scroll(driver, myheight<span class="op">*</span><span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)
scroll(driver, myheight<span class="op">*</span><span class="dv">2</span><span class="op">/</span><span class="dv">4</span>)
scroll(driver, myheight<span class="op">*</span><span class="dv">3</span><span class="op">/</span><span class="dv">4</span>)
scroll(driver, myheight<span class="op">*</span><span class="dv">4</span><span class="op">/</span><span class="dv">4</span>)

<span class="co"># find_elements_by_*</span></code></pre></div>
<p><strong>Hint:</strong> At the time of writing there should be about 86 links to images of homes.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_v9iesfnc">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-selenium">selenium</a>, <a href="data-formats.html#xml">xml</a>, <a href="python.html#p-for-loops">loops</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-69" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">driver <span class="op">=</span> webdriver.Firefox(options<span class="op">=</span>firefox_options, executable_path<span class="op">=</span><span class="st">&#39;/Users/kamstut/Downloads/geckodriver&#39;</span>)
url <span class="op">=</span> <span class="st">&#39;https://www.trulia.com/IN/West_Lafayette/47906/&#39;</span>
driver.get(url)

<span class="co"># Needed to get the window size set right and scroll in headless mode</span>
height <span class="op">=</span> driver.execute_script(<span class="st">&#39;return document.body.scrollHeight&#39;</span>)
driver.set_window_size(<span class="dv">1080</span>,height<span class="op">+</span><span class="dv">100</span>)

<span class="kw">def</span> scroll(driver, scroll_point):  
    driver.execute_script(<span class="ss">f&#39;window.scrollTo(0, </span><span class="sc">{</span>scroll_point<span class="sc">}</span><span class="ss">);&#39;</span>)
    time.sleep(<span class="dv">5</span>) 
    
scroll(driver, height<span class="op">/</span><span class="dv">4</span>)
scroll(driver, height<span class="op">/</span><span class="dv">4</span><span class="op">*</span><span class="dv">2</span>)
scroll(driver, height<span class="op">/</span><span class="dv">4</span><span class="op">*</span><span class="dv">3</span>)
scroll(driver, height)

elements <span class="op">=</span> driver.find_elements_by_xpath(<span class="st">&quot;//picture/img&quot;</span>)
<span class="bu">print</span>(<span class="bu">len</span>(elements))
<span class="cf">for</span> e <span class="kw">in</span> elements:
    <span class="bu">print</span>(e.get_attribute(<span class="st">&quot;src&quot;</span>))</code></pre></div>
</div>
<div id="write-a-function-called-avg_house_cost-that-accepts-a-zip-code-as-an-argument-and-returns-the-average-cost-of-the-first-page-of-homes.-now-to-make-this-a-more-meaningful-statistic-filter-for-3-beds-and-then-find-the-average.-test-avg_house_cost-out-on-the-zip-code-47906-and-print-the-average-costs.-1" class="section level5">
<h5>4. Write a function called <code>avg_house_cost</code> that accepts a zip code as an argument, and returns the average cost of the first page of homes. Now, to make this a more meaningful statistic, filter for &quot;3+&quot; beds and <em>then</em> find the average. Test <code>avg_house_cost</code> out on the zip code <code>47906</code> and print the average costs.</h5>
<p><strong>Important note:</strong> Use <code>selenium</code> to &quot;click&quot; on the &quot;3+ beds&quot; filter.</p>
<p><strong>Hint:</strong> If you get an error that tells you <code>button</code> is not clickable because it is covered by an <code>li</code> element, try clicking on the <code>li</code> element instead.</p>
<p><strong>Hint:</strong> You will want to wait a solid 10-15 seconds for the sales page to load before trying to select or click on anything.</p>
<p><strong>Hint:</strong> Your results may end up including prices for &quot;Homes Near &lt;ZIPCODE&gt;&quot;. This is okay. Even better if you manage to remove those results. If you <em>do</em> choose to remove those results, take a look at the <code>data-testid</code> attribute with value <code>search-result-list-container</code>. Perhaps only selecting the children of the first element will get the desired outcome.</p>
<p><strong>Hint:</strong> You can use the following code to remove the non-numeric text from a string, and then convert to an integer:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> re

<span class="bu">int</span>(re.sub(<span class="st">&quot;[^0-9]&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;removenon45454_numbers$&quot;</span>))</code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_ahm64jjz">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-selenium">selenium</a>, <a href="data-formats.html#xml">xml</a>, <a href="python.html#p-for-loops">loops</a>, <a href="#p-functions">functions</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-70" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">from</span> selenium.webdriver.support.ui <span class="im">import</span> WebDriverWait
<span class="im">import</span> re

<span class="kw">def</span> avg_house_cost(<span class="bu">zip</span>: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">float</span>:
    firefox_options <span class="op">=</span> Options()
    firefox_options.add_argument(<span class="st">&quot;window-size=1920,1080&quot;</span>)
    <span class="co"># firefox_options.add_argument(&quot;--headless&quot;) # Headless mode means no GUI</span>
    firefox_options.add_argument(<span class="st">&quot;start-maximized&quot;</span>)
    firefox_options.add_argument(<span class="st">&quot;disable-infobars&quot;</span>)
    firefox_options.add_argument(<span class="st">&quot;--disable-extensions&quot;</span>)
    firefox_options.add_argument(<span class="st">&quot;--no-sandbox&quot;</span>)
    firefox_options.add_argument(<span class="st">&quot;--disable-dev-shm-usage&quot;</span>)
    firefox_options.binary_location <span class="op">=</span> <span class="st">&#39;/Applications/Firefox.app/Contents/MacOS/firefox&#39;</span>
    
    driver <span class="op">=</span> webdriver.Firefox(options<span class="op">=</span>firefox_options, executable_path<span class="op">=</span><span class="st">&#39;/Users/kamstut/Downloads/geckodriver&#39;</span>)
    url <span class="op">=</span> <span class="st">&#39;https://www.trulia.com/&#39;</span>
    driver.get(url)
    
    search_input <span class="op">=</span> driver.find_element_by_id(<span class="st">&quot;banner-search&quot;</span>)
    search_input.send_keys(<span class="bu">zip</span>)
    search_input.send_keys(Keys.RETURN)
    time.sleep(<span class="dv">10</span>)
    
    allbed_button <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//button[@data-testid=&#39;srp-xl-bedrooms-filter-button&#39;]/ancestor::li&quot;</span>)
    allbed_button.click()
    time.sleep(<span class="dv">2</span>)
    
    bed_button <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//button[contains(text(), &#39;3+&#39;)]&quot;</span>)
    bed_button.click()
    time.sleep(<span class="dv">3</span>)
    
    price_elements <span class="op">=</span> driver.find_elements_by_xpath(<span class="st">&quot;(//div[@data-testid=&#39;search-result-list-container&#39;])[1]//div[@data-testid=&#39;property-price&#39;]&quot;</span>)
    prices <span class="op">=</span> [<span class="bu">int</span>(re.sub(<span class="st">&quot;[^0-9]&quot;</span>, <span class="st">&quot;&quot;</span>, e.text)) <span class="cf">for</span> e <span class="kw">in</span> price_elements]
    
    driver.quit()
    
    <span class="cf">return</span> <span class="bu">sum</span>(prices)<span class="op">/</span><span class="bu">len</span>(prices)
    
avg_house_cost(<span class="st">&#39;47906&#39;</span>)</code></pre></div>
</div>
<div id="get-creative.-either-add-an-interesting-feature-to-your-function-from-4-or-use-matplotlib-to-generate-some-sort-of-accompanying-graphic-with-your-output.-make-sure-to-explain-what-your-additions-do.-1" class="section level5">
<h5>5. Get creative. Either add an interesting feature to your function from (4), or use <code>matplotlib</code> to generate some sort of accompanying graphic with your output. Make sure to explain what your additions do.</h5>
<p><strong>Relevant topics:</strong> <a href="python.html#p-selenium">selenium</a>, <a href="data-formats.html#xml">xml</a>, <a href="python.html#p-for-loops">loops</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-71" class="section level5">
<h5>Solution</h5>
<div class="solution">
<p>
Could be anything.
</p>
</div>
<hr />
</div>
</div>
</div>
<div id="p04-390" class="section level3">
<h3>Project 4</h3>
<hr />
<p><strong>Motivation:</strong> In this project we will continue to hone your web scraping skills, introduce you to some &quot;gotchas&quot;, and give you a little bit of exposure to a powerful tool called cron.</p>
<p><strong>Context:</strong> We are in the second to last project focused on web scraping. This project will introduce some supplementary tools that work well with web scraping: cron, sending emails from Python, etc.</p>
<p><strong>Scope:</strong> python, web scraping, selenium, cron</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Review and summarize the differences between XML and HTML/CSV.
</li>
<li>
Use the requests package to scrape a web page.
</li>
<li>
Use the lxml package to filter and parse data from a scraped web page.
</li>
<li>
Use the beautifulsoup4 package to filter and parse data from a scraped web page.
</li>
<li>
Use selenium to interact with a browser in order to get a web page to a desired state for scraping.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="questions-28" class="section level4">
<h4>Questions</h4>
<div id="check-out-the-following-website-httpsproject4.tdm.wiki-1" class="section level5">
<h5>1. Check out the following website: <a href="https://project4.tdm.wiki" class="uri">https://project4.tdm.wiki</a></h5>
</div>
<div id="use-selenium-to-scrape-and-print-the-6-colors-of-pants-offered.-1" class="section level5">
<h5>Use <code>selenium</code> to scrape and print the 6 colors of pants offered.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_j3ik06bo">Click here for video for Question 1</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_tr8qvwn3">Here is a video about the new feature to reset your RStudio session if you make a big mistake or if your session is very slow</a></p>
<p><strong>Hint:</strong> You <em>may</em> have to interact with the webpage for certain elements to render.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-scraping">scraping</a>, <a href="python.html#p-selenium">selenium</a>, <a href="python.html#p-selenium-example01">example clicking a button</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-72" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">from</span> selenium <span class="im">import</span> webdriver
<span class="im">from</span> selenium.webdriver.common.keys <span class="im">import</span> Keys
<span class="im">from</span> selenium.webdriver.firefox.options <span class="im">import</span> Options
<span class="im">from</span> selenium.common.exceptions <span class="im">import</span> NoSuchElementException

<span class="im">import</span> time</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python">driver.get(<span class="st">&quot;https://project4.tdm.wiki/&quot;</span>)

elements <span class="op">=</span> driver.find_elements_by_xpath(<span class="st">&quot;//span[@class=&#39;ui-component-card--color-amount&#39;]&quot;</span>)
<span class="cf">for</span> element <span class="kw">in</span> elements:
    <span class="bu">print</span>(element.text)

<span class="co"># click the &quot;wild colors&quot; button</span>
label <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//label[@for=&#39;ui-component-toggle__wild&#39;]&quot;</span>)
label.click()

elements <span class="op">=</span> driver.find_elements_by_xpath(<span class="st">&quot;//span[@class=&#39;ui-component-card--color-amount&#39;]&quot;</span>)
<span class="cf">for</span> element <span class="kw">in</span> elements:
    <span class="bu">print</span>(element.text)
    
driver.quit()</code></pre></div>
</div>
<div id="websites-are-updated-frequently.-you-can-imagine-a-scenario-where-a-change-in-a-website-is-a-sign-that-there-is-more-data-available-or-that-something-of-note-has-happened.-this-is-a-fake-website-designed-to-help-students-emulate-real-changes-to-a-website.-specifically-there-is-one-part-of-the-website-that-has-two-possible-states-lets-say-state-a-and-state-b.-upon-refreshing-the-website-or-scraping-the-website-again-there-is-an-x-chance-that-the-website-will-be-in-state-a-and-a-1-x-chance-the-website-will-be-in-state-b.-1" class="section level5">
<h5>2. Websites are updated frequently. You can imagine a scenario where a change in a website is a sign that there is more data available, or that something of note has happened. This is a fake website designed to help students emulate real changes to a website. Specifically, there is one part of the website that has two possible states (let's say, state <code>A</code> and state <code>B</code>). Upon refreshing the website, or scraping the website again, there is an <span class="math inline">\(x\%\)</span> chance that the website will be in state <code>A</code> and a <span class="math inline">\(1-x\%\)</span> chance the website will be in state <code>B</code>.</h5>
</div>
<div id="describe-the-two-states-the-thing-element-or-set-of-elements-that-changes-as-you-refresh-the-page-and-scrape-the-website-enough-to-estimate-x.-1" class="section level5">
<h5>Describe the two states (the thing (element or set of elements) that changes as you refresh the page), and scrape the website enough to estimate <span class="math inline">\(x\)</span>.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_2zaiodzi">Click here for video for Questions 2 and 3</a></p>
<p><strong>Hint:</strong> You <em>will</em> need to interact with the website to &quot;see&quot; the change.</p>
<p><strong>Hint:</strong> Since we are just asking about a state, and not any specific element, you could use the <code>page_source</code> attribute of the <code>selenium</code> driver to scrape the entire page instead of trying to use xpath expressions to find a specific element.</p>
<p><strong>Hint:</strong> Your estimate of <span class="math inline">\(x\)</span> does not need to be perfect.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-scraping">scraping</a>, <a href="python.html#p-selenium">selenium</a>, <a href="python.html#p-selenium-example01">example clicking a button</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
What state <code>A</code> and <code>B</code> represent.
</li>
<li>
An estimate for <code>x</code>.
</li>
</ul>
</div>
</div>
<div id="solution-73" class="section level5">
<h5>Solution</h5>
<div class="solution">
<p>
25% in stock 75% out of stock -- anything remotely close give full credit
</p>
</div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="co"># The state of the Chartreuse pants, sold out (A) or in stock (B)</span>
driver <span class="op">=</span> webdriver.Firefox(options<span class="op">=</span>firefox_options, executable_path<span class="op">=</span><span class="st">&#39;/class/datamine/apps/geckodriver&#39;</span>)
driver.get(<span class="st">&quot;https://project4.tdm.wiki/&quot;</span>)

<span class="co"># click the &quot;wild colors&quot; button</span>
label <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//label[@for=&#39;ui-component-toggle__wild&#39;]&quot;</span>)
label.click()

stateA <span class="op">=</span> driver.page_source
stateAct <span class="op">=</span> <span class="dv">0</span>
stateBct <span class="op">=</span> <span class="dv">0</span>
<span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):
    driver <span class="op">=</span> webdriver.Firefox(options<span class="op">=</span>firefox_options, executable_path<span class="op">=</span><span class="st">&#39;/class/datamine/apps/geckodriver&#39;</span>)
    driver.get(<span class="st">&quot;https://project4.tdm.wiki/&quot;</span>)

    <span class="co"># click the &quot;wild colors&quot; button</span>
    label <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//label[@for=&#39;ui-component-toggle__wild&#39;]&quot;</span>)
    label.click()
    
    <span class="cf">if</span> driver.page_source <span class="op">==</span> stateA:
        stateAct <span class="op">+=</span> <span class="dv">1</span>
    <span class="cf">else</span>:
        stateBct <span class="op">+=</span> <span class="dv">1</span>

    driver.quit()

<span class="bu">print</span>(<span class="ss">f&quot;State A: </span><span class="sc">{</span>stateAct<span class="sc">}</span><span class="ss">&quot;</span>)
<span class="bu">print</span>(<span class="ss">f&quot;State B: </span><span class="sc">{</span>stateBct<span class="sc">}</span><span class="ss">&quot;</span>)</code></pre></div>
</div>
<div id="dig-into-the-changing-thing-from-question-2.-what-specifically-is-changing-use-selenium-and-xpath-expressions-to-scrape-and-print-the-content.-what-are-the-two-possible-values-for-the-content-1" class="section level5">
<h5>3. Dig into the changing &quot;thing&quot; from question (2). What specifically is changing? Use selenium and xpath expressions to scrape and print the content. What are the two possible values for the content?</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_2zaiodzi">Click here for video (same as above) for Questions 2 and 3</a></p>
<p><strong>Hint:</strong> Due to the changes that occur when a button is clicked, I'd highly advice you to use the <code>data-color</code> attribute in your xpath expression instead of <code>contains(text(), 'blahblah')</code>.</p>
<p><strong>Hint:</strong> <code>parent::</code> and <code>following-sibling::</code> may be useful <a href="https://www.w3schools.com/xml/xpath_axes.asp">xpath axes</a> to use.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-scraping">scraping</a>, <a href="python.html#p-selenium">selenium</a>, <a href="python.html#p-selenium-example01">example using <code>following-sibling::</code></a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-74" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="co"># The state of the Chartreuse pants, sold out (A) or in stock (B)</span>
driver <span class="op">=</span> webdriver.Firefox(options<span class="op">=</span>firefox_options, executable_path<span class="op">=</span><span class="st">&#39;/class/datamine/apps/geckodriver&#39;</span>)
driver.get(<span class="st">&quot;https://project4.tdm.wiki/&quot;</span>)

<span class="co"># click the &quot;wild colors&quot; button</span>
label <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//label[@for=&#39;ui-component-toggle__wild&#39;]&quot;</span>)
label.click()

element <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//span[@data-color=&#39;Chartreuse&#39;]/parent::div/following-sibling::div/span&quot;</span>)
<span class="bu">print</span>(element.text)

driver.quit()</code></pre></div>
</div>
<div id="the-following-code-allows-you-to-send-an-email-using-python-from-your-purdue-email-account.-replace-the-username-and-password-with-your-own-information-and-send-a-test-email-to-yourself-to-ensure-that-it-works.-1" class="section level5">
<h5>4. The following code allows you to send an email using Python from your Purdue email account. Replace the username and password with your own information and send a test email to yourself to ensure that it works.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_dt6j3sov">Click here for video for Questions 4 and 5</a></p>
<p><strong>Important note:</strong> Do <strong>NOT</strong> include your password in your homework submission. Any time you need to type your password in you final submission just put something like &quot;SUPERSECRETPASSWORD&quot; or &quot;MYPASSWORD&quot;.</p>
<p><strong>Hint:</strong> To include an image (or screenshot) in RMarkdown, try <code>![](./my_image.png)</code> where <code>my_image.png</code> is inside the same folder as your <code>.Rmd</code> file.</p>
<p><strong>Hint:</strong> The spacing and tabs near the <code>message</code> variable are very important. Make sure to copy the code exactly. Otherwise, your subject may not end up in the subject of your email, or the email could end up being blank when sent.</p>
<p><strong>Hint:</strong> Questions 4 and 5 were inspired by examples and borrowed from the code found at the <a href="https://realpython.com/python-send-email/">Real Python</a> website.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> send_purdue_email(my_purdue_email, my_password, to, my_subject, my_message):
  <span class="im">import</span> smtplib, ssl
  <span class="im">from</span> email.mime.text <span class="im">import</span> MIMEText
  <span class="im">from</span> email.mime.multipart <span class="im">import</span> MIMEMultipart
  
  message <span class="op">=</span> MIMEMultipart(<span class="st">&quot;alternative&quot;</span>)
  message[<span class="st">&quot;Subject&quot;</span>] <span class="op">=</span> my_subject
  message[<span class="st">&quot;From&quot;</span>] <span class="op">=</span> my_purdue_email
  message[<span class="st">&quot;To&quot;</span>] <span class="op">=</span> to
  
  <span class="co"># Create the plain-text and HTML version of your message</span>
  text <span class="op">=</span> <span class="ss">f&#39;&#39;&#39;\</span>
<span class="ss">Subject: </span><span class="sc">{</span>my_subject<span class="sc">}</span>
<span class="ss">To: </span><span class="sc">{to}</span>
<span class="ss">From: </span><span class="sc">{</span>my_purdue_email<span class="sc">}</span>
<span class="ss">  </span>
<span class="sc">{</span>my_message<span class="sc">}</span><span class="ss">&#39;&#39;&#39;</span>
  html <span class="op">=</span> <span class="ss">f&#39;&#39;&#39;\</span>
<span class="ss">&lt;html&gt;</span>
<span class="ss">  &lt;body&gt;</span>
<span class="ss">    </span><span class="sc">{</span>my_message<span class="sc">}</span>
<span class="ss">  &lt;/body&gt;</span>
<span class="ss">&lt;/html&gt;</span>
<span class="ss">&#39;&#39;&#39;</span>
  <span class="co"># Turn these into plain/html MIMEText objects</span>
  part1 <span class="op">=</span> MIMEText(text, <span class="st">&quot;plain&quot;</span>)
  part2 <span class="op">=</span> MIMEText(html, <span class="st">&quot;html&quot;</span>)
  
  <span class="co"># Add HTML/plain-text parts to MIMEMultipart message</span>
  <span class="co"># The email client will try to render the last part first</span>
  message.attach(part1)
  message.attach(part2)
  
  context <span class="op">=</span> ssl.create_default_context()
  <span class="cf">with</span> smtplib.SMTP(<span class="st">&quot;smtp.purdue.edu&quot;</span>, <span class="dv">587</span>) <span class="im">as</span> server:
    server.ehlo()  <span class="co"># Can be omitted</span>
    server.starttls(context<span class="op">=</span>context)
    server.ehlo()  <span class="co"># Can be omitted</span>
    server.login(my_purdue_email, my_password)
    server.sendmail(my_purdue_email, to, message.as_string())
        
<span class="co"># this sends an email from kamstut@purdue.edu to mdw@purdue.edu</span>
<span class="co"># replace supersecretpassword with your own password</span>
<span class="co"># do NOT include your password in your homework submission.</span>
send_purdue_email(<span class="st">&quot;kamstut@purdue.edu&quot;</span>, <span class="st">&quot;supersecretpassword&quot;</span>, <span class="st">&quot;mdw@purdue.edu&quot;</span>, <span class="st">&quot;put subject here&quot;</span>, <span class="st">&quot;put message body here&quot;</span>)</code></pre></div>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-functions">functions</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
Screenshot showing your received the email.
</li>
</ul>
</div>
</div>
<div id="solution-75" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">import</span> smtplib, ssl

port <span class="op">=</span> <span class="dv">587</span>  <span class="co"># For starttls</span>
smtp_server <span class="op">=</span> <span class="st">&quot;smtp.purdue.edu&quot;</span>
sender_email <span class="op">=</span> <span class="st">&quot;kamstut@purdue.edu&quot;</span>
receiver_email <span class="op">=</span> <span class="st">&quot;kamstut@purdue.edu&quot;</span>
password <span class="op">=</span> <span class="st">&quot;MYPASSWORD&quot;</span>
message <span class="op">=</span> <span class="st">&quot;&quot;&quot;\</span>
<span class="st">Subject: Hi there</span>

<span class="st">This message is sent from Python.&quot;&quot;&quot;</span>

context <span class="op">=</span> ssl.create_default_context()
<span class="cf">with</span> smtplib.SMTP(smtp_server, port) <span class="im">as</span> server:
    server.ehlo()  <span class="co"># Can be omitted</span>
    server.starttls(context<span class="op">=</span>context)
    server.ehlo()  <span class="co"># Can be omitted</span>
    server.login(sender_email, password)
    server.sendmail(sender_email, receiver_email, message)</code></pre></div>
</div>
<div id="the-following-is-the-content-of-a-new-python-script-called-is_in_stock.py-1" class="section level5">
<h5>5. The following is the content of a new Python script called <code>is_in_stock.py</code>:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> send_purdue_email(my_purdue_email, my_password, to, my_subject, my_message):
  <span class="im">import</span> smtplib, ssl
  <span class="im">from</span> email.mime.text <span class="im">import</span> MIMEText
  <span class="im">from</span> email.mime.multipart <span class="im">import</span> MIMEMultipart
  
  message <span class="op">=</span> MIMEMultipart(<span class="st">&quot;alternative&quot;</span>)
  message[<span class="st">&quot;Subject&quot;</span>] <span class="op">=</span> my_subject
  message[<span class="st">&quot;From&quot;</span>] <span class="op">=</span> my_purdue_email
  message[<span class="st">&quot;To&quot;</span>] <span class="op">=</span> to
  
  <span class="co"># Create the plain-text and HTML version of your message</span>
  text <span class="op">=</span> <span class="ss">f&#39;&#39;&#39;\</span>
<span class="ss">Subject: </span><span class="sc">{</span>my_subject<span class="sc">}</span>
<span class="ss">To: </span><span class="sc">{to}</span>
<span class="ss">From: </span><span class="sc">{</span>my_purdue_email<span class="sc">}</span>
<span class="ss">  </span>
<span class="sc">{</span>my_message<span class="sc">}</span><span class="ss">&#39;&#39;&#39;</span>
  html <span class="op">=</span> <span class="ss">f&#39;&#39;&#39;\</span>
<span class="ss">&lt;html&gt;</span>
<span class="ss">  &lt;body&gt;</span>
<span class="ss">    </span><span class="sc">{</span>my_message<span class="sc">}</span>
<span class="ss">  &lt;/body&gt;</span>
<span class="ss">&lt;/html&gt;</span>
<span class="ss">&#39;&#39;&#39;</span>
  <span class="co"># Turn these into plain/html MIMEText objects</span>
  part1 <span class="op">=</span> MIMEText(text, <span class="st">&quot;plain&quot;</span>)
  part2 <span class="op">=</span> MIMEText(html, <span class="st">&quot;html&quot;</span>)
  
  <span class="co"># Add HTML/plain-text parts to MIMEMultipart message</span>
  <span class="co"># The email client will try to render the last part first</span>
  message.attach(part1)
  message.attach(part2)
  
  context <span class="op">=</span> ssl.create_default_context()
  <span class="cf">with</span> smtplib.SMTP(<span class="st">&quot;smtp.purdue.edu&quot;</span>, <span class="dv">587</span>) <span class="im">as</span> server:
    server.ehlo()  <span class="co"># Can be omitted</span>
    server.starttls(context<span class="op">=</span>context)
    server.ehlo()  <span class="co"># Can be omitted</span>
    server.login(my_purdue_email, my_password)
    server.sendmail(my_purdue_email, to, message.as_string())
        
<span class="kw">def</span> main():
    <span class="co"># scrape element from question 3</span>
    
    <span class="co"># does the text indicate it is in stock?</span>
    
    <span class="co"># if yes, send email to yourself telling you it is in stock.</span>
    
    <span class="co"># otherwise, gracefully end script using the &quot;pass&quot; Python keyword</span>

<span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:
    main()</code></pre></div>
</div>
<div id="first-make-a-copy-of-the-script-in-your-home-directory-1" class="section level5">
<h5>First, make a copy of the script in your <code>$HOME</code> directory:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cp</span> /class/datamine/data/scraping/is_in_stock.py <span class="va">$HOME</span>/is_in_stock.py</code></pre></div>
</div>
<div id="if-you-now-look-in-the-files-tab-in-the-lower-right-hand-corner-of-rstudio-and-click-the-refresh-button-you-should-see-the-file-is_in_stock.py.-you-can-open-and-modify-this-file-directly-in-rstudio.-before-you-do-so-however-change-the-permissions-of-the-homeis_in_stock.py-script-so-only-you-can-read-write-and-execute-it-1" class="section level5">
<h5>If you now look in the &quot;Files&quot; tab in the lower right hand corner of RStudio, and click the refresh button, you should see the file <code>is_in_stock.py</code>. You can open and modify this file directly in RStudio. Before you do so, however, change the permissions of the <code>$HOME/is_in_stock.py</code> script so only YOU can read, write, and execute it:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">chmod</span> 700 <span class="va">$HOME</span>/is_in_stock.py</code></pre></div>
</div>
<div id="the-script-should-now-appear-in-rstudio-in-your-home-directory-with-the-correct-permissions.-open-the-script-in-rstudio-and-fill-in-the-main-function-as-indicated-by-the-comments.-we-want-the-script-to-scrape-to-see-whether-the-pants-from-question-3-are-in-stock-or-not.-1" class="section level5">
<h5>The script should now appear in RStudio, in your home directory, with the correct permissions. Open the script (in RStudio) and fill in the <code>main</code> function as indicated by the comments. We want the script to scrape to see whether the pants from question 3 are in stock or not.</h5>
</div>
<div id="a-cron-job-is-a-task-that-runs-at-a-certain-interval.-create-a-cron-job-that-runs-your-script-classdatamineappspythonf2020-s2021envbinpython-homeis_in_stock.py-every-5-minutes.-wait-10-15-minutes-and-verify-that-it-is-working-properly.-the-long-path-classdatamineappspythonf2020-s2021envbinpython-simply-makes-sure-that-our-script-is-run-with-access-to-all-of-the-packages-in-our-course-environment.-homeis_in_stock.py-is-the-path-to-your-script-home-expands-or-transforms-to-homemy_purdue_alias.-1" class="section level5">
<h5>A cron job is a task that runs at a certain interval. Create a cron job that runs your script, <code>/class/datamine/apps/python/f2020-s2021/env/bin/python $HOME/is_in_stock.py</code> every 5 minutes. Wait 10-15 minutes and verify that it is working properly. The long path, <code>/class/datamine/apps/python/f2020-s2021/env/bin/python</code> simply makes sure that our script is run with access to all of the packages in our course environment. <code>$HOME/is_in_stock.py</code> is the path to your script (<code>$HOME</code> expands or transforms to <code>/home/&lt;my_purdue_alias&gt;</code>.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_dt6j3sov">Click here for video (same as above) for Questions 4 and 5</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_xz9df91y">Click here for a longer video about setting up the cronjob in Question 5</a></p>
<p><strong>Hint:</strong> If you struggle to use the text editor used with the <code>crontab -e</code> command, be sure to continue reading the <a href="unix.html#cron">cron section</a> of the book. We highlight another method that may be easier.</p>
<p><strong>Hint:</strong> Don't forget to copy your import statements from question (3) as well.</p>
<p><strong>Important note:</strong> Once you are finished with the project, if you no longer wish to receive emails every so often, follow the instructions <a href="unix.html#how-to-delete-cron-job">here</a> to remove the cron job.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#cron">cron</a>, <a href="https://crontab.guru">crontab guru</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
The content of your cron job in a bash code chunk.
</li>
<li>
The content of your <code>is_in_stock.py</code> script.
</li>
</ul>
</div>
</div>
<div id="solution-76" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash solution"><code class="sourceCode bash"><span class="ex">*/5</span> * * * * /home/kamstut/is_in_stock.py</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="co">#!/usr/bin/env python3</span>

<span class="kw">def</span> send_purdue_email(my_purdue_email, my_password, to):
    <span class="im">import</span> smtplib, ssl
    
    port <span class="op">=</span> <span class="dv">587</span>  <span class="co"># For starttls</span>
    smtp_server <span class="op">=</span> <span class="st">&quot;smtp.purdue.edu&quot;</span>
    sender_email <span class="op">=</span> my_purdue_email
    receiver_email <span class="op">=</span> to
    password <span class="op">=</span> my_password
    message <span class="op">=</span> <span class="st">&quot;&quot;&quot;\</span>
<span class="st">    Subject: Test subject</span>
<span class="st">    </span>
<span class="st">    This is the email body.&quot;&quot;&quot;</span>
    
    context <span class="op">=</span> ssl.create_default_context()
    <span class="cf">with</span> smtplib.SMTP(smtp_server, port) <span class="im">as</span> server:
        server.ehlo()  <span class="co"># Can be omitted</span>
        server.starttls(context<span class="op">=</span>context)
        server.ehlo()  <span class="co"># Can be omitted</span>
        server.login(sender_email, password)
        server.sendmail(sender_email, receiver_email, message)
        
<span class="kw">def</span> main():
    <span class="co"># scrape element from question 3</span>

    <span class="co"># The state of the Chartreuse pants, sold out (A) or in stock (B)</span>
    driver <span class="op">=</span> webdriver.Firefox(options<span class="op">=</span>firefox_options, executable_path<span class="op">=</span><span class="st">&#39;/class/datamine/apps/geckodriver&#39;</span>)
    driver.get(<span class="st">&quot;https://project4.tdm.wiki/&quot;</span>)

    <span class="co"># click the &quot;wild colors&quot; button</span>
    label <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//label[@for=&#39;ui-component-toggle__wild&#39;]&quot;</span>)
    label.click()

    element <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//span[@data-color=&#39;Chartreuse&#39;]/parent::div/following-sibling::div/span&quot;</span>)
    
    <span class="co"># does the text indicate it is in stock?</span>
    <span class="cf">if</span> element.text <span class="op">==</span> <span class="st">&quot;In stock&quot;</span>:
    
        <span class="co"># if yes, send email to yourself telling you it is in stock.</span>
        send_purdue_email(<span class="st">&quot;kamstut@purdue.edu&quot;</span>, <span class="st">&quot;MYPASSWORD&quot;</span>, <span class="st">&quot;kamstut@purdue.edu&quot;</span>)
    
    <span class="co"># otherwise, gracefully end script using the &quot;pass&quot; Python keyword</span>
    <span class="cf">else</span>:
        <span class="cf">pass</span>

<span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:
    main()</code></pre></div>
</div>
<div id="take-a-look-at-the-byline-of-each-pair-of-pants-the-sentences-starting-with-perfect-for....-inspect-the-html.-try-and-scrape-the-text-using-xpath-expressions-like-you-normally-would.-what-happens-are-you-able-to-scrape-it-google-around-and-come-up-with-your-best-explanation-of-what-is-happening." class="section level5">
<h5>6. Take a look at the byline of each pair of pants (the sentences starting with &quot;Perfect for...&quot;). Inspect the HTML. Try and scrape the text using xpath expressions like you normally would. What happens? Are you able to scrape it? Google around and come up with your best explanation of what is happening.</h5>
<p><strong>Relevant topics:</strong> pseudo elements</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
An explanation of what is happening.
</li>
</ul>
</div>
</div>
<div id="solution-77" class="section level5">
<h5>Solution</h5>
<div class="solution">
<p>
If you try and scrape using an xpath expression and the class attribute, you get no text:
</p>
</div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="co"># The state of the Chartreuse pants, sold out (A) or in stock (B)</span>
driver <span class="op">=</span> webdriver.Firefox(options<span class="op">=</span>firefox_options, executable_path<span class="op">=</span><span class="st">&#39;/class/datamine/apps/geckodriver&#39;</span>)
driver.get(<span class="st">&quot;https://project4.tdm.wiki/&quot;</span>)

<span class="co"># click the &quot;wild colors&quot; button</span>
label <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//label[@for=&#39;ui-component-toggle__wild&#39;]&quot;</span>)
label.click()

element <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//span[@class=&#39;ui-component-card--desc-amount ui-component-card--desc-amount-2&#39;]&quot;</span>)
<span class="bu">print</span>(element.text)

driver.quit()</code></pre></div>
<div class="solution">
<p>
What is happening is pseudo elements are not part of the DOM -- they are for styling (in this case, using &quot;content&quot; is css). To scrape, you'd need to use a script and css:
</p>
</div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="co"># The state of the Chartreuse pants, sold out (A) or in stock (B)</span>
driver <span class="op">=</span> webdriver.Firefox(options<span class="op">=</span>firefox_options, executable_path<span class="op">=</span><span class="st">&#39;/class/datamine/apps/geckodriver&#39;</span>)
driver.get(<span class="st">&quot;https://project4.tdm.wiki/&quot;</span>)

<span class="co"># click the &quot;wild colors&quot; button</span>
label <span class="op">=</span> driver.find_element_by_xpath(<span class="st">&quot;//label[@for=&#39;ui-component-toggle__wild&#39;]&quot;</span>)
label.click()
script <span class="op">=</span> <span class="st">&quot;return window.getComputedStyle(document.querySelector(&#39;.ui-component-card--desc-amount.ui-component-card--desc-amount-2&#39;),&#39;:before&#39;).getPropertyValue(&#39;content&#39;)&quot;</span>
<span class="bu">print</span>(driver.execute_script(script).strip())

driver.quit()</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="p05-390" class="section level3">
<h3>Project 5</h3>
<hr />
<p><strong>Motivation:</strong> One of the best things about learning to scrape data is the many applications of the skill that may pop into your mind. In this project, we want to give you some flexibility to explore your own ideas, but at the same time, add a couple of important tools to your tool set. We hope that you've learned a lot in this series, and can think of creative ways to utilize your new skills.</p>
<p><strong>Context:</strong> This is the last project in a series focused on scraping data. We have created a couple of very common scenarios that can be problematic when first learning to scrape data, and we want to show you how to get around them.</p>
<p><strong>Scope:</strong> python, web scraping, etc.</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Use the requests package to scrape a web page.
</li>
<li>
Use the lxml/selenium package to filter and parse data from a scraped web page.
</li>
<li>
Learn how to step around header-based filtering.
</li>
<li>
Learn how to handle rate limiting.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="questions-29" class="section level4">
<h4>Questions</h4>
<div id="it-is-not-uncommon-to-be-blocked-from-scraping-a-website.-there-are-a-variety-of-strategies-that-they-use-to-do-this-and-in-general-they-work-well.-in-general-if-a-company-wants-you-to-extract-information-from-their-website-they-will-make-an-api-application-programming-interface-available-for-you-to-use.-one-method-that-is-commonly-paired-with-other-methods-is-blocking-your-request-based-on-headers.-you-can-read-about-headers-here.-in-general-you-can-think-of-headers-as-some-extra-data-that-gives-the-server-or-client-context.-here-is-a-list-of-headers-and-some-more-explanation.-1" class="section level5">
<h5>1. It is not uncommon to be blocked from scraping a website. There are a variety of strategies that they use to do this, and in general they work well. In general, if a company wants you to extract information from their website, they will make an API (application programming interface) available for you to use. One method (that is commonly paired with other methods) is blocking your request based on <em>headers</em>. You can read about headers <a href="https://developer.mozilla.org/en-US/docs/Glossary/Request_header">here</a>. In general, you can think of headers as some extra data that gives the server or client context. <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers">Here</a> is a list of headers, and some more explanation.</h5>
</div>
<div id="each-header-has-a-purpose.-one-common-header-is-called-the-user-agent-header.-a-user-agent-looks-something-like-1" class="section level5">
<h5>Each header has a purpose. One common header is called the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent">User-Agent header</a>. A User-Agent looks something like:</h5>
<pre><code>User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:86.0) Gecko/20100101 Firefox/86.0</code></pre>
</div>
<div id="you-can-see-headers-if-you-open-the-console-in-firefox-or-chrome-and-load-a-website.-it-will-look-something-like-1" class="section level5">
<h5>You can see headers if you open the console in Firefox or Chrome and load a website. It will look something like:</h5>
<div class="figure">
<img src="images/headers01.png" />

</div>
</div>
<div id="from-the-mozilla-link-this-header-is-a-string-that-lets-servers-and-network-peers-identify-the-application-operating-system-vendor-andor-version-of-the-requesting-user-agent.-basically-if-you-are-browsing-the-internet-with-a-common-browser-the-server-will-know-what-you-are-using.-in-the-provided-example-we-are-using-firefox-86-from-mozilla-on-a-mac-running-mac-os-10.16-with-an-intel-processor.-1" class="section level5">
<h5>From the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent">mozilla link</a>, this header is a string that &quot;lets servers and network peers identify the application, operating system, vendor, and/or version of the requesting user agent.&quot; Basically, if you are browsing the internet with a common browser, the server will know what you are using. In the provided example, we are using Firefox 86 from Mozilla, on a Mac running Mac OS 10.16 with an Intel processor.</h5>
</div>
<div id="when-we-send-a-request-from-a-package-like-requests-in-python-here-is-what-the-headers-look-like-1" class="section level5">
<h5>When we send a request from a package like <code>requests</code> in Python, here is what the headers look like:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> requests

response <span class="op">=</span> requests.get(<span class="st">&quot;https://project5-headers.tdm.wiki&quot;</span>)
<span class="bu">print</span>(response.request.headers)</code></pre></div>
<pre><code>{&#39;User-Agent&#39;: &#39;python-requests/2.25.1&#39;, &#39;Accept-Encoding&#39;: &#39;gzip, deflate&#39;, &#39;Accept&#39;: &#39;*/*&#39;, &#39;Connection&#39;: &#39;keep-alive&#39;}</code></pre>
</div>
<div id="as-you-can-see-our-user-agent-is-python-requests2.25.1.-you-will-find-that-many-websites-block-requests-made-from-anything-such-user-agents.-one-such-website-is-httpsproject5-headers.tdm.wiki.-1" class="section level5">
<h5>As you can see our User-Agent is <code>python-requests/2.25.1</code>. You will find that many websites block requests made from anything such user agents. One such website is: <a href="https://project5-headers.tdm.wiki" class="uri">https://project5-headers.tdm.wiki</a>.</h5>
</div>
<div id="scrape-httpsproject5-headers.tdm.wiki-from-scholar-and-explain-what-happens.-what-is-the-response-code-and-what-does-that-response-code-mean-can-you-ascertain-what-you-would-be-seeing-more-or-less-in-a-browser-based-on-the-text-of-the-response-the-actual-html-read-this-section-of-the-documentation-for-the-headers-package-and-attempt-to-trick-httpsproject5-headers.tdm.wiki-into-presenting-you-with-the-desired-information.-the-desired-information-should-look-something-like-1" class="section level5">
<h5>Scrape <a href="https://project5-headers.tdm.wiki" class="uri">https://project5-headers.tdm.wiki</a> from Scholar and explain what happens. What is the <a href="python.html#p-requests-response-code">response code</a>, and what does that response code mean? Can you ascertain what you would be seeing (more or less) in a browser based on the <a href="python.html#p-requests-example01">text of the response</a> (the actual HTML)? Read <a href="https://requests.readthedocs.io/en/master/user/quickstart/#custom-headers">this section of the documentation for the <code>headers</code> package</a>, and attempt to &quot;trick&quot; <a href="https://project5-headers.tdm.wiki" class="uri">https://project5-headers.tdm.wiki</a> into presenting you with the desired information. The desired information should look something like:</h5>
<pre><code>Hostname: c1de5faf1daa
IP: 127.0.0.1
IP: 172.18.0.4
RemoteAddr: 172.18.0.2:34520
GET / HTTP/1.1
Host: project5-headers.tdm.wiki
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:86.0) Gecko/20100101 Firefox/86.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Encoding: gzip
Accept-Language: en-US,en;q=0.5
Cdn-Loop: cloudflare
Cf-Connecting-Ip: 107.201.65.5
Cf-Ipcountry: US
Cf-Ray: 62289b90aa55f975-EWR
Cf-Request-Id: 084d3f8e740000f975e0038000000001
Cf-Visitor: {&quot;scheme&quot;:&quot;https&quot;}
Cookie: __cfduid=d9df5daa57fae5a4e425173aaaaacbfc91613136177
Dnt: 1
Sec-Gpc: 1
Upgrade-Insecure-Requests: 1
X-Forwarded-For: 123.123.123.123
X-Forwarded-Host: project5-headers.tdm.wiki
X-Forwarded-Port: 443
X-Forwarded-Proto: https
X-Forwarded-Server: 6afe64faffaf
X-Real-Ip: 123.123.123.123</code></pre>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_qg61j5iu">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-requests">requests</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Response code received (a number), and an explanation of what that HTTP response code means.
</li>
<li>
What you would (probably) be seeing in a browser if you were blocked.
</li>
<li>
Python code used to &quot;trick&quot; the website into being scraped.
</li>
<li>
The content of the successfully scraped site.
</li>
</ul>
</div>
</div>
<div id="solution-78" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">import</span> requests

response <span class="op">=</span> requests.get(<span class="st">&quot;https://project5-headers.tdm.wiki&quot;</span>)
<span class="bu">print</span>(response.status_code) <span class="co"># 403</span>

<span class="co"># 403 is an https response code that means the content is forbidden</span>

<span class="co"># based on the HTML it looks like we&#39;d be presented with a CAPTCHA</span>
<span class="bu">print</span>(response.text)

<span class="co"># to fix this, let&#39;s change our User-Agent header</span>
response <span class="op">=</span> requests.get(<span class="st">&quot;https://project5-headers.tdm.wiki&quot;</span>, headers<span class="op">=</span>{<span class="st">&quot;User-Agent&quot;</span>: <span class="st">&quot;anything&quot;</span>})
<span class="bu">print</span>(response.text)

<span class="co"># or even better, would be to &quot;fake&quot; a browser</span>
response <span class="op">=</span> requests.get(<span class="st">&quot;https://project5-headers.tdm.wiki&quot;</span>, headers<span class="op">=</span>{<span class="st">&quot;User-Agent&quot;</span>: <span class="st">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:86.0) Gecko/20100101 Firefox/86.0&quot;</span>})
<span class="bu">print</span>(response.text)</code></pre></div>
</div>
<div id="open-a-browser-and-navigate-to-httpsproject5-rate-limit.tdm.wiki.-while-at-first-glance-it-will-seem-identical-to-httpsproject5-headers.tdm.wiki-it-is-not.-httpsproject5-rate-limit.tdm.wiki-is-rate-limited-based-on-ip-address.-depending-on-when-you-are-completing-this-project-this-may-or-may-not-be-obvious.-if-you-refresh-your-browser-fast-enough-instead-of-receiving-a-bunch-of-information-you-will-receive-text-that-says-too-many-requests.-1" class="section level5">
<h5>2. Open a browser and navigate to: <a href="https://project5-rate-limit.tdm.wiki/" class="uri">https://project5-rate-limit.tdm.wiki/</a>. While at first glance, it will seem identical to <a href="https://project5-headers.tdm.wiki/" class="uri">https://project5-headers.tdm.wiki/</a>, it is not. <a href="https://project5-rate-limit.tdm.wiki/" class="uri">https://project5-rate-limit.tdm.wiki/</a> is rate limited based on IP address. Depending on when you are completing this project, this may or may not be obvious. If you refresh your browser fast enough, instead of receiving a bunch of information, you will receive text that says &quot;Too Many Requests&quot;.</h5>
</div>
<div id="the-following-function-tries-to-scrape-the-cf-request-id-header-which-will-have-a-unique-value-each-request-1" class="section level5">
<h5>The following function tries to scrape the <code>Cf-Request-Id</code> header which will have a unique value each request:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> requests
<span class="im">import</span> lxml.html

<span class="kw">def</span> scrape_cf_request_id(url):
    resp <span class="op">=</span> requests.get(url)
    tree <span class="op">=</span> lxml.html.fromstring(resp.text)
    content <span class="op">=</span> tree.xpath(<span class="st">&quot;//p&quot;</span>)[<span class="dv">0</span>].text.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)
    cfid <span class="op">=</span> [l <span class="cf">for</span> l <span class="kw">in</span> content <span class="cf">if</span> <span class="st">&#39;Cf-Request-Id&#39;</span> <span class="kw">in</span> l][<span class="dv">0</span>].split()[<span class="dv">1</span>]
    <span class="cf">return</span> cfid</code></pre></div>
</div>
<div id="you-can-test-it-out-1" class="section level5">
<h5>You can test it out:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">scrape_cf_request_id(<span class="st">&quot;https://project5-rate-limit.tdm.wiki&quot;</span>)</code></pre></div>
</div>
<div id="write-code-to-scrape-10-unique-cf-request-ids-in-a-loop-and-save-them-to-a-list-called-my_ids.-what-happens-when-you-run-the-code-this-is-caused-by-our-expected-text-not-being-present.-instead-text-with-too-many-requests-is.-while-normally-this-error-would-be-something-that-makes-more-sense-like-an-httperror-or-a-timeout-exception-it-could-be-anything-depending-on-your-code.-1" class="section level5">
<h5>Write code to scrape 10 unique <code>Cf-Request-Id</code>s (in a loop), and save them to a list called <code>my_ids</code>. What happens when you run the code? This is caused by our expected text not being present. Instead text with &quot;Too Many Requests&quot; is. While normally this error would be something that makes more sense, like an HTTPError or a Timeout Exception, it <em>could</em> be anything, depending on your code.</h5>
</div>
<div id="one-solution-that-might-come-to-mind-is-to-wait-between-each-loop-using-time.sleep.-while-yes-this-may-work-it-is-not-a-robust-solution.-other-users-from-your-ip-address-may-count-towards-your-rate-limit-and-cause-your-function-to-fail-the-amount-of-sleep-time-may-change-dynamically-or-even-be-manually-adjusted-to-be-longer-etc.-the-best-way-to-handle-this-is-to-used-something-called-exponential-backoff.-1" class="section level5">
<h5>One solution that might come to mind is to &quot;wait&quot; between each loop using <code>time.sleep()</code>. While yes, this may work, it is not a robust solution. Other users from your IP address may count towards your rate limit and cause your function to fail, the amount of sleep time may change dynamically, or even be manually adjusted to be longer, etc. The best way to handle this is to used something called exponential backoff.</h5>
</div>
<div id="in-a-nutshell-exponential-backoff-is-a-way-to-increase-the-wait-time-exponentially-until-an-acceptable-rate-is-found.-backoff-is-an-excellent-package-to-do-just-that.-backoff-upon-being-triggered-from-a-specified-error-or-exception-will-wait-to-try-again-until-a-certain-amount-of-time-has-passed.-upon-receving-the-same-error-or-exception-the-time-to-wait-will-increase-exponentially.-use-backoff-to-modify-the-provided-scrape_cf_request_id-function-to-use-exponential-backoff-when-the-we-alluded-to-occurs.-test-out-the-modified-function-in-a-loop-and-print-the-resulting-10-cf-request-ids.-1" class="section level5">
<h5>In a nutshell, exponential backoff is a way to increase the wait time (exponentially) until an acceptable rate is found. <a href="https://pypi.org/project/backoff/"><code>backoff</code></a> is an excellent package to do just that. <code>backoff</code>, upon being triggered from a specified error or exception, will wait to &quot;try again&quot; until a certain amount of time has passed. Upon receving the same error or exception, the time to wait will increase exponentially. Use <code>backoff</code> to modify the provided <code>scrape_cf_request_id</code> function to use exponential backoff when the we alluded to occurs. Test out the modified function in a loop and print the resulting 10 <code>Cf-Request-Id</code>s.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_p0ioevlc">Click here for video</a></p>
<p><strong>Note:</strong> <code>backoff</code> utilizes decorators. For those interested in learning about decorators, <a href="https://realpython.com/primer-on-python-decorators/">this</a> is an excellent article.</p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-requests">requests</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
What happens when you run the function 10 times in a row?
</li>
<li>
Fixed code that will work regardless of the rate limiting.
</li>
<li>
10 unique <code>Cf-Request-Id</code>s printed.
</li>
</ul>
</div>
</div>
<div id="solution-79" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">import</span> requests
<span class="im">import</span> lxml.html

<span class="co"># function to scrape the Cf-Request-Id</span>
<span class="kw">def</span> scrape_cf_request_id(url):
    resp <span class="op">=</span> requests.get(url)
    tree <span class="op">=</span> lxml.html.fromstring(resp.text)
    content <span class="op">=</span> tree.xpath(<span class="st">&quot;//p&quot;</span>)[<span class="dv">0</span>].text.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)
    cfid <span class="op">=</span> [l <span class="cf">for</span> l <span class="kw">in</span> content <span class="cf">if</span> <span class="st">&#39;Cf-Request-Id&#39;</span> <span class="kw">in</span> l][<span class="dv">0</span>].split()[<span class="dv">1</span>]
    <span class="bu">print</span>(cfid)
    
my_list <span class="op">=</span> []
<span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):
    my_list.append(scrape_cf_request_id(<span class="st">&quot;https://project5-rate-limit.tdm.wiki&quot;</span>))</code></pre></div>
<div class="solution">
<p>
This will cause an IndexError because the expected content containing the <code>Cf-Request-Id</code> is not present, instead &quot;Too Many Requests&quot; is.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode python solution"><code class="sourceCode python"><span class="im">import</span> backoff
<span class="im">from</span> lxml <span class="im">import</span> etree

<span class="at">@backoff.on_exception</span>(backoff.expo,
                      <span class="pp">IndexError</span>)
<span class="kw">def</span> scrape_cf_request_id(url):
    resp <span class="op">=</span> requests.get(url, headers<span class="op">=</span>{<span class="st">&quot;User-Agent&quot;</span>: <span class="st">&quot;something&quot;</span>})
    tree <span class="op">=</span> lxml.html.fromstring(resp.text)
    content <span class="op">=</span> tree.xpath(<span class="st">&quot;//p&quot;</span>)[<span class="dv">0</span>].text.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)
    cfid <span class="op">=</span> [l <span class="cf">for</span> l <span class="kw">in</span> content <span class="cf">if</span> <span class="st">&#39;Cf-Request-Id&#39;</span> <span class="kw">in</span> l][<span class="dv">0</span>].split()[<span class="dv">1</span>]
    <span class="bu">print</span>(cfid)

my_list <span class="op">=</span> []
<span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):
    my_list.append(scrape_cf_request_id(<span class="st">&quot;https://project5-rate-limit.tdm.wiki&quot;</span>))
    
<span class="bu">print</span>(my_list)</code></pre></div>
</div>
<div id="you-now-have-a-great-set-of-tools-to-be-able-to-scrape-pretty-much-anything-you-want-from-the-internet.-now-all-that-is-left-to-do-is-practice.-find-a-course-appropriate-website-containing-data-you-would-like-to-scrape.-utilize-the-tools-youve-learned-about-to-scrape-at-least-100-units-of-data.-a-unit-is-just-a-representation-of-what-you-are-scraping.-for-example-a-unit-could-be-a-tweet-from-twitter-a-basketball-players-statistics-from-sportsreference-a-product-from-amazon-a-blog-post-from-your-favorite-blogger-etc.-1" class="section level5">
<h5>3. You now have a great set of tools to be able to scrape pretty much anything you want from the internet. Now all that is left to do is practice. Find a course appropriate website containing data you would like to scrape. Utilize the tools you've learned about to scrape at least 100 &quot;units&quot; of data. A &quot;unit&quot; is just a representation of what you are scraping. For example, a unit could be a tweet from Twitter, a basketball player's statistics from sportsreference, a product from Amazon, a blog post from your favorite blogger, etc.</h5>
</div>
<div id="the-hard-requirements-are-1" class="section level5">
<h5>The hard requirements are:</h5>
<ul>
<li>Documented code with thorough comments explaining what the code does.</li>
<li>At least 100 &quot;units&quot; scraped.</li>
<li>The data must be from multiple web pages.</li>
<li>Write at least 1 function (with a docstring) to help you scrape.</li>
<li>A clear explanation of what your scraper scrapes, challenges you encountered (if any) and how you overcame them, and a sample of your data printed out (for example a <code>head</code> of a pandas dataframe containing the data).</li>
</ul>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code that scrapes 100 unites of data (with thorough comments explaining what the code does).
</li>
<li>
The data must be from more than a single web page.
</li>
<li>
1 or more functions (with docstrings) used to help you scrape/parse data.
</li>
<li>
Clear documentation and explanation of what your scraper scrapes, challenges you encountered (if any) and how you overcame them, and a sample of your data printed out (for example using the <code>head</code> of a dataframe containing the data).
</li>
</ul>
</div>
</div>
<div id="solution-80" class="section level5">
<h5>Solution</h5>
<div class="solution">
<ul>
<li>
Python code with comments
</li>
<li>
Sample of scraped data (must be from multiple pages)
</li>
<li>
At least 100 &quot;units&quot; of scraped data (for example 1 tweet == 1 unit, 1 product from amazon == 1 unit, etc.)
</li>
<li>
At least 1 helper function with a docstring
</li>
<li>
A paragraph explaining things
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="p06-390" class="section level3">
<h3>Project 6</h3>
<hr />
<p><strong>Motivation:</strong> Being able to analyze and create good visualizations is a skill that is invaluable in <em>many</em> fields. It can be pretty fun too! In this project, you can pick and choose if a couple of different plotting projects.</p>
<p><strong>Context:</strong> We've been working hard all semester, learning a lot about web scraping. In this project, you are given the choice between a project designed to go through some <code>matplotlib</code> basics, and a project that has you replicate plots from a book using <code>plotly</code> (an interactive plotting package) inside a Jupyter Notebook (which you would submit instead of an RMarkdown file).</p>
<p><strong>Scope:</strong> python, visualizing data</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Demostrate the ability to create basic graphs with default settings.
</li>
<li>
Demonstrate the ability to modify axes labels and titles.
</li>
<li>
Demonstrate the ability to customize a plot (color, shape/linetype).
</li>
</ul>
</div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_2i0gm004">Click here for video</a></p>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="option-1" class="section level4">
<h4>Option 1</h4>
<p><a href="projects.html#p06-290">A maybe-too-familiar-to-you 29000 project</a></p>
</div>
<div id="option-2" class="section level4">
<h4>Option 2</h4>
<div id="here-are-a-variety-of-interesting-graphics-from-the-popular-book-displaying-time-series-spatial-and-space-time-data-with-r-by-oscar-perpinan-lamigueiro.-you-can-replicate-the-graphics-using-data-found-here." class="section level5">
<h5>1. <a href="https://github.com/oscarperpinan/bookvis/tree/master/figs">Here</a> are a variety of interesting graphics from the popular book <a href="https://oscarperpinan.github.io/spacetime-vis/">Displaying time series, spatial and space-time data with R</a> by Oscar Perpinan Lamigueiro. You can replicate the graphics using data found <a href="https://github.com/oscarperpinan/bookvis/tree/master/data">here</a>.</h5>
</div>
<div id="choose-3-graphics-from-the-book-to-replicate-using-plotly.-the-replications-do-not-need-to-be-perfect----a-strong-effort-to-get-as-close-as-possible-is-fine.-feel-free-to-change-colors-as-you-please.-if-you-have-the-desire-to-improve-the-graphic-please-feel-free-to-do-so-and-explain-how-it-is-an-improvement." class="section level5">
<h5>Choose 3 graphics from the book to replicate using <code>plotly</code>. The replications do not need to be perfect -- a strong effort to get as close as possible is fine. Feel free to change colors as you please. If you have the desire to improve the graphic, please feel free to do so and explain how it is an improvement.</h5>
</div>
<div id="use-httpsnotebook.scholar.rcac.purdue.edu-and-the-f2020-s2021-kernel-to-complete-this-project.-the-only-thing-you-need-to-submit-for-this-project-is-the-downloaded-.ipynb-file.-make-sure-that-the-grader-will-be-able-to-click-run-all-using-the-same-kernel-f2020-s2021-and-have-everything-run-properly." class="section level5">
<h5>Use <a href="https://notebook.scholar.rcac.purdue.edu" class="uri">https://notebook.scholar.rcac.purdue.edu</a> and the f2020-s2021 kernel to complete this project. The <em>only</em> thing you need to submit for this project is the downloaded .ipynb file. Make sure that the grader will be able to click &quot;run all&quot; (using the same kernel, f2020-s2021), and have everything run properly.</h5>
<p><strong>Important note:</strong> The object of this project is to challenge yourself (as much as you want), learn about and mess around with <code>plotly</code>, and be creative. If you have an idea for a cool plot, graphic, or modification, please include it!</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="p07-390" class="section level3">
<h3>Project 7</h3>
<hr />
<p><strong>Motivation:</strong> Being able to analyze and create good visualizations is a skill that is invaluable in <em>many</em> fields. It can be pretty fun too! As you probably noticed in the previous project, <code>matplotlib</code> can be finicky -- certain types of plots are really easy to create, while others are not. For example, you would think changing the color of a boxplot would be easy to do in <code>matplotlib</code>, perhaps we just need to add an option to the function call. As it turns out, this isn't so straightforward (as illustrated at the end of <a href="python.html#p-matplotlib-boxplot">this section</a>). Occasionally this will happen and that is when packages like <code>seaborn</code> or <code>plotnine</code> (both are packages built using <code>matplotlib</code>) can be good. In this project we will explore this a little bit, and learn about some useful <code>pandas</code> functions to help shape your data in a format that any given package requires.</p>
<p><strong>Context:</strong> In the next project, we will continue to learn about and become comfortable using <code>matplotlib</code>, <code>seaborn</code>, and <code>plotnine</code>.</p>
<p><strong>Scope:</strong> python, visualizing data</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Demonstrate the ability to create basic graphs with default settings.
</li>
<li>
Demonstrate the ability to modify axes labels and titles.
</li>
<li>
Demonstrate the ability to customize a plot (color, shape/linetype).
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset-23" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/apple/health/watch_dump.xml</code></p>
</div>
<div id="questions-30" class="section level4">
<h4>Questions</h4>
<div id="in-an-earlier-project-we-explored-some-xml-data-in-the-form-of-an-apple-watch-data-dump.-most-health-related-apps-give-you-some-sort-of-graph-or-set-of-graphs-as-an-output.-use-any-package-you-want-to-parse-the-xml-data.-there-are-a-lot-of-records-in-this-dataset.-each-record-has-an-attribute-called-creationdate.-create-a-barplot-of-the-number-of-records-per-day.-make-sure-your-plot-is-polished-containing-proper-labels-and-good-colors.-1" class="section level5">
<h5>1. In an earlier project we explored some XML data in the form of an Apple Watch data dump. Most health-related apps give you some sort of graph or set of graphs as an output. Use any package you want to parse the XML data. There are a lot of <code>Record</code>s in this dataset. Each <code>Record</code> has an attribute called <code>creationDate</code>. Create a barplot of the number of <code>Record</code>s per day. Make sure your plot is polished, containing proper labels and good colors.</h5>
<p><strong>Hint:</strong> You could start by parsing out the required data into a <code>pandas</code> dataframe or series.</p>
<p><strong>Hint:</strong> The <code>groupby</code> method is one of the most useful <code>pandas</code> methods. It allows you to quickly perform operations on groups of data.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_69sdl8rk">Click here for video</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_ho5ej4gy">Click here for another video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-lxml">lxml</a>, <a href="python.html#p-pandas-groupby">groupby</a>, <a href="python.html#p-matplotlib-barplot">barplot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code (including the graphic).
</li>
</ul>
</div>
</div>
<div id="the-plot-in-question-1-should-look-bimodal.-lets-focus-only-on-the-first-apparent-group-of-readings.-create-a-new-dataframe-containing-only-the-readings-for-the-time-period-from-912017-to-5312019.-how-many-records-are-there-in-that-time-period-1" class="section level5">
<h5>2. The plot in question 1 should look bimodal. Let's focus only on the first apparent group of readings. Create a new dataframe containing only the readings for the time period from 9/1/2017 to 5/31/2019. How many <code>Record</code>s are there in that time period?</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_wlkijwnv">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-lxml">lxml</a>, <a href="python.html#p-pandas-groupby">groupby</a>, <a href="python.html#p-matplotlib-barplot">barplot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="it-is-hard-to-discern-weekly-patterns-if-any-based-on-the-graphics-created-so-far.-for-the-period-of-time-in-question-2-create-a-labeled-bar-plot-for-the-count-of-records-by-day-of-the-week.-what-if-any-discernable-patterns-are-there-make-sure-to-include-the-labels-provided-below-1" class="section level5">
<h5>3. It is hard to discern weekly patterns (if any) based on the graphics created so far. For the period of time in question 2, create a labeled bar plot for the count of <code>Record</code>s by day of the week. What (if any) discernable patterns are there? Make sure to include the labels provided below:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">labels <span class="op">=</span> [<span class="st">&quot;Mon&quot;</span>, <span class="st">&quot;Tue&quot;</span>, <span class="st">&quot;Wed&quot;</span>, <span class="st">&quot;Thu&quot;</span>, <span class="st">&quot;Fri&quot;</span>, <span class="st">&quot;Sat&quot;</span>, <span class="st">&quot;Sun&quot;</span>]</code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_e7d9ve0o">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-lxml">lxml</a>, <a href="python.html#p-pandas-groupby">groupby</a>, <a href="python.html#p-matplotlib-barplot">barplot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code (including the graphic).
</li>
</ul>
</div>
</div>
<div id="create-a-pandas-dataframe-containing-the-following-data-from-watch_dump.xml-1" class="section level5">
<h5>4. Create a <code>pandas</code> dataframe containing the following data from <code>watch_dump.xml</code>:</h5>
<ul>
<li>A column called <code>bpm</code> with the <code>bpm</code> (beats per minute) of the <code>InstantaneousBeatsPerMinute</code>.</li>
<li>A column called <code>time</code> with the <code>time</code> of each individual <code>bpm</code> reading in <code>InstantaneousBeatsPerMinute</code>.</li>
<li>A column called <code>date</code> with the date.</li>
<li>A column called <code>dayofweek</code> with the day of the week.</li>
</ul>
<p><strong>Hint:</strong> You may want to use <code>pd.to_numeric</code> to convert the <code>bpm</code> column to a numeric type.</p>
<p><strong>Hint:</strong> This is one way to convert the numbers 0-6 to days of the week:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">myDF[<span class="st">&#39;dayofweek&#39;</span>] <span class="op">=</span> myDF[<span class="st">&#39;dayofweek&#39;</span>].<span class="bu">map</span>({<span class="dv">0</span>:<span class="st">&quot;Mon&quot;</span>, <span class="dv">1</span>:<span class="st">&quot;Tue&quot;</span>, <span class="dv">2</span>:<span class="st">&quot;Wed&quot;</span>, <span class="dv">3</span>:<span class="st">&quot;Thu&quot;</span>, <span class="dv">4</span>:<span class="st">&quot;Fri&quot;</span>, <span class="dv">5</span>: <span class="st">&quot;Sat&quot;</span>, <span class="dv">6</span>: <span class="st">&quot;Sun&quot;</span>})</code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_h8crbise">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-lxml">lxml</a>, <a href="python.html#p-pandas-groupby">groupby</a>, <a href="python.html#p-matplotlib-barplot">barplot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="create-a-heatmap-using-seaborn-where-the-y-axis-shows-the-day-of-the-week-mon---sun-the-x-axis-shows-the-hour-and-the-values-on-the-interior-of-the-plot-are-the-average-bpm-by-hour-by-day-of-the-week.-1" class="section level5">
<h5>5. Create a heatmap using <code>seaborn</code>, where the y-axis shows the day of the week (&quot;Mon&quot; - &quot;Sun&quot;), the x-axis shows the hour, and the values on the interior of the plot are the average <code>bpm</code> by hour by day of the week.</h5>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_rl5iu9am">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-lxml">lxml</a>, <a href="python.html#p-pandas-groupby">groupby</a>, <a href="python.html#p-pandas-pivot">pivot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code (including the graphic).
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="p08-390" class="section level3">
<h3>Project 8</h3>
<hr />
<p><strong>Motivation:</strong> Python is an <a href="https://www.geeksforgeeks.org/internal-working-of-python/">interpreted language</a> (as opposed to a compiled language). In a compiled language, you are (mostly) unable to run and evaluate a single instruction at a time. In Python (and R -- also an interpreted language), we can run and evaluate a line of code easily using a <a href="https://en.wikipedia.org/wiki/Read-eval-print_loop">repl</a>. In fact, this is the way you've been using Python to date -- selecting and running pieces of Python code. Other ways to use Python include creating a package (like numpy, pandas, and pytorch), and creating scripts. You can create powerful CLI's (command line interface) tools using Python. In this project, we will explore this in detail and learn how to create scripts that accept options and input and perform tasks.</p>
<p><strong>Context:</strong> This is the first (of two) projects where we will learn about creating and using Python scripts.</p>
<p><strong>Scope:</strong> python</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Write a python script that accepts user inputs and returns something useful.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="questions-31" class="section level4">
<h4>Questions</h4>
<div id="often-times-the-deliverable-part-of-a-project-isnt-custom-built-packages-or-modules-but-a-script.-a-script-is-a-.py-file-with-python-code-written-inside-to-perform-actions.-python-scripts-are-incredibly-easy-to-run-for-example-if-you-had-a-python-script-called-question01.py-you-could-run-it-by-opening-a-terminal-and-typing-1" class="section level5">
<h5>1. Often times the deliverable part of a project isn’t custom built packages or modules, but a script. A script is a .py file with python code written inside to perform action(s). Python scripts are incredibly easy to run, for example, if you had a python script called <code>question01.py</code>, you could run it by opening a terminal and typing:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">python3</span> /path/to/question01.py</code></pre></div>
</div>
<div id="the-python-interpreter-then-looks-for-the-scripts-entrypoint-and-starts-executing.-you-should-read-this-article-about-the-main-function-and-python-scripts.-in-addition-read-this-section-paying-special-attention-to-the-shebang.-1" class="section level5">
<h5>The python interpreter then looks for the scripts entrypoint, and starts executing. You should read <a href="https://realpython.com/python-main-function/">this</a> article about the main function and python scripts. In addition, read <a href="https://realpython.com/run-python-scripts/#using-the-script-filename">this</a> section, paying special attention to the shebang.</h5>
</div>
<div id="create-a-python-script-called-question01.py-in-your-home-directory.-use-the-second-shebang-from-the-article-usrbinenv-python3.-when-run-question01.py-should-use-the-sys-package-to-print-the-location-of-the-interpreter-being-used-to-run-the-script.-for-example-if-we-started-a-python-interpreter-in-rstudio-using-the-following-code-1" class="section level5">
<h5>Create a Python script called <code>question01.py</code> in your <code>$HOME</code> directory. Use the second shebang from the article: <code>#!/usr/bin/env python3</code>. When run, <code>question01.py</code> should use the <code>sys</code> package to print the location of the interpreter being used to run the script. For example, if we started a Python interpreter in RStudio using the following code:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">datamine_py</span>()
reticulate<span class="op">::</span><span class="kw">repl_python</span>()</code></pre></div>
</div>
<div id="then-we-could-print-the-interpreter-by-running-the-following-python-code-one-line-at-a-time-1" class="section level5">
<h5>Then, we could print the interpreter by running the following Python code one line at a time:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> sys
<span class="bu">print</span>(sys.executable)</code></pre></div>
</div>
<div id="since-we-are-using-our-python-environment-you-should-see-this-result-classdatamineappspythonf2020-s2021envbinpython3.-this-is-the-fully-qualified-path-of-the-python-interpreter-weve-been-using-for-this-course.-1" class="section level5">
<h5>Since we are using our Python environment, you should see this result: <code>/class/datamine/apps/python/f2020-s2021/env/bin/python3</code>. This is the fully qualified path of the Python interpreter we've been using for this course.</h5>
</div>
<div id="restart-your-r-session-by-clicking-session-restart-r-navigate-to-the-terminal-tab-in-rstudio-and-run-the-following-lines-in-the-terminal.-what-is-the-output-1" class="section level5">
<h5>Restart your R session by clicking <code>Session &gt; Restart R</code>, navigate to the &quot;Terminal&quot; tab in RStudio, and run the following lines in the terminal. What is the output?</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># this command gives execute permissions to your script -- this only needs to be run once</span>
<span class="fu">chmod</span> +x <span class="va">$HOME</span>/question01.py

<span class="co"># execute your script </span>
<span class="va">$HOME</span><span class="ex">/question01.py</span></code></pre></div>
<p><strong>Important note:</strong> You can run bash code using a bash code chunk just like you would an R or Python code chunk. Simply replace &quot;python&quot; with &quot;bash&quot; in the code chunk options.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_zu7ezftg">Click here for video</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_3q4cpan4">Click here for another video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-shebang">shebang</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The entire <code>question01.py</code> script's contents in a Python code chunk with chunk option &quot;eval=F&quot;.
</li>
<li>
Output from running your code copy and pasted as text.
</li>
</ul>
</div>
</div>
<div id="was-your-output-in-question-1-expected-why-or-why-not-1" class="section level5">
<h5>2. Was your output in question (1) expected? Why or why not?</h5>
</div>
<div id="when-we-restarted-the-r-session-our-datamine_pys-effects-were-reversed-and-the-default-python-interpreter-is-no-longer-our-default-when-running-python3.-it-is-very-common-to-have-a-multitude-of-python-environments-available-to-use.-but-when-we-are-running-a-python-script-it-is-not-convenient-to-have-to-run-various-commands-in-our-case-the-single-datamine_py-command-in-order-to-get-our-script-to-run-the-way-we-want-it-to-run.-in-addition-if-our-script-used-a-set-of-packages-that-were-not-installed-outside-of-our-course-environment-the-script-would-fail.-1" class="section level5">
<h5>When we restarted the R session, our <code>datamine_py</code>'s effects were reversed, and the default Python interpreter is no longer our default when running <code>python3</code>. It is very common to have a multitude of Python environments available to use. But, when we are running a Python script it is <em>not</em> convenient to have to run various commands (in our case, the single <code>datamine_py</code> command) in order to get our script to run the way we want it to run. In addition, if our script used a set of packages that were not installed outside of our course environment, the script would fail.</h5>
</div>
<div id="in-this-project-since-our-focus-is-more-on-how-to-write-scripts-and-make-them-work-as-expected-we-will-have-some-fun-and-experiment-with-some-pre-trained-state-of-the-art-machine-learning-models.-1" class="section level5">
<h5>In this project, since our focus is more on how to write scripts and make them work as expected, we will have some fun and experiment with some pre-trained state of the art machine learning models.</h5>
</div>
<div id="the-following-function-accepts-a-string-called-sentence-as-an-input-and-returns-the-sentiment-of-the-sentence-positive-or-negative.-1" class="section level5">
<h5>The following function accepts a string called <code>sentence</code> as an input and returns the sentiment of the sentence, &quot;POSITIVE&quot; or &quot;NEGATIVE&quot;.</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> transformers <span class="im">import</span> pipeline

<span class="kw">def</span> get_sentiment(model, sentence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:
    result <span class="op">=</span> model(sentence)
    
    <span class="cf">return</span> result[<span class="dv">0</span>].get(<span class="st">&#39;label&#39;</span>)

model <span class="op">=</span> pipeline(<span class="st">&#39;sentiment-analysis&#39;</span>)

<span class="bu">print</span>(get_sentiment(model, <span class="st">&#39;This is really great!&#39;</span>))
<span class="bu">print</span>(get_sentiment(model, <span class="st">&#39;Oh no! Thats horrible!&#39;</span>))</code></pre></div>
</div>
<div id="include-get_sentiment-including-the-import-statement-in-a-new-script-question02.py-script.-note-that-you-do-not-have-to-use-get_sentiment-anywhere-just-include-it-for-now.-go-to-the-terminal-in-rstudio-and-execute-your-script.-what-happens-1" class="section level5">
<h5>Include <code>get_sentiment</code> (including the import statement) in a new script, <code>question02.py</code> script. Note that you do not have to <em>use</em> <code>get_sentiment</code> anywhere, just include it for now. Go to the terminal in RStudio and execute your script. What happens?</h5>
</div>
<div id="remember-since-our-current-shebang-is-usrbinenv-python3-if-our-script-uses-one-or-more-packages-that-are-not-installed-in-the-current-environment-environment-the-script-will-fail.-this-is-what-is-happening.-the-transformers-package-that-we-use-is-not-installed-in-the-current-environment.-we-do-however-have-an-environment-that-does-have-it-installed-and-it-is-located-on-scholar-at-classdatamineappspythonpytorch2021envbinpython.-update-the-scripts-shebang-and-try-to-run-it-again.-does-it-work-now-1" class="section level5">
<h5>Remember, since our current shebang is <code>#!/usr/bin/env python3</code>, if our script uses one or more packages that are not installed in the current environment environment, the script will fail. This is what is happening. The <code>transformers</code> package that we use is not installed in the current environment. We do, however, have an environment that <em>does</em> have it installed, and it is located on Scholar at: <code>/class/datamine/apps/python/pytorch2021/env/bin/python</code>. Update the script's shebang and try to run it again. Does it work now?</h5>
<p><strong>Explanation:</strong> Depending on the state of your current environment, the original shebang, <code>#!/usr/bin/env python3</code> will use the same Python interpreter and environment that is currently set to <code>python3</code> (run <code>which python3</code> to see). If you haven't run <code>datamine_py</code>, this will be something like: <code>/apps/spack/scholar/fall20/apps/anaconda/2020.11-py38-gcc-4.8.5-djkvkvk/bin/python</code> or <code>/usr/bin/python</code>, if you <em>have</em> run <code>datamine_py</code>, this will be: <code>/class/datamine/apps/python/f2020-s2021/env/bin/python</code>. <em>Both</em> environments lack the <code>transformers</code> package. Our other environment whose interpreter lives here: <code>/class/datamine/apps/python/pytorch2021/env/bin/python</code> <em>does</em> have this package. The shebang is then critically important for any scripts that want to utilize packages from a specific environment.</p>
<p><strong>Important note:</strong> You can run bash code using a bash code chunk just like you would an R or Python code chunk. Simply replace &quot;python&quot; with &quot;bash&quot; in the code chunk options.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_njfnysr8">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-scripts">writing scripts</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Sentence explaining why or why not the output from question (1) was expected.
</li>
<li>
Sentence explaining what happens when you include <code>get_sentiment</code> in your script and try to execute it.
</li>
<li>
The entirety of the updated (working) script's content in a Python code chunk with chunk option &quot;eval=F&quot;.
</li>
</ul>
</div>
</div>
<div id="okay-great.-we-now-understand-that-if-we-want-to-use-packages-from-a-specific-environment-we-need-to-modify-our-shebang-accordingly.-as-it-currently-stands-our-script-is-pretty-useless.-modify-the-script-in-a-new-script-called-question03.py-to-accept-a-single-argument.-this-argument-should-be-a-sentence.-your-script-should-then-print-the-sentence-and-whether-or-not-the-sentence-is-positive-or-negative.-use-sys.argv-to-accomplish-this.-make-sure-the-script-functions-in-the-following-way-1" class="section level5">
<h5>3. Okay, great. We now understand that if we want to use packages from a specific environment, we need to modify our shebang accordingly. As it currently stands, our script is pretty useless. Modify the script, in a new script called <code>question03.py</code> to accept a single argument. This argument should be a sentence. Your script should then print the sentence, and whether or not the sentence is &quot;POSITIVE&quot; or &quot;NEGATIVE&quot;. Use <code>sys.argv</code> to accomplish this. Make sure the script functions in the following way:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question03.py</span> This is a happy sentence, yay!</code></pre></div>
<pre><code>Too many arguments.</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question03.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span></code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question03.py</span></code></pre></div>
<pre><code>./question03.py requires at least 1 argument, &quot;sentence&quot;.</code></pre>
<p><strong>Hint:</strong> One really useful way to exit the script and print a message is like this:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> sys

sys.exit(<span class="ss">f&quot;</span><span class="sc">{</span><span class="va">__file__</span><span class="sc">}</span><span class="ss"> requires at least 1 argument, &#39;sentence&#39;&quot;</span>)</code></pre></div>
<p><strong>Important note:</strong> You can run bash code using a bash code chunk just like you would an R or Python code chunk. Simply replace &quot;python&quot; with &quot;bash&quot; in the code chunk options.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_idex90v8">Click here for video</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_c6qljtb5">Click here for another video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-scripts">writing scripts</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The entirety of the updated (working) script's content in a Python code chunk with chunk option &quot;eval=F&quot;.
</li>
<li>
Output from running your script with the given examples.
</li>
</ul>
</div>
</div>
<div id="if-you-look-at-the-man-pages-for-a-command-line-tool-like-awk-or-grep-you-can-get-these-by-running-man-awk-or-man-grep-in-the-terminal-you-will-see-that-typically-clis-have-a-variety-of-options.-options-usually-follow-the-following-format-1" class="section level5">
<h5>4. If you look at the man pages for a command line tool like <code>awk</code> or <code>grep</code> (you can get these by running <code>man awk</code> or <code>man grep</code> in the terminal), you will see that typically CLI's have a variety of options. Options usually follow the following format:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">grep</span> -i <span class="st">&#39;ok&#39;</span> some_file.txt</code></pre></div>
</div>
<div id="however-often-times-you-have-2-ways-you-can-use-an-option----either-with-the-short-form-for-example--i-or-long-form-for-example--i-is-the-same-as---ignore-case.-sometimes-options-can-get-values.-if-options-dont-have-values-you-can-assume-that-the-presence-of-the-flag-means-true-and-the-lack-means-false.-when-using-short-form-the-value-for-the-option-is-separated-by-a-space-for-example-grep--f-my_file.txt.-when-using-long-form-the-value-for-the-option-is-separated-by-an-equals-sign-for-example-grep---filemy_file.txt.-1" class="section level5">
<h5>However, often times you have 2 ways you can use an option -- either with the short form (for example <code>-i</code>), or long form (for example <code>-i</code> is the same as <code>--ignore-case</code>). Sometimes options can get values. If options don't have values, you can assume that the presence of the flag means <code>TRUE</code> and the lack means <code>FALSE</code>. When using short form, the value for the option is separated by a space (for example <code>grep -f my_file.txt</code>). When using long form, the value for the option is separated by an equals sign (for example <code>grep --file=my_file.txt</code>).</h5>
</div>
<div id="modify-your-script-as-a-new-question04.py-to-include-an-option-called-score.-when-active-question04.py---score-or-question04.py--s-the-script-should-return-both-the-sentiment-positive-or-negative-and-the-probability-of-being-accurate.-make-sure-that-you-modify-your-checks-from-question-3-to-continue-to-work-whenever-we-use---score-or--s.-some-examples-below-1" class="section level5">
<h5>Modify your script (as a new <code>question04.py</code>) to include an option called <code>score</code>. When active (<code>question04.py --score</code> or <code>question04.py -s</code>), the script should return both the sentiment, &quot;POSITIVE&quot; or &quot;NEGATIVE&quot; and the probability of being accurate. Make sure that you modify your checks from question 3 to continue to work whenever we use <code>--score</code> or <code>-s</code>. Some examples below:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question04.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span></code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question04.py</span> --score <span class="st">&#39;This is a happy sentence, yay!&#39;</span></code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE: 0.999848484992981</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question04.py</span> -s <span class="st">&#39;This is a happy sentence, yay!&#39;</span></code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE: 0.999848484992981</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question04.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span> -s</code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE: 0.999848484992981</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question04.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span> --score</code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE: 0.999848484992981</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question04.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span> --value</code></pre></div>
<pre><code>Unknown option(s): [&#39;--value&#39;]</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question04.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span> --value --score</code></pre></div>
<pre><code>Too many arguments.</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question04.py</span></code></pre></div>
<pre><code>question04.py requires at least 1 argument, &quot;sentence&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question04.py</span> --score</code></pre></div>
<pre><code>./question04.py requires at least 1 argument, &quot;sentence&quot;. No sentence provided.</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question04.py</span> <span class="st">&#39;This is one sentence&#39;</span> <span class="st">&#39;This is another&#39;</span></code></pre></div>
<pre><code>./question04.py requires only 1 sentence, but 2 were provided.</code></pre>
<p><strong>Important note:</strong> You can run bash code using a bash code chunk just like you would an R or Python code chunk. Simply replace &quot;python&quot; with &quot;bash&quot; in the code chunk options.</p>
<p><strong>Hint:</strong> Experiment with the provided function. You will find the probability of being accurate is already returned by the model.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_hxx5pgtp">Click here for video</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_vqwmjvt4">Click here for another video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-scripts">writing scripts</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The entirety of the updated (working) script's content in a Python code chunk with chunk option &quot;eval=F&quot;.
</li>
<li>
Output from running your script with the given examples.
</li>
</ul>
</div>
</div>
<div id="wow-that-is-an-extensive-amount-of-logic-for-for-a-single-option.-luckily-python-has-the-argparse-package-to-help-you-build-clis-and-handle-situations-like-this.-you-can-find-the-documentation-for-argparse-here-and-a-nice-little-tutorial-here.-update-your-script-as-a-new-question05.py-using-argparse-instead-of-custom-logic.-specifically-add-1-positional-argument-called-sentence-and-1-optional-argument---score-or--s.-you-should-handle-the-following-scenarios-1" class="section level5">
<h5>5. Wow, that is an extensive amount of logic for for a single option. Luckily, Python has the <code>argparse</code> package to help you build CLI's and handle situations like this. You can find the documentation for argparse <a href="https://docs.python.org/3/library/argparse.html">here</a> and a nice little tutorial <a href="https://docs.python.org/3/howto/argparse.html">here</a>. Update your script (as a new <code>question05.py</code>) using <code>argparse</code> instead of custom logic. Specifically, add 1 positional argument called &quot;sentence&quot;, and 1 optional argument &quot;--score&quot; or &quot;-s&quot;. You should handle the following scenarios:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question05.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span></code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question05.py</span> --score <span class="st">&#39;This is a happy sentence, yay!&#39;</span></code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE: 0.999848484992981</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question05.py</span> -s <span class="st">&#39;This is a happy sentence, yay!&#39;</span></code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE: 0.999848484992981</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question05.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span> -s</code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE: 0.999848484992981</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question05.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span> --score</code></pre></div>
<pre><code>Our sentence is: This is a happy sentence, yay!
POSITIVE: 0.999848484992981</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question05.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span> --value</code></pre></div>
<pre><code>usage: question05.py [-h] [-s] sentence
question05.py: error: unrecognized arguments: --value</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question05.py</span> <span class="st">&#39;This is a happy sentence, yay!&#39;</span> --value --score</code></pre></div>
<pre><code>usage: question05.py [-h] [-s] sentence
question05.py: error: unrecognized arguments: --value</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question05.py</span></code></pre></div>
<pre><code>usage: question05.py [-h] [-s] sentence

positional arguments:
  sentence

optional arguments:
  -h, --help   show this help message and exit
  -s, --score  display the probability of accuracy</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question05.py</span> --score</code></pre></div>
<pre><code>usage: question05.py [-h] [-s] sentence
question05.py: error: too few arguments</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question05.py</span> <span class="st">&#39;This is one sentence&#39;</span> <span class="st">&#39;This is another&#39;</span></code></pre></div>
<pre><code>usage: question05.py [-h] [-s] sentence
question05.py: error: unrecognized arguments: This is another</code></pre>
<p><strong>Hint:</strong> A good way to print the help information if no arguments are provided is:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">if</span> <span class="bu">len</span>(sys.argv) <span class="op">==</span> <span class="dv">1</span>:
    parser.print_help()
    parser.exit()</code></pre></div>
<p><strong>Important note:</strong> Include the bash code chunk option <code>error=T</code> to enable RMarkdown to knit and output errors.</p>
<p><strong>Important note:</strong> You can run bash code using a bash code chunk just like you would an R or Python code chunk. Simply replace &quot;python&quot; with &quot;bash&quot; in the code chunk options.</p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_n89f70ts">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-scripts">writing scripts</a>, <a href="python.html#p-argparse">argparse</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Python code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="p09-390" class="section level3">
<h3>Project 9</h3>
<hr />
<p><strong>Motivation:</strong> In the previous project you worked through some common logic needed to make a good script. By the end of the project <code>argparse</code> was (hopefully) a welcome package to be able to use. In this project, we are going to continue to learn about <code>argparse</code> and create a CLI for the <a href="https://data.whin.org">WHIN Data Portal</a>. In doing so, not only will we get to practice using <code>argparse</code>, but you will also get to learn about using an API to retrieve data. An API (application programming interface) is a common way to retrieve structured data from a company or resource. It is common for large companies like Twitter, Facebook, Google, etc. to make certain data available via API's, so it is important to get some exposure.</p>
<p><strong>Context:</strong> This is the second (of two) projects where we will learn about creating and using Python scripts.</p>
<p><strong>Scope:</strong> python</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Write a python script that accepts user inputs and returns something useful.
</li>
<li>
Interact with an API to retrieve data.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset-24" class="section level4">
<h4>Dataset</h4>
<p>The following questions will involve retrieving data using an API. Instructions and hints will be provided as we go.</p>
</div>
<div id="questions-32" class="section level4">
<h4>Questions</h4>
<div id="whin-wabash-heartland-innovation-network-has-deployed-hundreds-of-weather-stations-across-the-region-so-farmers-can-use-the-data-collected-to-become-more-efficient-save-time-and-increase-yields.-whin-has-kindly-granted-access-to-20-public-facing-weather-stations-for-educational-purposes.-1" class="section level5">
<h5>1. WHIN (Wabash Heartland Innovation Network) has deployed hundreds of weather stations across the region so farmers can use the data collected to become more efficient, save time, and increase yields. WHIN has kindly granted access to 20+ public-facing weather stations for educational purposes.</h5>
</div>
<div id="navigate-to-httpsdata.whin.orgdatacurrent-conditions-and-click-on-the-create-account-button-in-the-middle-of-the-screen-1" class="section level5">
<h5>Navigate to <a href="https://data.whin.org/data/current-conditions" class="uri">https://data.whin.org/data/current-conditions</a>, and click on the &quot;CREATE ACCOUNT&quot; button in the middle of the screen:</h5>
<div class="figure">
<img src="images/p9_01.png" />

</div>
</div>
<div id="click-on-im-a-student-or-educator-1" class="section level5">
<h5>Click on &quot;I'm a student or educator&quot;:</h5>
<div class="figure">
<img src="images/p9_02.png" />

</div>
</div>
<div id="enter-your-information.-for-school-or-organization-please-enter-purdue-university.-for-class-or-project-please-put-the-data-mine-project-9.-for-the-description-please-put-we-are-learning-about-writing-scripts-by-writing-a-cli-to-fetch-data-from-the-whin-api.-please-use-your-purdue.edu-email-address.-once-complete-click-next.-1" class="section level5">
<h5>Enter your information. For &quot;School or Organization&quot; please enter &quot;Purdue University&quot;. For &quot;Class or project&quot;, please put &quot;The Data Mine Project 9&quot;. For the description, please put &quot;We are learning about writing scripts by writing a CLI to fetch data from the WHIN API.&quot; Please use your purdue.edu email address. Once complete, click &quot;Next&quot;.</h5>
</div>
<div id="carefully-read-the-license-terms-before-accepting-and-confirm-your-email-address-if-needed.-upon-completion-navigate-here-httpsdata.whin.orgdatacurrent-conditions-1" class="section level5">
<h5>Carefully read the LICENSE TERMS before accepting, and confirm your email address if needed. Upon completion, navigate here: <a href="https://data.whin.org/data/current-conditions" class="uri">https://data.whin.org/data/current-conditions</a></h5>
</div>
<div id="read-about-the-api-under-api-usage.-an-endpoint-is-the-place-in-this-case-the-end-of-a-url-which-can-be-referred-to-as-the-uri-that-you-can-use-to-accessdeleteupdateetc.-a-given-resource-depending-on-the-http-method-used.-what-are-the-3-endpoints-of-this-api-1" class="section level5">
<h5>Read about the API under &quot;API Usage&quot;. An endpoint is the place (in this case the end of a URL (which can be referred to as the URI)) that you can use to access/delete/update/etc. a given resource depending on the HTTP method used. What are the 3 endpoints of this API?</h5>
</div>
<div id="write-and-run-a-script-called-question01.py-that-when-run-tries-to-print-the-current-listing-of-the-weather-stations.-instead-of-printing-what-you-think-it-should-print-it-will-print-something-else.-what-happened-1" class="section level5">
<h5>Write and run a script called <code>question01.py</code> that, when run, tries to print the current listing of the weather stations. Instead of printing what you think it should print, it will print something else. What happened?</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question01.py</span></code></pre></div>
<p><strong>Hint:</strong> You can use the <code>requests</code> library to run the HTTP GET method on the endpoint. For example:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> requests

response <span class="op">=</span> requests.get(<span class="st">&quot;https://datamine.purdue.edu/&quot;</span>)
<span class="bu">print</span>(response.json())</code></pre></div>
<p><strong>Hint:</strong> We want to use our regular course environment, therefore, make sure to use the following shebang: <code>#!/class/datamine/apps/python/f2020-s2021/env/bin/python</code></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_3pwhon32">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-scripts">writing scripts</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
List the 3 endpoints for this API.
</li>
<li>
The entirety of the updated (working) script's content in a Python code chunk with chunk option &quot;eval=F&quot;.
</li>
<li>
Output from running your script with the given examples.
</li>
</ul>
</div>
</div>
<div id="in-question-1-we-quickly-realize-that-we-are-missing-a-critical-step----authentication-recall-that-authentication-is-the-process-of-a-system-understanding-who-a-person-is-authorization-is-the-process-of-telling-whether-or-not-somebody-or-something-has-permissions-to-accessmodifydeleteetc.-a-resource.-when-we-make-get-requests-to-httpsdata.whin.orgapiweatherstations-or-any-other-endpoint-the-server-that-returns-the-data-we-are-trying-to-access-has-no-clue-who-we-are-which-explains-the-result-from-question-1.-1" class="section level5">
<h5>2. In question 1, we quickly realize that we are missing a critical step -- authentication! Recall that authentication is the process of a system understanding <em>who</em> a person is, authorization is the process of telling whether or not somebody (or something) has permissions to access/modify/delete/etc. a resource. When we make GET requests to <a href="https://data.whin.org/api/weather/stations" class="uri">https://data.whin.org/api/weather/stations</a>, or any other endpoint, the server that returns the data we are trying to access has no clue who we are, which explains the result from question 1.</h5>
</div>
<div id="while-there-are-many-methods-of-authentication-whin-is-using-bearer-tokens.-navigate-here.-take-a-look-at-your-account-info.-you-should-see-a-large-chunk-of-random-numbers-and-text.-this-is-your-bearer-token-that-you-can-use-for-authentication.-the-bearer-token-is-to-be-sent-in-the-authorization-header-of-the-request.-for-example-1" class="section level5">
<h5>While there are many methods of authentication, WHIN is using Bearer tokens. Navigate <a href="https://data.whin.org/account">here</a>. Take a look at your account info. You should see a large chunk of random numbers and text. This is your bearer token that you can use for authentication. The bearer token is to be sent in the &quot;Authorization&quot; header of the request. For example:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> requests

my_headers <span class="op">=</span> {<span class="st">&quot;Authorization&quot;</span>: <span class="st">&quot;Bearer LDFKGHSOIDFRUTRLKJNXDFGT&quot;</span>}
response <span class="op">=</span> requests.get(<span class="st">&quot;my_url&quot;</span>, headers <span class="op">=</span> my_headers)</code></pre></div>
</div>
<div id="update-your-script-as-a-new-script-called-question02.py-and-test-it-out-again-to-see-if-we-get-the-expected-results-now.-question02.py-should-only-print-the-first-5-results.-1" class="section level5">
<h5>Update your script (as a new script called <code>question02.py</code>), and test it out again to see if we get the expected results now. <code>question02.py</code> should only print the first 5 results.</h5>
</div>
<div id="a-couple-important-notes-1" class="section level5">
<h5>A couple important notes:</h5>
<ul>
<li>The bearer token should be taken care of like a password. You do NOT want to share this, ever.</li>
<li>There is an inherent risk in saving code like the code shown above. What if you accidentally upload it to GitHub? Then anyone with access could potentially read and use your token.</li>
</ul>
</div>
<div id="how-can-we-include-the-token-in-our-code-without-typing-it-in-our-code-the-typical-way-to-handle-this-is-to-use-environment-variables-andor-a-file-containing-the-information-that-is-specifically-not-shared-unless-necessary.-for-example-create-a-file-called-.env-in-your-home-directory-with-the-following-contents-1" class="section level5">
<h5>How can we include the token in our code without typing it in our code? The typical way to handle this is to use environment variables and/or a file containing the information that is specifically NOT shared unless necessary. For example, create a file called <code>.env</code> in your home directory, with the following contents:</h5>
<pre><code>MY_BEARER_TOKEN=aslgdkjn304iunglsejkrht09
SOME_OTHER_VARIABLE=some_other_value</code></pre>
</div>
<div id="in-this-file-replace-the-aslgdkj...-part-with-you-actual-token-and-save-the-file.-then-make-sure-only-you-can-read-and-write-to-this-file-by-running-the-following-in-a-terminal-1" class="section level5">
<h5>In this file, replace the &quot;aslgdkj...&quot; part with you actual token and save the file. Then make sure only YOU can read and write to this file by running the following in a terminal:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">chmod</span> 600 <span class="va">$HOME</span>/.env</code></pre></div>
</div>
<div id="now-we-can-use-a-package-called-dotenv-to-load-the-variables-in-the-home.env-file-into-the-environment.-we-can-then-use-the-os-package-to-get-the-environment-variables.-for-example-1" class="section level5">
<h5>Now, we can use a package called <code>dotenv</code> to load the variables in the <code>$HOME/.env</code> file into the environment. We can then use the <code>os</code> package to get the environment variables. For example:</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> os
<span class="im">from</span> dotenv <span class="im">import</span> load_dotenv

<span class="co"># This function will load the .env file variables from the same directory as the script into the environment</span>
load_dotenv()

<span class="co"># We can now use os.getenv to get the important information without showing anything.</span>
<span class="co"># Now, all anybody reading the code sees is &quot;os.getenv(&#39;MY_BEARER_TOKEN&#39;)&quot; even though that is replaced by the actual</span>
<span class="co"># token when the code is run, cool!</span>
my_headers <span class="op">=</span> {<span class="st">&quot;Authorization&quot;</span>: <span class="ss">f&quot;Bearer </span><span class="sc">{os.</span>getenv(<span class="st">&#39;MY_BEARER_TOKEN&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span>}</code></pre></div>
</div>
<div id="update-question02.py-to-use-dotenv-and-os.getenv-to-get-the-token-from-the-local-home.env-file.-test-out-your-script-1" class="section level5">
<h5>Update <code>question02.py</code> to use <code>dotenv</code> and <code>os.getenv</code> to get the token from the local <code>$HOME/.env</code> file. Test out your script:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question02.py</span> </code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_fotbs2kc">Click here for video</a></p>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_fq0pqm2c">Click here for another video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-scripts">writing scripts</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The entirety of the updated (working) script's content in a Python code chunk with chunk option &quot;eval=F&quot;.
</li>
<li>
Output from running your script with the given example.
</li>
</ul>
</div>
</div>
<div id="thats-not-so-bad-we-now-know-how-to-retrieve-data-from-the-api-as-well-as-load-up-variables-from-our-environment-rather-than-insecurely-just-pasting-them-in-our-code-great-1" class="section level5">
<h5>3. That's not so bad! We now know how to retrieve data from the API as well as load up variables from our environment rather than insecurely just pasting them in our code, great!</h5>
</div>
<div id="a-query-parameter-is-more-or-less-some-extra-information-added-at-the-end-of-the-endpoint.-for-example-the-following-url-has-a-query-parameter-called-param-and-value-called-value-httpsexample.comsome_resourceparamvalue.-you-could-even-add-more-than-one-query-parameter-as-follows-httpsexample.comsome_resourceparamvaluesecond_paramsecond_value----as-you-can-see-now-we-have-another-parameter-called-second_param-with-a-value-of-second_value.-while-the-query-parameters-begin-with-a-each-subsequent-parameter-is-added-using-.-1" class="section level5">
<h5>A query parameter is (more or less) some extra information added at the end of the endpoint. For example, the following url has a query parameter called <code>param</code> and value called <code>value</code>: <a href="https://example.com/some_resource?param=value" class="uri">https://example.com/some_resource?param=value</a>. You could even add more than one query parameter as follows: <a href="https://example.com/some_resource?param=value&amp;second_param=second_value" class="uri">https://example.com/some_resource?param=value&amp;second_param=second_value</a> -- as you can see, now we have another parameter called <code>second_param</code> with a value of <code>second_value</code>. While the query parameters begin with a <code>?</code>, each subsequent parameter is added using <code>&amp;</code>.</h5>
</div>
<div id="query-parameters-can-be-optional-or-required.-apis-will-sometimes-utilize-query-parameters-to-filter-or-fine-tune-the-returned-results.-look-at-the-documentation-for-the-apiweatherstation-daily-endpoint.-use-your-newfound-knowledge-of-query-parameters-to-update-your-script-as-a-new-script-called-question03.py-to-retrieve-the-data-for-station-with-id-150-on-2021-01-05-and-print-the-first-5-results.-test-out-your-script-1" class="section level5">
<h5>Query parameters can be optional or required. API's will sometimes utilize query parameters to filter or fine-tune the returned results. Look at the documentation for the <code>/api/weather/station-daily</code> endpoint. Use your newfound knowledge of query parameters to update your script (as a new script called <code>question03.py</code>) to retrieve the data for station with id <code>150</code> on <code>2021-01-05</code>, and print the first 5 results. Test out your script:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/question03.py</span></code></pre></div>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_xjcywy0i">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-scripts">writing scripts</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The entirety of the updated (working) script's content in a Python code chunk with chunk option &quot;eval=F&quot;.
</li>
<li>
Output from running your script with the given example.
</li>
</ul>
</div>
</div>
<div id="excellent-now-lets-build-our-cli.-call-the-script-whin.py.-use-your-knowledge-of-requests-argparse-and-apis-to-write-a-cli-that-replicates-the-behavior-shown-below.-for-convenience-only-print-the-first-2-results-for-all-output.-1" class="section level5">
<h5>4. Excellent, now let's build our CLI. Call the script <code>whin.py</code>. Use your knowledge of <code>requests</code>, <code>argparse</code>, and API's to write a CLI that replicates the behavior shown below. For convenience, only print the first 2 results for all output.</h5>
<p><strong>Hints:</strong></p>
<ul>
<li>In general, there will be 3 commands: <code>stations</code>, <code>daily</code>, and <code>cc</code> (for current condition).</li>
<li>You will want to create a subparser for each command: <code>stations_parser</code>, <code>current_conditions_parser</code>, and <code>daily_parser</code>.</li>
<li>The <code>daily_parser</code> will have 2 <em>position</em>, <em>required</em> arguments: <code>station_id</code> and <code>date</code>.</li>
<li>The <code>current_conditions_parser</code> will have 2 <em>optional</em> arguments of type <code>str</code>: <code>--center</code>/<code>-c</code> and <code>--radius</code>/<code>-r</code>.</li>
<li>If only one of <code>--center</code> or <code>--radius</code> is present, you should use <code>sys.exit</code> to print a message saying &quot;Need both center AND radius, or neither.&quot;.</li>
<li>To create a subparser, just do the following:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">parser <span class="op">=</span> argparse.ArgumentParser()
subparsers <span class="op">=</span> parser.add_subparsers(<span class="bu">help</span><span class="op">=</span><span class="st">&quot;possible commands&quot;</span>, dest<span class="op">=</span><span class="st">&quot;command&quot;</span>)

my_subparser <span class="op">=</span> subparsers.add_parser(<span class="st">&quot;my_command&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;my help message&quot;</span>)
my_subparser.add_argument(<span class="st">&quot;--my-option&quot;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">str</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;some option&quot;</span>)

args <span class="op">=</span> parser.parse_args()</code></pre></div>
<ul>
<li>Then, you can access which command was run with <code>args.command</code> (which in this case would only have 1 possible value of <code>my_command</code>), and access any parser or subparsers options with <code>args</code>, for example, <code>args.my_option</code>.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/whin.py</span></code></pre></div>
<pre><code>usage: whin.py [-h] {stations,cc,daily} ...

positional arguments:
  {stations,cc,daily}  possible commands
    stations           list the stations
    cc                 list the most recent data from each weather station
    daily              list data from a given day and station

optional arguments:
  -h, --help           show this help message and exit</code></pre>
<p><strong>Hint:</strong> A good way to print the help information if no arguments are provided is:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">if</span> <span class="bu">len</span>(sys.argv) <span class="op">==</span> <span class="dv">1</span>:
    parser.print_help()
    parser.exit()</code></pre></div>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/whin.py</span> stations -h</code></pre></div>
<pre><code>usage: whin.py stations [-h]

optional arguments:
  -h, --help  show this help message and exit</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/whin.py</span> cc -h</code></pre></div>
<pre><code>usage: whin.py cc [-h] [-c CENTER] [-r RADIUS]

optional arguments:
  -h, --help            show this help message and exit
  -c CENTER, --center CENTER
                        return results near this center coordinate, given as a
                        latitude,longitude pair
  -r RADIUS, --radius RADIUS
                        search distance, in meters, from the center</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/whin.py</span> cc</code></pre></div>
<pre><code>[{&#39;humidity&#39;: 90, &#39;latitude&#39;: 40.93894, &#39;longitude&#39;: -86.47418, &#39;name&#39;: &#39;WHIN001-PULA001&#39;, &#39;observation_time&#39;: &#39;2021-03-16T18:45:00Z&#39;, &#39;pressure&#39;: &#39;30.051&#39;, &#39;rain&#39;: &#39;0&#39;, &#39;rain_inches_last_hour&#39;: &#39;0&#39;, &#39;soil_moist_1&#39;: 6, &#39;soil_moist_2&#39;: 11, &#39;soil_moist_3&#39;: 14, &#39;soil_moist_4&#39;: 9, &#39;soil_temp_1&#39;: 42, &#39;soil_temp_2&#39;: 40, &#39;soil_temp_3&#39;: 40, &#39;soil_temp_4&#39;: 41, &#39;solar_radiation&#39;: 203, &#39;solar_radiation_high&#39;: 244, &#39;station_id&#39;: 1, &#39;temperature&#39;: 40, &#39;temperature_high&#39;: 40, &#39;temperature_low&#39;: 40, &#39;wind_direction_degrees&#39;: &#39;337.5&#39;, &#39;wind_gust_direction_degrees&#39;: &#39;22.5&#39;, &#39;wind_gust_speed_mph&#39;: 6, &#39;wind_speed_mph&#39;: 3}, {&#39;humidity&#39;: 88, &#39;latitude&#39;: 40.73083, &#39;longitude&#39;: -86.98467, &#39;name&#39;: &#39;WHIN003-WHIT001&#39;, &#39;observation_time&#39;: &#39;2021-03-16T18:45:00Z&#39;, &#39;pressure&#39;: &#39;30.051&#39;, &#39;rain&#39;: &#39;0&#39;, &#39;rain_inches_last_hour&#39;: &#39;0&#39;, &#39;soil_moist_1&#39;: 6, &#39;soil_moist_2&#39;: 5, &#39;soil_moist_3&#39;: 6, &#39;soil_moist_4&#39;: 4, &#39;soil_temp_1&#39;: 40, &#39;soil_temp_2&#39;: 39, &#39;soil_temp_3&#39;: 39, &#39;soil_temp_4&#39;: 40, &#39;solar_radiation&#39;: 156, &#39;solar_radiation_high&#39;: 171, &#39;station_id&#39;: 3, &#39;temperature&#39;: 40, &#39;temperature_high&#39;: 40, &#39;temperature_low&#39;: 39, &#39;wind_direction_degrees&#39;: &#39;337.5&#39;, &#39;wind_gust_direction_degrees&#39;: &#39;337.5&#39;, &#39;wind_gust_speed_mph&#39;: 8, &#39;wind_speed_mph&#39;: 3}]</code></pre>
<p><strong>Important note:</strong> Your values may be different because they are <em>current</em> conditions.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/whin.py</span> cc --radius=10000</code></pre></div>
<pre><code>Need both center AND radius, or neither.</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/whin.py</span> cc --center=40.4258686,-86.9080654</code></pre></div>
<pre><code>Need both center AND radius, or neither.</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/whin.py</span> cc --center=40.4258686,-86.9080654 --radius=10000</code></pre></div>
<pre><code>[{&#39;humidity&#39;: 86, &#39;latitude&#39;: 40.42919, &#39;longitude&#39;: -86.84547, &#39;name&#39;: &#39;WHIN008-TIPP005 Chatham Square&#39;, &#39;observation_time&#39;: &#39;2021-03-16T18:45:00Z&#39;, &#39;pressure&#39;: &#39;30.012&#39;, &#39;rain&#39;: &#39;0&#39;, &#39;rain_inches_last_hour&#39;: &#39;0&#39;, &#39;soil_moist_1&#39;: 5, &#39;soil_moist_2&#39;: 5, &#39;soil_moist_3&#39;: 5, &#39;soil_moist_4&#39;: 5, &#39;soil_temp_1&#39;: 42, &#39;soil_temp_2&#39;: 41, &#39;soil_temp_3&#39;: 41, &#39;soil_temp_4&#39;: 42, &#39;solar_radiation&#39;: 191, &#39;solar_radiation_high&#39;: 220, &#39;station_id&#39;: 8, &#39;temperature&#39;: 42, &#39;temperature_high&#39;: 42, &#39;temperature_low&#39;: 42, &#39;wind_direction_degrees&#39;: &#39;0&#39;, &#39;wind_gust_direction_degrees&#39;: &#39;22.5&#39;, &#39;wind_gust_speed_mph&#39;: 9, &#39;wind_speed_mph&#39;: 3}, {&#39;humidity&#39;: 86, &#39;latitude&#39;: 40.38494, &#39;longitude&#39;: -86.84577, &#39;name&#39;: &#39;WHIN027-TIPP003 EXT&#39;, &#39;observation_time&#39;: &#39;2021-03-16T18:45:00Z&#39;, &#39;pressure&#39;: &#39;29.515&#39;, &#39;rain&#39;: &#39;0&#39;, &#39;rain_inches_last_hour&#39;: &#39;0&#39;, &#39;soil_moist_1&#39;: 5, &#39;soil_moist_2&#39;: 4, &#39;soil_moist_3&#39;: 4, &#39;soil_moist_4&#39;: 5, &#39;soil_temp_1&#39;: 43, &#39;soil_temp_2&#39;: 42, &#39;soil_temp_3&#39;: 42, &#39;soil_temp_4&#39;: 42, &#39;solar_radiation&#39;: 221, &#39;solar_radiation_high&#39;: 244, &#39;station_id&#39;: 27, &#39;temperature&#39;: 43, &#39;temperature_high&#39;: 43, &#39;temperature_low&#39;: 43, &#39;wind_direction_degrees&#39;: &#39;337.5&#39;, &#39;wind_gust_direction_degrees&#39;: &#39;337.5&#39;, &#39;wind_gust_speed_mph&#39;: 6, &#39;wind_speed_mph&#39;: 3}]</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/whin.py</span> daily</code></pre></div>
<pre><code>usage: whin.py daily [-h] station_id date
whin.py daily: error: too few arguments</code></pre>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">$HOME</span><span class="ex">/whin.py</span> daily 150 2021-01-05</code></pre></div>
<pre><code>[{&#39;humidity&#39;: 96, &#39;latitude&#39;: 41.00467, &#39;longitude&#39;: -86.68428, &#39;name&#39;: &#39;WHIN058-PULA007&#39;, &#39;observation_time&#39;: &#39;2021-01-05T05:00:00Z&#39;, &#39;pressure&#39;: &#39;29.213&#39;, &#39;rain&#39;: &#39;0&#39;, &#39;rain_inches_last_hour&#39;: &#39;0&#39;, &#39;soil_moist_1&#39;: 5, &#39;soil_moist_2&#39;: 6, &#39;soil_moist_3&#39;: 7, &#39;soil_moist_4&#39;: 5, &#39;soil_temp_1&#39;: 33, &#39;soil_temp_2&#39;: 34, &#39;soil_temp_3&#39;: 35, &#39;soil_temp_4&#39;: 35, &#39;solar_radiation&#39;: 0, &#39;solar_radiation_high&#39;: 0, &#39;station_id&#39;: 150, &#39;temperature&#39;: 31, &#39;temperature_high&#39;: 31, &#39;temperature_low&#39;: 31, &#39;wind_direction_degrees&#39;: &#39;270&#39;, &#39;wind_gust_direction_degrees&#39;: &#39;292.5&#39;, &#39;wind_gust_speed_mph&#39;: 13, &#39;wind_speed_mph&#39;: 8}, {&#39;humidity&#39;: 96, &#39;latitude&#39;: 41.00467, &#39;longitude&#39;: -86.68428, &#39;name&#39;: &#39;WHIN058-PULA007&#39;, &#39;observation_time&#39;: &#39;2021-01-05T05:15:00Z&#39;, &#39;pressure&#39;: &#39;29.207&#39;, &#39;rain&#39;: &#39;1&#39;, &#39;rain_inches_last_hour&#39;: &#39;0&#39;, &#39;soil_moist_1&#39;: 5, &#39;soil_moist_2&#39;: 6, &#39;soil_moist_3&#39;: 7, &#39;soil_moist_4&#39;: 5, &#39;soil_temp_1&#39;: 33, &#39;soil_temp_2&#39;: 34, &#39;soil_temp_3&#39;: 35, &#39;soil_temp_4&#39;: 35, &#39;solar_radiation&#39;: 0, &#39;solar_radiation_high&#39;: 0, &#39;station_id&#39;: 150, &#39;temperature&#39;: 31, &#39;temperature_high&#39;: 31, &#39;temperature_low&#39;: 31, &#39;wind_direction_degrees&#39;: &#39;270&#39;, &#39;wind_gust_direction_degrees&#39;: &#39;292.5&#39;, &#39;wind_gust_speed_mph&#39;: 14, &#39;wind_speed_mph&#39;: 9}]</code></pre>
<p><a href="https://mediaspace.itap.purdue.edu/id/1_rej7d8oo">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-scripts">writing scripts</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The entirety of the updated (working) script's content in a Python code chunk with chunk option &quot;eval=F&quot;.
</li>
<li>
Output from running your script with the given examples.
</li>
</ul>
</div>
</div>
<div id="there-are-a-multitude-of-improvements-andor-features-that-we-could-add-to-whin.py.-customize-your-script-as-a-new-script-called-question05.py-to-either-do-something-new-or-fix-a-scenario-that-wasnt-covered-in-question-4.-be-sure-to-include-1-2-sentences-that-explains-exactly-what-your-modification-does.-demonstrate-the-feature-by-running-it-in-a-bash-code-chunk.-1" class="section level5">
<h5>5. There are a multitude of improvements and/or features that we could add to <code>whin.py</code>. Customize your script (as a new script called <code>question05.py</code>), to either do something new, or fix a scenario that wasn't covered in question 4. Be sure to include 1-2 sentences that explains exactly what your modification does. Demonstrate the feature by running it in a bash code chunk.</h5>
<p><strong>Relevant topics:</strong> <a href="python.html#p-writing-scripts">writing scripts</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The entirety of the updated (working) script's content in a Python code chunk with chunk option &quot;eval=F&quot;.
</li>
<li>
Output from running your script with the given examples.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="p10-390" class="section level3">
<h3>Project 10</h3>
<hr />
<p><strong>Motivation:</strong> The use of a suite of packages referred to as the <code>tidyverse</code> is popular with many R users. It is apparent just by looking at <code>tidyverse</code> R code, that it varies greatly in style from typical R code. It is useful to gain some familiarity with this collection of packages, in case you run into a situation where these packages are needed -- you may even find that you enjoy using them!</p>
<p><strong>Context:</strong> We've covered a lot of ground so far this semester, and almost completely using Python. In this next series of projects we are going to switch back to R with a strong focus on the <code>tidyverse</code> (including <code>ggplot</code>) and data wrangling tasks.</p>
<p><strong>Scope:</strong> R, tidyverse, ggplot</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Explain the differences between regular data frames and tibbles.
</li>
<li>
Use mutate, pivot, unite, filter, and arrange to wrangle data and solve data-driven problems.
</li>
<li>
Combine different data using joins (left_join, right_join, semi_join, anti_join), and bind_rows.
</li>
<li>
Group data and calculate aggregated statistics using group_by, mutate, and transform functions.
</li>
<li>
Demonstrate the ability to create basic graphs with default settings, in <code>ggplot</code>.
</li>
<li>
Demonstrate the ability to modify axes labels and titles.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<p>The <code>tidyverse</code> consists of a variety of packages, including, but not limited to: <code>ggplot2</code>, <code>dplyr</code>, <code>tidyr</code>, <code>readr</code>, <code>purrr</code>, <code>tibble</code>, <code>stringr</code>, and <code>lubridate</code>.</p>
<p>One of the underlying premises of the <code>tidyverse</code> is getting the data to be <a href="https://r4ds.had.co.nz/tidy-data.html#tidy-data-1">tidy</a>. You can read a lot more about this in Hadley Wickham's excellent book, <a href="https://r4ds.had.co.nz">R for Data Science</a>.</p>
<p>There is an excellent graphic <a href="https://r4ds.had.co.nz/introduction.html#what-you-will-learn">here</a> that illustrates a general workflow for data science projects:</p>
<ol style="list-style-type: decimal">
<li>Import</li>
<li>Tidy</li>
<li>Iterate on, to gain understanding:
<ol style="list-style-type: decimal">
<li>Transform</li>
<li>Visualize</li>
<li>Model</li>
</ol></li>
<li>Communicate</li>
</ol>
<p>This is a good general outline of how a project could be organized, but depending on the project or company, this could vary greatly and change as the goals of a project change.</p>
<div id="dataset-25" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/okcupid/filtered/*.csv</code></p>
<div id="lets-more-or-less-follow-the-guidelines-given-above.-the-first-step-is-to-import-the-data.-there-are-two-files-questions.csv-and-users.csv.-read-this-section-and-use-what-you-learn-to-read-in-the-two-files-into-questions-and-users-respectively.-which-functions-from-the-tidyverse-did-you-use-and-why-1" class="section level5">
<h5>1. Let's (more or less) follow the guidelines given above. The first step is to <a href="https://r4ds.had.co.nz/data-import.html">import</a> the data. There are two files: <code>questions.csv</code>, and <code>users.csv</code>. Read <a href="https://r4ds.had.co.nz/data-import.html">this section</a>, and use what you learn to read in the two files into <code>questions</code> and <code>users</code>, respectively. Which functions from the <code>tidyverse</code> did you use and why?</h5>
<p><strong>Hint:</strong> Its easy to load up the <code>tidyverse</code> packages:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre></div>
<p><strong>Hint:</strong> Just because a file has the <code>.csv</code> extension does <em>not</em> mean that is it comma separated.</p>
<p><strong>Hint:</strong> Make sure to print the <code>tibble</code>s after reading them in to ensure that they were read in correctly. If they were not, use a different function (from <code>tidyverse</code>) to read in the data.</p>
<p><strong>Hint:</strong> <code>questions</code> should be 2281x10 and <code>users</code> should be 68371 x 2284</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
<code>head</code> of each dataset, <code>users</code> and <code>questions</code>.
</li>
<li>
1 sentence explaining which functions you used (from <code>tidyverse</code>) and why.
</li>
</ul>
</div>
</div>
<div id="you-may-recall-that-the-function-read.csv-from-base-r-reads-data-into-a-data.frame-by-default.-in-the-tidyverse-readrs-functions-read-the-data-into-a-tibbles-instead.-read-this-section.-to-summarize-some-important-features-that-are-true-for-tibbles-but-not-necessarily-for-data.frames-are-1" class="section level5">
<h5>2. You may recall that the function <code>read.csv</code> from base R reads data into a data.frame by default. In the <code>tidyverse</code>, <code>readr</code>'s functions read the data into a <code>tibble</code>'s, instead. Read <a href="https://r4ds.had.co.nz/tibbles.html">this section</a>. To summarize, some important features that are true for <code>tibble</code>'s but not necessarily for data.frames are:</h5>
<ul>
<li>Non-syntactic variable names (surrounded by backticks <code>`</code> )</li>
<li>Never changes the type of the inputs (for example converting strings to factors)</li>
<li>More informative output from printing</li>
<li>No partial matching</li>
<li>Simple <a href="https://r4ds.had.co.nz/tibbles.html#subsetting">subsetting</a></li>
</ul>
</div>
<div id="great-the-next-step-in-our-outline-is-to-make-the-data-tidy.-read-this-section.-okay-lets-say-for-instance-that-we-wanted-to-create-a-tibble-with-the-following-columns-user-question-question_text-selected_option-race-gender2-gender_orientation-n-and-keywords.-as-you-can-imagine-the-tidy-format-while-great-for-analysis-would-not-be-great-for-storage-as-there-would-be-a-row-for-each-question-for-each-user-at-least.-columns-like-gender2-and-race-dont-change-for-a-user-so-we-end-up-with-a-lot-of-repeated-values.-1" class="section level5">
<h5>Great, the next step in our outline is to make the data &quot;tidy&quot;. Read <a href="https://r4ds.had.co.nz/tidy-data.html#tidy-data-1">this section</a>. Okay, let's say, for instance, that we wanted to create a <code>tibble</code> with the following columns: <code>user</code>, <code>question</code>, <code>question_text</code>, <code>selected_option</code>, <code>race</code>, <code>gender2</code>, <code>gender_orientation</code>, <code>n</code>, and <code>keywords</code>. As you can imagine, the &quot;tidy&quot; format, while great for analysis, would <em>not</em> be great for storage as there would be a row for each question for each user, at least. Columns like <code>gender2</code> and <code>race</code> don't change for a user, so we end up with a lot of repeated values.</h5>
</div>
<div id="okay-we-dont-need-to-analyze-all-68000-users-at-once-lets-instead-take-a-random-sample-of-2200-users-and-create-a-tidy-tibble-as-described-above.-after-all-we-want-to-see-why-this-format-is-useful-while-trying-to-figure-out-how-to-do-this-may-seem-daunting-at-first-it-is-actually-not-so-bad-1" class="section level5">
<h5>Okay, we don't need to analyze all 68000 users at once, let's instead, take a random sample of 2200 users, and create a &quot;tidy&quot; <code>tibble</code> as described above. After all, we want to see why this format is useful! While trying to figure out how to do this may seem daunting at first, it is actually not <em>so</em> bad:</h5>
</div>
<div id="first-we-convert-the-users-tibble-to-long-form-so-each-row-represents-1-answer-to-1-questions-from-1-user-1" class="section level5">
<h5>First, we convert the <code>users</code> tibble to long form, so each row represents 1 answer to 1 questions from 1 user:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Add an &quot;id&quot; columns to the users data</span>
users<span class="op">$</span>id &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(users)
<span class="co"># To ensure we get the same random sample, run the set.seed line</span>
<span class="co"># before every time you run the following line</span>
<span class="kw">set.seed</span>(<span class="dv">12345</span>) 
columns_to_pivot &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">2278</span>
users_sample_long &lt;-<span class="st"> </span>users[<span class="kw">sample</span>(<span class="kw">nrow</span>(users), <span class="dv">2200</span>),] <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate_at</span>(columns_to_pivot, as.character) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># This converts all of our columns in columns_to_pivot to strings</span>
<span class="st">    </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> columns_to_pivot, <span class="dt">names_to=</span><span class="st">&quot;question&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;selected_option&quot;</span>) <span class="co"># The old qXXXX columns are now values in the &quot;question&quot; column.</span></code></pre></div>
</div>
<div id="next-we-want-to-merge-our-data-from-the-questions-tibble-with-our-users_sample_long-tibble-into-a-new-table-we-will-call-mydf.-how-many-rows-and-columns-are-in-mydf-1" class="section level5">
<h5>Next, we want to merge our data from the <code>questions</code> tibble with our <code>users_sample_long</code> tibble, into a new table we will call <code>myDF</code>. How many rows and columns are in <code>myDF</code>?</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myDF &lt;-<span class="st"> </span><span class="kw">merge</span>(users_sample_long, questions, <span class="dt">by.x =</span> <span class="st">&quot;question&quot;</span>, <span class="dt">by.y =</span> <span class="st">&quot;X&quot;</span>)</code></pre></div>
<p><strong>Challenge:</strong> (0 pts, for fun) If you are looking for a challenge, try to do this in excel or without <code>tidyverse</code>.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The number of rows and columns in <code>myDF</code>.
</li>
<li>
The <code>head</code> of <code>myDF</code>.
</li>
</ul>
</div>
</div>
<div id="excellent-now-we-have-a-nice-tidy-dataset-that-we-can-work-with.-you-may-have-noticed-some-odd-syntax-in-the-code-provided-in-the-previous-question.-is-the-piping-operator-in-r-added-by-the-magittr-package.-it-works-pretty-much-just-like-does-in-bash.-it-feeds-the-output-from-the-previous-bit-of-code-to-the-next-bit-of-code.-it-is-extremely-common-practice-to-use-this-operator-in-the-tidyverse.-1" class="section level5">
<h5>3. Excellent! Now, we have a nice tidy dataset that we can work with. You may have noticed some odd syntax <code>%&gt;%</code> in the code provided in the previous question. <code>%&gt;%</code> is the piping operator in R added by the <code>magittr</code> package. It works pretty much just like <code>|</code> does in bash. It &quot;feeds&quot; the output from the previous bit of code to the next bit of code. It is extremely common practice to use this operator in the <code>tidyverse</code>.</h5>
</div>
<div id="observe-the-head-of-mydf.-notice-how-our-question-column-has-the-value-d_age-text-has-the-content-age-and-selected_option-the-column-that-shows-the-answer-the-user-gave-has-the-actual-age-of-the-user.-wouldnt-it-be-better-if-our-mydf-had-a-new-column-called-age-instead-of-age-being-an-answer-to-a-question-1" class="section level5">
<h5>Observe the <code>head</code> of <code>myDF</code>. Notice how our <code>question</code> column has the value <code>d_age</code>, <code>text</code> has the content &quot;Age&quot;, and <code>selected_option</code> (the column that shows the &quot;answer&quot; the user gave), has the actual age of the user. Wouldn't it be better if our <code>myDF</code> had a new column called <code>age</code> instead of <code>age</code> being an answer to a question?</h5>
</div>
<div id="modify-the-code-provided-in-question-2-so-age-ends-up-being-a-column-in-mydf-with-the-value-being-the-actual-age-of-the-user.-1" class="section level5">
<h5>Modify the code provided in question 2 so <code>age</code> ends up being a column in <code>myDF</code> with the value being the actual age of the user.</h5>
<p><strong>Hint:</strong> Pay close attention to <a href="https://tidyr.tidyverse.org/reference/pivot_longer.html"><code>pivot_longer</code></a>. You will need to understand what this function is doing to fix this.</p>
<p><strong>Hint:</strong> You can make a single modification to 1 line to accomplish this. Pay close attention to the <code>cols</code> option in <code>pivot_longer</code>. If you include a column in <code>cols</code> what happens? If you exclude a columns from <code>cols</code> what happens? Experiment on the following <code>tibble</code>, using different values for <code>cols</code>, as well as <code>names_to</code>, and <code>values_to</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myDF &lt;-<span class="st"> </span><span class="kw">tibble</span>(
    <span class="dt">x=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,
    <span class="dt">y=</span><span class="dv">1</span>,
    <span class="dt">question1=</span><span class="kw">c</span>(<span class="st">&quot;How&quot;</span>, <span class="st">&quot;What&quot;</span>, <span class="st">&quot;Why&quot;</span>),
    <span class="dt">question2=</span><span class="kw">c</span>(<span class="st">&quot;Really&quot;</span>, <span class="st">&quot;You sure&quot;</span>, <span class="st">&quot;When&quot;</span>),
    <span class="dt">question3=</span><span class="kw">c</span>(<span class="st">&quot;Who&quot;</span>, <span class="st">&quot;Seriously&quot;</span>, <span class="st">&quot;Right now&quot;</span>)
)</code></pre></div>
<p><strong>Hint:</strong> You can make a single modification to 1 line to accomplish this.</p>
<p><strong>Challenge:</strong> (0 pts, for fun) If you are looking for a challenge, try to do this in excel or without <code>tidyverse</code>.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-indexing">Negative Indexing</a>, <a href="r.html#r-which">which</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The number of rows and columns in <code>myDF</code>.
</li>
<li>
The <code>head</code> of <code>myDF</code>.
</li>
</ul>
</div>
</div>
<div id="wow-that-is-pretty-powerful-okay-it-is-clear-that-there-are-question-questions-where-the-column-starts-with-q-and-other-questions-where-the-column-starts-with-something-else.-modify-question-3-so-all-of-the-questions-that-dont-start-with-q-have-their-own-column-in-mydf.-like-before-show-the-number-of-rows-and-columns-for-the-new-mydf-as-well-as-print-the-head.-1" class="section level5">
<h5>4. Wow! That is pretty powerful! Okay, it is clear that there are question questions, where the column starts with &quot;q&quot;, and other questions, where the column starts with something else. Modify question (3) so all of the questions that <em>don't</em> start with &quot;q&quot; have their own column in <code>myDF</code>. Like before, show the number of rows and columns for the new <code>myDF</code>, as well as print the <code>head</code>.</h5>
<p><strong>Challenge:</strong> (0 pts, for fun) If you are looking for a challenge, try to do this in excel or without <code>tidyverse</code>.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-indexing">Negative Indexing</a>, <a href="r.html#r-which">which</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The number of rows and columns in <code>myDF</code>.
</li>
<li>
The <code>head</code> of <code>myDF</code>.
</li>
</ul>
</div>
</div>
<div id="it-seems-like-weve-spent-the-majority-of-the-project-just-wrangling-our-dataset----that-is-normal-youd-be-incredibly-lucky-to-work-in-an-environment-where-you-recieve-data-in-a-nice-neat-perfect-format.-lets-do-a-couple-basic-operations-now-to-practice.-1" class="section level5">
<h5>5. It seems like we've spent the majority of the project just wrangling our dataset -- that is normal! You'd be incredibly lucky to work in an environment where you recieve data in a nice, neat, perfect format. Let's do a couple basic operations now, to practice.</h5>
</div>
<div id="mutate-is-a-powerful-function-in-dplyr-that-is-not-easy-to-mimic-in-pythons-pandas-package.-mutate-adds-new-columns-to-your-tibble-while-preserving-your-existing-columns.-it-doesnt-sound-very-powerful-but-it-is.-1" class="section level5">
<h5><a href="https://dplyr.tidyverse.org/reference/mutate.html"><code>mutate</code></a> is a powerful function in <code>dplyr</code>, that is not easy to mimic in Python's <code>pandas</code> package. <code>mutate</code> adds new columns to your tibble, while preserving your existing columns. It doesn't sound very powerful, but it is.</h5>
</div>
<div id="use-mutate-to-create-a-new-column-called-generation.-generation-should-contain-gen-z-for-ages-0-24-millenial-for-ages-25-40-gen-x-for-ages-41-56-and-boomers-ii-for-ages-57-66-and-older-for-all-other-ages.-1" class="section level5">
<h5>Use mutate to create a new column called <code>generation</code>. <code>generation</code> should contain &quot;Gen Z&quot; for ages [0, 24], &quot;Millenial&quot; for ages [25-40], &quot;Gen X&quot; for ages [41-56], and &quot;Boomers II&quot; for ages [57-66], and &quot;Older&quot; for all other ages.</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-mutate">mutate</a>, <a href="r.html#r-case_when">case_when</a>, <a href="r.html#r-between">between</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The number of rows and columns in <code>myDF</code>.
</li>
<li>
The <code>head</code> of <code>myDF</code>.
</li>
</ul>
</div>
</div>
<div id="use-ggplot-to-create-a-scatterplot-showing-d_age-on-the-x-axis-and-lf_min_age-on-the-y-axis.-lf_min_age-is-the-minimum-age-a-user-is-okay-dating.-color-the-points-based-on-gender2.-add-a-proper-title-and-labels-for-the-x-and-y-axes.-use-alpha.6.-1" class="section level5">
<h5>6. Use <code>ggplot</code> to create a scatterplot showing <code>d_age</code> on the x-axis, and <code>lf_min_age</code> on the y-axis. <code>lf_min_age</code> is the minimum age a user is okay dating. Color the points based on <code>gender2</code>. Add a proper title, and labels for the X and Y axes. Use <code>alpha=.6</code>.</h5>
<p><strong>Note:</strong> This may take quite a few minutes to create. Before creating a plot with the entire <code>myDF</code>, use <code>myDF[1:10,]</code>. If you are in a time crunch, the minimum number of points to plot to get full credit is 100, but if you wait, the plot is a bit more telling.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-scatterplot">ggplot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
The plot produced.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="p11-390" class="section level3">
<h3>Project 11</h3>
<hr />
<p><strong>Motivation:</strong> Data wrangling is the process of gathering, cleaning, structuring, and transforming data. Data wrangling is a big part in any data driven project, and sometimes can take a great deal of time. 'tidyverse` is a great, but opinionated, suite of integrated packages to wrangle, tidy and visualize data. It is useful to gain some familiarity with this collection of packages, in case you run into a situation where these packages are needed -- you may even find that you enjoy using them!</p>
<p><strong>Context:</strong> We have covered a few topics on the <code>tidyverse</code> packages, but there is a lot more to learn! We will continue our strong focus on the <code>tidyverse</code> (including <code>ggplot</code>) and data wrangling tasks.</p>
<p><strong>Scope:</strong> R, tidyverse, ggplot</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Explain the differences between regular data frames and tibbles.
</li>
<li>
Use mutate, pivot, unite, filter, and arrange to wrangle data and solve data-driven problems.
</li>
<li>
Combine different data using joins (left_join, right_join, semi_join, anti_join), and bind_rows.
</li>
<li>
Group data and calculate aggregated statistics using group_by, mutate, and transform functions.
</li>
<li>
Demonstrate the ability to create basic graphs with default settings, in <code>ggplot</code>.
</li>
<li>
Demonstrate the ability to modify axes labels and titles.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<p>The <code>tidyverse</code> consists of a variety of packages, including, but not limited to: <code>ggplot2</code>, <code>dplyr</code>, <code>tidyr</code>, <code>readr</code>, <code>purrr</code>, <code>tibble</code>, <code>stringr</code>, and <code>lubridate</code>.</p>
<p>One of the underlying premises of the <code>tidyverse</code> is getting the data to be <a href="https://r4ds.had.co.nz/tidy-data.html#tidy-data-1">tidy</a>. You can read a lot more about this in Hadley Wickham's excellent book, <a href="https://r4ds.had.co.nz">R for Data Science</a>.</p>
<p>There is an excellent graphic <a href="https://r4ds.had.co.nz/introduction.html#what-you-will-learn">here</a> that illustrates a general workflow for data science projects:</p>
<ol style="list-style-type: decimal">
<li>Import</li>
<li>Tidy</li>
<li>Iterate on, to gain understanding:
<ol style="list-style-type: decimal">
<li>Transform</li>
<li>Visualize</li>
<li>Model</li>
</ol></li>
<li>Communicate</li>
</ol>
<p>This is a good general outline of how a project could be organized, but depending on the project or company, this could vary greatly and change as the goals of a project change.</p>
<div id="dataset-26" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/okcupid/filtered/*.csv</code></p>
</div>
<div id="questions-33" class="section level4">
<h4>Questions</h4>
<div class="sourceCode"><pre class="sourceCode r solution"><code class="sourceCode r"><span class="kw">datamine_py</span>()
<span class="kw">library</span>(tidyverse)

questions &lt;-<span class="st"> </span><span class="kw">read_csv2</span>(<span class="st">&quot;/class/datamine/data/okcupid/filtered/questions.csv&quot;</span>)
users &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;/class/datamine/data/okcupid/filtered/users.csv&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r solution"><code class="sourceCode r">users<span class="op">$</span>id &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(users)
<span class="kw">set.seed</span>(<span class="dv">12345</span>)
columns_to_pivot &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">2278</span>
users_sample_long &lt;-<span class="st"> </span>users[<span class="kw">sample</span>(<span class="kw">nrow</span>(users), <span class="dv">2200</span>),] <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate_at</span>(columns_to_pivot, as.character) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> columns_to_pivot, <span class="dt">names_to=</span><span class="st">&quot;question&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;selected_option&quot;</span>)

myDF &lt;-<span class="st"> </span><span class="kw">merge</span>(users_sample_long, questions, <span class="dt">by.x =</span> <span class="st">&quot;question&quot;</span>, <span class="dt">by.y =</span> <span class="st">&quot;X&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r solution"><code class="sourceCode r">users<span class="op">$</span>id &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(users)
<span class="kw">set.seed</span>(<span class="dv">12345</span>)
columns_to_pivot &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">2278</span>
users_sample_long &lt;-<span class="st"> </span>users[<span class="kw">sample</span>(<span class="kw">nrow</span>(users), <span class="dv">2200</span>),] <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate_at</span>(columns_to_pivot, as.character) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> columns_to_pivot[<span class="op">-</span><span class="dv">1242</span>], <span class="dt">names_to=</span><span class="st">&quot;question&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;selected_option&quot;</span>)

myDF &lt;-<span class="st"> </span><span class="kw">merge</span>(users_sample_long, questions, <span class="dt">by.x =</span> <span class="st">&quot;question&quot;</span>, <span class="dt">by.y =</span> <span class="st">&quot;X&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r solution"><code class="sourceCode r">users<span class="op">$</span>id &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(users)
<span class="kw">set.seed</span>(<span class="dv">12345</span>)
columns_to_pivot &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">2278</span>
users_sample_long &lt;-<span class="st"> </span>users[<span class="kw">sample</span>(<span class="kw">nrow</span>(users), <span class="dv">2200</span>),] <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate_at</span>(columns_to_pivot, as.character) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> columns_to_pivot[<span class="op">-</span>(<span class="kw">which</span>(<span class="kw">substr</span>(<span class="kw">names</span>(users), <span class="dv">1</span>, <span class="dv">1</span>) <span class="op">!=</span><span class="st"> &quot;q&quot;</span>))], <span class="dt">names_to=</span><span class="st">&quot;question&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;selected_option&quot;</span>)

myDF &lt;-<span class="st"> </span><span class="kw">merge</span>(users_sample_long, questions, <span class="dt">by.x =</span> <span class="st">&quot;question&quot;</span>, <span class="dt">by.y =</span> <span class="st">&quot;X&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r solution"><code class="sourceCode r">myDF &lt;-<span class="st"> </span>myDF <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">generation=</span><span class="kw">case_when</span>(d_age<span class="op">&lt;=</span><span class="dv">24</span> <span class="op">~</span><span class="st"> &quot;Gen Z&quot;</span>,
                                     <span class="kw">between</span>(d_age, <span class="dv">25</span>, <span class="dv">40</span>) <span class="op">~</span><span class="st"> &quot;Millenial&quot;</span>,
                                     <span class="kw">between</span>(d_age, <span class="dv">41</span>, <span class="dv">56</span>) <span class="op">~</span><span class="st"> &quot;Gen X&quot;</span>,
                                     <span class="kw">between</span>(d_age, <span class="dv">57</span>, <span class="dv">66</span>) <span class="op">~</span><span class="st"> &quot;Boomers II&quot;</span>,
                                     <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Other&quot;</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r solution"><code class="sourceCode r"><span class="kw">ggplot</span>(myDF[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,]) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>d_age, <span class="dt">y =</span> lf_min_age, <span class="dt">col=</span>gender2), <span class="dt">alpha=</span>.<span class="dv">6</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Minimum dating age by gender&quot;</span>, <span class="dt">x=</span><span class="st">&quot;User age&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Minimum date age&quot;</span>)</code></pre></div>
<div id="lets-pick-up-where-we-left-in-project-10.-for-those-who-struggled-with-project-10-i-will-post-the-solutions-above-either-on-saturday-morning-or-at-the-latest-monday.-re-run-your-code-from-project-10-so-we-once-again-have-our-tibble-mydf.-1" class="section level5">
<h5>1. Let's pick up where we left in project 10. For those who struggled with project 10, I will post the solutions above either on Saturday morning, or at the latest Monday. Re-run your code from project 10 so we, once again, have our <code>tibble</code>, <code>myDF</code>.</h5>
</div>
<div id="at-the-end-of-project-10-we-created-a-scatterplot-showing-d_age-on-the-x-axis-and-lf_min_age-on-the-y-axis.-in-addition-we-colored-the-points-by-gender2.-in-many-cases-instead-of-just-coloring-the-different-dots-we-may-want-to-do-the-exact-same-plot-for-different-groups.-this-can-easily-be-accomplished-using-ggplot.-1" class="section level5">
<h5>At the end of project 10 we created a scatterplot showing <code>d_age</code> on the x-axis, and <code>lf_min_age</code> on the y-axis. In addition, we colored the points by <code>gender2</code>. In many cases, instead of just coloring the different dots, we may want to do the exact <em>same</em> plot for <em>different</em> groups. This can easily be accomplished using <code>ggplot</code>.</h5>
</div>
<div id="without-splitting-or-filtering-your-data-prior-to-creating-the-plots-create-a-graphic-with-plots-for-each-generation-where-we-show-d_age-on-the-x-axis-and-lf_min_age-on-the-y-axis-colored-by-gender2.-1" class="section level5">
<h5><strong>Without</strong> splitting or filtering your data prior to creating the plots, create a graphic with plots for each <code>generation</code> where we show <code>d_age</code> on the x-axis and <code>lf_min_age</code> on the y-axis, colored by <code>gender2</code>.</h5>
<p><strong>Important note:</strong> You do not need to modify <code>myDF</code> at all.</p>
<p><strong>Important note:</strong> This may take quite a few minutes to create. Before creating a plot with the entire myDF, use myDF[1:50,]. If you are in a time crunch, the minimum number of points to plot to get full credit is 500, but if you wait, the plot is a bit more telling.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-facet_wrap">facet_wrap</a>, <a href="r.html#r-facet_grid">facet_grid</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
The plot produced.
</li>
</ul>
</div>
</div>
<div id="by-default-facet_wrap-and-facet_grid-maintain-the-same-scale-for-the-x-and-y-axes-across-the-various-plots.-this-makes-it-easier-to-compare-visually.-in-this-case-it-may-make-it-harder-to-see-the-patterns-that-emerge.-modify-your-code-from-question-1-to-allow-each-facet-to-have-its-own-x-and-y-axis-limits.-1" class="section level5">
<h5>2. By default, <code>facet_wrap</code> and <code>facet_grid</code> maintain the same scale for the x and y axes across the various plots. This makes it easier to compare visually. In this case, it may make it harder to see the patterns that emerge. Modify your code from question (1) to allow each facet to have its own x and y axis limits.</h5>
<p><strong>Hint:</strong> Look at the argument <code>scales</code> in the <code>facet_wrap</code>/<code>facet_grid</code> functions.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-facet_wrap">facet_wrap</a>, <a href="r.html#r-facet_grid">facet_grid</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
The plot produced.
</li>
</ul>
</div>
</div>
<div id="lets-say-we-have-a-theory-that-the-older-generations-tend-to-smoke-more.-you-decided-you-want-to-create-a-plot-that-compares-the-percentage-of-smokers-per-generation.-before-we-do-this-we-need-to-wrangle-the-data-a-bit.-1" class="section level5">
<h5>3. Let's say we have a theory that the older generations tend to smoke more. You decided you want to create a plot that compares the percentage of smokers per <code>generation</code>. Before we do this, we need to wrangle the data a bit.</h5>
</div>
<div id="what-are-the-possible-values-of-d_smokes-create-a-new-column-in-mydf-called-is_smoker-that-has-values-true-false-or-na-when-applicable.-you-will-need-to-determine-how-you-will-assign-a-user-as-a-smoker-or-not----this-is-up-to-you-explain-your-cutoffs.-make-sure-you-stay-in-the-tidyverse-to-solve-this-problem.-1" class="section level5">
<h5>What are the possible values of <code>d_smokes</code>? Create a new column in <code>myDF</code> called <code>is_smoker</code> that has values <code>TRUE</code>, <code>FALSE</code>, or <code>NA</code> when applicable. You will need to determine how you will assign a user as a smoker or not -- this is up to you! Explain your cutoffs. Make sure you stay in the <code>tidyverse</code> to solve this problem.</h5>
<p><strong>Relevant topics:</strong> <a href="">unique</a>, <a href="">mutate</a>, <a href="">case_when</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
1-2 sentences explaining your logic and cutoffs for the new <code>is_smoker</code> column.
</li>
<li>
The <code>table</code> of the <code>is_smoker</code> column.
</li>
</ul>
</div>
</div>
<div id="great-now-that-we-have-our-new-is_smoker-column-create-a-new-tibble-called-smokers_per_gen.-smokers_per_gen-should-be-a-summary-of-mydf-containing-the-percentage-of-smokers-per-generation.-1" class="section level5">
<h5>4. Great! Now that we have our new <code>is_smoker</code> column, create a new <code>tibble</code> called <code>smokers_per_gen</code>. <code>smokers_per_gen</code> should be a summary of <code>myDF</code> containing the percentage of smokers per <code>generation</code>.</h5>
<p><strong>Hint:</strong> The result, <code>smokers_per_gen</code> should have 2 columns: <code>generation</code> and <code>percentage_of_smokers</code>. It should have the same number of rows as there are <code>generation</code>s.</p>
<p><strong>Relevant topics:</strong> <a href="">group_by</a>, <a href="">summarize</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="create-a-cleveland-dot-plot-using-ggplot-to-show-the-percentage-of-smokers-for-the-different-generations.-use-ggthemr-to-give-your-plot-a-new-look-you-can-choose-any-theme-youd-like-1" class="section level5">
<h5>5. Create a Cleveland dot plot using <code>ggplot</code> to show the percentage of smokers for the different <code>generation</code>s. Use <code>ggthemr</code> to give your plot a new look! You can choose any theme you'd like!</h5>
</div>
<div id="is-our-theory-from-question-3-correct-explain-why-you-think-so-or-not.-1" class="section level5">
<h5>Is our theory from question (3) correct? Explain why you think so, or not.</h5>
</div>
<div id="optional-i-0-points-to-make-the-plot-have-a-more-aesthetic-look-consider-reordering-the-data-by-percentage-of-smokers-or-even-by-the-generations-age.-you-can-do-that-before-passing-the-data-using-the-arrange-function-or-inside-the-geom_point-function-using-the-reorder-function.-to-re-order-by-generation-you-can-either-use-brute-force-or-you-can-create-a-new-column-called-avg_age-while-using-summarize.-avg_age-should-be-the-average-age-for-each-group-using-the-variable-d_age.-you-can-use-this-new-column-avg_age-to-re-order-the-data.-1" class="section level5">
<h5>(OPTIONAL I, 0 points) To make the plot have a more aesthetic look, consider reordering the data by percentage of smokers, or even by the <code>generation</code>'s age. You can do that before passing the data using the <code>arrange</code> function, or inside the <code>geom_point</code> function, using the <code>reorder</code> function. To re-order by <code>generation</code>, you can either use brute force, or you can create a new column called <code>avg_age</code> while using <code>summarize</code>. <code>avg_age</code> should be the average age for each group (using the variable <code>d_age</code>). You can use this new column, <code>avg_age</code> to re-order the data.</h5>
</div>
<div id="optional-ii-0-points-improve-our-plot-change-the-x-axis-to-be-displayed-as-a-percentage.-you-can-use-the-scales-package-and-the-function-scale_x_continuous-to-accomplish-this.-1" class="section level5">
<h5>(OPTIONAL II, 0 points) Improve our plot, change the x-axis to be displayed as a percentage. You can use the <code>scales</code> package and the function <code>scale_x_continuous</code> to accomplish this.</h5>
<p><strong>Hint:</strong> Use <code>geom_point</code> <strong>not</strong> <code>geom_dotplot</code> to solve this problem.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-geom_point">geom_point</a>, <a href="">ggthemr</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
The plot produced.
</li>
<li>
1-2 sentences commenting on the theory, and what are your conclusions based on your plot (if any).
</li>
</ul>
</div>
</div>
<div id="create-an-interesting-visualization-to-answer-a-question-you-have-regarding-this-dataset.-have-fun-playing-with-the-different-aesthetics.-make-sure-to-modify-your-x-axis-title-y-axis-title-and-title-of-your-plot." class="section level5">
<h5>6. Create an interesting visualization to answer a question you have regarding this dataset. Have fun playing with the different aesthetics. Make sure to modify your x-axis title, y-axis title, and title of your plot.</h5>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
The plot produced.
</li>
<li>
The question you are interested in answering.
</li>
<li>
1-2 sentences describing your plot, and the answer to your question.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="p12-390" class="section level3">
<h3>Project 12</h3>
<hr />
<p><strong>Motivation:</strong> As we mentioned before, data wrangling is a big part in any data driven project. <a href="https://www.amazon.com/Exploratory-Data-Mining-Cleaning/dp/0471268518">&quot;Data Scientists spend up to 80% of the time on data cleaning and 20 percent of their time on actual data analysis.&quot;</a> Therefore, it is worth to spend some time mastering how to best tidy up our data.</p>
<p><strong>Context:</strong> We are continuing to practice using various <code>tidyverse</code> packages, in order to wrangle data.</p>
<p><strong>Scope:</strong> python</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Explain the differences between regular data frames and tibbles.
</li>
<li>
Use mutate, pivot, unite, filter, and arrange to wrangle data and solve data-driven problems.
</li>
<li>
Combine different data using joins (left_join, right_join, semi_join, anti_join), and bind_rows.
</li>
<li>
Group data and calculate aggregated statistics using group_by, mutate, and transform functions.
</li>
<li>
Demonstrate the ability to create basic graphs with default settings, in <code>ggplot</code>.
</li>
<li>
Demonstrate the ability to modify axes labels and titles.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<p>The first step in any data science project is to define our problem statement. In this project, our goal is to gain insights into customers' behaviours with regards to online orders and restaurant ratings.</p>
<div id="dataset-27" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/restaurant_recommendation/*.csv</code></p>
</div>
<div id="questions-34" class="section level4">
<h4>Questions</h4>
<div id="load-the-tidyverse-suite-a-packages-and-read-the-data-from-files-orders.csv-train_customers.csv-and-vendors.csv-into-tibbles-named-orders-customers-and-vendors-respectively.-1" class="section level5">
<h5>1. Load the <code>tidyverse</code> suite a packages, and read the data from files <code>orders.csv</code>, <code>train_customers.csv</code>, and <code>vendors.csv</code> into <code>tibble</code>s named <code>orders</code>, <code>customers</code>, and <code>vendors</code> respectively.</h5>
</div>
<div id="take-a-look-the-tibbles-and-describe-in-a-few-sentences-the-type-of-information-contained-in-each-dataset.-although-the-name-can-be-self-explanatory-it-is-important-to-get-an-idea-of-what-exactly-we-are-looking-at.-for-each-combination-of-2-datasets-which-column-would-you-use-to-join-them-1" class="section level5">
<h5>Take a look the <code>tibble</code>s and describe in a few sentences the type of information contained in each dataset. Although the name can be self-explanatory, it is important to get an idea of what exactly we are looking at. For each combination of 2 datasets, which column would you use to join them?</h5>
<p><strong>Relevant topics:</strong> <a href="https://www.rdocumentation.org/packages/qtl2/versions/0.24/topics/read_csv">read_csv</a>, <a href="r.html#r-str">str</a>, <a href="https://www.rdocumentation.org/packages/dplyr/versions/0.3/topics/glimpse">glimpse</a>, <a href="r.html#r-head">head</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
1-2 sentences explaining each dataset (<code>orders</code>, <code>customers</code>, and <code>vendors</code>).
</li>
<li>
1-2 sentences for each combination of 2 datasets describing if we could combine the datasets or not, and which column you would you use to join them.
</li>
</ul>
</div>
</div>
<div id="lets-tidy-up-our-datasets-a-bit-prior-to-joining-them.-for-each-dataset-complete-the-tasks-below.-1" class="section level5">
<h5>2. Let's tidy up our datasets a bit prior to joining them. For each dataset, complete the tasks below.</h5>
<ul>
<li><code>orders</code>: remove all columns that have <code>NA</code> for every single row.</li>
<li><code>customers</code>: Take a look at the column <code>dob</code>. Based on its values, what do you believe was it supposed to contain? Can we rely on the numbers selected? Why or why not? Based on your answer, keep the columns <code>akeed_customer_id</code>, <code>gender</code>, and <code>dob</code> or just <code>akeed_customer_id</code> and <code>gender</code>.</li>
<li><code>vendors</code>: Take a look at columns <code>country_id</code> and <code>city_id</code>. Would they be useful to compare the vendors in our dataset? Why or why not? If not, remove the columns from the dataset.</li>
</ul>
<p><strong>Hint:</strong> There are a variety of ways to do this. To get a better feel for how powerful <code>tidyverse</code> can be, we recommend you try solving it using the <code>select_if</code> function without creating any additional functions.</p>
<p><strong>Hint:</strong> Do not use <code>drop_na</code> function from <code>dplyr</code>. This drops rows not columns.</p>
<p><strong>Relevant topics:</strong> <a href="">select_if</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
1-2 sentences describing what columns you kept for <code>vendors</code> and <code>customers</code> and why.
</li>
</ul>
</div>
</div>
<div id="use-your-solutions-from-questions-1-and-2-and-the-join-functions-from-tidyverse-inner_join-left_join-right_join-and-full_join-to-create-a-single-tibble-called-mydf-containing-information-only-where-all-3-tibbles-intersect.-1" class="section level5">
<h5>3. Use your solutions from questions (1) and (2), and the join functions from tidyverse (<code>inner_join</code>, <code>left_join</code>, <code>right_join</code>, and <code>full_join</code>) to create a single <code>tibble</code> called <code>myDF</code> containing information only where all 3 <code>tibble</code>s intersect.</h5>
</div>
<div id="for-example-we-do-not-want-mydf-to-contain-orders-from-customers-that-are-not-in-customers-tibble.-which-functions-from-the-tidyverse-did-you-use-to-merge-the-datasets-and-why-1" class="section level5">
<h5>For example, we do not want <code>myDF</code> to contain orders from customers that are not in <code>customers</code> tibble. Which function(s) from the tidyverse did you use to merge the datasets and why?</h5>
<p><strong>Hint:</strong> <code>myDF</code> should have 132,226 rows.</p>
<p><strong>Hint:</strong> When combining two datasets, you may want to change the argument <code>suffix</code> in the join function to specify from which dataset it came from. For example, when joining <code>customers</code> and <code>orders</code>: <code>*_join(customers, orders, suffix = c('_customers', '_orders'))</code>.</p>
<p><strong>Relevant topics:</strong> <a href="">inner_join</a>, <a href="">left_join</a>, <a href="">right_join</a>, <a href="">full_join</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
1-2 sentences describing which function you used, and why.
</li>
</ul>
</div>
</div>
<div id="great-now-we-have-a-single-tidy-dataset-to-work-with.-there-are-2-vendor-categories-in-mydf-restaurants-and-sweets-bakes.-we-would-expect-there-to-be-some-differences.-lets-compare-them-using-the-following-variables-deliverydistance-item_count-grand_total-and-vendor_discount_amount.-our-end-goal-by-the-end-of-question-5-is-to-create-a-histogram-colored-by-the-vendors-category-vendor_category_en-for-each-variable.-1" class="section level5">
<h5>4. Great, now we have a single, tidy dataset to work with. There are 2 vendor categories in myDF, <code>Restaurants</code> and <code>Sweets &amp; Bakes</code>. We would expect there to be some differences. Let's compare them using the following variables: <code>deliverydistance</code>, <code>item_count</code>, <code>grand_total</code>, and <code>vendor_discount_amount</code>. Our end goal (by the end of question 5) is to create a histogram colored by the vendor's category (<code>vendor_category_en</code>), for each variable.</h5>
</div>
<div id="to-accomplish-this-easily-using-ggplot-we-will-take-advantage-of-pivot_longer.-pivot-columns-deliverydistance-item_count-grand_total-and-vendor_discount_amount-in-mydf.-the-end-result-should-be-a-tibble-with-columns-variable-and-values-which-contain-the-name-of-the-pivoted-column-variable-and-values-of-those-columns-values-call-this-modified-dataset-mydf_long.-1" class="section level5">
<h5>To accomplish this easily using <code>ggplot</code>, we will take advantage of <code>pivot_longer</code>. Pivot columns <code>deliverydistance</code>, <code>item_count</code>, <code>grand_total</code>, and <code>vendor_discount_amount</code> in <code>myDF</code>. The end result should be a <code>tibble</code> with columns <code>variable</code> and <code>values</code>, which contain the name of the pivoted column (<code>variable</code>), and values of those columns (<code>values</code>) Call this modified dataset <code>myDF_long</code>.</h5>
<p><strong>Relevant topics:</strong> <a href="#r-pivot_longer">pivot_longer</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
</ul>
</div>
</div>
<div id="now-that-we-have-the-data-in-the-ideal-format-for-our-plot-create-a-histogram-for-each-variable.-make-sure-to-color-them-by-vendor-category-vendor_category_en.-how-do-the-two-types-of-vendors-compare-in-these-4-variables-1" class="section level5">
<h5>5. Now that we have the data in the ideal format for our plot, create a histogram for each variable. Make sure to color them by vendor category (<code>vendor_category_en</code>). How do the two types of vendors compare in these 4 variables?</h5>
<p><strong>Hint:</strong> Use the argument <code>fill</code> instead of <code>color</code> in <code>geom_histogram</code>.</p>
<p><strong>Hint:</strong> You may want to add some transparency to your plot. Add it using <code>alpha</code> argument in <code>geom_histogram</code>.</p>
<p><strong>Hint:</strong> You may want to change the argument <code>scales</code> in <code>facet_*</code>.</p>
<p><strong>Relevant topics:</strong> <a href="">geom_histogram</a>, <a href="r.html#r-facet_wrap">facet_wrap</a>, <a href="r.html#r-facet_grid">facet_grid</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your code.
</li>
<li>
2-3 sentences comparing <code>Restaurants</code> and <code>Sweets &amp; Bakes</code> for <code>deliverydistance</code>, <code>item_count</code>, <code>grand_total</code> and <code>vendor_discount_amount</code>.
</li>
</ul>
</div>
<hr />

</div>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="faqs.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="fall2020-projects.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/kevinamstutz/the-examples-book/edit/master/09-projects.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["the-datamine-examples.pdf", "the-datamine-examples.epub"],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
