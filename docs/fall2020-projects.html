<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Fall 2020 projects | The Examples Book</title>
  <meta name="description" content="A book of supplemental examples for The Data Mine at Purdue University." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Fall 2020 projects | The Examples Book" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A book of supplemental examples for The Data Mine at Purdue University." />
  <meta name="github-repo" content="kevinamstutz/the-examples-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Fall 2020 projects | The Examples Book" />
  
  <meta name="twitter:description" content="A book of supplemental examples for The Data Mine at Purdue University." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="images/touch-icon.png" />
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="projects.html"/>
<link rel="next" href="contributors.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="book.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The Data Mine</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contribute"><i class="fa fa-check"></i>How to contribute</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#small-changes-and-additions"><i class="fa fa-check"></i>Small changes and additions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#larger-changes-or-additions"><i class="fa fa-check"></i>Larger changes or additions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="scholar.html"><a href="scholar.html"><i class="fa fa-check"></i>Scholar</a><ul>
<li class="chapter" data-level="" data-path="scholar.html"><a href="scholar.html#connecting-to-scholar"><i class="fa fa-check"></i>Connecting to Scholar</a><ul>
<li class="chapter" data-level="" data-path="scholar.html"><a href="scholar.html#rstudio-server-pro"><i class="fa fa-check"></i>RStudio Server Pro</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scholar.html"><a href="scholar.html#other-ways-to-connect"><i class="fa fa-check"></i>Other ways to connect</a><ul>
<li class="chapter" data-level="" data-path="scholar.html"><a href="scholar.html#connecting-with-thinlinc-webclient"><i class="fa fa-check"></i>ThinLinc web client</a></li>
<li class="chapter" data-level="" data-path="scholar.html"><a href="scholar.html#connecting-with-thinlinc-client"><i class="fa fa-check"></i>ThinLinc client</a></li>
<li class="chapter" data-level="" data-path="scholar.html"><a href="scholar.html#connecting-with-ssh"><i class="fa fa-check"></i>SSH</a></li>
<li class="chapter" data-level="" data-path="scholar.html"><a href="scholar.html#jupyterhub"><i class="fa fa-check"></i>JupyterHub</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scholar.html"><a href="scholar.html#scholar-resources"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-formats.html"><a href="data-formats.html"><i class="fa fa-check"></i>Data Formats</a><ul>
<li class="chapter" data-level="" data-path="data-formats.html"><a href="data-formats.html#html"><i class="fa fa-check"></i>HTML</a></li>
<li class="chapter" data-level="" data-path="data-formats.html"><a href="data-formats.html#xml"><i class="fa fa-check"></i>XML</a><ul>
<li class="chapter" data-level="" data-path="data-formats.html"><a href="data-formats.html#xml-xpath"><i class="fa fa-check"></i>XPath Expressions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html"><i class="fa fa-check"></i>Unix</a><ul>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#unix-getting-started"><i class="fa fa-check"></i>Getting started</a></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#unix-utilities"><i class="fa fa-check"></i>Standard utilities</a><ul>
<li><a href="unix.html#man"><code>man</code></a></li>
<li><a href="unix.html#cat"><code>cat</code></a></li>
<li><a href="unix.html#head"><code>head</code></a></li>
<li><a href="unix.html#tail"><code>tail</code></a></li>
<li><a href="unix.html#ls"><code>ls</code></a></li>
<li><a href="unix.html#du"><code>du</code></a></li>
<li><a href="unix.html#cp"><code>cp</code></a></li>
<li><a href="unix.html#mv"><code>mv</code></a></li>
<li><a href="unix.html#touch"><code>touch</code></a></li>
<li><a href="unix.html#mkdir"><code>mkdir</code></a></li>
<li><a href="unix.html#rm"><code>rm</code></a></li>
<li><a href="unix.html#rmdir"><code>rmdir</code></a></li>
<li><a href="unix.html#pwd"><code>pwd</code></a></li>
<li><a href="unix.html#type"><code>type</code></a></li>
<li><a href="unix.html#uniq"><code>uniq</code></a></li>
<li><a href="unix.html#wc"><code>wc</code></a></li>
<li><a href="unix.html#ssh"><code>ssh</code></a></li>
<li><a href="unix.html#scp"><code>scp</code></a></li>
<li><a href="unix.html#cut"><code>cut</code></a></li>
<li><a href="unix.html#sed"><code>sed</code></a></li>
<li><a href="unix.html#grep"><code>grep</code></a></li>
<li><a href="unix.html#find"><code>find</code></a></li>
<li><a href="unix.html#less"><code>less</code></a></li>
<li><a href="unix.html#sort"><code>sort</code></a></li>
<li><a href="unix.html#git-ref-01"><code>git</code></a></li>
</ul></li>
<li><a href="unix.html#awk"><code>awk</code></a><ul>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#unix-awk-built-in-variables"><i class="fa fa-check"></i>Built in variables</a></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#examples-5"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#dots"><i class="fa fa-check"></i>~ &amp; . &amp; ..</a><ul>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#examples-6"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#piping-and-redirection"><i class="fa fa-check"></i>Piping &amp; Redirection</a><ul>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#redirection"><i class="fa fa-check"></i>Redirection</a></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#piping"><i class="fa fa-check"></i>Piping</a></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#piping-and-redirection-resources"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#emacs"><i class="fa fa-check"></i>Emacs</a></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#nano"><i class="fa fa-check"></i>Nano</a></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#vim"><i class="fa fa-check"></i>Vim</a></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#unix-writing-scripts"><i class="fa fa-check"></i>Writing scripts</a><ul>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#unix-bash-arguments"><i class="fa fa-check"></i>Arguments</a></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#unix-bash-script-examples"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html"><i class="fa fa-check"></i>SQL</a><ul>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#sql-joins"><i class="fa fa-check"></i>Joins</a><ul>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#sql-inner-join"><i class="fa fa-check"></i>INNER JOIN</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#sql-left-join"><i class="fa fa-check"></i>LEFT OUTER JOIN</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#aliasing"><i class="fa fa-check"></i>Aliasing</a><ul>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#sql-rdbms"><i class="fa fa-check"></i>RDBMS</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#sql-in-r"><i class="fa fa-check"></i>SQL in R</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#sql-in-python"><i class="fa fa-check"></i>SQL in Python</a></li>
<li class="chapter" data-level="" data-path="sql.html"><a href="sql.html#sql-examples"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html"><i class="fa fa-check"></i>R</a><ul>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#getting-started-with-r"><i class="fa fa-check"></i>Getting started</a><ul>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-8451-intro"><i class="fa fa-check"></i>Examples using the 84.51 data set.</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-nyc-taxi-intro"><i class="fa fa-check"></i>Examples using the New York City yellow taxi cab data set.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-variables"><i class="fa fa-check"></i>Variables</a><ul>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-na"><i class="fa fa-check"></i>NA</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-nan"><i class="fa fa-check"></i>NaN</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-null"><i class="fa fa-check"></i>NULL</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-dates"><i class="fa fa-check"></i>Dates</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-factors"><i class="fa fa-check"></i>Factors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-logical-operators"><i class="fa fa-check"></i>Logical operators</a><ul>
<li class="chapter" data-level="" data-path="data-formats.html"><a href="data-formats.html#examples"><i class="fa fa-check"></i>Examples</a></li>
<li class="chapter" data-level="" data-path="data-formats.html"><a href="data-formats.html#resources"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-lists-and-vectors"><i class="fa fa-check"></i>Lists &amp; Vectors</a><ul>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-indexing"><i class="fa fa-check"></i>Indexing</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-recycling"><i class="fa fa-check"></i>Recycling</a></li>
<li class="chapter" data-level="" data-path="unix.html"><a href="unix.html#examples-2"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-basic-functions"><i class="fa fa-check"></i>Basic R functions</a><ul>
<li><a href="r.html#r-all"><code>all</code></a></li>
<li><a href="r.html#r-any"><code>any</code></a></li>
<li><a href="r.html#r-all.equal"><code>all.equal</code></a></li>
<li><a href="r.html#r-in"><code>%in%</code></a></li>
<li><a href="r.html#r-setdiff"><code>setdiff</code></a></li>
<li><a href="r.html#r-intersect"><code>intersect</code></a></li>
<li><a href="r.html#r-dim"><code>dim</code></a></li>
<li><a href="r.html#r-length"><code>length</code></a></li>
<li><a href="r.html#r-rep"><code>rep</code></a></li>
<li><a href="r.html#r-bind"><code>rbind</code> and <code>cbind</code></a></li>
<li><a href="r.html#r-which"><code>which</code>, <code>which.max</code>, <code>which.min</code></a></li>
<li><a href="r.html#r-grep"><code>grep</code>, <code>grepl</code>, etc.</a></li>
<li><a href="r.html#r-sum"><code>sum</code></a></li>
<li><a href="r.html#r-mean"><code>mean</code></a></li>
<li><a href="r.html#r-var"><code>var</code></a></li>
<li><a href="r.html#r-sums"><code>colSums</code> and <code>rowSums</code></a></li>
<li><a href="r.html#r-means"><code>colMeans</code> and <code>rowMeans</code></a></li>
<li><a href="r.html#r-unique"><code>unique</code></a></li>
<li><a href="r.html#r-summary"><code>summary</code></a></li>
<li><a href="r.html#r-order"><code>order</code> and <code>sort</code></a></li>
<li><a href="r.html#r-paste"><code>paste</code> and <code>paste0</code></a></li>
<li><a href="r.html#r-head"><code>head</code> and <code>tail</code></a></li>
<li><a href="r.html#r-str"><code>str</code></a></li>
<li><a href="r.html#r-strsplit"><code>strsplit</code></a></li>
<li><a href="r.html#r-names"><code>names</code></a></li>
<li><a href="r.html#r-colnames-and-rownames"><code>colnames</code> &amp; <code>rownames</code></a></li>
<li><a href="r.html#r-table"><code>table</code> &amp; <code>prop.table</code></a></li>
<li><a href="r.html#r-cut"><code>cut</code></a></li>
<li><a href="r.html#r-subset"><code>subset</code></a></li>
<li><a href="r.html#difftime-r-difftime"><code>difftime</code> {r#-difftime}</a></li>
<li><a href="r.html#r-merge"><code>merge</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-data-frames"><i class="fa fa-check"></i>Data.frames</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-reading-and-writing-data"><i class="fa fa-check"></i>Reading &amp; Writing data</a><ul>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#examples-29"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-control-flow"><i class="fa fa-check"></i>Control flow</a><ul>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-if-else"><i class="fa fa-check"></i>If/else statements</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-for-loops"><i class="fa fa-check"></i>For loops</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-apply-functions"><i class="fa fa-check"></i>Apply functions</a><ul>
<li><a href="r.html#r-apply"><code>apply</code></a></li>
<li><a href="r.html#r-lapply"><code>lapply</code></a></li>
<li><a href="r.html#r-sapply"><code>sapply</code></a></li>
<li><a href="r.html#r-tapply"><code>tapply</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-writing-functions"><i class="fa fa-check"></i>Writing functions</a><ul>
<li><a href="r.html#r-ellipsis"><code>...</code></a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#examples-34"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-plotting"><i class="fa fa-check"></i>Plotting</a><ul>
<li><a href="r.html#r-barplot"><code>barplot</code></a></li>
<li><a href="r.html#r-boxplot"><code>boxplot</code></a></li>
<li><a href="r.html#r-pie"><code>pie</code></a></li>
<li><a href="r.html#r-dotchart"><code>dotchart</code></a></li>
<li><a href="r.html#r-plot"><code>plot</code></a></li>
<li><a href="r.html#r-lines"><code>lines</code></a></li>
<li><a href="r.html#r-points"><code>points</code></a></li>
<li><a href="r.html#r-abline"><code>abline</code></a></li>
<li><a href="r.html#r-text"><code>text</code></a></li>
<li><a href="r.html#r-mtext"><code>mtext</code></a></li>
<li><a href="r.html#r-legend"><code>legend</code></a></li>
<li><a href="r.html#r-par"><code>par</code></a></li>
<li><a href="r.html#r-plot_usmap"><code>plot_usmap</code></a></li>
<li><a href="r.html#r-ggplot"><code>ggplot</code></a></li>
<li><a href="r.html#r-ggmap"><code>ggmap</code></a></li>
<li><a href="r.html#r-leaflet"><code>leaflet</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-rmarkdown"><i class="fa fa-check"></i>RMarkdown</a><ul>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#code-chunks"><i class="fa fa-check"></i>Code chunks</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-markdown-resources"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-tidyverse"><i class="fa fa-check"></i>Tidyverse</a><ul>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-piping"><i class="fa fa-check"></i>piping</a></li>
<li><a href="r.html#r-glimpse"><code>glimpse</code></a></li>
<li><a href="r.html#r-filter"><code>filter</code></a></li>
<li><a href="r.html#r-arrange"><code>arrange</code></a></li>
<li><a href="r.html#r-mutate"><code>mutate</code></a></li>
<li><a href="r.html#r-group-by"><code>group_by</code></a></li>
<li><a href="r.html#r-str-extract"><code>str_extract</code> and <code>str_extract_all</code></a></li>
<li><a href="r.html#r-lubridate"><code>lubridate</code></a></li>
<li><a href="r.html#r-strrep"><code>strrep</code></a></li>
<li><a href="r.html#r-nchar"><code>nchar</code></a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-lubridate-resources"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-datatable"><i class="fa fa-check"></i>data.table</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-sql"><i class="fa fa-check"></i>SQL in R</a></li>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-scraping"><i class="fa fa-check"></i>Scraping</a></li>
<li><a href="r.html#r-shiny"><code>shiny</code></a><ul>
<li class="chapter" data-level="" data-path="r.html"><a href="r.html#r-shiny-render-images"><i class="fa fa-check"></i>Rendering images</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html"><i class="fa fa-check"></i>Python</a><ul>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#getting-started-with-python"><i class="fa fa-check"></i>Getting started</a><ul>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#python-on-scholar"><i class="fa fa-check"></i>Python on Scholar</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-variables"><i class="fa fa-check"></i>Variables</a><ul>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-none"><i class="fa fa-check"></i>None</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-bool"><i class="fa fa-check"></i>bool</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-str"><i class="fa fa-check"></i>str</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-int"><i class="fa fa-check"></i>int</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-float"><i class="fa fa-check"></i>float</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-complex"><i class="fa fa-check"></i>complex</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-printing"><i class="fa fa-check"></i>Printing</a><ul>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-f-strings"><i class="fa fa-check"></i>f-strings</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-logical-operators"><i class="fa fa-check"></i>Logical operators</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-lists-and-tuples"><i class="fa fa-check"></i>Lists &amp; Tuples</a><ul>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-indexing"><i class="fa fa-check"></i>Indexing</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-list-methods"><i class="fa fa-check"></i>List methods</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#tuple-methods"><i class="fa fa-check"></i>Tuple methods</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-dicts"><i class="fa fa-check"></i>Dicts</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-sets"><i class="fa fa-check"></i>Sets</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-control-flow"><i class="fa fa-check"></i>Control flow</a><ul>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-if-else"><i class="fa fa-check"></i>If/else statements</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-for-loops"><i class="fa fa-check"></i>For loops</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-list-comprehensions"><i class="fa fa-check"></i>List comprehensions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-writing-functions"><i class="fa fa-check"></i>Writing functions</a><ul>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#packing-and-unpacking"><i class="fa fa-check"></i>packing and unpacking</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#arguments"><i class="fa fa-check"></i>arguments</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#docstrings"><i class="fa fa-check"></i>docstrings</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#annotations"><i class="fa fa-check"></i>annotations</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#decorators"><i class="fa fa-check"></i>decorators</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-reading-and-writing-data"><i class="fa fa-check"></i>Reading &amp; Writing data</a><ul>
<li><a href="python.html#read_csv"><code>read_csv</code></a></li>
<li><a href="python.html#p-csv-pkg"><code>csv</code></a></li>
</ul></li>
<li><a href="python.html#p-pathlib"><code>pathlib</code></a><ul>
<li><a href="python.html#p-pathlib-path"><code>Path</code></a></li>
</ul></li>
<li><a href="python.html#p-numpy"><code>numpy</code></a></li>
<li><a href="python.html#p-scipy"><code>scipy</code></a></li>
<li><a href="python.html#p-pandas"><code>pandas</code></a><ul>
<li><a href="python.html#p-pandas-read_csv"><code>read_csv</code></a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-pandas-dataframe"><i class="fa fa-check"></i>DataFrame</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-pandas-series"><i class="fa fa-check"></i>Series</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-jupyter-notebooks"><i class="fa fa-check"></i>Jupyter notebooks</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-writing-scripts"><i class="fa fa-check"></i>Writing scripts</a><ul>
<li><a href="python.html#p-argparse"><code>argparse</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-scraping"><i class="fa fa-check"></i>Scraping</a><ul>
<li><a href="python.html#requests"><code>requests</code></a></li>
<li><a href="python.html#lxml"><code>lxml</code></a></li>
<li><a href="python.html#selenium"><code>selenium</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-xml"><i class="fa fa-check"></i>XML</a><ul>
<li><a href="python.html#p-lxml"><code>lxml</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-plotting"><i class="fa fa-check"></i>Plotting</a><ul>
<li><a href="python.html#p-matplotlib"><code>matplotlib</code></a></li>
<li><a href="python.html#p-plotly"><code>plotly</code></a></li>
<li><a href="python.html#p-plotnine"><code>plotnine</code></a></li>
<li><a href="python.html#p-pygal"><code>pygal</code></a></li>
<li><a href="python.html#p-seaborn"><code>seaborn</code></a></li>
<li><a href="python.html#p-bokeh"><code>bokeh</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#p-classes"><i class="fa fa-check"></i>Classes</a><ul>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#attributes"><i class="fa fa-check"></i>Attributes</a></li>
<li class="chapter" data-level="" data-path="python.html"><a href="python.html#methods"><i class="fa fa-check"></i>Methods</a></li>
</ul></li>
<li><a href="python.html#tensorflow"><code>tensorflow</code></a></li>
<li><a href="python.html#pytorch"><code>pytorch</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html"><i class="fa fa-check"></i>Tools</a><ul>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#docker"><i class="fa fa-check"></i>Docker</a></li>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#tableau"><i class="fa fa-check"></i>Tableau</a></li>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#github"><i class="fa fa-check"></i>GitHub</a><ul>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#github-overview"><i class="fa fa-check"></i>Overview</a></li>
<li><a href="tools.html#git"><code>git</code></a></li>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#github-desktop"><i class="fa fa-check"></i>GitHub Desktop</a></li>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#git-resources"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tools.html"><a href="tools.html#vpns"><i class="fa fa-check"></i>VPNs</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html"><i class="fa fa-check"></i>FAQs</a><ul>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-no-such-file-or-directory"><i class="fa fa-check"></i>Cannot open the connection. No such file or directory.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-how-do-i-connect-to-scholar-off-campus"><i class="fa fa-check"></i>How do I connect to Scholar from off-campus?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-cursor-offset"><i class="fa fa-check"></i>In Scholar, on RStudio, my font size looks weird or my cursor is offset.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-unable-to-type-terminal"><i class="fa fa-check"></i>I'm unable to type into the terminal in RStudio.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-unable-to-connect-to-rstudio-server"><i class="fa fa-check"></i>I'm unable to connect to RStudio Server.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-rstudio-long-time-to-open"><i class="fa fa-check"></i>RStudio is taking a long time to open.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-deleting-file-in-RStudio"><i class="fa fa-check"></i>How do I delete a file from my RStudio directory? (asked by Karthik Uppuluri)</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-how-do-i-rename-file-rstudio"><i class="fa fa-check"></i>How do I rename a file from my RStudio directory?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-running-R-code"><i class="fa fa-check"></i>How can you run a line of R code in RStudio without clicking the &quot;Run&quot; button?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-r-session-freezes"><i class="fa fa-check"></i>My R session freezes.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-scholar-is-slow"><i class="fa fa-check"></i>Scholar is slow.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-how-to-transfer-files"><i class="fa fa-check"></i>How to transfer files between your computer and Scholar.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#password-wont-work"><i class="fa fa-check"></i>My password will not work.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-jupyter-notebook-download-error-ie"><i class="fa fa-check"></i>Jupyter Notebook download error with IE.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-jupyter-notebook-kernel-dying"><i class="fa fa-check"></i>Jupyter Notebook kernel dying.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-kernel-jupyter-wont-save"><i class="fa fa-check"></i>Python kernel not working, Jupyter Notebook won't save.</a></li>
<li><a href="faqs.html#faq-installing-python-package">Installing <code>my_package</code> for Python.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-displaying-multiple-images-jupyter"><i class="fa fa-check"></i>Displaying multiple images after a single Jupyter Notebook Python code cell.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-error-has-null-value"><i class="fa fa-check"></i>RMarkdown “Error: option error has NULL value” when knitting&quot;.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-creating-rmarkdown-file"><i class="fa fa-check"></i>How do you create an RMarkdown file?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-problems-building-rmarkdown-scholar"><i class="fa fa-check"></i>Problems building an RMarkdown document on Scholar.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-how-to-use-sql-in-rmarkdown"><i class="fa fa-check"></i>How can I use SQL in RMarkdown?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-copy-paste-from-terminal-inside-rstudio"><i class="fa fa-check"></i>Copy/paste from terminal (not a console) inside RStudio to RMarkdown.</a></li>
<li><a href="faqs.html#faq-how-to-render-image-in-shiny-app">How do I render an image in a <code>shiny</code> app?</a></li>
<li><a href="faqs.html#faq-package-not-found">The package <code>my_package</code> is not found.</a></li>
<li><a href="faqs.html#faq-problems-installing-ggmap">Problems installing <code>ggmap</code>.</a></li>
<li><a href="faqs.html#faq-object-name-not-found">Error: <code>object_name</code> is not found.</a></li>
<li><a href="faqs.html#faq-zoom-in-ggmap">Zoom in on <code>ggmap</code>.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-find-lat-long-of-loc"><i class="fa fa-check"></i>Find the latitude and longitude of a location.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-save-work-pdf-scholar"><i class="fa fa-check"></i>Problems saving work as a PDF in R on Scholar.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-resources-for-html"><i class="fa fa-check"></i>What is a good resource to better understand HTML?</a></li>
<li><a href="faqs.html#faq-style-guide-r">Is there a style guide for <code>R</code> code?</a></li>
<li><a href="faqs.html#faq-best-practices-r">Is there a guide for best practices using <code>R</code>?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-tips-for-jupyter"><i class="fa fa-check"></i>Tips for using Jupyter notebooks.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-what-is-my-username"><i class="fa fa-check"></i>What is my username on Scholar?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-escape-characters"><i class="fa fa-check"></i>How and why would I need to &quot;escape a character&quot;?</a><ul>
<li class="chapter" data-level="" data-path="data-formats.html"><a href="data-formats.html#resources"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
<li><a href="faqs.html#faq-fix-illegal-byte-sequence">How can I fix the error &quot;Illegal byte sequence&quot; when using a UNIX utility like <code>cut</code>?</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#faq-rmarkdown-unicode-error"><i class="fa fa-check"></i>Unicode character error when Knitting an RMarkdown file to PDF.</a></li>
<li class="chapter" data-level="" data-path="faqs.html"><a href="faqs.html#my-tab-key-will-not-auto-complete-anymore-in-rstudio.-how-can-i-fix-this"><i class="fa fa-check"></i>My tab key will not auto-complete anymore in RStudio. How can I fix this?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html"><i class="fa fa-check"></i>Projects</a><ul>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#templates"><i class="fa fa-check"></i>Templates</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#submissions"><i class="fa fa-check"></i>Submissions</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#stat-19000"><i class="fa fa-check"></i>STAT 19000</a><ul>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#topics"><i class="fa fa-check"></i>Topics</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p01-190"><i class="fa fa-check"></i>Project 1</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p02-190"><i class="fa fa-check"></i>Project 2</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p03-190"><i class="fa fa-check"></i>Project 3</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p04-190"><i class="fa fa-check"></i>Project 4</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p05-190"><i class="fa fa-check"></i>Project 5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#stat-29000"><i class="fa fa-check"></i>STAT 29000</a><ul>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#topics-1"><i class="fa fa-check"></i>Topics</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p01-290"><i class="fa fa-check"></i>Project 1</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p02-290"><i class="fa fa-check"></i>Project 2</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p03-290"><i class="fa fa-check"></i>Project 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#stat-39000"><i class="fa fa-check"></i>STAT 39000</a><ul>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#topics-2"><i class="fa fa-check"></i>Topics</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p01-390"><i class="fa fa-check"></i>Project 1</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p02-390"><i class="fa fa-check"></i>Project 2</a></li>
<li class="chapter" data-level="" data-path="projects.html"><a href="projects.html#p03-390"><i class="fa fa-check"></i>Project 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html"><i class="fa fa-check"></i>Fall 2020 projects</a><ul>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-stat-19000"><i class="fa fa-check"></i>STAT 19000</a><ul>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p01-190"><i class="fa fa-check"></i>Project 1</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p02-190"><i class="fa fa-check"></i>Project 2</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p03-190"><i class="fa fa-check"></i>Project 3</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p04-190"><i class="fa fa-check"></i>Project 4</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p05-190"><i class="fa fa-check"></i>Project 5</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p06-190"><i class="fa fa-check"></i>Project 6</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p07-190"><i class="fa fa-check"></i>Project 7</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p08-190"><i class="fa fa-check"></i>Project 8</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p09-190"><i class="fa fa-check"></i>Project 9</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p10-190"><i class="fa fa-check"></i>Project 10</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p11-190"><i class="fa fa-check"></i>Project 11</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p12-190"><i class="fa fa-check"></i>Project 12</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p13-190"><i class="fa fa-check"></i>Project 13</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p14-190"><i class="fa fa-check"></i>Project 14</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p15-190"><i class="fa fa-check"></i>Project 15</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-stat-29000"><i class="fa fa-check"></i>STAT 29000</a><ul>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p01-290"><i class="fa fa-check"></i>Project 1</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p02-290"><i class="fa fa-check"></i>Project 2</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p03-290"><i class="fa fa-check"></i>Project 3</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p04-290"><i class="fa fa-check"></i>Project 4</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p05-290"><i class="fa fa-check"></i>Project 5</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p06-290"><i class="fa fa-check"></i>Project 6</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p07-290"><i class="fa fa-check"></i>Project 7</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p08-290"><i class="fa fa-check"></i>Project 8</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p09-290"><i class="fa fa-check"></i>Project 9</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p10-290"><i class="fa fa-check"></i>Project 10</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p11-290"><i class="fa fa-check"></i>Project 11</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p12-290"><i class="fa fa-check"></i>Project 12</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p13-290"><i class="fa fa-check"></i>Project 13</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p14-290"><i class="fa fa-check"></i>Project 14</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p15-290"><i class="fa fa-check"></i>Project 15</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-stat-39000"><i class="fa fa-check"></i>STAT 39000</a><ul>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p01-390"><i class="fa fa-check"></i>Project 1</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p02-390"><i class="fa fa-check"></i>Project 2</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p03-390"><i class="fa fa-check"></i>Project 3</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p04-390"><i class="fa fa-check"></i>Project 4</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p05-390"><i class="fa fa-check"></i>Project 5</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p06-390"><i class="fa fa-check"></i>Project 6</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p07-390"><i class="fa fa-check"></i>Project 7</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p08-390"><i class="fa fa-check"></i>Project 8</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p09-390"><i class="fa fa-check"></i>Project 9</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p10-390"><i class="fa fa-check"></i>Project 10</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p11-390"><i class="fa fa-check"></i>Project 11</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p12-390"><i class="fa fa-check"></i>Project 12</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p13-390"><i class="fa fa-check"></i>Project 13</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p14-390"><i class="fa fa-check"></i>Project 14</a></li>
<li class="chapter" data-level="" data-path="fall2020-projects.html"><a href="fall2020-projects.html#fall2020-p15-390"><i class="fa fa-check"></i>Project 15</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="contributors.html"><a href="contributors.html"><i class="fa fa-check"></i>Contributors</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Examples Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fall2020-projects" class="section level1">
<h1>Fall 2020 projects</h1>
<div id="fall2020-stat-19000" class="section level2">
<h2>STAT 19000</h2>
<div id="fall2020-p01-190" class="section level3">
<h3>Project 1</h3>
<hr />
<p><strong>Motivation:</strong> In this project we are going to jump head first into The Data Mine. We will load datasets into the R environment, and introduce some core programming concepts like variables, vectors, types, etc. As we will be &quot;living&quot; primarily in an IDE called RStudio, we will take some time to learn how to connect to it, configure it, and run code.</p>
<p><strong>Context:</strong> This is our first project as a part of The Data Mine. We will get situated, configure the environment we will be using throughout our time with The Data Mine, and jump straight into working with data!</p>
<p><strong>Scope:</strong> r, rstudio, Scholar</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Utilize other Scholar resources: rstudio.scholar.rcac.purdue.edu, notebook.scholar.rcac.purdue.edu, desktop.scholar.rcac.purdue.edu, etc.
</li>
<li>
Install R and setting up a working environment.
</li>
<li>
Explain and demonstrate: positional, named, and logical indexing.
</li>
<li>
Read and write basic (csv) data.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<div id="dataset" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/disney/splash_mountain.csv</code></p>
</div>
<div id="questions" class="section level4">
<h4>Questions</h4>
<div id="read-the-webpage-here.-scholar-is-the-computing-cluster-you-will-be-using-throughout-the-semester-and-your-time-with-the-data-mine.-each-node-is-an-individual-machine-with-cpus-and-memory-ram.-how-many-cores-and-how-much-memory-is-available-in-total-for-our-7-frontend-nodes-how-about-for-the-sub-clusters-how-much-is-available-on-your-computer-or-laptop" class="section level5">
<h5>1. Read the webpage <a href="https://www.rcac.purdue.edu/compute/scholar/">here</a>. Scholar is the computing cluster you will be using throughout the semester, and your time with The Data Mine. Each <em>node</em> is an individual machine with CPUs and memory (RAM). How many <em>cores</em> and how much <em>memory</em> is available, in total, for our 7 frontend nodes? How about for the sub-clusters? How much is available on your computer or laptop?</h5>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
A sentence explaining how much memory and how many cores the 7 frontends have combined.
</li>
<li>
A sentence explaining how much memory and how many cores the 28 sub-clusters have combined.
</li>
<li>
A sentence explaining how much memory and how many cores your personal computer has.
</li>
</ul>
</div>
</div>
<div id="solution" class="section level5">
<h5>Solution</h5>
<p>The memory on the 7 frontend nodes is: 4 * 512 + 3 * 768 = 4352 GB = 4.3 TB.</p>
<p>The memory on the 28 nodes in the sub-cluster is: 24 * 64 + 4 * 192 = 2304 GB = 2.3 TB.</p>
<p>The memory on Dr. Ward's laptop is 8 GB.</p>
<p>The number of cores on the 7 frontend nodes is: 4 * 20 + 3 * 20 = 140 cores.</p>
<p>The number of cores on the 28 nodes in the sub-cluster is: 24 * 20 + 4 * 16 = 544 cores.</p>
<p>The number of cores on Dr. Ward's laptop is 2.</p>
</div>
<div id="navigate-and-login-to-httpsrstudio.scholar.rcac.purdue.edu-using-your-purdue-career-account-credentials-and-boilerkey.-this-is-an-instance-of-rstudio-server-running-on-a-scholar-frontend-frontends-are-labeled.-so-for-example-scholar-fe01.rcac.purdue.edu-is-frontend-1.-create-a-new-r-file-file-new-file-r-script.-check-which-frontend-you-are-logged-in-on-by-running-the-following-in-the-new-file-systemhostname." class="section level5">
<h5>2. Navigate and login to <a href="https://rstudio.scholar.rcac.purdue.edu" class="uri">https://rstudio.scholar.rcac.purdue.edu</a> using your Purdue Career Account credentials (and Boilerkey). This is an instance of RStudio Server running on a Scholar frontend! Frontends are labeled. So, for example, <code>scholar-fe01.rcac.purdue.edu</code> is frontend <code>#1</code>. Create a new R file (File &gt; New File &gt; R Script). Check which frontend you are logged in on by running the following in the new file: <code>system(&quot;hostname&quot;)</code>.</h5>
</div>
<div id="press-control-and-enterreturn-keys-at-the-same-time-to-run-this-line.-which-frontend-are-you-in" class="section level5">
<h5>Press Control and Enter/Return keys at the same time, to run this line. Which frontend are you in?</h5>
<p><strong>Relevant topics:</strong> <a href="#running-R-code">running R code</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The <code>#</code> of the frontend your RStudio Server session is running on.
</li>
</ul>
</div>
</div>
<div id="solution-1" class="section level5">
<h5>Solution</h5>
<p>The node we are working on is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system</span>(<span class="st">&quot;hostname&quot;</span>, <span class="dt">intern=</span>T)</code></pre></div>
</div>
<div id="from-within-rstudio-we-can-run-every-type-of-code-that-you-will-need-to-run-throughout-your-time-with-the-data-mine-python-r-bash-sql-etc.-weve-created-a-one-time-setup-script-for-you-to-run-called" class="section level5">
<h5>3. From within RStudio, we can run every type of code that you will need to run throughout your time with The Data Mine: Python, R, Bash, SQL, etc. We've created a one-time setup script for you to run, called</h5>
<p><code>/class/datamine/apps/runme.sh</code> (as seen in the video at the top of this page).</p>
</div>
<div id="after-you-restart-r-as-in-the-video-after-4-minutes-and-16-seconds-there-should-be-a-message-that-is-printed-in-your-console-tab.-what-does-the-message-say" class="section level5">
<h5>After you restart R (as in the video, after 4 minutes and 16 seconds), there should be a message that is printed in your &quot;Console&quot; tab. What does the message say?</h5>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The sentence that is printed in the RStudio &quot;Console&quot;.
</li>
</ul>
</div>
</div>
<div id="solution-2" class="section level5">
<h5>Solution</h5>
<p>The welcome message is: <code>&quot;You've successfully loaded The Data Mine R settings!&quot;</code></p>
</div>
<div id="projects-in-the-data-mine-should-all-be-submitted-using-our-template-found-here-or-on-scholar-classdatamineappstemplatesproject_template.rmd.-at-the-beginning-of-every-project-the-first-step-should-be-downloading-andor-copying-and-pasting-the-template-into-a-.rmd-file-in-rstudio.-this-is-also-demonstrated-in-the-video-at-the-top-of-this-page." class="section level5">
<h5>4. Projects in The Data Mine should all be submitted using our template found <a href="https://raw.githubusercontent.com/TheDataMine/the-examples-book/master/files/project_template.Rmd">here</a> or on Scholar (<code>/class/datamine/apps/templates/project_template.Rmd</code>). At the beginning of every project, the first step should be downloading and/or copying and pasting the template into a <code>.Rmd</code> file in RStudio. This is also demonstrated in the video at the top of this page.</h5>
</div>
<div id="open-the-project-template-and-save-it-into-your-home-directory-in-a-new-rmarkdown-file-named-project01.rmd." class="section level5">
<h5>Open the project template and save it into your home directory, in a new RMarkdown file named <code>project01.Rmd</code>.</h5>
</div>
<div id="code-chunks-are-parts-of-the-rmarkdown-file-that-contains-code.-you-can-identify-what-type-of-code-a-code-chunk-contains-by-looking-at-the-engine-in-the-curly-braces-and-.-how-many-of-each-type-of-code-chunk-are-in-our-default-template" class="section level5">
<h5>Code chunks are parts of the RMarkdown file that contains code. You can identify what type of code a code chunk contains by looking at the <em>engine</em> in the curly braces &quot;{&quot; and &quot;}&quot;. How many of each type of code chunk are in our default template?</h5>
<p><strong>Hint:</strong> You can read about the template <a href="https://thedatamine.github.io/the-examples-book/projects.html#templates">here</a>.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
A list containing the type of code chunk (r, Python, sql, etc), and how many of each code chunks our default template contains.
</li>
</ul>
</div>
</div>
<div id="solution-3" class="section level5">
<h5>Solution</h5>
<p>There are 3 chunks of R code, 1 chunk of bash, 1 chunk of Python, 1 chunk of SQL</p>
</div>
<div id="fill-out-the-project-template-replacing-the-default-information-with-your-own.-if-a-category-is-not-applicable-to-you-put-na.-this-template-provides-examples-of-how-to-run-each-type-of-code-we-will-run-in-this-course.-look-for-the-second-r-code-chunk-and-run-it-by-clicking-the-tiny-green-play-button-in-the-upper-right-hand-corner-of-the-code-chunk.-what-is-the-output" class="section level5">
<h5>5. Fill out the project template, replacing the default information with your own. If a category is not applicable to you, put N/A. This template provides examples of how to run each &quot;type&quot; of code we will run in this course. Look for the second R code chunk, and run it by clicking the tiny green play button in the upper right hand corner of the code chunk. What is the output?</h5>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The output from running the R code chunk.
</li>
</ul>
</div>
</div>
<div id="solution-4" class="section level5">
<h5>Solution</h5>
<p>We store <code>1, 2, 3</code> into the variable my_variable, and then we display output: <code>1, 2, 3</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_variable &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)
my_variable</code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
</div>
<div id="in-question-1-we-answered-questions-about-cpus-and-ram-for-the-scholar-cluster.-to-do-so-we-needed-to-perform-some-arithmetic.-instead-of-using-a-calculator-or-paper-write-these-calculations-using-r.-replace-the-content-of-the-second-r-code-chunk-in-our-template-with-your-calculations." class="section level5">
<h5>6. In question (1) we answered questions about CPUs and RAM for the Scholar cluster. To do so, we needed to perform some arithmetic. Instead of using a calculator (or paper), write these calculations using R. Replace the content of the second R code chunk in our template with your calculations.</h5>
<p><strong>Relevant topics:</strong> <a href="projects.html#templates">templates</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The R code chunk with your calculations, and output.
</li>
</ul>
</div>
</div>
<div id="solution-5" class="section level5">
<h5>Solution</h5>
<p>We go back to question 1 and compute directly</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">512</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="dv">768</span></code></pre></div>
<pre><code>## [1] 4352</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">24</span> <span class="op">*</span><span class="st"> </span><span class="dv">64</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">192</span></code></pre></div>
<pre><code>## [1] 2304</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">20</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="dv">20</span></code></pre></div>
<pre><code>## [1] 140</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">24</span> <span class="op">*</span><span class="st"> </span><span class="dv">20</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">16</span></code></pre></div>
<pre><code>## [1] 544</code></pre>
</div>
<div id="in-6-we-got-to-see-how-you-can-type-out-arithmetic-and-r-will-calculate-the-result-for-you.-one-constant-throughout-the-semester-will-be-loading-datasets-into-r.-load-our-dataset-into-r-by-running-the-following-code" class="section level5">
<h5>7. In (6) we got to see how you can type out arithmetic and R will calculate the result for you. One constant throughout the semester will be loading datasets into R. Load our dataset into R by running the following code:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/disney/splash_mountain.csv&quot;</span>)</code></pre></div>
<p>Confirm the dataset has been read in by running the <code>head</code> function on it. <code>head</code> prints the first few rows of data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(dat)</code></pre></div>
<p><code>dat</code> is a variable which contains our data! We can name this variable anything we want, we do <em>not</em> have to name it <code>dat</code>. Run our code to read in our dataset, this time, instead of naming our resulting dataset <code>dat</code>, name it <code>splash_mountain</code>. Place all of your code into a new R code chunk under a new level 3 header (i.e. <code>### Question 7</code>).</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-reading-and-writing-data">reading data in R</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Code used to answer this question in a code chunk in our template.
</li>
<li>
Output of <code>head</code>.
</li>
</ul>
</div>
</div>
<div id="solution-6" class="section level5">
<h5>Solution</h5>
<p>We load in splash_mountain data and display the head</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">splash_mountain &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/disney/splash_mountain.csv&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(splash_mountain)</code></pre></div>
<pre><code>##         date            datetime SACTMIN SPOSTMIN
## 1 01/01/2015 2015-01-01 07:51:12      NA        5
## 2 01/01/2015 2015-01-01 08:02:13      NA        5
## 3 01/01/2015 2015-01-01 08:09:12      NA        5
## 4 01/01/2015 2015-01-01 08:16:12      NA        5
## 5 01/01/2015 2015-01-01 08:23:12      NA        5
## 6 01/01/2015 2015-01-01 08:29:12      NA        5</code></pre>
</div>
<div id="lets-pretend-we-are-now-done-with-our-project.-weve-written-some-r-code-maybe-added-some-text-explaining-what-we-did-and-we-are-ready-to-turn-things-in.-for-this-course-we-will-turn-in-a-variety-of-work-depending-on-the-type-of-project." class="section level5">
<h5>8. Let's pretend we are now done with our project. We've written some R code, maybe added some text explaining what we did, and we are ready to turn things in. For this course, we will turn in a variety of work, depending on the type of project.</h5>
</div>
<div id="we-will-always-require-a-pdf-which-contains-text-code-and-code-output.-normally-we-would-erase-any-code-chunks-from-the-template-that-are-not-used-however-for-this-project-it-is-ok-to-just-keep-the-rest-of-the-template-intact." class="section level5">
<h5>We will always require a PDF which contains text, code, and code output. Normally we would erase any code chunks from the template that are not used, however, for this project, it is OK to just keep the rest of the template intact.</h5>
</div>
<div id="a-pdf-is-generated-by-knitting-a-pdf-using-the-knit-button-in-rstudio." class="section level5">
<h5>A PDF is generated by &quot;knitting&quot; a PDF (using the &quot;knit&quot; button in RStudio).</h5>
</div>
<div id="in-addition-if-the-project-uses-r-code-you-will-need-to-also-submit-r-code-in-an-r-script-file-ending-with-.r.-later-this-year-when-submitting-python-code-you-will-submit-a-python-script-instead." class="section level5">
<h5>In addition, if the project uses R code, you will need to also submit R code in an R script (file ending with <code>.R</code>). (Later this year, when submitting Python code, you will submit a Python script instead.)</h5>
</div>
<div id="lets-practice.-take-the-code-from-your-project01.r-file-and-paste-it-perhaps-one-or-two-lines-at-time-into-your-rmarkdown-file-file-ending-with-.rmd." class="section level5">
<h5>Let's practice. Take the code from your <code>project01.R</code> file and paste it (perhaps one or two lines at time) into your RMarkdown file (file ending with <code>.Rmd</code>).</h5>
</div>
<div id="compile-your-rmarkdown-project-into-a-pdf.-follow-the-directions-in-brightspace-to-upload-and-submit-your-rmarkdown-file-compiled-pdf-and-r-script." class="section level5">
<h5>Compile your RMarkdown project into a PDF. Follow the directions in Brightspace to upload and submit your RMarkdown file, compiled PDF, and R script.</h5>
<p><strong>Relevant topics:</strong> <a href="projects.html#templates">templates</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Resulting knitted PDF.
</li>
<li>
<code>project01.R</code> script (with all of your R code) and the analogous <code>project01.Rmd</code> file.
</li>
</ul>
</div>
</div>
<div id="how-to-build-the-r-script-for-project-1-in-stat-19000." class="section level5">
<h5>How to build the R script for Project 1 in STAT 19000.</h5>
<p>In the videos below, for Question 1 and Question 6, Dr. Ward forgot to calculate the number of cores. (He only included the total amount of memory.) Dr. Ward is a human being who sometimes makes mistakes. Please remember to (also) calculate the number of cores, when you submit Question 1 and Question 6!</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_v8c05lak&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_q2jq19e0">Click here for video</a></p>
</div>
<div id="how-to-build-the-rmd-file-and-the-pdf-file-for-project-1-in-stat-19000." class="section level5">
<h5>How to build the Rmd file and the PDF file for Project 1 in STAT 19000.</h5>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_ccpgymsn&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_5kbz3ae1">Click here for video</a></p>
<hr />
</div>
</div>
</div>
<div id="fall2020-p02-190" class="section level3">
<h3>Project 2</h3>
<hr />
<div id="introduction-to-r-using-84.51-examples" class="section level5">
<h5>Introduction to R using 84.51 examples</h5>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_xqba3s8y&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=0_a5qq9eet">Click here for video</a></p>
</div>
<div id="introduction-to-r-using-nyc-yellow-taxi-cab-examples" class="section level5">
<h5>Introduction to R using NYC Yellow Taxi Cab examples</h5>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_ryucs8fg&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=0_gpzkq4ub">Click here for video</a></p>
<p><strong>Motivation:</strong> The R environment is a powerful tool to perform data analysis. R is a tool that is often compared to Python. Both have their advantages and disadvantages, and both are worth learning. In this project we will dive in head first and learn the basics while solving data-driven problems.</p>
<p><strong>Context:</strong> Last project we set the stage for the rest of the semester. We got some familiarity with our project templates, and modified and ran some R code. In this project, we will continue to use R within RStudio to solve problems. Soon you will see how powerful R is and why it is often a more effective tool to use than spreadsheets.</p>
<p><strong>Scope:</strong> r, vectors, indexing, recycling</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
List the differences between lists, vectors, factors, and data.frames, and when to use each.
</li>
<li>
Explain and demonstrate: positional, named, and logical indexing.
</li>
<li>
Read and write basic (csv) data.
</li>
<li>
Explain what &quot;recycling&quot; is in R and predict behavior of provided statements.
</li>
<li>
Identify good and bad aspects of simple plots.
</li>
</ul>
</div>
</div>
<div id="dataset-1" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/disney/metadata.csv</code></p>
<p>A public sample of the data can be found here: <a href="https://www.datadepot.rcac.purdue.edu/datamine/data/disney/metadata.csv">/class/datamine/data/disney/metadata.csv</a></p>
</div>
<div id="questions-1" class="section level4">
<h4>Questions</h4>
<div id="use-the-read.csv-function-to-load-classdataminedatadisneymetadata.csv-into-a-data.frame-called-mydf.-note-that-read.csv-by-default-loads-data-into-a-data.frame.-we-will-learn-more-about-the-idea-of-a-data.frame-but-for-now-just-think-of-it-like-a-spreadsheet-in-which-each-column-has-the-same-type-of-data.-print-the-first-few-rows-of-mydf-using-the-head-function-as-in-project-1-question-7." class="section level5">
<h5>1. Use the <code>read.csv</code> function to load <a href="https://www.datadepot.rcac.purdue.edu/datamine/data/disney/metadata.csv">/class/datamine/data/disney/metadata.csv</a> into a <code>data.frame</code> called <code>myDF</code>. Note that <code>read.csv</code> <em>by default</em> loads data into a <code>data.frame</code>. (We will learn more about the idea of a <code>data.frame</code>, but for now, just think of it like a spreadsheet, in which each column has the same type of data.) Print the first few rows of <code>myDF</code> using the <code>head</code> function (as in Project 1, Question 7).</h5>
<p><strong>Relevant topics:</strong> <a href="#reading-and-writing-data">reading data in r</a>, <a href="unix.html#head">head</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem in an R code chunk.
</li>
</ul>
</div>
</div>
<div id="solution-7" class="section level5">
<h5>Solution</h5>
<p>We load the data from the disney metadata into a data frame called <code>myDF</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myDF &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/disney/metadata.csv&quot;</span>)</code></pre></div>
</div>
<div id="weve-provided-you-with-r-code-below-that-will-extract-the-column-wdwmaxtemp-of-mydf-into-a-vector.-what-is-the-1st-value-in-the-vector-what-is-the-50th-value-in-the-vector-what-type-of-data-is-in-the-vector-for-this-last-question-use-the-typeof-function-to-find-the-type-of-data." class="section level5">
<h5>2. We've provided you with R code below that will extract the column <code>WDWMAXTEMP</code> of <code>myDF</code> into a vector. What is the 1st value in the vector? What is the 50th value in the vector? What type of data is in the vector? (For this last question, use the <code>typeof</code> function to find the type of data.)</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">our_vec &lt;-<span class="st"> </span>myDF<span class="op">$</span>WDWMAXTEMP</code></pre></div>
<p><strong>Relevant topics:</strong> <a href="r.html#r-indexing">indexing in r</a>, <a href="r.html#r-type">type</a>, <a href="r.html#r-variables">creating variables</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem in an R code chunk.
</li>
<li>
The values of the first, and 50th element in the vector.
</li>
<li>
The type of data in the vector (using the <code>typeof</code> function).
</li>
</ul>
</div>
</div>
<div id="solution-8" class="section level5">
<h5>Solution</h5>
<p>We first load the column <code>WDWMAXTEMP</code> of the data frame <code>myDF</code> into a vector:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">our_vec &lt;-<span class="st"> </span>myDF<span class="op">$</span>WDWMAXTEMP</code></pre></div>
<p>The 1st element is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">our_vec[<span class="dv">1</span>]</code></pre></div>
<pre><code>## [1] 73.02</code></pre>
<p>The 50th element is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">our_vec[<span class="dv">50</span>]</code></pre></div>
<pre><code>## [1] 51.24</code></pre>
<p>The type of data in the vector is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">typeof</span>(our_vec)</code></pre></div>
<pre><code>## [1] &quot;double&quot;</code></pre>
</div>
<div id="use-the-head-function-to-create-a-vector-called-first50-that-contains-the-first-50-values-of-the-vector-our_vec.-use-the-tail-function-to-create-a-vector-called-last50-that-contains-the-last-50-values-of-the-vector-our_vec." class="section level5">
<h5>3. Use the head function to create a vector called <code>first50</code> that contains the first 50 values of the vector <code>our_vec</code>. Use the tail function to create a vector called <code>last50</code> that contains the last 50 values of the vector <code>our_vec</code>.</h5>
</div>
<div id="you-can-access-many-elements-in-a-vector-at-the-same-time.-to-demonstrate-this-create-a-vector-called-mymix-that-contain-the-sum-of-each-element-of-first50-being-added-to-the-analogous-element-of-last50." class="section level5">
<h5>You can access many elements in a vector at the same time. To demonstrate this, create a vector called <code>mymix</code> that contain the sum of each element of <code>first50</code> being added to the analogous element of <code>last50</code>.</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-indexing">indexing in r</a>, <a href="r.html#r-variables">creating variables</a>, <a href="r.html#r-head">head and tail</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve this problem.
</li>
<li>
The contents of each of the three vectors.
</li>
</ul>
</div>
</div>
<div id="solution-9" class="section level5">
<h5>Solution</h5>
<p>We store the first 50 values of <code>our_vec</code> in <code>first50</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">first50 &lt;-<span class="st"> </span><span class="kw">head</span>(our_vec, <span class="dt">n=</span><span class="dv">50</span>)</code></pre></div>
<p>Here are the first 50 values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">first50</code></pre></div>
<pre><code>##  [1] 73.02 78.00 83.12 83.93 72.30 77.67 67.24 59.44 54.89 67.16 77.10 78.24
## [13] 74.89 64.51 62.12 63.58 72.83 70.59 69.89 71.03 75.78 77.09 78.40 70.77
## [25] 63.48 65.48 66.78 61.13 70.11 71.89 69.80 73.34 75.02 66.33 73.02 65.22
## [37] 66.33 71.78 73.58 70.42 64.23 66.96 71.39 59.54 63.24 73.42 74.11 78.70
## [49] 60.48 51.24</code></pre>
<p>We store the last 50 values of <code>our_vec</code> in last50:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">last50 &lt;-<span class="st"> </span><span class="kw">tail</span>(our_vec, <span class="dt">n=</span><span class="dv">50</span>)</code></pre></div>
<p>Here are the last 50 values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">last50</code></pre></div>
<pre><code>##  [1] 78.73 78.38 75.73 74.79 76.84 81.25 79.42 77.66 81.15 82.07 70.62 82.63
## [13] 79.12 78.55 76.34 74.10 78.62 74.31 67.69 73.30 74.51 77.66 81.15 82.07
## [25] 70.62 82.63 70.54 57.34 62.29 72.54 62.47 72.31 75.78 72.01 78.48 81.57
## [37] 82.06 80.45 82.01 76.05 79.38 79.38 79.38 79.74 70.41 68.23 58.31 64.29
## [49] 64.29 64.29</code></pre>
<p>The sums of these two vectors, element by element, are:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mymix &lt;-<span class="st"> </span>first50 <span class="op">+</span><span class="st"> </span>last50</code></pre></div>
<p>Here are these 50 values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mymix</code></pre></div>
<pre><code>##  [1] 151.75 156.38 158.85 158.72 149.14 158.92 146.66 137.10 136.04 149.23
## [11] 147.72 160.87 154.01 143.06 138.46 137.68 151.45 144.90 137.58 144.33
## [21] 150.29 154.75 159.55 152.84 134.10 148.11 137.32 118.47 132.40 144.43
## [31] 132.27 145.65 150.80 138.34 151.50 146.79 148.39 152.23 155.59 146.47
## [41] 143.61 146.34 150.77 139.28 133.65 141.65 132.42 142.99 124.77 115.53</code></pre>
</div>
<div id="in-3-we-were-able-to-rapidly-add-values-together-from-two-different-vectors.-both-vectors-were-the-same-size-hence-it-was-obvious-which-elements-in-each-vector-were-added-together." class="section level5">
<h5>4. In (3) we were able to rapidly add values together from two different vectors. Both vectors were the same size, hence, it was obvious which elements in each vector were added together.</h5>
</div>
<div id="create-a-new-vector-called-hot-which-contains-only-the-values-of-mydfwdwmaxtemp-which-are-greater-than-or-equal-to-80-our-vector-contains-max-temperatures-for-days-at-disney-world.-how-many-elements-are-in-hot" class="section level5">
<h5>Create a new vector called <code>hot</code> which contains only the values of <code>myDF$WDWMAXTEMP</code> which are greater than or equal to 80 (our vector contains max temperatures for days at Disney World). How many elements are in <code>hot</code>?</h5>
</div>
<div id="calculate-the-sum-of-hot-and-first50.-do-we-get-a-warning-read-this-and-then-explain-what-is-going-on." class="section level5">
<h5>Calculate the sum of <code>hot</code> and <code>first50</code>. Do we get a warning? Read <a href="https://excelkingdom.blogspot.com/2018/01/what-recycling-of-vector-elements-in-r.html">this</a> and then explain what is going on.</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-indexing">logical indexing</a>, <a href="r.html#r-length">length</a>, <a href="r.html#r-recycling">recycling</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve this problem.
</li>
<li>
1-2 sentences explaining what is happening when we are adding two vectors of different lengths.
</li>
</ul>
</div>
</div>
<div id="solution-10" class="section level5">
<h5>Solution</h5>
<p>The values of <code>myDF$WDWMAXTEMP</code> that are greater than or equal to 80 are:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hot &lt;-<span class="st"> </span>myDF<span class="op">$</span>WDWMAXTEMP[myDF<span class="op">$</span>WDWMAXTEMP <span class="op">&gt;=</span><span class="st"> </span><span class="dv">80</span>]</code></pre></div>
<p>The length of the vector <code>hot</code> is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(hot)</code></pre></div>
<pre><code>## [1] 1255</code></pre>
<p>If we calculate the sum of <code>hot</code> and <code>first50</code>,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mynewsum &lt;-<span class="st"> </span>hot <span class="op">+</span><span class="st"> </span>first50</code></pre></div>
<pre><code>## Warning in hot + first50: longer object length is not a multiple of shorter
## object length</code></pre>
<p>we get a warning that <code>hot</code> and <code>first50</code> have lengths that are not multiples of each other (so it does not make sense to be adding them, element by element).</p>
</div>
<div id="plot-the-wdwmaxtemp-vector-from-mydf." class="section level5">
<h5>5. Plot the <code>WDWMAXTEMP</code> vector from <code>myDF</code>.</h5>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve this problem.
</li>
<li>
Plot of the <code>WDWMAXTEMP</code> vector from <code>myDF</code>.
</li>
</ul>
</div>
<p><strong>Relevant topics:</strong> <a href="r.html#r-plotting">plotting</a></p>
</div>
<div id="solution-11" class="section level5">
<h5>Solution</h5>
<p>We plot the <code>max_temp</code> vector from <code>myDF</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(myDF<span class="op">$</span>WDWMAXTEMP)</code></pre></div>
<p><img src="the-datamine-examples_files/figure-html/unnamed-chunk-926-1.png" width="672" /></p>
</div>
<div id="the-following-three-pieces-of-code-each-create-a-graphic.-the-first-two-graphics-are-created-using-only-core-r-functions.-the-third-graphic-is-created-using-a-package-called-ggplot.-we-will-learn-more-about-all-of-these-things-later-on.-for-now-pick-your-favorite-graphic-and-write-1-2-sentences-explaining-why-it-is-your-favorite-what-could-be-improved-and-include-any-interesting-observations-if-any." class="section level5">
<h5>6. The following three pieces of code each create a graphic. The first two graphics are created using only core R functions. The third graphic is created using a package called <code>ggplot</code>. We will learn more about all of these things later on. For now, pick your favorite graphic, and write 1-2 sentences explaining why it is your favorite, what could be improved, and include any interesting observations (if any).</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">table</span>(myDF<span class="op">$</span>SEASON)
<span class="kw">dotchart</span>(dat, <span class="dt">main=</span><span class="st">&quot;Seasons&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Number of Days in Each Season&quot;</span>)</code></pre></div>
<div class="figure">
<img src="images/stat19000project2figure1.png" />

</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">tapply</span>(myDF<span class="op">$</span>WDWMEANTEMP, myDF<span class="op">$</span>DAYOFYEAR, mean, <span class="dt">na.rm=</span>T)
seasons &lt;-<span class="st"> </span><span class="kw">tapply</span>(myDF<span class="op">$</span>SEASON, myDF<span class="op">$</span>DAYOFYEAR, <span class="cf">function</span>(x) <span class="kw">unique</span>(x)[<span class="dv">1</span>])
pal &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#4E79A7&quot;</span>, <span class="st">&quot;#F28E2B&quot;</span>, <span class="st">&quot;#A0CBE8&quot;</span>,  <span class="st">&quot;#FFBE7D&quot;</span>, <span class="st">&quot;#59A14F&quot;</span>, <span class="st">&quot;#8CD17D&quot;</span>, <span class="st">&quot;#B6992D&quot;</span>, <span class="st">&quot;#F1CE63&quot;</span>, <span class="st">&quot;#499894&quot;</span>, <span class="st">&quot;#86BCB6&quot;</span>, <span class="st">&quot;#E15759&quot;</span>, <span class="st">&quot;#FF9D9A&quot;</span>, <span class="st">&quot;#79706E&quot;</span>, <span class="st">&quot;#BAB0AC&quot;</span>, <span class="st">&quot;#1170aa&quot;</span>, <span class="st">&quot;#B07AA1&quot;</span>)
colors &lt;-<span class="st"> </span><span class="kw">factor</span>(seasons)
<span class="kw">levels</span>(colors) &lt;-<span class="st"> </span>pal
<span class="kw">par</span>(<span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">xpd=</span><span class="ot">NA</span>)
<span class="kw">barplot</span>(dat, <span class="dt">main=</span><span class="st">&quot;Average Temperature&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Jan 1 (Day 0) - Dec 31 (Day 365)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Degrees in Fahrenheit&quot;</span>, <span class="dt">col=</span><span class="kw">as.factor</span>(colors), <span class="dt">border =</span> <span class="ot">NA</span>, <span class="dt">space=</span><span class="dv">0</span>)
<span class="kw">legend</span>(<span class="dv">0</span>, <span class="dv">-30</span>, <span class="dt">legend=</span><span class="kw">levels</span>(<span class="kw">factor</span>(seasons)), <span class="dt">lwd=</span><span class="dv">5</span>, <span class="dt">col=</span>pal, <span class="dt">ncol=</span><span class="dv">3</span>, <span class="dt">cex=</span><span class="fl">0.8</span>, <span class="dt">box.col=</span><span class="ot">NA</span>)</code></pre></div>
<div class="figure">
<img src="images/stat19000project2figure2.png" />

</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(tidyverse)
summary_temperatures &lt;-<span class="st"> </span>myDF <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(MONTHOFYEAR,WDWMAXTEMP<span class="op">:</span>WDWMEANTEMP) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(MONTHOFYEAR) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarise_all</span>(mean, <span class="dt">na.rm=</span>T)
<span class="kw">ggplot</span>(summary_temperatures, <span class="kw">aes</span>(<span class="dt">x=</span>MONTHOFYEAR)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> WDWMINTEMP, <span class="dt">ymax =</span> WDWMAXTEMP), <span class="dt">fill =</span> <span class="st">&quot;#ceb888&quot;</span>, <span class="dt">alpha=</span>.<span class="dv">5</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> WDWMEANTEMP), <span class="dt">col=</span><span class="st">&quot;#5D8AA8&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> WDWMEANTEMP), <span class="dt">pch=</span><span class="dv">21</span>,<span class="dt">fill =</span> <span class="st">&quot;#5D8AA8&quot;</span>, <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_classic</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Month&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;Temperature&#39;</span>, <span class="dt">title =</span> <span class="st">&#39;Average temperature range&#39;</span> ) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">labels=</span>month.abb)</code></pre></div>
<div class="figure">
<img src="images/stat19000project2figure3.png" />

</div>
</div>
<div id="solution-12" class="section level5">
<h5>Solution</h5>
<p>The seasons plot makes it easy to compare the values. On the other hand, the values do not appear to be given in any particular order.</p>
<p>The average temperature plot clearly indicates the rise and fall of the temperatures over the course of the year, but the color scheme is unusual. The colors in the plot do not seem to correspond to the colors in the legend. Additionally, the color schemes in both the plot and the legend seem to be chosen randomly.</p>
<hr />
</div>
</div>
</div>
<div id="fall2020-p03-190" class="section level3">
<h3>Project 3</h3>
<hr />
<p><strong>Motivation:</strong> <code>data.frame</code>s are the primary data structure you will work with when using R. It is important to understand how to insert, retrieve, and update data in a <code>data.frame</code>.</p>
<p><strong>Context:</strong> In the previous project we got our feet wet, and ran our first R code, and learned about accessing data inside vectors. In this project we will continue to reinforce what we've already learned and introduce a new, flexible data structure called <code>data.frame</code>s.</p>
<p><strong>Scope:</strong> r, data.frames, recycling, factors</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Explain what &quot;recycling&quot; is in R and predict behavior of provided statements.
</li>
<li>
Explain and demonstrate how R handles missing data: NA, NaN, NULL, etc.
</li>
<li>
Demonstrate the ability to use the following functions to solve data-driven problem(s): mean, var, table, cut, paste, rep, seq, sort, order, length, unique, etc.
</li>
<li>
Read and write basic (csv) data.
</li>
<li>
Explain and demonstrate: positional, named, and logical indexing.
</li>
<li>
List the differences between lists, vectors, factors, and data.frames, and when to use each.
</li>
</ul>
</div>
<div id="dataset-2" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/disney</code></p>
</div>
<div id="questions-2" class="section level4">
<h4>Questions</h4>
<div id="read-the-dataset-classdataminedatadisneysplash_mountain.csv-into-a-data.frame-called-splash_mountain.-how-many-columns-or-features-are-in-each-dataset-how-many-rows-or-observations" class="section level5">
<h5>1. Read the dataset <code>/class/datamine/data/disney/splash_mountain.csv</code> into a data.frame called <code>splash_mountain</code>. How many columns, or features are in each dataset? How many rows or observations?</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-str">str</a>, <a href="r.html#r-dim">dim</a></p>
<div class="bbox">
<p>
<strong>Item(s) to include:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
How many columns or features in each dataset?
</li>
</ul>
</div>
</div>
<div id="solution-13" class="section level5">
<h5>Solution</h5>
<p>We read in the Splash Mountain data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">splash_mountain &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/disney/splash_mountain.csv&quot;</span>)</code></pre></div>
<p>We can use either the <code>str</code> or the <code>dim</code> function to see that this data frame has 223936 rows and 4 columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(splash_mountain)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    223936 obs. of  4 variables:
##  $ date    : chr  &quot;01/01/2015&quot; &quot;01/01/2015&quot; &quot;01/01/2015&quot; &quot;01/01/2015&quot; ...
##  $ datetime: chr  &quot;2015-01-01 07:51:12&quot; &quot;2015-01-01 08:02:13&quot; &quot;2015-01-01 08:09:12&quot; &quot;2015-01-01 08:16:12&quot; ...
##  $ SACTMIN : int  NA NA NA NA NA NA NA NA NA 4 ...
##  $ SPOSTMIN: int  5 5 5 5 5 5 5 5 5 NA ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(splash_mountain)</code></pre></div>
<pre><code>## [1] 223936      4</code></pre>
</div>
<div id="splash-mountain-is-a-fan-favorite-ride-at-disney-worlds-magic-kingdom-theme-park.-splash_mountain-contains-a-series-of-dates-and-datetimes.-for-each-datetime-splash_mountain-contains-a-posted-minimum-wait-time-spostmin-and-an-actual-minimum-wait-time-sactmin.-what-is-the-average-posted-minimum-wait-time-for-splash-mountain-what-is-the-standard-deviation-based-on-the-fact-that-spostmin-represents-the-posted-minimum-wait-time-for-our-ride-does-our-mean-and-standard-deviation-make-sense-explain.-you-might-look-ahead-to-question-3-before-writing-the-answer-to-question-2." class="section level5">
<h5>2. Splash Mountain is a fan favorite ride at Disney World's Magic Kingdom theme park. <code>splash_mountain</code> contains a series of dates and datetimes. For each datetime, <code>splash_mountain</code> contains a posted minimum wait time, <code>SPOSTMIN</code>, and an actual minimum wait time, <code>SACTMIN</code>. What is the average posted minimum wait time for Splash Mountain? What is the standard deviation? Based on the fact that <code>SPOSTMIN</code> represents the posted minimum wait time for our ride, does our mean and standard deviation make sense? Explain. (You might look ahead to Question 3 before writing the answer to Question 2.)</h5>
<p><strong>Hint:</strong> If you got <code>NA</code> or <code>NaN</code> as a result, see <a href="https://thedatamine.github.io/the-examples-book/r.html#r-mean">here</a>.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-mean">mean</a>, <a href="r.html#r-var">var</a>, <a href="r.html#r-na">NA</a>, <a href="r.html#r-nan">NaN</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve this problem.
</li>
<li>
The results of running the R code.
</li>
<li>
1-2 sentences explaining why or why not the results make sense.
</li>
</ul>
</div>
</div>
<div id="solution-14" class="section level5">
<h5>Solution</h5>
<p>The average minimum posted wait time for Splash Mountain is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(splash_mountain<span class="op">$</span>SPOSTMIN, <span class="dt">na.rm=</span>T)</code></pre></div>
<pre><code>## [1] -71.70373</code></pre>
<p>and the standard deviation is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(splash_mountain<span class="op">$</span>SPOSTMIN, <span class="dt">na.rm=</span>T)</code></pre></div>
<pre><code>## [1] 328.0586</code></pre>
<p>This is strange because the average minimum posted wait time should not be a negative value, and the standard deviation seems to be very large.</p>
</div>
<div id="in-2-we-got-some-peculiar-values-for-the-mean-and-standard-deviation.-if-you-read-the-attractions-tab-in-the-file-classdataminedatadisneytouringplans_data_dictionary.xlsx-you-will-find-that--999-is-used-as-a-value-in-spostmin-and-sactmin-to-indicate-the-ride-as-being-closed.-recalculate-the-mean-and-standard-deviation-of-spostmin-excluding-values-that-are--999.-does-this-seem-to-have-fixed-our-problem" class="section level5">
<h5>3. In (2) we got some peculiar values for the mean and standard deviation. If you read the &quot;attractions&quot; tab in the file <code>/class/datamine/data/disney/touringplans_data_dictionary.xlsx</code>, you will find that -999 is used as a value in <code>SPOSTMIN</code> and <code>SACTMIN</code> to indicate the ride as being closed. Recalculate the mean and standard deviation of <code>SPOSTMIN</code>, excluding values that are -999. Does this seem to have fixed our problem?</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-na">NA</a>, <a href="r.html#r-mean">mean</a>, <a href="r.html#r-var">var</a>, <a href="r.html#r-indexing">indexing</a>, <a href="r.html#r-which">which</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve this problem.
</li>
<li>
The result of running the R code.
</li>
<li>
A statement indicating whether or not the value look reasonable now.
</li>
</ul>
</div>
</div>
<div id="solution-15" class="section level5">
<h5>Solution</h5>
<p>If we remove the -999 values, then the average minimum posted wait time (with the -999 values removed) is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(splash_mountain<span class="op">$</span>SPOSTMIN[splash_mountain<span class="op">$</span>SPOSTMIN <span class="op">!=</span><span class="st"> </span><span class="dv">-999</span>], <span class="dt">na.rm=</span>T)</code></pre></div>
<pre><code>## [1] 43.3892</code></pre>
<p>and the standard deviation (with the -999 values removed) is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(splash_mountain<span class="op">$</span>SPOSTMIN[splash_mountain<span class="op">$</span>SPOSTMIN <span class="op">!=</span><span class="st"> </span><span class="dv">-999</span>], <span class="dt">na.rm=</span>T)</code></pre></div>
<pre><code>## [1] 31.74894</code></pre>
<p>This looks more reasonable!</p>
</div>
<div id="spostmin-and-sactmin-arent-the-greatest-featurecolumn-names.-an-outsider-looking-at-the-data.frame-wouldnt-be-able-to-immediately-get-the-gist-of-what-they-represent.-change-spostmin-to-posted_min_wait_time-and-sactmin-to-actual_wait_time." class="section level5">
<h5>4. <code>SPOSTMIN</code> and <code>SACTMIN</code> aren't the greatest feature/column names. An outsider looking at the data.frame wouldn't be able to immediately get the gist of what they represent. Change <code>SPOSTMIN</code> to <code>posted_min_wait_time</code> and <code>SACTMIN</code> to <code>actual_wait_time</code>.</h5>
<p><strong>Hint:</strong> You can always use hard-coded integers to change names manually, however, if you use <code>which</code>, you can get the index of the column name that you would like to change. For data.frames like <code>splash_mountain</code>, this is a lot more efficient than manually counting which column is the one with a certain name.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-colnames-and-rownames">colnames</a>, <a href="r.html#r-names">names</a>, <a href="r.html#r-which">which</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The output from executing <code>names(splash_mountain)</code> or <code>colnames(splash_mountain)</code>.
</li>
</ul>
</div>
</div>
<div id="solution-16" class="section level5">
<h5>Solution</h5>
<p>The current column names of <code>splash_mountain</code> are:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colnames</span>(splash_mountain)</code></pre></div>
<pre><code>## [1] &quot;date&quot;     &quot;datetime&quot; &quot;SACTMIN&quot;  &quot;SPOSTMIN&quot;</code></pre>
<p>We can find which column is called <code>SPOSTMIN</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">which</span>(<span class="kw">colnames</span>(splash_mountain) <span class="op">==</span><span class="st"> &quot;SPOSTMIN&quot;</span>)</code></pre></div>
<pre><code>## [1] 4</code></pre>
<p>and change this column name to <code>posted_min_wait_time</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colnames</span>(splash_mountain)[<span class="dv">4</span>] &lt;-<span class="st"> &quot;posted_min_wait_time&quot;</span></code></pre></div>
<p>Next, we can find which column is called <code>SACTMIN</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">which</span>(<span class="kw">colnames</span>(splash_mountain) <span class="op">==</span><span class="st"> &quot;SACTMIN&quot;</span>)</code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>and change this column name to <code>actual_wait_time</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colnames</span>(splash_mountain)[<span class="dv">3</span>] &lt;-<span class="st"> &quot;actual_wait_time&quot;</span></code></pre></div>
<p>Alternatively, we could have used names instead of <code>colnames</code> and the effect would have been totally the same.</p>
</div>
<div id="use-the-cut-function-to-create-a-new-vector-called-quarter-that-breaks-the-date-column-up-by-quarter.-use-the-labels-argument-in-the-factor-function-to-label-the-quarters-q1-q2-...-qx-where-x-is-the-last-quarter.-add-quarter-as-a-column-named-quarter-in-splash_mountain.-how-many-quarters-are-there" class="section level5">
<h5>5. Use the <code>cut</code> function to create a new vector called <code>quarter</code> that breaks the <code>date</code> column up by quarter. Use the <code>labels</code> argument in the <code>factor</code> function to label the quarters &quot;q1&quot;, &quot;q2&quot;, ..., &quot;qX&quot; where <code>X</code> is the last quarter. Add <code>quarter</code> as a column named <code>quarter</code> in <code>splash_mountain</code>. How many quarters are there?</h5>
<p><strong>Hint:</strong> If you have 2 years of data, this will result in 8 quarters: &quot;q1&quot;, ..., &quot;q8&quot;.</p>
<p><strong>Hint:</strong> We can generate sequential data using <code>seq</code> and <code>paste0</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">paste0</span>(<span class="st">&quot;item&quot;</span>, <span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>))</code></pre></div>
<pre><code>## [1] &quot;item1&quot; &quot;item2&quot; &quot;item3&quot; &quot;item4&quot; &quot;item5&quot;</code></pre>
<p>or</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">paste0</span>(<span class="st">&quot;item&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</code></pre></div>
<pre><code>## [1] &quot;item1&quot; &quot;item2&quot; &quot;item3&quot; &quot;item4&quot; &quot;item5&quot;</code></pre>
<p><strong>Relevant topics:</strong> <a href="r.html#r-cut">cut</a>, <a href="r.html#r-dates">dates</a>, <a href="r.html#r-factors">factor</a>, <a href="r.html#r-paste">paste0</a>, seq, <a href="r.html#r-nlevels">nlevels</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The <code>head</code> and <code>tail</code> of <code>splash_mountain</code>.
</li>
<li>
The number of quarters in the new <code>quarter</code> column.
</li>
</ul>
</div>
<p>Question 5 is intended to be a little more challenging, so we worked through the <em>exact</em> same steps, with two other data sets. That way, if you work through these, all you will need to do, to solve Question 5, is to follow the example, and change two things, namely, the data set itself (in the <code>read.csv</code> file) and also the format of the date.</p>
<p>This basically steps you through <em>everything</em> in Question 5.</p>
<p>We hope that these are helpful resources for you! We appreciate you very much and we are here to support you! You would not know how to solve this question on your own--because we are just getting started--but we like to sometimes put in a question like this, in which you get introduced to several new things, and we will dive deeper into these ideas as we push ahead.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_mq1vhejd&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_1aapmvkx">Click here for video</a></p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_2xg1g5rq&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_ud2o1irw">Click here for video</a></p>
</div>
<div id="solution-17" class="section level5">
<h5>Solution</h5>
<p>We first take the date column from <code>splash_mountain</code> and treat it as <code>Date</code> values, and we break the dates according to which quarter they are in.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myresults &lt;-<span class="st"> </span><span class="kw">cut</span>((<span class="kw">as.Date</span>(splash_mountain<span class="op">$</span>date,<span class="st">&quot;%m/%d/%Y&quot;</span>)), <span class="dt">breaks=</span><span class="st">&quot;quarter&quot;</span>)</code></pre></div>
<p>There are 20 quarters altogether:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nlevels</span>(myresults)</code></pre></div>
<pre><code>## [1] 20</code></pre>
<p>We set the levels to be a letter <code>q</code> and then a number between <code>1</code> and <code>nlevels(myresults)</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(myresults) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;q&quot;</span>,<span class="dv">1</span><span class="op">:</span><span class="kw">nlevels</span>(myresults))
splash_mountain<span class="op">$</span>quarters &lt;-<span class="st"> </span>myresults
<span class="kw">head</span>(splash_mountain)</code></pre></div>
<pre><code>##         date            datetime actual_wait_time posted_min_wait_time quarters
## 1 01/01/2015 2015-01-01 07:51:12               NA                    5       q1
## 2 01/01/2015 2015-01-01 08:02:13               NA                    5       q1
## 3 01/01/2015 2015-01-01 08:09:12               NA                    5       q1
## 4 01/01/2015 2015-01-01 08:16:12               NA                    5       q1
## 5 01/01/2015 2015-01-01 08:23:12               NA                    5       q1
## 6 01/01/2015 2015-01-01 08:29:12               NA                    5       q1</code></pre>
</div>
<div id="please-include-a-statement-in-project-3-that-says-i-acknowledge-that-the-stat-190002900039000-1-credit-data-mine-seminar-will-be-recorded-and-posted-on-piazza-for-participants-in-this-course.-or-if-you-disagree-with-this-statement-please-consult-with-us-at-dataminepurdue.edu-for-an-alternative-plan." class="section level5">
<h5>6. Please include a statement in Project 3 that says, &quot;I acknowledge that the STAT 19000/29000/39000 1-credit Data Mine seminar will be recorded and posted on Piazza, for participants in this course.&quot; or if you disagree with this statement, please consult with us at <a href="mailto:datamine@purdue.edu">datamine@purdue.edu</a> for an alternative plan.</h5>
<hr />
</div>
</div>
</div>
<div id="fall2020-p04-190" class="section level3">
<h3>Project 4</h3>
<hr />
<p><strong>Motivation:</strong> Control flow is (roughtly) the order in which instructions are executed. We can execute certain tasks or code <em>if</em> certain requirements are met using if/else statements. In addition, we can perform operations many times in a loop using for loops. While these are important concepts to grasp, R differs from other programming languages in that operations are usually vectorized and there is little to no need to write loops.</p>
<p><strong>Context:</strong> We are gaining familiarity working in RStudio and writing R code. In this project we introduce and practice using control flow in R.</p>
<p><strong>Scope:</strong> r, data.frames, recycling, factors, if/else, for</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Explain what &quot;recycling&quot; is in R and predict behavior of provided statements.
</li>
<li>
Explain and demonstrate how R handles missing data: NA, NaN, NULL, etc.
</li>
<li>
Demonstrate the ability to use the following functions to solve data-driven problem(s): mean, var, table, cut, paste, rep, seq, sort, order, length, unique, etc.
</li>
<li>
Read and write basic (csv) data.
</li>
<li>
Explain and demonstrate: positional, named, and logical indexing.
</li>
<li>
List the differences between lists, vectors, factors, and data.frames, and when to use each.
</li>
<li>
Demonstrate a working knowledge of control flow in r: if/else statements, while loops, etc.
</li>
</ul>
</div>
<div id="dataset-3" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/disney</code></p>
</div>
<div id="questions-3" class="section level4">
<h4>Questions</h4>
<div id="use-read.csv-to-read-in-the-classdataminedatadisneysplash_mountain.csv-data-into-a-data.frame-called-splash_mountain.-in-the-previous-project-we-calculated-the-mean-and-standard-deviation-of-the-spostmin-posted-minimum-wait-time.-these-are-vectorized-operations-we-will-learn-more-about-this-next-project.-instead-of-using-the-mean-function-use-a-loop-to-calculate-the-meanaverage-just-like-the-previous-project.-do-not-use-sum-either." class="section level5">
<h5>1. Use <code>read.csv</code> to read in the <code>/class/datamine/data/disney/splash_mountain.csv</code> data into a data.frame called <code>splash_mountain</code>. In the previous project we calculated the mean and standard deviation of the <code>SPOSTMIN</code> (posted minimum wait time). These are vectorized operations (we will learn more about this next project). Instead of using the <code>mean</code> function, use a loop to calculate the mean(average), just like the previous project. Do not use <code>sum</code> either.</h5>
<p><strong>Hint:</strong> Remember, if a value is NA, we don't want to include it.</p>
<p><strong>Hint:</strong> Remember, if a value is -999, it means the ride is closed, we don't want to include it.</p>
<p><strong>Note:</strong> This exercise should make you appreciate the variety of useful functions R has to offer!</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-for-loops">for loops</a>, <a href="r.html#r-if-else">if/else statements</a>, <a href="r.html#r-isna">is.na</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem w/comments explaining what the code does.
</li>
<li>
The mean posted wait time.
</li>
</ul>
</div>
</div>
<div id="solution-18" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">splash_mountain &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/disney/splash_mountain.csv&quot;</span>)
sum_posted_wait_time &lt;-<span class="st"> </span><span class="dv">0</span>
not_nas_and_nines &lt;-<span class="st"> </span><span class="dv">0</span>
<span class="cf">for</span> (i <span class="cf">in</span> splash_mountain<span class="op">$</span>SPOSTMIN) {
    <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.na</span>(i) <span class="op">&amp;&amp;</span><span class="st"> </span>i <span class="op">!=</span><span class="st"> </span><span class="dv">-999</span>) {
        sum_posted_wait_time &lt;-<span class="st"> </span>sum_posted_wait_time <span class="op">+</span><span class="st"> </span>i
         not_nas_and_nines &lt;-<span class="st"> </span>not_nas_and_nines <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
    } 
}
mean_posted_wait_time &lt;-<span class="st"> </span>sum_posted_wait_time<span class="op">/</span>not_nas_and_nines
mean_posted_wait_time</code></pre></div>
</div>
<div id="choose-one-of-the-.csv-files-containing-data-for-a-ride.-use-read.csv-to-load-the-file-into-a-data.frame-named-ride_name-where-ride_name-is-the-name-of-the-ride-you-chose.-use-a-for-loop-to-loop-through-the-ride-file-and-add-a-new-column-called-status.-status-should-contain-a-string-whose-value-is-either-open-or-closed.-if-spostmin-or-sactmin-is--999-classify-the-row-as-closed.-otherwise-classify-the-row-as-open.-after-status-is-added-to-your-data.frame-convert-the-column-to-a-factor." class="section level5">
<h5>2. Choose one of the <code>.csv</code> files containing data for a ride. Use <code>read.csv</code> to load the file into a data.frame named <code>ride_name</code> where &quot;ride_name&quot; is the name of the ride you chose. Use a for loop to loop through the ride file and add a new column called <code>status</code>. <code>status</code> should contain a string whose value is either &quot;open&quot;, or &quot;closed&quot;. If <code>SPOSTMIN</code> or <code>SACTMIN</code> is -999, classify the row as &quot;closed&quot;. Otherwise, classify the row as &quot;open&quot;. After <code>status</code> is added to your data.frame, convert the column to a <code>factor</code>.</h5>
<p><strong>Hint:</strong> If you want to access two columns at once from a data.frame, you can do: <code>splash_mountain[i, c(&quot;SPOSTMIN&quot;, &quot;SACTMIN&quot;)]</code>.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-any">any</a>, <a href="r.html#r-for-loops">for loops</a>, <a href="r.html#r-if-else">if/else statements</a>, <a href="r.html#r-data-frames">nrow</a></p>
<p><strong>Note:</strong> For loops are often <a href="r.html#r-for-loops-versus-vectorized-functions">much slower (here is a video to demonstrate)</a> than vectorized functions, as we will see in (3) below.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem w/comments explaining what the code does.
</li>
<li>
The output from running <code>str</code> on <code>ride_name</code>.
</li>
</ul>
</div>
<p>In this video, we basically go all the way through Question 2 using a video:</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_867pc9uq&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_txgdir1q">Click here for video</a></p>
</div>
<div id="solution-19" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">splash_mountain &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/disney/splash_mountain.csv&quot;</span>)
status &lt;-<span class="st"> </span><span class="kw">c</span>()
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(splash_mountain)) {
    <span class="cf">if</span> (<span class="kw">any</span>(splash_mountain[i, <span class="kw">c</span>(<span class="st">&quot;SACTMIN&quot;</span>, <span class="st">&quot;SPOSTMIN&quot;</span>)]<span class="op">==-</span><span class="dv">999</span>, <span class="dt">na.rm=</span>T)) {
        status[i] &lt;-<span class="st"> &quot;closed&quot;</span>
    }<span class="cf">else</span> {
        status[i] &lt;-<span class="st"> &quot;open&quot;</span>
    }
}
splash_mountain<span class="op">$</span>status &lt;-<span class="st"> </span><span class="kw">factor</span>(status)</code></pre></div>
</div>
<div id="typically-you-want-to-avoid-using-for-loops-or-even-apply-functions-we-will-learn-more-about-these-later-on-dont-worry-when-they-arent-needed.-instead-you-can-use-vectorized-operations-and-indexing.-repeat-2-without-using-any-for-loops-or-apply-functions-instead-use-indexing-and-the-which-function.-which-method-was-faster" class="section level5">
<h5>3. Typically you want to avoid using for loops (or even apply functions (we will learn more about these later on, don't worry)) when they aren't needed. Instead you can use vectorized operations and indexing. Repeat (2) without using any for loops or apply functions (instead use indexing and the <code>which</code> function). Which method was faster?</h5>
<p><strong>Hint:</strong> To have multiple conditions within the <code>which</code> statement, use <code>|</code> for logical OR and <code>&amp;</code> for logical AND.</p>
<p><strong>Hint:</strong> You can start by assigning every value in <code>status</code> as &quot;open&quot;, and then change the correct values to &quot;closed&quot;.</p>
<p><strong>Note:</strong> Here is a <a href="r.html#r-example-safe-versus-contaminated">complete example (very much like question 3) with another video</a> that shows how we can classify objects.</p>
<p><strong>Note:</strong> Here is a <a href="r.html#r-example-for-loops-compared-to-vectorized-functions">complete example with a video</a> that makes a comparison between the concept of a for loop versus the concept for a vectorized function.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-which">which</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem w/comments explaining what the code does.
</li>
<li>
The output from running <code>str</code> on <code>ride_name</code>.
</li>
</ul>
</div>
</div>
<div id="solution-20" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">splash_mountain &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/disney/splash_mountain.csv&quot;</span>)
splash_mountain<span class="op">$</span>status &lt;-<span class="st"> &quot;open&quot;</span>
splash_mountain<span class="op">$</span>status[<span class="kw">which</span>(splash_mountain<span class="op">$</span>SPOSTMIN <span class="op">==</span><span class="st"> </span><span class="dv">-999</span> <span class="op">|</span><span class="st"> </span>splash_mountain<span class="op">$</span>SACTMIN <span class="op">==</span><span class="st"> </span><span class="dv">-999</span>)] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;closed&quot;</span>)
splash_mountain<span class="op">$</span>status &lt;-<span class="st"> </span><span class="kw">factor</span>(splash_mountain<span class="op">$</span>status)</code></pre></div>
</div>
<div id="create-a-pie-chart-for-open-vs.-closed-for-splash_mountain.csv.-first-use-the-table-command-to-get-a-count-of-each-status.-use-the-resulting-table-as-input-to-the-pie-function.-make-sure-to-give-your-pie-chart-a-title-that-somehow-indicates-the-ride-to-the-audience." class="section level5">
<h5>4. Create a pie chart for open vs. closed for <code>splash_mountain.csv</code>. First, use the <code>table</code> command to get a count of each <code>status</code>. Use the resulting table as input to the <code>pie</code> function. Make sure to give your pie chart a title that somehow indicates the ride to the audience.</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-pie">pie</a>, <a href="r.html#r-table">table</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem w/comments explaining what the code does.
</li>
<li>
The resulting plot displayed as output in the RMarkdown.
</li>
</ul>
</div>
</div>
<div id="solution-21" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pie</span>(<span class="kw">table</span>(splash_mountain<span class="op">$</span>status), <span class="dt">main=</span><span class="st">&quot;Splash Mountain&quot;</span>)</code></pre></div>
</div>
<div id="loop-through-the-vector-of-files-weve-provided-below-and-create-a-pie-chart-of-open-vs-closed-for-each-ride.-place-all-6-resulting-pie-charts-on-the-same-image.-make-sure-to-give-each-pie-chart-a-title-that-somehow-indicates-the-ride." class="section level5">
<h5>5. Loop through the vector of files we've provided below, and create a pie chart of open vs closed for each ride. Place all 6 resulting pie charts on the same image. Make sure to give each pie chart a title that somehow indicates the ride.</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ride_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;splash_mountain&quot;</span>, <span class="st">&quot;soarin&quot;</span>, <span class="st">&quot;pirates_of_caribbean&quot;</span>, <span class="st">&quot;expedition_everest&quot;</span>, <span class="st">&quot;flight_of_passage&quot;</span>, <span class="st">&quot;rock_n_rollercoaster&quot;</span>)
ride_files &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;/class/datamine/data/disney/&quot;</span>, ride_names, <span class="st">&quot;.csv&quot;</span>)</code></pre></div>
<p><strong>Hint:</strong> To place all of the resulting pie charts in the same image, prior to running the for loop, run <code>par(mfrow=c(2,3))</code>.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-for-loops">for loop</a>, <a href="r.html#r-reading-and-writing-data">read.csv</a>, <a href="r.html#r-pie">pie</a>, <a href="r.html#r-table">table</a>, <a href="r.html#r-par">par</a></p>
<p>This is not exactly the same, but it is a similar example, using the campaign election data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mypiechart &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  myDF &lt;-<span class="st"> </span><span class="kw">read.csv</span>( <span class="kw">paste0</span>(<span class="st">&quot;/class/datamine/data/election/itcont&quot;</span>, x, <span class="st">&quot;.txt&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;|&quot;</span>)
  mystate &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;other&quot;</span>, <span class="dt">times=</span><span class="kw">nrow</span>(myDF))
  mystate[myDF<span class="op">$</span>STATE <span class="op">==</span><span class="st"> &quot;CA&quot;</span>] &lt;-<span class="st"> &quot;California&quot;</span>
  mystate[myDF<span class="op">$</span>STATE <span class="op">==</span><span class="st"> &quot;TX&quot;</span>] &lt;-<span class="st"> &quot;Texas&quot;</span>
  mystate[myDF<span class="op">$</span>STATE <span class="op">==</span><span class="st"> &quot;NY&quot;</span>] &lt;-<span class="st"> &quot;New York&quot;</span>
  myDF<span class="op">$</span>stateclassification &lt;-<span class="st"> </span><span class="kw">factor</span>(mystate)
  <span class="kw">pie</span>(<span class="kw">table</span>(myDF<span class="op">$</span>stateclassification))
}

myyears &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1980&quot;</span>,<span class="st">&quot;1984&quot;</span>,<span class="st">&quot;1988&quot;</span>,<span class="st">&quot;1992&quot;</span>,<span class="st">&quot;1996&quot;</span>,<span class="st">&quot;2000&quot;</span>)
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))
<span class="cf">for</span> (i <span class="cf">in</span> myyears) {
  <span class="kw">mypiechart</span>(i)
}</code></pre></div>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_mi6rahcs&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_49hh9f0u">Click here for video</a></p>
<p>Here is another video, which guides students even more closely through Question 5.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_s6o47xgf&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_46qlvzbr">Click here for video</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem w/comments explaining what the code does.
</li>
<li>
The resulting plot displayed as output in the RMarkdown.
</li>
</ul>
</div>
</div>
<div id="solution-22" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ride_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;splash_mountain&quot;</span>, <span class="st">&quot;soarin&quot;</span>, <span class="st">&quot;pirates_of_caribbean&quot;</span>, <span class="st">&quot;flight_of_passage&quot;</span>, <span class="st">&quot;expedition_everest&quot;</span>, <span class="st">&quot;rock_n_rollercoaster&quot;</span>)
ride_files &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">c</span>(<span class="st">&quot;/class/datamine/data/disney/&quot;</span>), ride_names, <span class="st">&quot;.csv&quot;</span>)
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(ride_names)) {
    dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(ride_files[i])
    dat<span class="op">$</span>status &lt;-<span class="st"> &quot;open&quot;</span>
    dat<span class="op">$</span>status[<span class="kw">which</span>(dat<span class="op">$</span>SPOSTMIN <span class="op">==</span><span class="st"> </span><span class="dv">-999</span> <span class="op">|</span><span class="st"> </span>dat<span class="op">$</span>SACTMIN <span class="op">==</span><span class="st"> </span><span class="dv">-999</span>)] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;closed&quot;</span>)
    dat<span class="op">$</span>status &lt;-<span class="st"> </span><span class="kw">factor</span>(dat<span class="op">$</span>status)
    <span class="kw">pie</span>(<span class="kw">table</span>(dat<span class="op">$</span>status), <span class="dt">main=</span>ride_names[i])
}</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p05-190" class="section level3">
<h3>Project 5</h3>
<hr />
<p><strong>Motivation:</strong> As briefly mentioned in project 4, R differs from other programming languages in that <em>typically</em> you will want to avoid using for loops, and instead use vectorized functions and the apply suite. In this project we will demonstrate some basic vectorized operations, and how they are better to use than loops.</p>
<p><strong>Context:</strong> While it was important to stop and learn about looping and if/else statements, in this project, we will explore the R way of doing things.</p>
<p><strong>Scope:</strong> r, data.frames, recycling, factors, if/else, for</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Explain what &quot;recycling&quot; is in R and predict behavior of provided statements.
</li>
<li>
Explain and demonstrate how R handles missing data: NA, NaN, NULL, etc.
</li>
<li>
Demonstrate the ability to use the following functions to solve data-driven problem(s): mean, var, table, cut, paste, rep, seq, sort, order, length, unique, etc.
</li>
<li>
Read and write basic (csv) data.
</li>
<li>
Explain and demonstrate: positional, named, and logical indexing.
</li>
<li>
List the differences between lists, vectors, factors, and data.frames, and when to use each.
</li>
<li>
Demonstrate a working knowledge of control flow in r: for loops .
</li>
</ul>
</div>
<div id="dataset-4" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/fars</code></p>
<p>To get more information on the dataset, see <a href="https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812602">here</a>.</p>
</div>
<div id="questions-4" class="section level4">
<h4>Questions</h4>
<div id="the-fars-dataset-contains-a-series-of-folders-labeled-by-year.-in-each-year-folder-there-is-at-least-the-files-accident.csv-person.csv-and-vehicle.csv.-if-you-take-a-peek-at-any-accident.csv-file-in-any-year-youll-notice-that-the-column-year-only-contains-the-last-two-digits-of-the-year.-add-a-new-year-column-that-contains-the-full-year.-use-the-rbind-function-to-create-a-data.frame-called-accidents-that-combines-the-accident.csv-files-from-the-years-1975-through-1981-inclusive-into-one-big-dataset.-after-creating-that-accidents-data-frame-change-the-values-in-the-year-column-from-two-digits-to-four-digits-i.e.-paste-a-19-onto-each-year-value." class="section level5">
<h5>1. The <code>fars</code> dataset contains a series of folders labeled by year. In each year folder there is (at least) the files <code>ACCIDENT.CSV</code>, <code>PERSON.CSV</code>, and <code>VEHICLE.CSV</code>. If you take a peek at any <code>ACCIDENT.CSV</code> file in any year, you'll notice that the column <code>YEAR</code> only contains the last two digits of the year. Add a new <code>YEAR</code> column that contains the <em>full</em> year. Use the <code>rbind</code> function to create a data.frame called <code>accidents</code> that combines the <code>ACCIDENT.CSV</code> files from the years 1975 through 1981 (inclusive) into one big dataset. After creating that <code>accidents</code> data frame, change the values in the <code>YEAR</code> column from two digits to four digits (i.e., paste a 19 onto each year value).</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-bind">rbind</a>, <a href="r.html#r-read">read.csv</a>, <a href="r.html#r-paste">paste0</a></p>
<p>Here is a video to walk you through the method of solving Question 1.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_s3rmm49r&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_0m0lcfn4">Click here for video</a></p>
<p>Here is another video, using two functions you have not (yet) learned, namely, <code>lapply</code> and <code>do.call</code>. You do <strong>not</strong> need to understand these yet. <em>It is just a glimpse of some powerful functions to come later in the course!</em></p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_0j12nvt9&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_kja0bugl">Click here for video</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem/comments explaining what the code does.
</li>
<li>
The result of <code>unique(accidents$YEAR)</code>.
</li>
</ul>
</div>
</div>
<div id="solution-23" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">accidents &lt;-<span class="st"> </span><span class="kw">data.frame</span>()
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1975</span><span class="op">:</span><span class="dv">1981</span>) {
    filename &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;/class/datamine/data/fars/&quot;</span>, i, <span class="st">&quot;/ACCIDENT.CSV&quot;</span>)
    dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(filename)
    dat<span class="op">$</span>YEAR &lt;-<span class="st"> </span>i
    accidents &lt;-<span class="st"> </span><span class="kw">rbind</span>(accidents, dat)
}</code></pre></div>
</div>
<div id="using-the-new-accidents-data-frame-that-you-created-in-1-how-many-accidents-are-there-in-which-1-or-more-drunk-drivers-were-involved-in-an-accident-with-a-school-bus" class="section level5">
<h5>2. Using the new <code>accidents</code> data frame that you created in (1), how many accidents are there in which 1 or more drunk drivers were involved in an accident with a school bus?</h5>
<p><strong>Hint:</strong> Look at the variables <code>DRUNK_DR</code> and <code>SCH_BUS</code>.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-table">table</a>, <a href="r.html#r-which">which</a>, <a href="r.html#r-indexing">indexing</a></p>
<p>Here is a video about a related problem with 3 fatalities (instead of considering drunk drivers).</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_atos2tng&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_rhoyx3ok">Click here for video</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem/comments explaining what the code does.
</li>
<li>
The result/answer itself.
</li>
</ul>
</div>
</div>
<div id="solution-24" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(accidents<span class="op">$</span>DRUNK_DR, accidents<span class="op">$</span>SCH_BUS)</code></pre></div>
</div>
<div id="again-using-the-accidents-data-frame-for-accidents-involving-1-or-more-drunk-drivers-and-a-school-bus-how-many-happened-in-each-of-the-7-years-which-year-had-the-largest-number-of-these-types-of-accidents" class="section level5">
<h5>3. Again using the <code>accidents</code> data frame: For accidents involving 1 or more drunk drivers and a school bus, how many happened in each of the 7 years? Which year had the largest number of these types of accidents?</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-table">table</a>, <a href="r.html#r-which">which</a>, <a href="r.html#r-indexing">indexing</a></p>
<p>Here is a video about the related problem with 3 fatalities (instead of considering drunk drivers), tabulated according to year.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_gwzvg6ug&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_p9qs43kc">Click here for video</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem/comments explaining what the code does.
</li>
<li>
The results.
</li>
<li>
Which year had the most qualifying accidents.
</li>
</ul>
</div>
</div>
<div id="solution-25" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">result &lt;-<span class="st"> </span><span class="kw">table</span>(accidents<span class="op">$</span>YEAR[<span class="kw">which</span>(accidents<span class="op">$</span>DRUNK_DR <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>accidents<span class="op">$</span>SCH_BUS<span class="op">==</span><span class="dv">1</span>)])
result[<span class="kw">which.max</span>(result)]</code></pre></div>
</div>
<div id="again-using-the-accidents-data-frame-calculate-the-mean-number-of-motorists-involved-in-an-accident-variable-person-with-i-drunk-drivers-where-i-takes-the-values-from-0-through-6." class="section level5">
<h5>4. Again using the <code>accidents</code> data frame: Calculate the mean number of motorists involved in an accident (variable <code>PERSON</code>) with i drunk drivers, where i takes the values from 0 through 6.</h5>
<p><strong>Hint:</strong> It is OK that there are no accidents involving just 5 drunk drivers.</p>
<p><strong>Hint:</strong> You can use either a <code>for</code> loop or a <code>tapply</code> function to accomplish this question.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-for-loops">for loops</a>, <a href="r.html#r-indexing">indexing</a>, <a href="r.html#r-tapply">tapply</a>, <a href="r.html#r-mean">mean</a>,</p>
<p>Here is a video about the related problem with 3 fatalities (instead of considering drunk drivers). We calculate the mean number of fatalities for accidents with i drunk drivers, where i takes the values from 0 through 6.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_l3rehgyu&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_nqqp8016">Click here for video</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem/comments explaining what the code does.
</li>
<li>
The output from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-26" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span><span class="dv">6</span>) {
    <span class="kw">print</span>(<span class="kw">mean</span>(accidents<span class="op">$</span>PERSONS[accidents<span class="op">$</span>DRUNK_DR <span class="op">==</span><span class="st"> </span>i], <span class="dt">na.rm=</span>T))
}</code></pre></div>
</div>
<div id="again-using-the-accidents-data-frame-we-have-a-theory-that-there-are-more-accidents-in-cold-weather-months-for-indiana-and-states-around-indiana.-for-this-question-only-consider-the-data-for-which-state-is-one-of-these-indiana-18-illinois-17-ohio-39-or-michigan-26.-create-a-barplot-that-shows-the-number-of-accidents-by-state-and-by-month-month-simultanously.-what-months-have-the-most-accidents-are-you-surprised-by-these-results-explain-why-or-why-not" class="section level5">
<h5>5. Again using the <code>accidents</code> data frame: We have a theory that there are more accidents in cold weather months for Indiana and states around Indiana. For this question, only consider the data for which <code>STATE</code> is one of these: Indiana (18), Illinois (17), Ohio (39), or Michigan (26). Create a barplot that shows the number of accidents by <code>STATE</code> and by month (<code>MONTH</code>) simultanously. What months have the most accidents? Are you surprised by these results? Explain why or why not?</h5>
<p>We guide students through the methodology for Question 5 in this video. We also add a legend, in case students want to distinguish which stacked barplot goes with each of the four States.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_l3rehgyu&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_nqqp8016">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-in">in</a>, <a href="r.html#r-barplot">barplot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem/comments explaining what the code does.
</li>
<li>
The output (plot) from running your code.
</li>
<li>
1-2 sentences explaining which month(s) have the most accidents and whether or not this surprises you.
</li>
</ul>
</div>
</div>
<div id="solution-27" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span>accidents[accidents<span class="op">$</span>STATE <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">17</span>, <span class="dv">18</span>, <span class="dv">26</span>, <span class="dv">39</span>),]
<span class="kw">barplot</span>(<span class="kw">table</span>(dat<span class="op">$</span>STATE, dat<span class="op">$</span>MONTH))</code></pre></div>
</div>
<div id="optional-question.-spruce-up-your-plot-from-5.-do-any-of-the-following" class="section level5">
<h5>OPTIONAL QUESTION. Spruce up your plot from (5). Do any of the following:</h5>
<ul>
<li>add vibrant (and preferably colorblind friendly) colors to your plot</li>
<li>add a title</li>
<li>add a legend</li>
<li>add month names or abbreviations instead of numbers</li>
</ul>
<p><strong>Hint:</strong> <a href="https://www.r-graph-gallery.com/209-the-options-of-barplot.html">Here</a> is a resource to get you started.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem/comments explaining what the code does.
</li>
<li>
The output (plot) from running your code.
</li>
</ul>
</div>
</div>
<div id="solution-28" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RColorBrewer)
dat &lt;-<span class="st"> </span>accidents[accidents<span class="op">$</span>STATE <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">17</span>, <span class="dv">18</span>, <span class="dv">26</span>, <span class="dv">39</span>),]
dat<span class="op">$</span>STATE &lt;-<span class="st"> </span><span class="kw">factor</span>(dat<span class="op">$</span>STATE, <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Illinois&quot;</span>, <span class="st">&quot;Indiana&quot;</span>, <span class="st">&quot;Michigan&quot;</span>, <span class="st">&quot;Ohio&quot;</span>))
dat<span class="op">$</span>MONTH &lt;-<span class="st"> </span><span class="kw">factor</span>(dat<span class="op">$</span>MONTH, <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Jan&quot;</span>, <span class="st">&quot;Feb&quot;</span>, <span class="st">&quot;Mar&quot;</span>, <span class="st">&quot;Apr&quot;</span>, <span class="st">&quot;May&quot;</span>, <span class="st">&quot;Jun&quot;</span>, <span class="st">&quot;Jul&quot;</span>, <span class="st">&quot;Aug&quot;</span>, <span class="st">&quot;Sep&quot;</span>, <span class="st">&quot;Oct&quot;</span>, <span class="st">&quot;Nov&quot;</span>, <span class="st">&quot;Dec&quot;</span>))
color_palette &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dv">5</span>, <span class="st">&quot;Set2&quot;</span>)
<span class="kw">barplot</span>(<span class="kw">table</span>(dat<span class="op">$</span>STATE, dat<span class="op">$</span>MONTH), <span class="dt">col=</span>color_palette, <span class="dt">main=</span><span class="st">&quot;Accidents by Month&quot;</span>, <span class="dt">legend=</span>T, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5000</span>), <span class="dt">las=</span><span class="dv">2</span>)</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p06-190" class="section level3">
<h3>Project 6</h3>
<hr />
<p>The <code>tapply</code> function works like this:</p>
<p><code>tapply( somedata, thewaythedataisgrouped, myfunction)</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myDF &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/8451/The_Complete_Journey_2_Master/5000_transactions.csv&quot;</span>)
<span class="kw">head</span>(myDF)</code></pre></div>
<p>We could do four computations to compute the <code>mean</code> <code>SPEND</code> amount in each <code>STORE_R</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(myDF<span class="op">$</span>SPEND[myDF<span class="op">$</span>STORE_R <span class="op">==</span><span class="st"> &quot;CENTRAL&quot;</span>])
<span class="kw">mean</span>(myDF<span class="op">$</span>SPEND[myDF<span class="op">$</span>STORE_R <span class="op">==</span><span class="st"> &quot;EAST   &quot;</span>])
<span class="kw">mean</span>(myDF<span class="op">$</span>SPEND[myDF<span class="op">$</span>STORE_R <span class="op">==</span><span class="st"> &quot;SOUTH  &quot;</span>])
<span class="kw">mean</span>(myDF<span class="op">$</span>SPEND[myDF<span class="op">$</span>STORE_R <span class="op">==</span><span class="st"> &quot;WEST   &quot;</span>])</code></pre></div>
<p>but it is easier to do all four of these calculations with the <code>tapply</code> function. We take a <code>mean</code> of the <code>SPEND</code> values, broken into groups according to the <code>STORE_R</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>( myDF<span class="op">$</span>SPEND, myDF<span class="op">$</span>STORE_R, mean)</code></pre></div>
<p>We could find the total amount in the <code>SPEND</code> column in 2016 and then again in 2017.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(myDF<span class="op">$</span>SPEND[myDF<span class="op">$</span>YEAR <span class="op">==</span><span class="st"> &quot;2016&quot;</span>])
<span class="kw">sum</span>(myDF<span class="op">$</span>SPEND[myDF<span class="op">$</span>YEAR <span class="op">==</span><span class="st"> &quot;2017&quot;</span>])</code></pre></div>
<p>or we could do both of these calculations at once, using the <code>tapply</code> function. We take the <code>sum</code> of all <code>SPEND</code> amounts, broken into groups according to the <code>YEAR</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(myDF<span class="op">$</span>SPEND, myDF<span class="op">$</span>YEAR, sum)</code></pre></div>
<p>As a last example, we can calculate the amount spent on each day of purchases. We take the <code>sum</code> of all <code>SPEND</code> amounts, broken into groups according to the <code>PURCHASE_</code> day</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(myDF<span class="op">$</span>SPEND, myDF<span class="op">$</span>PURCHASE_, sum)</code></pre></div>
<p>It makes sense to sort the results and then look at the 20 days on which the <code>sum</code> of the <code>SPEND</code> amounts were the highest.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tail</span>(<span class="kw">sort</span>(  <span class="kw">tapply</span>(myDF<span class="op">$</span>SPEND, myDF<span class="op">$</span>PURCHASE_, sum)  ),<span class="dt">n=</span><span class="dv">20</span>)</code></pre></div>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_q6l8tjy6&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_w53gzazn">Click here for video</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>( mydata, mygroups, myfunction, <span class="dt">na.rm=</span>T )</code></pre></div>
<p>Some generic uses to explain how this would look, if we made the calculations in a naive/verbose/painful way</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">myfunction</span>(mydata[mygroups <span class="op">==</span><span class="st"> </span><span class="dv">1</span>], <span class="dt">na.rm=</span>T)
<span class="kw">myfunction</span>(mydata[mygroups <span class="op">==</span><span class="st"> </span><span class="dv">2</span>], <span class="dt">na.rm=</span>T)
<span class="kw">myfunction</span>(mydata[mygroups <span class="op">==</span><span class="st"> </span><span class="dv">3</span>], <span class="dt">na.rm=</span>T) ....

<span class="kw">myfunction</span>(mydata[mygroups <span class="op">==</span><span class="st"> &quot;IN&quot;</span>], <span class="dt">na.rm=</span>T)
<span class="kw">myfunction</span>(mydata[mygroups <span class="op">==</span><span class="st"> &quot;OH&quot;</span>], <span class="dt">na.rm=</span>T)
<span class="kw">myfunction</span>(mydata[mygroups <span class="op">==</span><span class="st"> &quot;IL&quot;</span>], <span class="dt">na.rm=</span>T) ....</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myDF &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/flights/subset/2005.csv&quot;</span>)
<span class="kw">head</span>(myDF)</code></pre></div>
<p><code>sum</code> the <code>Distance</code>s of the flights, split into groups according to the airline (<code>UniqueCarrier</code>)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sort</span>(<span class="kw">tapply</span>(myDF<span class="op">$</span>Distance, myDF<span class="op">$</span>UniqueCarrier, sum))</code></pre></div>
<p>Find the <code>mean</code> flight <code>Distance</code>, grouped according to the city of <code>Origin</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sort</span>(<span class="kw">tapply</span>(myDF<span class="op">$</span>Distance, myDF<span class="op">$</span>Origin, mean))</code></pre></div>
<p>Calculate the <code>mean</code> departure delay (<code>DepDelay</code>), for each airplane (i.e., each <code>TailNum</code>), using <code>na.rm=T</code> because some of the values of the departure delays are <code>NA</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tail</span>(<span class="kw">sort</span>(<span class="kw">tapply</span>(myDF<span class="op">$</span>DepDelay, myDF<span class="op">$</span>TailNum, mean, <span class="dt">na.rm=</span>T)),<span class="dt">n=</span><span class="dv">20</span>)</code></pre></div>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_q23jrwal&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_rncsd599">Click here for video</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(data.table)
myDF &lt;-<span class="st"> </span><span class="kw">fread</span>(<span class="st">&quot;/class/datamine/data/election/itcont2016.txt&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;|&quot;</span>)
<span class="kw">head</span>(myDF)</code></pre></div>
<p><code>sum</code> the amounts of all contributions made, grouped according to the <code>STATE</code> where the people lived</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sort</span>(<span class="kw">tapply</span>(myDF<span class="op">$</span>TRANSACTION_AMT, myDF<span class="op">$</span>STATE, sum))</code></pre></div>
<p><code>sum</code> the amounts of all contributions made, grouped according to the <code>CITY</code>/<code>STATE</code> where the people lived</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tail</span>(<span class="kw">sort</span>(<span class="kw">tapply</span>(myDF<span class="op">$</span>TRANSACTION_AMT, <span class="kw">paste</span>(myDF<span class="op">$</span>CITY, myDF<span class="op">$</span>STATE), sum)),<span class="dt">n=</span><span class="dv">20</span>)
mylocations &lt;-<span class="st">  </span><span class="kw">paste</span>(myDF<span class="op">$</span>CITY, myDF<span class="op">$</span>STATE)
<span class="kw">tail</span>(<span class="kw">sort</span>(<span class="kw">tapply</span>(myDF<span class="op">$</span>TRANSACTION_AMT, mylocations, sum)),<span class="dt">n=</span><span class="dv">20</span>)</code></pre></div>
<p><code>sum</code> the amounts of all contributions made, grouped according to the <code>EMPLOYER</code> where the people worked</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tail</span>(<span class="kw">sort</span>(<span class="kw">tapply</span>(myDF<span class="op">$</span>TRANSACTION_AMT, myDF<span class="op">$</span>EMPLOYER, sum)), <span class="dt">n=</span><span class="dv">30</span>)</code></pre></div>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_in1zeba2&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_qsx7vd9y">Click here for video</a></p>
<p><strong>Motivation:</strong> <code>tapply</code> is a powerful function that allows us to group data, and perform calculations on that data in bulk. The &quot;apply suite&quot; of functions provide a fast way of performing operations that would normally require the use of loops. Typically, when writing R code, you will want to use an &quot;apply suite&quot; function rather than a for loop.</p>
<p><strong>Context:</strong> The past couple of projects have studied the use of loops and/or vectorized operations. In this project, we will introduce a function called <code>tapply</code> from the &quot;apply suite&quot; of functions in R.</p>
<p><strong>Scope:</strong> r, for, tapply</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Explain what &quot;recycling&quot; is in R and predict behavior of provided statements.
</li>
<li>
Explain and demonstrate how R handles missing data: NA, NaN, NULL, etc.
</li>
<li>
Demonstrate the ability to use the following functions to solve data-driven problem(s): mean, var, table, cut, paste, rep, seq, sort, order, length, unique, etc.
</li>
<li>
Read and write basic (csv) data.
</li>
<li>
Explain and demonstrate: positional, named, and logical indexing.
</li>
<li>
List the differences between lists, vectors, factors, and data.frames, and when to use each.
</li>
<li>
Demonstrate a working knowledge of control flow in r: if/else statements, while loops, etc.
</li>
<li>
Demonstrate how apply functions are generally faster than using loops.
</li>
</ul>
</div>
<div id="dataset-5" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/fars/7581.csv</code></p>
</div>
<div id="questions-5" class="section level4">
<h4>Questions</h4>
<p><strong>Important note:</strong> Please make sure to <strong>double check</strong> that the your submission does indeed contain the files you think it does. You can do this by downloading your submission from Gradescope after uploading. If you can see all of your files and they open up properly on your computer, you should be good to go.</p>
<p><strong>Important note:</strong> Please make sure to look at your knit PDF <em>before</em> submitting. PDFs should be relatively short and not contain huge amounts of printed data. Remember you can use functions like <code>head</code> to print a sample of the data or output. Extremely large PDFs will be subject to lose points.</p>
<div id="the-dataset-classdataminedatafars7581.csv-contains-the-combined-accident-records-from-year-1975-to-1981.-load-up-the-dataset-into-a-data.frame-named-dat.-in-the-previous-projects-question-4-we-asked-you-to-calculate-the-mean-number-of-motorists-involved-in-an-accident-variable-person-with-i-drunk-drivers-where-i-takes-the-values-from-0-through-6.-this-time-solve-this-question-using-the-tapply-function-instead.-which-method-did-you-prefer-and-why" class="section level5">
<h5>1. The dataset, <code>/class/datamine/data/fars/7581.csv</code> contains the combined accident records from year 1975 to 1981. Load up the dataset into a data.frame named <code>dat</code>. In the previous project's question 4, we asked you to calculate the mean number of motorists involved in an accident (variable <code>PERSON</code>) with i drunk drivers where i takes the values from 0 through 6. This time, solve this question using the <code>tapply</code> function instead. Which method did you prefer and why?</h5>
</div>
<div id="now-that-youve-read-the-data-into-a-dataframe-named-dat-run-the-following-code" class="section level5">
<h5>Now that you've read the data into a dataframe named <code>dat</code>, run the following code:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Read in data that maps state codes to state names</span>
state_names &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/fars/states.csv&quot;</span>)

<span class="co"># Create a vector of state names called v</span>
v &lt;-<span class="st"> </span>state_names<span class="op">$</span>state

<span class="co"># Set the names of the new vector to the codes</span>
<span class="kw">names</span>(v) &lt;-<span class="st"> </span>state_names<span class="op">$</span>code

<span class="co"># Create a new column in the dat dataframe with the actual names of the states</span>
dat<span class="op">$</span>mystates &lt;-<span class="st"> </span>v[<span class="kw">as.character</span>(dat<span class="op">$</span>STATE)]</code></pre></div>
<p><strong>Relevant topics:</strong> <a href="r.html#r-tapply">tapply</a>, <a href="r.html#r-mean">mean</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The output/solution.
</li>
</ul>
</div>
</div>
<div id="solution-29" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/fars/7581.csv&quot;</span>)
state_names &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/fars/states.csv&quot;</span>)
v &lt;-<span class="st"> </span>state_names<span class="op">$</span>state
<span class="kw">names</span>(v) &lt;-<span class="st"> </span>state_names<span class="op">$</span>code
dat<span class="op">$</span>mystates &lt;-<span class="st"> </span>v[<span class="kw">as.character</span>(dat<span class="op">$</span>STATE)]
<span class="kw">tapply</span>(dat<span class="op">$</span>PERSONS, dat<span class="op">$</span>DRUNK_DR, mean, <span class="dt">na.rm=</span>T)</code></pre></div>
</div>
<div id="make-a-state-by-state-classification-of-the-average-number-of-drunk-drivers-in-an-accident.-which-state-has-the-highest-average-number-of-drunk-drivers-per-accident" class="section level5">
<h5>2. Make a state-by-state classification of the average number of drunk drivers in an accident. Which state has the highest average number of drunk drivers per accident?</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-tapply">tapply</a>, <a href="r.html#r-mean">mean</a>, <a href="#r-sort">sort</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The entire output.
</li>
<li>
Which state has the highest average number of drunk drivers per accident?
</li>
</ul>
</div>
</div>
<div id="solution-30" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">st &lt;-<span class="st"> </span><span class="kw">tapply</span>(dat<span class="op">$</span>DRUNK_DR, dat<span class="op">$</span>mystates, mean, <span class="dt">na.rm=</span>T)
st[<span class="kw">which.max</span>(st)]

<span class="co"># or</span>

<span class="kw">sort</span>(<span class="kw">tapply</span>(dat<span class="op">$</span>DRUNK_DR, dat<span class="op">$</span>mystates, mean, <span class="dt">na.rm=</span>T), <span class="dt">decreasing=</span>T)</code></pre></div>
</div>
<div id="add-up-the-total-number-of-fatalities-according-to-the-day-of-the-week-on-which-they-occurred.-are-the-numbers-surprising-to-you-what-days-of-the-week-have-a-higher-number-of-fatalities-if-instead-you-calculate-the-proportion-of-fatalities-over-the-total-number-of-people-in-the-accidents-what-would-you-expect-calculate-it-and-see-if-your-expectations-match." class="section level5">
<h5>3. Add up the total number of fatalities, according to the day of the week on which they occurred. Are the numbers surprising to you? What days of the week have a higher number of fatalities? If instead you calculate the proportion of fatalities over the total number of people in the accidents, what would you expect? Calculate it and see if your expectations match.</h5>
<p><strong>Hint:</strong> Sundays through Saturdays are days 1 through 7, respectively. Day 9 indicates that the day is unknown.</p>
<p>This video example uses the Amazon fine food reviews dataset to make a similar calculation, in which we have two tapply statements, and we divide the results to get a ton of similar ratios all at once. Powerful stuff! It may guide you in your thinking about this question.</p>
<p>Code from the example: <a href="r.html#r-Amazon-tapply-example">double tapply examples</a></p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_24jmfygn&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_3bp1m0a5">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-tapply">tapply</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
What days have the highest number of fatalities?
</li>
<li>
What would you expect if you calculate the proportion of fatalities over the total number of people in the accidents?
</li>
</ul>
</div>
</div>
<div id="solution-31" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sort</span>(<span class="kw">tapply</span>(dat<span class="op">$</span>FATALS, dat<span class="op">$</span>DAY_WEEK, sum))
<span class="kw">sort</span>(<span class="kw">tapply</span>(dat<span class="op">$</span>FATALS, dat<span class="op">$</span>DAY_WEEK, sum)<span class="op">/</span><span class="kw">tapply</span>(dat<span class="op">$</span>PERSONS, dat<span class="op">$</span>DAY_WEEK, sum))</code></pre></div>
</div>
<div id="how-many-drunk-drivers-are-involved-on-average-in-crashes-that-occur-on-straight-roads-how-many-drunk-drivers-are-involved-on-average-in-crashes-that-occur-on-curved-roads-solve-the-pair-of-questions-in-a-single-line-of-r-code." class="section level5">
<h5>4. How many drunk drivers are involved, on average, in crashes that occur on straight roads? How many drunk drivers are involved, on average, in crashes that occur on curved roads? Solve the pair of questions in a single line of R code.</h5>
<p><strong>Hint:</strong> The <code>ALIGNMNT</code> variable is 1 for straight, 2 for curved, and 9 for unknown.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-tapply">tapply</a>, <a href="r.html#r-sum">sum</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Results from running the R code.
</li>
</ul>
</div>
</div>
<div id="solution-32" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(dat<span class="op">$</span>DRUNK_DR, dat<span class="op">$</span>ALIGNMNT, mean, <span class="dt">na.rm=</span>T)</code></pre></div>
</div>
<div id="break-the-day-into-portions-as-follows-midnight-to-6am-6am-to-12-noon-12-noon-to-6pm-6pm-to-midnight-other.-find-the-total-number-of-fatalities-that-occur-during-each-of-these-time-intervals.-also-find-the-average-number-of-fatalities-per-crash-that-occurs-during-each-of-these-time-intervals." class="section level5">
<h5>5. Break the day into portions, as follows: midnight to 6AM, 6AM to 12 noon, 12 noon to 6PM, 6PM to midnight, other. Find the total number of fatalities that occur during each of these time intervals. Also, find the average number of fatalities per crash that occurs during each of these time intervals.</h5>
<p>This example demonstrates a comparable calculation. In the video, I used the total number of people in the accident, and your question is (instead) about the number of fatalities, but this is essentially the only difference. I hope it helps to explain the way that the cut function works, along with the analogous breaks.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_pjbc24vt&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_0paky6vm">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-tapply">tapply</a>, <a href="r.html#r-cut">cut</a>, <a href="r.html#r-sum">sum</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Results from running the R code.
</li>
</ul>
</div>
</div>
<div id="solution-33" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(dat<span class="op">$</span>FATALS, <span class="kw">cut</span>(dat<span class="op">$</span>HOUR, <span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">6</span>,<span class="dv">12</span>,<span class="dv">18</span>,<span class="dv">24</span>,<span class="dv">99</span>), <span class="dt">include.lowest=</span>T), sum)</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p07-190" class="section level3">
<h3>Project 7</h3>
<hr />
<p><strong>Motivation:</strong> Three bread-and-butter functions that are a part of the base R are: <code>subset</code>, <code>merge</code>, and <code>split</code>. <code>subset</code> provides a more natural way to filter and select data from a data.frame. <code>split</code> is a useful function that splits a dataset based on one or more factors. <code>merge</code> brings the principals of combining data that SQL uses, to R.</p>
<p><strong>Context:</strong> We've been getting comfortable working with data in within the R environment. Now we are going to expand our toolset with three useful functions, all the while gaining experience and practice wrangling data!</p>
<p><strong>Scope:</strong> r, subset, merge, split, tapply</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Gain proficiency using split, merge, and subset.
</li>
<li>
Demonstrate the ability to use the following functions to solve data-driven problem(s): mean, var, table, cut, paste, rep, seq, sort, order, length, unique, etc.
</li>
<li>
Read and write basic (csv) data.
</li>
<li>
Explain and demonstrate: positional, named, and logical indexing.
</li>
<li>
Demonstrate how to use tapply to solve data-driven problems.
</li>
</ul>
</div>
<div id="dataset-6" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/goodreads/csv</code></p>
</div>
<div id="questions-6" class="section level4">
<h4>Questions</h4>
<p><strong>Important note:</strong> Please make sure to <strong>double check</strong> that the your submission does indeed contain the files you think it does. You can do this by downloading your submission from Gradescope after uploading. If you can see all of your files and they open up properly on your computer, you should be good to go.</p>
<p><strong>Important note:</strong> Please make sure to look at your knit PDF <em>before</em> submitting. PDFs should be relatively short and not contain huge amounts of printed data. Remember you can use functions like <code>head</code> to print a sample of the data or output. Extremely large PDFs will be subject to lose points.</p>
<div id="load-up-the-following-two-datasets-goodreads_books.csv-and-goodreads_book_authors.csvinto-two-data.frames-books-and-authors-respectively.-how-many-columns-and-rows-are-in-each-of-these-two-datasets" class="section level5">
<h5>1. Load up the following two datasets <code>goodreads_books.csv</code> and <code>goodreads_book_authors.csv</code>into two data.frames <code>books</code>, and <code>authors</code>, respectively. How many columns and rows are in each of these two datasets?</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-read">read.csv</a>, <a href="r.html#r-dim">dim</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The result of running the R code.
</li>
</ul>
</div>
</div>
<div id="solution-34" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">books &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/goodreads/csv/books_sample.csv&quot;</span>)
authors &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/goodreads/csv/goodreads_book_authors.csv&quot;</span>)

<span class="kw">dim</span>(books)
<span class="kw">dim</span>(authors)

<span class="co"># or</span>

<span class="kw">str</span>(books)
<span class="kw">str</span>(authors)</code></pre></div>
</div>
<div id="we-want-to-figure-out-how-book-size-num_pages-is-associated-with-various-metrics.-first-lets-create-a-vector-called-book_size-that-categorizes-books-into-4-categories-based-on-num_pages-small-up-to-250-pages-medium-250-500-pages-large-500-1000-pages-huge-1000-pages." class="section level5">
<h5>2. We want to figure out how book size (<code>num_pages</code>) is associated with various metrics. First, let's create a vector called <code>book_size</code>, that categorizes books into 4 categories based on <code>num_pages</code>: <code>small</code> (up to 250 pages), <code>medium</code> (250-500 pages), <code>large</code> (500-1000 pages), <code>huge</code> (1000+ pages).</h5>
<p><strong>Note:</strong> This <a href="r.html#r-lapply-flight-example">video and code</a> might be helpful.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#cut">cut</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The result of <code>table(book_size)</code>.
</li>
</ul>
</div>
</div>
<div id="solution-35" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">book_size &lt;-<span class="st"> </span><span class="kw">cut</span>(books<span class="op">$</span>num_pages, <span class="dt">breaks=</span><span class="kw">c</span>(<span class="op">-</span><span class="ot">Inf</span>, <span class="dv">250</span>, <span class="dv">500</span>, <span class="dv">1000</span>, <span class="ot">Inf</span>), <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;small&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;large&quot;</span>, <span class="st">&quot;huge&quot;</span>))
<span class="kw">table</span>(book_size)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(books<span class="op">$</span>num_pages)

<span class="co"># We can split each element into categories,</span>
<span class="co"># based on how num_pages compares to 0, 250, 500, 1000, </span>
<span class="co"># and a huge number (say, 50000000, or Inf for infinity)</span>
<span class="kw">head</span>(<span class="kw">cut</span>(books<span class="op">$</span>num_pages, <span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">250</span>,<span class="dv">500</span>,<span class="dv">1000</span>,<span class="dv">50000000</span>),<span class="dt">include.lowest=</span>T))

<span class="co"># Or like this:</span>
<span class="kw">head</span>(<span class="kw">cut</span>(books<span class="op">$</span>num_pages, <span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">250</span>,<span class="dv">500</span>,<span class="dv">1000</span>,<span class="ot">Inf</span>),<span class="dt">include.lowest=</span>T))

<span class="co"># It is worthwhile to make sure that we included every book.  </span>
<span class="co"># For instance, if you do not use include.lowest=T, then we </span>
<span class="co"># will miss the pages that are exactly equal to 0.</span>
<span class="co"># Or if you do not use a big enough number on the right hand side,</span>
<span class="co"># then you will miss the very long pages.</span>
<span class="co"># We know, from question 1, that we should have 1000000 books</span>
<span class="co"># and we can verify that we got them all here:</span>
<span class="kw">table</span>( <span class="kw">cut</span>(books<span class="op">$</span>num_pages, <span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">250</span>,<span class="dv">500</span>,<span class="dv">1000</span>,<span class="ot">Inf</span>),<span class="dt">include.lowest=</span>T), <span class="dt">useNA=</span><span class="st">&quot;always&quot;</span> )
<span class="kw">sum</span>(<span class="kw">table</span>( <span class="kw">cut</span>(books<span class="op">$</span>num_pages, <span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">250</span>,<span class="dv">500</span>,<span class="dv">1000</span>,<span class="ot">Inf</span>),<span class="dt">include.lowest=</span>T), <span class="dt">useNA=</span><span class="st">&quot;always&quot;</span> ))

<span class="co"># Now we create the book_size vector:</span>
book_size &lt;-<span class="st"> </span><span class="kw">cut</span>(books<span class="op">$</span>num_pages, <span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">250</span>,<span class="dv">500</span>,<span class="dv">1000</span>,<span class="ot">Inf</span>), <span class="dt">include.lowest=</span>T)

<span class="co"># and we can check that the first several entries look reasonable.</span>
<span class="kw">head</span>(book_size)</code></pre></div>
</div>
<div id="use-tapply-to-calculate-the-mean-average_rating-text_reviews_count-and-publication_year-by-book_size.-did-any-of-the-result-surprise-you-why-or-why-not" class="section level5">
<h5>3. Use <code>tapply</code> to calculate the mean <code>average_rating</code>, <code>text_reviews_count</code>, and <code>publication_year</code> by <code>book_size</code>. Did any of the result surprise you? Why or why not?</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-tapply">tapply</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The output from running the R code.
</li>
</ul>
</div>
</div>
<div id="solution-36" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(books<span class="op">$</span>average_rating, book_size, mean, <span class="dt">na.rm=</span>T)
<span class="kw">tapply</span>(books<span class="op">$</span>text_reviews_count, book_size, mean, <span class="dt">na.rm=</span>T)
<span class="kw">tapply</span>(books<span class="op">$</span>publication_year, book_size, mean, <span class="dt">na.rm=</span>T)
<span class="co"># It might be surprising, for instance, that longer books get </span>
<span class="co"># more reviews and higher reviews. Answers to this part of the </span>
<span class="co"># question will vary.</span></code></pre></div>
</div>
<div id="notice-in-3-how-we-used-tapply-3-times.-this-would-get-burdensome-if-we-decided-to-calculate-4-or-5-or-6-columns-instead.-instead-of-using-tapply-we-can-use-split-lapply-and-colmeans-to-perform-the-same-calculations." class="section level5">
<h5>4. Notice in (3) how we used <code>tapply</code> 3 times. This would get burdensome if we decided to calculate 4 or 5 or 6 columns instead. Instead of using tapply, we can use <code>split</code>, <code>lapply</code>, and <code>colMeans</code> to perform the same calculations.</h5>
</div>
<div id="use-split-to-partition-the-data-containing-only-the-following-3-columns-average_rating-text_reviews_count-and-publication_year-by-book_size.-save-the-result-as-books_by_size.-what-class-is-the-result-lapply-is-a-function-that-allows-you-to-loop-over-each-item-in-a-list-and-apply-a-function.-use-lapply-and-colmeans-to-perform-the-same-calculation-as-in-3." class="section level5">
<h5>Use <code>split</code> to partition the data containing only the following 3 columns: <code>average_rating</code>, <code>text_reviews_count</code>, and <code>publication_year</code>, by <code>book_size</code>. Save the result as <code>books_by_size</code>. What class is the result? <code>lapply</code> is a function that allows you to loop over each item in a list and apply a function. Use <code>lapply</code> and <code>colMeans</code> to perform the same calculation as in (3).</h5>
<p><strong>Note:</strong> This <a href="r.html#r-lapply-flight-example">video and code</a> and also this <a href="r.html#r-lapply-fars-example">video and code</a> might be helpful.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-lapply">lapply</a>, <a href="r.html#r-writing-functions">split</a>, <a href="r.html#r-means">colMeans</a>, <a href="r.html#r-indexing">indexing</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The output from running the code.
</li>
</ul>
</div>
</div>
<div id="solution-37" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">books_by_size &lt;-<span class="st"> </span><span class="kw">split</span>(books[,<span class="kw">c</span>(<span class="st">&#39;text_reviews_count&#39;</span>,<span class="st">&#39;average_rating&#39;</span>,<span class="st">&#39;publication_year&#39;</span>)], book_size)
<span class="kw">lapply</span>(books_by_size, colMeans, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># We can build a temporarily data frame that has the 3 desired variables:</span>
<span class="kw">head</span>(<span class="kw">data.frame</span>(books<span class="op">$</span>average_rating, books<span class="op">$</span>text_reviews_count, books<span class="op">$</span>publication_year))

<span class="co"># and split it according to the book_size.</span>
<span class="co"># We get a list of length 4 as a result:</span>
books_by_size &lt;-<span class="st"> </span><span class="kw">split</span>(<span class="kw">data.frame</span>(books<span class="op">$</span>average_rating, books<span class="op">$</span>text_reviews_count, books<span class="op">$</span>publication_year), book_size)
<span class="kw">class</span>(books_by_size)
<span class="kw">length</span>(books_by_size)
<span class="kw">str</span>(books_by_size)

<span class="co"># and then we can take the colMeans of each of these 4 parts of the list:</span>
<span class="kw">lapply</span>(books_by_size, colMeans, <span class="dt">na.rm=</span>T)

<span class="co"># and the results agree with the results from question 3.</span></code></pre></div>
</div>
<div id="we-are-working-with-a-lot-more-data-than-we-really-want-right-now.-weve-provided-you-with-the-following-code-to-filter-out-non-english-books-and-only-keep-columns-of-interest.-this-will-create-a-data-frame-called-en_books." class="section level5">
<h5>5. We are working with a lot more data than we really want right now. We've provided you with the following code to filter out non-English books and only keep columns of interest. This will create a data frame called <code>en_books</code>.</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">en_books &lt;-<span class="st"> </span>books[books<span class="op">$</span>language_code <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;en-US&quot;</span>, <span class="st">&quot;en-CA&quot;</span>, <span class="st">&quot;en-GB&quot;</span>, <span class="st">&quot;eng&quot;</span>, <span class="st">&quot;en&quot;</span>, <span class="st">&quot;en-IN&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>books<span class="op">$</span>publication_year <span class="op">&gt;</span><span class="st"> </span><span class="dv">2000</span>, <span class="kw">c</span>(<span class="st">&quot;author_id&quot;</span>, <span class="st">&quot;book_id&quot;</span>, <span class="st">&quot;average_rating&quot;</span>, <span class="st">&quot;description&quot;</span>, <span class="st">&quot;title&quot;</span>, <span class="st">&quot;ratings_count&quot;</span>, <span class="st">&quot;language_code&quot;</span>, <span class="st">&quot;publication_year&quot;</span>)]</code></pre></div>
<p>Now create an equivalent data frame of your own, by using the <code>subset</code> function (instead of indexing). Use <code>res</code> as the name of the data frame that you create. Do the dimensions (using <code>dim</code>) of <code>en_books</code> and <code>res</code> agree? Why or why not? (They should both have 8 columns, but a different number of rows.)</p>
<p><strong>Hint:</strong> Since the dimensions don't match, take a look at NA values for the variables used to subset our data.</p>
<p><strong>Note:</strong> This <a href="r.html#r-subset-8451-example">video and code</a> and also this <a href="r.html#r-subset-election-example">video and code</a> might be helpful.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-indexing">indexing</a>, <a href="r.html#r-subset">subset</a>, <a href="r.html#r-na">NA</a>, <a href="r.html#r-in">%in%</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Do the dimensions match?
</li>
<li>
1-2 sentences explaining why or why not.
</li>
</ul>
</div>
</div>
<div id="solution-38" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">en_books_subset &lt;-<span class="st"> </span><span class="kw">subset</span>(books, language_code <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;en-US&quot;</span>, <span class="st">&quot;en-CA&quot;</span>, <span class="st">&quot;en-GB&quot;</span>, <span class="st">&quot;eng&quot;</span>, <span class="st">&quot;en&quot;</span>, <span class="st">&quot;en-IN&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>publication_year <span class="op">&gt;</span><span class="st"> </span><span class="dv">2000</span>, <span class="dt">select=</span><span class="kw">c</span>(author_id, book_id, average_rating,description, title, ratings_count, language_code, publication_year))


en_books &lt;-<span class="st"> </span>books[books<span class="op">$</span>language_code <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;en-US&quot;</span>, <span class="st">&quot;en-CA&quot;</span>, <span class="st">&quot;en-GB&quot;</span>, <span class="st">&quot;eng&quot;</span>, <span class="st">&quot;en&quot;</span>, <span class="st">&quot;en-IN&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>books<span class="op">$</span>publication_year <span class="op">&gt;</span><span class="st"> </span><span class="dv">2000</span>, <span class="kw">c</span>(<span class="st">&quot;author_id&quot;</span>, <span class="st">&quot;book_id&quot;</span>, <span class="st">&quot;average_rating&quot;</span>, <span class="st">&quot;description&quot;</span>, <span class="st">&quot;title&quot;</span>, <span class="st">&quot;ratings_count&quot;</span>, <span class="st">&quot;language_code&quot;</span>, <span class="st">&quot;publication_year&quot;</span>)]

<span class="kw">dim</span>(en_books)
<span class="kw">dim</span>(en_books_subset)

<span class="kw">sum</span>(<span class="kw">is.na</span>(en_books_subset<span class="op">$</span>language_code))
<span class="kw">sum</span>(<span class="kw">is.na</span>(en_books<span class="op">$</span>language_code))

<span class="co"># you can see that without the NAs the results are the same</span>
<span class="kw">all.equal</span>(en_books_subset, en_books[<span class="op">!</span><span class="kw">is.na</span>(en_books<span class="op">$</span>language_code),], <span class="dt">check.attributes=</span>F)

<span class="co"># subset is automatically removing NAs</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">en_books &lt;-<span class="st"> </span>books[books<span class="op">$</span>language_code <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;en-US&quot;</span>, <span class="st">&quot;en-CA&quot;</span>, <span class="st">&quot;en-GB&quot;</span>, <span class="st">&quot;eng&quot;</span>, <span class="st">&quot;en&quot;</span>, <span class="st">&quot;en-IN&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>books<span class="op">$</span>publication_year <span class="op">&gt;</span><span class="st"> </span><span class="dv">2000</span>, <span class="kw">c</span>(<span class="st">&quot;author_id&quot;</span>, <span class="st">&quot;book_id&quot;</span>, <span class="st">&quot;average_rating&quot;</span>, <span class="st">&quot;description&quot;</span>, <span class="st">&quot;title&quot;</span>, <span class="st">&quot;ratings_count&quot;</span>, <span class="st">&quot;language_code&quot;</span>, <span class="st">&quot;publication_year&quot;</span>)]

<span class="co"># We build a new data frame called res that takes a subset</span>
<span class="co"># of the data frame books that meet the two given conditions </span>
<span class="co"># on language_code and publication_year and that contains the 8 </span>
<span class="co"># desired columns.</span>
res &lt;-<span class="st"> </span><span class="kw">subset</span>(books, <span class="dt">subset=</span>language_code <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;en-US&quot;</span>, <span class="st">&quot;en-CA&quot;</span>, <span class="st">&quot;en-GB&quot;</span>, <span class="st">&quot;eng&quot;</span>, <span class="st">&quot;en&quot;</span>, <span class="st">&quot;en-IN&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>publication_year <span class="op">&gt;</span><span class="st"> </span><span class="dv">2000</span>, <span class="dt">select=</span><span class="kw">c</span>(<span class="st">&quot;author_id&quot;</span>, <span class="st">&quot;book_id&quot;</span>, <span class="st">&quot;average_rating&quot;</span>, <span class="st">&quot;description&quot;</span>, <span class="st">&quot;title&quot;</span>, <span class="st">&quot;ratings_count&quot;</span>, <span class="st">&quot;language_code&quot;</span>, <span class="st">&quot;publication_year&quot;</span>))
<span class="kw">class</span>(res)
<span class="kw">dim</span>(res)

<span class="co"># This data frame is smaller.</span>
<span class="co"># The earlier data frame has some rows with missing information,</span>
<span class="co"># which are not included here.</span>
<span class="co"># (We might want to give examples/details about what is missing.)</span></code></pre></div>
</div>
<div id="we-now-have-a-nice-and-tidy-subset-of-data-called-res.-it-would-be-really-nice-to-get-some-information-on-the-authors.-we-can-find-that-information-in-authors-dataset-loaded-in-question-1-in-question-2-of-the-previous-project-we-had-a-similar-issue-with-the-states-names.-there-is-a-much-better-and-easier-way-to-solve-these-types-of-problems.-use-the-merge-function-to-combine-res-and-authors-in-a-way-which-appends-all-information-from-author-when-there-is-a-match-in-res.-use-the-condition-byauthor_id-in-the-merge.-this-is-all-you-need-to-do" class="section level5">
<h5>6. We now have a nice and tidy subset of data, called <code>res</code>. It would be really nice to get some information on the authors. We can find that information in <code>authors</code> dataset loaded in question 1! In question 2 of the previous project, we had a similar issue with the states names. There is a <em>much</em> better and easier way to solve these types of problems. Use the <code>merge</code> function to combine <code>res</code> and <code>authors</code> in a way which appends all information from <code>author</code> when there is a match in <code>res</code>. Use the condition <code>by=&quot;author_id&quot;</code> in the merge. This is all you need to do:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mymergedDF &lt;-<span class="st"> </span><span class="kw">merge</span>(res, authors, <span class="dt">by=</span><span class="st">&quot;author_id&quot;</span>)</code></pre></div>
<p><strong>Note:</strong> The resulting data frame will have all of the columns that are found in either <code>res</code> or <code>authors</code>. When we perform the merge, we only insist that the <code>author_id</code> should match. We do not expect that the <code>ratings_count</code> or <code>average_rating</code> should agree in <code>res</code> versus <code>authors</code>. Why? In the <code>res</code> data frame, the <code>ratings_count</code> and <code>average_rating</code> refer to the specific book, but in the <code>authors</code> data frame, the <code>ratings_count</code> and <code>average_rating</code> refer to the total works by the author. Therefore, in <code>mymergedDF</code>, there are columns <code>ratings_count.x</code> and <code>average_rating.x</code> from <code>res</code>, and there are columns <code>ratings_count.y</code> and <code>average_rating.y</code> from <code>authors</code>.</p>
<p><strong>Note:</strong> Although we provided the necessary code for this example, you might want to know more about the merge function. This <a href="r.html#r-merge-fars-example">video and code</a> and also this <a href="r.html#r-merge-flights-example">video and code</a> might be helpful.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-merge">merge</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
the given R code used to solve the problem.
</li>
<li>
The <code>dim</code> of the newly merged data.frame.
</li>
</ul>
</div>
</div>
<div id="solution-39" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res &lt;-<span class="st"> </span><span class="kw">merge</span>(books, authors, <span class="dt">by=</span><span class="st">&quot;author_id&quot;</span>)
<span class="kw">dim</span>(res)</code></pre></div>
</div>
<div id="for-an-author-of-your-choice-that-is-in-the-dataset-find-the-authors-highest-rated-book.-do-you-agree" class="section level5">
<h5>7. For an author of your choice (that <em>is</em> in the dataset), find the author's highest rated book. Do you agree?</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-indexing">indexing</a>, <a href="r.html#r-subset">subset</a>, <a href="r.html#r-which">which</a>, <a href="r.html#r-max">max</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The title of the highest rated book (from your author).
</li>
<li>
1-2 sentences explaining why or why not you agree with it being the highest rated book from that author.
</li>
</ul>
</div>
</div>
<div id="solution-40" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brandons_books &lt;-<span class="st"> </span>res[res<span class="op">$</span>name<span class="op">==</span><span class="st">&quot;Brandon Sanderson&quot;</span>,]
brandons_books[<span class="kw">which.max</span>(brandons_books<span class="op">$</span>average_rating_books),]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myDF &lt;-<span class="st"> </span><span class="kw">merge</span>(res, authors, <span class="dt">by=</span><span class="st">&quot;author_id&quot;</span>)

<span class="co"># Here are the books by author Sandra Cisneros:</span>
myfavoriteDF &lt;-<span class="st"> </span>myDF[myDF<span class="op">$</span>name<span class="op">==</span><span class="st">&quot;Sandra Cisneros&quot;</span>, ]
myfavoriteDF

<span class="co"># Her highest rated book has the rating 4.23:</span>
<span class="kw">max</span>(myfavoriteDF<span class="op">$</span>average_rating.x)

<span class="co"># It is called &quot;A House of My Own: Stories from My Life&quot;:</span>
myfavoriteDF[<span class="kw">which.max</span>(myfavoriteDF<span class="op">$</span>average_rating.x), ]<span class="op">$</span>title</code></pre></div>
</div>
<div id="optional-question.-look-at-the-column-names-of-the-new-dataframe-created-in-question-6.-notice-that-there-are-two-values-for-ratings_count-and-two-values-for-average_rating.-the-names-that-have-an-appended-x-are-those-values-from-the-first-argument-to-merge-and-the-names-that-have-an-appended-y-are-those-values-from-the-second-argument-to-merge.-rename-these-columns-to-indicate-if-they-refer-to-a-book-or-an-author." class="section level5">
<h5>OPTIONAL QUESTION. Look at the column names of the new dataframe created in question 6. Notice that there are two values for <code>ratings_count</code> and two values for <code>average_rating</code>. The names that have an appended <code>x</code> are those values from the first argument to <code>merge</code>, and the names that have an appended <code>y</code>, are those values from the second argument to <code>merge</code>. Rename these columns to indicate if they refer to a book, or an author.</h5>
<p><strong>Hint:</strong> For example, <code>ratings_count.x</code> could be <code>ratings_count_book</code> or <code>ratings_count_author</code>.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-names">names</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The <code>names</code> of the new data.frame.
</li>
</ul>
</div>
</div>
<div id="solution-41" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res &lt;-<span class="st"> </span><span class="kw">merge</span>(books, authors, <span class="dt">by=</span><span class="st">&quot;author_id&quot;</span>)

<span class="co"># rename columns</span>
<span class="kw">names</span>(res) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">.x&quot;</span>, <span class="st">&quot;_books&quot;</span>, <span class="kw">names</span>(res))
<span class="kw">names</span>(res) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">.y&quot;</span>, <span class="st">&quot;_author&quot;</span>, <span class="kw">names</span>(res))

<span class="kw">dim</span>(res)</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p08-190" class="section level3">
<h3>Project 8</h3>
<hr />
<p><strong>Motivation:</strong> A key component to writing efficient code is writing functions. Functions allow us to repeat and reuse coding steps that we used previously, over and over again. If you find you are repeating code over and over, a function may be a good way to reduce lots of lines of code!</p>
<p><strong>Context:</strong> We've been learning about and using functions all year! Now we are going to learn more about some of the terminology and components of a function, as you will certainly need to be able to write your own functions soon.</p>
<p><strong>Scope:</strong> r, functions</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Gain proficiency using split, merge, and subset.
</li>
<li>
Demonstrate the ability to use the following functions to solve data-driven problem(s): mean, var, table, cut, paste, rep, seq, sort, order, length, unique, etc.
</li>
<li>
Read and write basic (csv) data.
</li>
<li>
Explain and demonstrate: positional, named, and logical indexing.
</li>
<li>
Demonstrate how to use tapply to solve data-driven problems.
</li>
<li>
Comprehend what a function is, and the components of a function in R.
</li>
</ul>
</div>
<div id="dataset-7" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/goodreads/csv</code></p>
</div>
<div id="questions-7" class="section level4">
<h4>Questions</h4>
<p><strong>Important note:</strong> Please make sure to <strong>double check</strong> that the your submission does indeed contain the files you think it does. You can do this by downloading your submission from Gradescope after uploading. If you can see all of your files and they open up properly on your computer, you should be good to go.</p>
<p><strong>Important note:</strong> Please make sure to look at your knit PDF <em>before</em> submitting. PDFs should be relatively short and not contain huge amounts of printed data. Remember you can use functions like <code>head</code> to print a sample of the data or output. Extremely large PDFs will be subject to lose points.</p>
<div id="read-in-the-same-data-in-the-same-way-as-the-previous-project-with-the-same-names.-weve-provided-you-with-the-function-below.-how-many-arguments-does-the-function-have-name-all-of-the-arguments.-what-is-the-name-of-the-function-replace-the-description-column-in-our-books-data.frame-with-the-same-information-but-with-stripped-punctuation-using-the-function-provided." class="section level5">
<h5>1. Read in the same data, in the same way as the previous project (with the same names). We've provided you with the function below. How many arguments does the function have? Name all of the arguments. What is the name of the function? Replace the <code>description</code> column in our <code>books</code> data.frame with the same information, but with stripped punctuation using the function provided.</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># A function that, given a string (myColumn), returns the string</span>
<span class="co"># without any punctuation.</span>
strip_punctuation &lt;-<span class="st"> </span><span class="cf">function</span>(myColumn) {
    <span class="co"># Use regular expressions to identify punctuation.</span>
    <span class="co"># Replace identified punctuation with an empty string &#39;&#39;.</span>
    desc_no_punc &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;[[:punct:]]+&#39;</span>, <span class="st">&#39;&#39;</span>, myColumn)
    
    <span class="co"># Return the result</span>
    <span class="kw">return</span>(desc_no_punc)
}</code></pre></div>
<p><strong>Hint:</strong> Since <code>gsub</code> accepts a vector of values, you can pass an entire vector to <code>strip_punctuation</code>.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-writing-functions">functions</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
How many arguments does the function have?
</li>
<li>
What are the name(s) of all of the arguments?
</li>
<li>
What is the name of the function?
</li>
</ul>
</div>
</div>
<div id="solution-42" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The function has 1 argument called &quot;myColumn&quot;</span>
<span class="co"># The name of the function is &quot;strip_punctuation&quot;</span>
books<span class="op">$</span>description &lt;-<span class="st"> </span><span class="kw">strip_punctuation</span>(books<span class="op">$</span>description)</code></pre></div>
</div>
<div id="use-the-strsplit-function-to-split-a-string-by-spaces.-some-examples-would-be" class="section level5">
<h5>2. Use the <code>strsplit</code> function to split a string by spaces. Some examples would be:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">strsplit</span>(<span class="st">&quot;This will split by space.&quot;</span>, <span class="st">&quot; &quot;</span>)</code></pre></div>
<pre><code>## [[1]]
## [1] &quot;This&quot;   &quot;will&quot;   &quot;split&quot;  &quot;by&quot;     &quot;space.&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">strsplit</span>(<span class="st">&quot;This. Will. Split. By. A. Period.&quot;</span>, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>)</code></pre></div>
<pre><code>## [[1]]
## [1] &quot;This&quot;    &quot; Will&quot;   &quot; Split&quot;  &quot; By&quot;     &quot; A&quot;      &quot; Period&quot;</code></pre>
</div>
<div id="an-example-string-is" class="section level5">
<h5>An example string is:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test_string &lt;-<span class="st"> &quot;This is  a test string  with no punctuation&quot;</span></code></pre></div>
</div>
<div id="test-out-strsplit-using-the-provided-test_string.-make-sure-to-copy-and-paste-the-code-that-declares-test_string.-if-you-counted-the-words-shown-in-your-results-would-it-be-an-accurate-count-why-or-why-not" class="section level5">
<h5>Test out <code>strsplit</code> using the provided <code>test_string</code>. Make sure to copy and paste the code that declares <code>test_string</code>. If you counted the words shown in your results, would it be an accurate count? Why or why not?</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-strsplit">strsplit</a>, <a href="r.html#r-writing-functions">functions</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
1-2 sentences explaining why or why not your count would be accurate.
</li>
</ul>
</div>
</div>
<div id="solution-43" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test_string &lt;-<span class="st"> &quot;This is a  test string  with no punctuation&quot;</span>
<span class="kw">strsplit</span>(test_string, <span class="st">&quot; &quot;</span>)

<span class="co"># It would not be accurate because it is counting the extra spaces as words.</span></code></pre></div>
</div>
<div id="fix-the-issue-in-2-using-which.-you-may-need-to-unlist-the-strsplit-result-first.-after-youve-accomplished-this-you-can-count-the-remaining-words" class="section level5">
<h5>3. Fix the issue in (2), using <code>which</code>. You may need to <code>unlist</code> the <code>strsplit</code> result first. After you've accomplished this, you can count the remaining words!</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-strsplit">strsplit</a>, <a href="r.html#r-sum">sum</a>, <a href="r.html#r-which">which</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem (including counting the words).
</li>
</ul>
</div>
</div>
<div id="solution-44" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">strsplit</span>(test_string, <span class="st">&quot; &quot;</span>))
<span class="kw">length</span>(test[test<span class="op">!=</span><span class="st">&quot;&quot;</span>])
<span class="kw">sum</span>(test<span class="op">!=</span><span class="st">&quot;&quot;</span>)</code></pre></div>
</div>
<div id="we-are-finally-to-the-point-where-we-have-code-from-questions-2-and-3-that-we-think-we-may-want-to-use-many-times.-write-a-function-called-count_words-which-given-a-string-description-returns-the-number-of-words-in-description.-test-out-count_words-on-the-description-from-the-second-row-of-books.-how-many-words-are-in-the-description" class="section level5">
<h5>4. We are finally to the point where we have code from questions (2) and (3) that we think we may want to use many times. Write a function called <code>count_words</code> which, given a string, <code>description</code>, returns the number of words in <code>description</code>. Test out <code>count_words</code> on the <code>description</code> from the second row of <code>books</code>. How many words are in the description?</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-writing-functions">functions</a>, <a href="r.html#r-writing-functions">unlist</a>, <a href="r.html#r-indexing">indexing</a>, <a href="r.html#r-writing-functions">strsplit</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The result of using the function on the <code>description</code> from the second row of <code>books</code>.
</li>
</ul>
</div>
</div>
<div id="solution-45" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">count_words &lt;-<span class="st"> </span><span class="cf">function</span>(description) {
    split_desc &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">strsplit</span>(description, <span class="st">&quot; &quot;</span>))
    
    <span class="kw">return</span>(<span class="kw">length</span>(split_desc[split_desc<span class="op">!=</span><span class="st">&quot;&quot;</span>]))
}

<span class="kw">count_words</span>(books<span class="op">$</span>description[<span class="dv">2</span>])</code></pre></div>
</div>
<div id="practice-makes-perfect-write-a-function-of-your-own-design-that-is-intended-on-being-used-with-one-of-our-datasets.-test-it-out-and-share-the-results." class="section level5">
<h5>5. Practice makes perfect! Write a function of your own design that is intended on being used with one of our datasets. Test it out and share the results.</h5>
<p><strong>Note:</strong> You could even pass (as an argument) one of our datasets to your function and calculate a cool statistic or something like that! Maybe your function makes a plot? Who knows?</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-writing-functions">functions</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
An example (with output) of using your newly created function.
</li>
</ul>
</div>
</div>
<div id="solution-46" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Could be anything.</span></code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p09-190" class="section level3">
<h3>Project 9</h3>
<hr />
<p><strong>Motivation:</strong> A key component to writing efficient code is writing functions. Functions allow us to repeat and reuse coding steps that we used previously, over and over again. If you find you are repeating code over and over, a function may be a good way to reduce lots of lines of code!</p>
<p><strong>Context:</strong> We've been learning about and using functions all year! Now we are going to learn more about some of the terminology and components of a function, as you will certainly need to be able to write your own functions soon.</p>
<p><strong>Scope:</strong> r, functions</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Gain proficiency using split, merge, and subset.
</li>
<li>
Demonstrate the ability to use the following functions to solve data-driven problem(s): mean, var, table, cut, paste, rep, seq, sort, order, length, unique, etc.
</li>
<li>
Read and write basic (csv) data.
</li>
<li>
Explain and demonstrate: positional, named, and logical indexing.
</li>
<li>
Demonstrate how to use tapply to solve data-driven problems.
</li>
<li>
Comprehend what a function is, and the components of a function in R.
</li>
</ul>
</div>
<div id="dataset-8" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/goodreads/csv</code></p>
</div>
<div id="questions-8" class="section level4">
<h4>Questions</h4>
<p><strong>Important note:</strong> Please make sure to <strong>double check</strong> that the your submission does indeed contain the files you think it does. You can do this by downloading your submission from Gradescope after uploading. If you can see all of your files and they open up properly on your computer, you should be good to go.</p>
<p><strong>Important note:</strong> Please make sure to look at your knit PDF <em>before</em> submitting. PDFs should be relatively short and not contain huge amounts of printed data. Remember you can use functions like <code>head</code> to print a sample of the data or output. Extremely large PDFs will be subject to lose points.</p>
<div id="weve-provided-you-with-a-function-below.-how-many-arguments-does-the-function-have-and-what-are-their-names-you-can-get-a-book_id-from-the-url-of-a-goodreads-books-webpage.-for-example-if-you-search-for-the-book-words-of-radianceon-goodreads-the-book_id-contained-in-the-url-httpswww.goodreads.combookshow17332218-words-of-radiance-is-17332218.-another-example-is-httpswww.goodreads.combookshow157993.the_little_princefrom_searchtruefrom_srptrueqidjjgquk9vp9rank1-the-little-prince-with-a-book_id-of-157993." class="section level5">
<h5>1. We've provided you with a function below. How many arguments does the function have, and what are their names? You can get a <code>book_id</code> from the URL of a goodreads book's webpage. For example, if you search for the book <code>Words of Radiance</code>on goodreads, the <code>book_id</code> contained in the url <a href="https://www.goodreads.com/book/show/17332218-words-of-radiance#" class="uri">https://www.goodreads.com/book/show/17332218-words-of-radiance#</a>, is 17332218. Another example is <a href="https://www.goodreads.com/book/show/157993.The_Little_Prince?from_search=true&amp;from_srp=true&amp;qid=JJGqUK9Vp9&amp;rank=1" class="uri">https://www.goodreads.com/book/show/157993.The_Little_Prince?from_search=true&amp;from_srp=true&amp;qid=JJGqUK9Vp9&amp;rank=1</a>, (the little prince) with a <code>book_id</code> of 157993.</h5>
</div>
<div id="find-2-or-3-book_ids-and-test-out-the-function-until-you-get-two-successes.-explain-in-words-what-the-function-is-doing-and-what-options-you-have." class="section level5">
<h5>Find 2 or 3 <code>book_id</code>s and test out the function until you get two successes. Explain in words, what the function is doing, and what options you have.</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(imager)

books &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/goodreads/csv/goodreads_books.csv&quot;</span>)
authors &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/goodreads/csv/goodreads_book_authors.csv&quot;</span>)

get_author_name &lt;-<span class="st"> </span><span class="cf">function</span>(my_authors_dataset, my_author_id){
        <span class="kw">return</span>(my_authors_dataset[my_authors_dataset<span class="op">$</span>author_id<span class="op">==</span>my_author_id,<span class="st">&#39;name&#39;</span>])
}

fun_plot &lt;-<span class="st"> </span><span class="cf">function</span>(my_authors_dataset, my_books_dataset, my_book_id, <span class="dt">display_cover=</span>T) {
    book_info &lt;-<span class="st"> </span>my_books_dataset[my_books_dataset<span class="op">$</span>book_id<span class="op">==</span>my_book_id,]
    all_books_by_author &lt;-<span class="st"> </span>my_books_dataset[my_books_dataset<span class="op">$</span>author_id<span class="op">==</span>book_info<span class="op">$</span>author_id,]
    author_name &lt;-<span class="st"> </span><span class="kw">get_author_name</span>(my_authors_dataset, book_info<span class="op">$</span>author_id)
    
    img &lt;-<span class="st"> </span><span class="kw">load.image</span>(book_info<span class="op">$</span>image_url)
    
    <span class="cf">if</span>(display_cover){
        <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
        <span class="kw">plot</span>(img, <span class="dt">axes=</span><span class="ot">FALSE</span>)
    }
    
    <span class="kw">plot</span>(all_books_by_author<span class="op">$</span>num_pages, all_books_by_author<span class="op">$</span>average_rating, 
         <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">5.1</span>), <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span><span class="st">&#39;grey80&#39;</span>,
         <span class="dt">xlab=</span><span class="st">&#39;Number of pages&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Average rating&#39;</span>, 
         <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&#39;Books by&#39;</span>, author_name))
    
    <span class="kw">points</span>(book_info<span class="op">$</span>num_pages, book_info<span class="op">$</span>average_rating,<span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span><span class="st">&#39;orange&#39;</span>, <span class="dt">cex=</span><span class="fl">1.5</span>)
}</code></pre></div>
<p><strong>Relevant topics:</strong> <a href="r.html#r-writing-functions">functions</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
How many arguments does the function have, and what are their names?
</li>
<li>
The result of using the function on 2-3 <code>book_id</code>s.
</li>
<li>
1-2 sentences explaining what the function does (generally), and what (if any) options the function provides you with.
</li>
</ul>
</div>
</div>
<div id="solution-47" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># fun_plot has 4 arguments, my_authors_dataset, my_books_dataset, my_book_id, and display_cover. </span>
<span class="co"># Given a `book_id`, the function finds all books by the same author and plots the book cover </span>
<span class="co"># next to a plot of ratings where the current book is highlighted. You can choose to show the </span>
<span class="co"># cover image or not.</span>

<span class="kw">fun_plot</span>(authors, books, <span class="dv">17332218</span>)
<span class="kw">fun_plot</span>(authors, books, <span class="dv">17593132</span>)</code></pre></div>
</div>
<div id="you-may-have-encountered-a-situation-where-the-my_book_id-was-not-in-our-dataset-and-hence-didnt-get-plotted.-when-writing-functions-it-is-usually-best-to-try-and-foresee-issues-like-this-and-have-the-function-fail-gracefully-instead-of-showing-some-ugly-and-sometimes-unclear-warning.-add-some-code-at-the-beginning-of-our-function-that-checks-to-see-if-my_book_id-is-within-our-dataset-and-if-it-does-not-exist-prints-book-id-not-found.-and-exits-the-function.-test-it-out-on-book_id123-and-book_id19063." class="section level5">
<h5>2. You may have encountered a situation where the <code>my_book_id</code> was not in our dataset, and hence, didn't get plotted. When writing functions, it is usually best to try and foresee issues like this and have the function fail gracefully, instead of showing some ugly (and sometimes unclear) warning. Add some code at the beginning of our function that checks to see if <code>my_book_id</code> is within our dataset, and if it does not exist, prints &quot;Book ID not found.&quot;, and exits the function. Test it out on <code>book_id=123</code> and <code>book_id=19063</code>.</h5>
<p><strong>Hint:</strong> Run <code>?stop</code> to see if that is a function that may be useful.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-writing-functions">functions</a>, <a href="r.html#r-if-else">if/else</a>, stop</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code with your new and improved function.
</li>
<li>
The results from <code>fun_plot(123)</code>.
</li>
<li>
The results from <code>fun_plot(19063)</code>.
</li>
</ul>
</div>
</div>
<div id="solution-48" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fun_plot &lt;-<span class="st"> </span><span class="cf">function</span>(my_authors_dataset, my_books_dataset, my_book_id, <span class="dt">display_cover=</span>T) {
  
    <span class="cf">if</span> (<span class="op">!</span>(my_book_id <span class="op">%in%</span><span class="st"> </span>my_books_dataset<span class="op">$</span>book_id)) {
        <span class="kw">stop</span>(<span class="st">&quot;Book ID not found.&quot;</span>)
    }
  
    book_info &lt;-<span class="st"> </span>my_books_dataset[my_books_dataset<span class="op">$</span>book_id<span class="op">==</span>my_book_id,]
    all_books_by_author &lt;-<span class="st"> </span>my_books_dataset[my_books_dataset<span class="op">$</span>author_id<span class="op">==</span>book_info<span class="op">$</span>author_id,]
    author_name &lt;-<span class="st"> </span><span class="kw">get_author_name</span>(my_authors_dataset, book_info<span class="op">$</span>author_id)
    
    img &lt;-<span class="st"> </span><span class="kw">load.image</span>(book_info<span class="op">$</span>image_url)
    
    <span class="cf">if</span>(display_cover){
        <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
        <span class="kw">plot</span>(img, <span class="dt">axes=</span><span class="ot">FALSE</span>)
    }
    
    <span class="kw">plot</span>(all_books_by_author<span class="op">$</span>num_pages, all_books_by_author<span class="op">$</span>average_rating, 
         <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">5.1</span>), <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span><span class="st">&#39;grey80&#39;</span>,
         <span class="dt">xlab=</span><span class="st">&#39;Number of pages&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Average rating&#39;</span>, 
         <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&#39;Books by&#39;</span>, author_name))
    
    <span class="kw">points</span>(book_info<span class="op">$</span>num_pages, book_info<span class="op">$</span>average_rating,<span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span><span class="st">&#39;orange&#39;</span>, <span class="dt">cex=</span><span class="fl">1.5</span>)
}

<span class="kw">fun_plot</span>(authors, books, <span class="dv">19063</span>)
<span class="kw">fun_plot</span>(authors, books, <span class="dv">123</span>)</code></pre></div>
</div>
<div id="we-have-this-nice-get_author_name-function-that-accepts-a-dataset-in-this-case-our-authors-dataset-and-a-book_id-and-returns-the-name-of-the-author.-write-a-new-function-called-get_author_id-that-accepts-an-authors-name-and-returns-the-author_id-of-the-author." class="section level5">
<h5>3. We have this nice <code>get_author_name</code> function that accepts a dataset (in this case, our <code>authors</code> dataset), and a <code>book_id</code> and returns the name of the author. Write a new function called <code>get_author_id</code> that accepts an authors name and returns the <code>author_id</code> of the author.</h5>
</div>
<div id="you-can-test-your-function-using-some-of-these-examples" class="section level5">
<h5>You can test your function using some of these examples:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_author_id</span>(authors, <span class="st">&quot;Brandon Sanderson&quot;</span>) <span class="co"># 38550</span>
<span class="kw">get_author_id</span>(authors, <span class="st">&quot;J.K. Rowling&quot;</span>) <span class="co"># 1077326</span></code></pre></div>
<p><strong>Relevant topics:</strong> <a href="r.html#r-writing-functions">functions</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code containing your new function.
</li>
<li>
The results of using your new function on a few authors.
</li>
</ul>
</div>
</div>
<div id="solution-49" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">get_author_id &lt;-<span class="st"> </span><span class="cf">function</span>(my_author_dataset, my_author_name) {
  <span class="kw">return</span>(my_author_dataset[my_author_dataset<span class="op">$</span>name<span class="op">==</span>my_author_name,]<span class="op">$</span>author_id)
}

<span class="kw">get_author_id</span>(authors, <span class="st">&quot;Brandon Sanderson&quot;</span>) <span class="co"># 38550</span>
<span class="kw">get_author_id</span>(authors, <span class="st">&quot;J.K. Rowling&quot;</span>) <span class="co"># 1077326</span></code></pre></div>
</div>
<div id="see-the-function-below." class="section level5">
<h5>4. See the function below.</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">search_books_for_word &lt;-<span class="st"> </span><span class="cf">function</span>(word) {
    <span class="kw">return</span>(books[<span class="kw">grepl</span>(word, books<span class="op">$</span>description, <span class="dt">fixed=</span>T),]<span class="op">$</span>title)
}</code></pre></div>
</div>
<div id="given-a-word-search_books_for_word-returns-the-titles-of-books-where-the-provided-word-is-inside-the-books-description.-search_books_for_word-utilizes-the-books-dataset-internally.-it-requires-that-the-books-dataset-has-been-loaded-into-the-environment-prior-to-running-and-with-the-correct-name.-by-including-and-referencing-objects-defined-outside-of-our-functions-scope-within-our-function-in-this-case-the-variable-books-our-search_books_for_word-function-will-be-more-prone-to-errors-as-any-changes-to-those-objects-may-break-our-function.-for-example" class="section level5">
<h5>Given a word, <code>search_books_for_word</code> returns the titles of books where the provided word is inside the book's description. <code>search_books_for_word</code> utilizes the <code>books</code> dataset internally. It requires that the <code>books</code> dataset has been loaded into the environment prior to running (and with the correct name). By including and referencing objects defined <em>outside</em> of our function's scope <em>within</em> our function (in this case the variable <code>books</code>), our <code>search_books_for_word</code> function will be more prone to errors, as any changes to those objects may break our function. For example:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">our_function &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Our argument is:&quot;</span>, x))
  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Our variable is:&quot;</span>, my_variable))
}

<span class="co"># our variable outside the scope of our_function</span>
my_variable &lt;-<span class="st"> &quot;dog&quot;</span>

<span class="co"># run our_function</span>
<span class="kw">our_function</span>(<span class="st">&quot;first&quot;</span>)

<span class="co"># change the variable outside the scope of our function</span>
my_variable &lt;-<span class="st"> &quot;cat&quot;</span>

<span class="co"># run our_function again</span>
<span class="kw">our_function</span>(<span class="st">&quot;second&quot;</span>)

<span class="co"># imagine a scenario where &quot;my_variable&quot; doesn&#39;t exist, our_function would break!</span>
<span class="kw">rm</span>(my_variable)
<span class="kw">our_function</span>(<span class="st">&quot;third&quot;</span>)</code></pre></div>
</div>
<div id="fix-our-search_books_for_word-function-to-accept-the-books-dataset-as-an-argument-called-my_books_dataset-and-utilize-my_books_dataset-within-the-function-instead-of-the-global-variable-books." class="section level5">
<h5>Fix our <code>search_books_for_word</code> function to accept the <code>books</code> dataset as an argument called <code>my_books_dataset</code> and utilize <code>my_books_dataset</code> within the function instead of the global variable <code>books</code>.</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-writing-functions">functions</a>, <a href="r.html#r-read">read.csv</a>, scoping</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code with your new and improved function.
</li>
<li>
An example using the updated function.
</li>
</ul>
</div>
</div>
<div id="solution-50" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">search_books_for_word &lt;-<span class="st"> </span><span class="cf">function</span>(my_books_dataset, word) {
    <span class="kw">return</span>(my_books_dataset[<span class="kw">grepl</span>(word, my_books_dataset<span class="op">$</span>description, <span class="dt">fixed=</span>T),]<span class="op">$</span>title)
}</code></pre></div>
</div>
<div id="write-your-own-custom-function.-make-sure-your-function-includes-at-least-2-arguments.-if-you-access-one-of-our-datasets-from-within-your-function-which-you-definitely-should-do-use-what-you-learned-in-4-to-avoid-future-errors-dealing-with-scoping.-your-function-could-output-a-cool-plot-interesting-tidbits-of-information-or-anything-else-you-can-think-of.-get-creative-and-make-a-function-that-is-fun-to-use" class="section level5">
<h5>5. Write your own custom function. Make sure your function includes at least 2 arguments. If you access one of our datasets from within your function (which you <em>definitely</em> should do), use what you learned in (4), to avoid future errors dealing with scoping. Your function could output a cool plot, interesting tidbits of information, or anything else you can think of. Get creative and make a function that is fun to use!</h5>
<p><strong>Relevant topics:</strong> scoping, <a href="r.html#r-writing-functions">functions</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Examples using your function with included output.
</li>
</ul>
</div>
</div>
<div id="solution-51" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Could be anything.</span></code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p10-190" class="section level3">
<h3>Project 10</h3>
<hr />
<p><strong>Motivation:</strong> Functions are powerful. They are building blocks to more complex programs and behavior. In fact, there is an entire programming paradigm based on functions called <a href="https://en.wikipedia.org/wiki/Functional_programming">functional programming</a>. In this project, we will learn to <em>apply</em> functions to entire vectors of data using <code>sapply</code>.</p>
<p><strong>Context:</strong> We've just taken some time to learn about and create functions. One of the more common &quot;next steps&quot; after creating a function is to use it on a series of data, like a vector. <code>sapply</code> is one of the best ways to do this in R.</p>
<p><strong>Scope:</strong> r, sapply, functions</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Read and write basic (csv) data.
</li>
<li>
Explain and demonstrate: positional, named, and logical indexing.
</li>
<li>
Utilize apply functions in order to solve a data-driven problem.
</li>
<li>
Gain proficiency using split, merge, and subset.
</li>
</ul>
</div>
<div id="dataset-9" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/okcupid/filtered</code></p>
</div>
<div id="questions-9" class="section level4">
<h4>Questions</h4>
<p><strong>Important note:</strong> Please make sure to <strong>double check</strong> that your submission does indeed contain the files you think it does. You can do this by downloading your submission from Gradescope after uploading. If you can see all of your files and they open up properly on your computer, you should be good to go.</p>
<p><strong>Important note:</strong> Please make sure to look at your knit PDF <em>before</em> submitting. PDFs should be relatively short and not contain huge amounts of printed data. Remember you can use functions like <code>head</code> to print a sample of the data or output. Extremely large PDFs will be subject to lose points.</p>
<div id="load-up-the-the-following-datasets-into-data.frames-named-users-and-questions-respectively-classdataminedataokcupidfilteredusers.csv-classdataminedataokcupidfilteredquestions.csv.-this-is-data-from-users-on-okcupid-an-online-dating-app.-in-your-own-words-explain-what-each-file-contains-and-how-they-are-related----its-always-a-good-idea-to-poke-around-the-data-to-get-a-better-understanding-of-how-things-are-structured" class="section level5">
<h5>1. Load up the the following datasets into data.frames named <code>users</code> and <code>questions</code>, respectively: <code>/class/datamine/data/okcupid/filtered/users.csv</code>, <code>/class/datamine/data/okcupid/filtered/questions.csv</code>. This is data from users on OkCupid, an online dating app. In your own words, explain what each file contains and how they are related -- its <em>always</em> a good idea to poke around the data to get a better understanding of how things are structured!</h5>
<p><strong>Hint:</strong> Be careful, just because a file ends in <code>.csv</code>, does <em>not</em> mean it is comma-separated. You can change what separator <code>read.csv</code> uses with the <code>sep</code> argument. You can use the <code>readLines</code> function on a file (say, with <code>n=10</code>, for instance), to see the first lines of a file, and determine the character to use with the <code>sep</code> argument.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_6avtd4it&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_fvfdp1ga">Click here for video</a> <strong>Relevant topics:</strong> <a href="r.html#r-read">read.csv</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
1-2 sentences describing what each file contains and how they are related.
</li>
</ul>
</div>
</div>
<div id="solution-52" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># You can show files and subdirectories using list.files</span>
<span class="kw">list.files</span>(<span class="st">&quot;/class/datamine/data/okcupid&quot;</span>)

<span class="co"># You can also take a look at files using file.info</span>
<span class="kw">file.info</span>(<span class="st">&quot;/class/datamine/data/okcupid/filtered/questions.csv&quot;</span>)

<span class="co"># You can peek at a file before reading it all in using readLines</span>
<span class="kw">readLines</span>(<span class="st">&quot;/class/datamine/data/okcupid/filtered/questions.csv&quot;</span>, <span class="dt">n=</span><span class="dv">10</span>) 

<span class="co"># we can see things are separated by semicolons</span>

users &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/okcupid/filtered/users.csv&quot;</span>)
questions &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/okcupid/filtered/questions.csv&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;;&quot;</span>)</code></pre></div>
</div>
<div id="grep-is-an-incredibly-powerful-tool-available-to-us-in-r.-we-will-learn-more-about-grep-in-the-future-but-for-now-know-that-a-simple-application-of-grep-is-to-find-a-word-in-a-string.-in-r-grep-is-vectorized-and-can-be-applied-to-an-entire-vector-of-strings.-use-grep-to-find-a-question-that-references-google.-what-is-the-question" class="section level5">
<h5>2. <code>grep</code> is an incredibly powerful tool available to us in R. We will learn more about <code>grep</code> in the future, but for now, know that a simple application of <code>grep</code> is to find a word in a string. In R, <code>grep</code> is vectorized and can be applied to an entire vector of strings. Use <code>grep</code> to find a question that references &quot;google&quot;. What is the question?</h5>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_rprsqhin&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_e39rbc8x">Click here for video</a></p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_vo0x3xun&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_3tppnvqk">Click here for video</a></p>
<p><strong>Hint:</strong> If at first you don't succeed, run <code>?grep</code> and check out the <code>ignore.case</code> argument.</p>
<p><strong>Hint:</strong> To prepare for Question 3, look at the entire row of the <code>questions</code> data frame that has the question about google. The first entry on this row tells you the question that you need, in the <code>users</code> data frame, while working on Question 3.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-grep">grep</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The <code>text</code> of the question that references Google.
</li>
</ul>
</div>
</div>
<div id="solution-53" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">questions[<span class="kw">grep</span>(<span class="st">&quot;google&quot;</span>, questions<span class="op">$</span>text, <span class="dt">ignore.case=</span>T),]</code></pre></div>
</div>
<div id="in-2-we-found-a-pretty-interesting-question.-what-is-the-percentage-of-users-that-google-someone-before-the-first-date-does-the-proportion-change-by-gender-as-defined-by-gender2-how-about-by-gender_orientation" class="section level5">
<h5>3. In (2) we found a pretty interesting question. What is the percentage of users that Google someone before the first date? Does the proportion change by gender (as defined by <code>gender2</code>)? How about by <code>gender_orientation</code>?</h5>
<p><strong>Hint:</strong> The two videos posted in Question 2 might help.</p>
<p><strong>Hint:</strong> If you look at the column of <code>users</code> corresponding to the question identified in (2), you will see that this column of <code>users</code> has two possible answers, namely: <code>&quot;No. Why spoil the mystery?&quot;</code> and <code>&quot;Yes. Knowledge is power!&quot;</code>.</p>
<p><strong>Hint:</strong> Use the <code>tapply</code> function with three inputs:</p>
<p>the correct column of <code>users</code>,</p>
<p>breaking up the data according to <code>gender2</code> or according to <code>gender_orientation</code>,</p>
<p>and use this as your function in the <code>tapply</code>:</p>
<p><code>function(x) {prop.table(table(x, useNA=&quot;always&quot;))}</code></p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-writing-functions">functions</a>, <a href="r.html#r-tapply">tapply</a>, <a href="r.html#r-table">table</a>, <a href="r.html#r-table">prop.table</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve this problem.
</li>
<li>
The results of running the code.
</li>
<li>
Written answers to the questions.
</li>
</ul>
</div>
</div>
<div id="solution-54" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.table</span>(<span class="kw">table</span>(users_filtered<span class="op">$</span><span class="st">`</span><span class="dt">q170849</span><span class="st">`</span>))

prop_google &lt;-<span class="st"> </span><span class="cf">function</span>(answers_to_q170849){
  <span class="kw">return</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(answers_to_q170849))[<span class="dv">2</span>])
}

<span class="kw">tapply</span>(users_filtered<span class="op">$</span><span class="st">`</span><span class="dt">q170849</span><span class="st">`</span>, users_filtered<span class="op">$</span>gender2, prop_google)
<span class="kw">tapply</span>(users_filtered<span class="op">$</span><span class="st">`</span><span class="dt">q170849</span><span class="st">`</span>, users_filtered<span class="op">$</span>gender_orientation, prop_google)

<span class="co"># ~35% of people Google people before the first date.</span>

<span class="co"># According to this set of data, men Google woman 10% less than woman Google men before the first date.</span>

<span class="co"># When broken down by the provided gender orientations, hetero females, bisexual females, and gay males tend to</span>
<span class="co"># Google people before the first date more than bisexual males, gay females, and hetero males.</span></code></pre></div>
</div>
<div id="in-project-8-we-created-a-function-called-count_words.-use-this-function-and-sapply-to-create-a-vector-which-contains-the-number-of-words-in-each-row-of-the-column-text-from-the-questions-dataframe.-call-the-new-vector-question_length-and-add-it-as-a-column-to-the-questions-dataframe." class="section level5">
<h5>4. In project (8) we created a function called <code>count_words</code>. Use this function and <code>sapply</code> to create a vector which contains the number of words in each row of the column <code>text</code> from the <code>questions</code> dataframe. Call the new vector <code>question_length</code>, and add it as a column to the <code>questions</code> dataframe.</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">count_words &lt;-<span class="st"> </span><span class="cf">function</span>(my_text) {
    my_split_text &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">strsplit</span>(my_text, <span class="st">&quot; &quot;</span>))
    
    <span class="kw">return</span>(<span class="kw">length</span>(my_split_text[my_split_text<span class="op">!=</span><span class="st">&quot;&quot;</span>]))
}</code></pre></div>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_b3mpapel&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_d8ebd3xf">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-sapply">sapply</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve this problem.
</li>
<li>
The result of <code>str(questions)</code> (this shows how your <code>questions</code> data frame looks, after adding the new column called <code>question_length</code>).
</li>
</ul>
</div>
</div>
<div id="solution-55" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">count_words &lt;-<span class="st"> </span><span class="cf">function</span>(description) {
    split_desc &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">strsplit</span>(description, <span class="st">&quot; &quot;</span>))
    
    <span class="kw">return</span>(<span class="kw">length</span>(split_desc[split_desc<span class="op">!=</span><span class="st">&quot;&quot;</span>]))
}

questions<span class="op">$</span>question_length &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">as.character</span>(questions<span class="op">$</span>text), count_words)</code></pre></div>
</div>
<div id="consider-this-function-called-number_of_options-that-accepts-a-data-frame-for-instance-questions" class="section level5">
<h5>5. Consider this function called <code>number_of_options</code> that accepts a data frame (for instance, <code>questions</code>)</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">number_of_options &lt;-<span class="st"> </span><span class="cf">function</span>(myDF) {
   <span class="kw">table</span>(<span class="kw">apply</span>(<span class="kw">as.matrix</span>(myDF[ ,<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>]), <span class="dv">1</span>, <span class="cf">function</span>(x) {<span class="kw">sum</span>(<span class="op">!</span>(x<span class="op">==</span><span class="st">&quot;&quot;</span>))}))
}</code></pre></div>
<p>and counts the number of questions that have each possible number of responses. For instance, if we calculate: <code>number_of_options(questions)</code> we get:</p>
<pre><code>  0   2   3   4 
590 936 519 746</code></pre>
<p>which means that: 590 questions have 0 possible responses; 936 questions have 2 possible responses; 519 questions have 3 possible responses; and 746 questions have 4 possible responses.</p>
<p>Now use the <code>split</code> function to break the data frame <code>questions</code> into 7 smaller data frames, according to the value in <code>questions$Keywords</code>. Then use the <code>sapply</code> function to determine, for each possible value of <code>questions$Keywords</code>, the analogous breakdown of questions with different numbers of responses, as we did above.</p>
<p><strong>Hint:</strong> You can write:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mylist &lt;-<span class="st"> </span><span class="kw">split</span>(questions, questions<span class="op">$</span>Keywords)
<span class="kw">sapply</span>(mylist, number_of_options)</code></pre></div>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_3bqgn6rw&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_hsk9kd48">Click here for video</a></p>
<p><strong>Background/explanation:</strong> The way <code>sapply</code> works is the the first argument is by default the first argument to your function, the second argument is the function you want applied, and after that you can specify arguments by name. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="ot">NA</span>, <span class="dv">5</span>)
test2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="ot">NA</span>)
mylist &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">first=</span>test1, <span class="dt">second=</span>test2)

<span class="co"># for a single vector in the list</span>
<span class="kw">mean</span>(mylist<span class="op">$</span>first, <span class="dt">na.rm=</span>T)

<span class="co"># what if we want to do this for each vector in the list?</span>
<span class="co"># how do we remove na&#39;s?</span>
<span class="kw">sapply</span>(mylist, mean)

<span class="co"># we can specify the arguments that are for the mean function</span>
<span class="co"># by naming them after the first two arguments, like this</span>
<span class="kw">sapply</span>(mylist, mean, <span class="dt">na.rm=</span>T)

<span class="co"># in the code shown above, na.rm=T is passed to the mean function</span>
<span class="co"># just like if you run the following</span>
<span class="kw">mean</span>(mylist<span class="op">$</span>first, <span class="dt">na.rm=</span>T)
<span class="kw">mean</span>(mylist<span class="op">$</span>second, <span class="dt">na.rm=</span>T)

<span class="co"># you can include as many arguments to mean as you normally would</span>
<span class="co"># and in any order. just make sure to name the arguments</span>
<span class="kw">sapply</span>(mylist, mean, <span class="dt">na.rm=</span>T, <span class="dt">trim=</span><span class="fl">0.5</span>)
<span class="co"># or sapply(mylist, mean, trim=0.5, na.rm=T) </span>

<span class="co"># which is similar to </span>
<span class="kw">mean</span>(mylist<span class="op">$</span>first, <span class="dt">na.rm=</span>T, <span class="dt">trim=</span><span class="fl">0.5</span>)
<span class="kw">mean</span>(mylist<span class="op">$</span>second, <span class="dt">na.rm=</span>T, <span class="dt">trim=</span><span class="fl">0.5</span>)</code></pre></div>
<p><strong>Relevant topics:</strong> <a href="r.html#r-sapply">sapply</a>, <a href="r.html#r-writing-functions">functions</a>, <a href="r.html#r-indexing">indexing</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve this problem.
</li>
<li>
The results of the running the code.
</li>
</ul>
</div>
</div>
<div id="solution-56" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">number_of_options &lt;-<span class="st"> </span><span class="cf">function</span>(myDF) {
    <span class="kw">table</span>(<span class="kw">apply</span>(<span class="kw">as.matrix</span>(myDF[ ,<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>]), <span class="dv">1</span>, <span class="cf">function</span>(x) {<span class="kw">sum</span>(<span class="op">!</span>(x<span class="op">==</span><span class="st">&quot;&quot;</span>))}))
}

<span class="kw">number_of_options</span>(questions)

mylist &lt;-<span class="st"> </span><span class="kw">split</span>(questions, questions<span class="op">$</span>Keywords)
<span class="kw">sapply</span>(mylist, number_of_options)</code></pre></div>
</div>
<div id="lots-of-questions-are-asked-in-this-okcupid-dataset.-explore-the-dataset-and-either-calculate-an-interesting-statisticresult-using-sapply-or-generate-a-graphic-with-good-x-axis-andor-y-axis-labels-main-labels-legends-etc.-or-both-write-1-2-sentences-about-your-analysis-andor-graphic-and-explain-what-you-thought-youd-find-and-what-you-actually-discovered." class="section level5">
<h5>6. <em>Lots</em> of questions are asked in this <code>okcupid</code> dataset. Explore the dataset, and either calculate an interesting statistic/result using <code>sapply</code>, or generate a graphic (with good x-axis and/or y-axis labels, main labels, legends, etc.), or both! Write 1-2 sentences about your analysis and/or graphic, and explain what you thought you'd find, and what you actually discovered.</h5>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_vo0x3xun&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_nj51drkw">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-plotting">plotting</a>, <a href="r.html#r-writing-functions">functions</a>, <a href="r.html#r-sapply">sapply</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve this problem.
</li>
<li>
The results from running your code.
</li>
<li>
1-2 sentences about your analysis and/or graphic, and explain what you thought you'd find, and what you actually discovered.
</li>
</ul>
</div>
</div>
<div id="solution-57" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Could be anything.</span></code></pre></div>
</div>
<div id="optional-question.-does-it-appear-that-there-is-an-association-between-the-length-of-the-question-and-whether-or-not-users-answered-the-question-assume-na-means-unanswered.-first-create-a-function-called-percent_answered-that-given-a-vector-returns-the-percentage-of-values-that-are-not-na.-use-percent_answered-and-sapply-to-calculate-the-percentage-of-users-who-answer-each-question.-plot-this-result-against-the-length-of-the-questions." class="section level5">
<h5>OPTIONAL QUESTION. Does it appear that there is an association between the length of the question and whether or not users answered the question? Assume NA means &quot;unanswered&quot;. First create a function called <code>percent_answered</code> that, given a vector, returns the percentage of values that are not NA. Use <code>percent_answered</code> and <code>sapply</code> to calculate the percentage of users who answer each question. Plot this result, against the length of the questions.</h5>
<p><strong>Hint:</strong> <code>length_of_questions &lt;- questions$question_length[grep(&quot;^q&quot;, questions$X)]</code></p>
<p><strong>Hint:</strong> <code>grep(&quot;^q&quot;, questions$X)</code> returns the column index of every column that starts with &quot;q&quot;. Use the same trick we used in the previous hint, to subset our <code>users</code> data.frame before using <code>sapply</code> to apply <code>percent_answered</code>.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-sapply">sapply</a>, <a href="r.html#r-isna">is.na</a>, <a href="r.html#r-length">length</a>, <a href="r.html#r-grep">grep</a>, <a href="r.html#r-plot">plot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve this problem.
</li>
<li>
The plot.
</li>
<li>
Whether or not you think there may or may not be an association between question length and whether or not the question is answered.
</li>
</ul>
</div>
</div>
<div id="solution-58" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">number_of_options &lt;-<span class="st"> </span><span class="cf">function</span>(questions, question_id) {
    
    is_empty &lt;-<span class="st"> </span><span class="cf">function</span>(value) {
        <span class="cf">if</span> (<span class="kw">is.na</span>(value)) <span class="kw">return</span>(<span class="ot">TRUE</span>)
        <span class="cf">else</span> <span class="cf">if</span> (value<span class="op">==</span><span class="st">&quot;&quot;</span>) <span class="kw">return</span>(<span class="ot">TRUE</span>)
        <span class="cf">else</span> <span class="kw">return</span>(<span class="ot">FALSE</span>)
    }
    
    question &lt;-<span class="st"> </span>questions[questions<span class="op">$</span>X<span class="op">==</span>question_id,]
    
    <span class="kw">is_empty</span>(question<span class="op">$</span>option_<span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">is_empty</span>(question<span class="op">$</span>option_<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">is_empty</span>(question<span class="op">$</span>option_<span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">is_empty</span>(question<span class="op">$</span>option_<span class="dv">4</span>)
    
}
<span class="kw">prop.table</span>(<span class="kw">table</span>(<span class="kw">sapply</span>(questions<span class="op">$</span>X, number_of_options, <span class="dt">questions =</span> questions)))

questions<span class="op">$</span>number_options &lt;-<span class="st"> </span><span class="kw">sapply</span>(questions<span class="op">$</span>X, number_of_options, <span class="dt">questions =</span> questions)

<span class="kw">prop.table</span>(<span class="kw">table</span>(<span class="kw">sapply</span>(questions<span class="op">$</span>X, number_of_options, <span class="dt">questions =</span> questions)))

questions<span class="op">$</span>number_options &lt;-<span class="st"> </span><span class="kw">sapply</span>(questions<span class="op">$</span>X, number_of_options, <span class="dt">questions =</span> questions)

percent_answered &lt;-<span class="st"> </span><span class="cf">function</span>(col) {
    <span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(col))<span class="op">/</span><span class="kw">length</span>(col)
}

p_answered &lt;-<span class="st"> </span><span class="kw">sapply</span>(users[,<span class="kw">grep</span>(<span class="st">&quot;^q&quot;</span>, <span class="kw">names</span>(users))], percent_answered)
length_of_questions &lt;-<span class="st"> </span>questions<span class="op">$</span>question_length[<span class="kw">grep</span>(<span class="st">&quot;^q&quot;</span>, questions<span class="op">$</span>X)]
<span class="kw">plot</span>(length_of_questions, p_answered)</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p11-190" class="section level3">
<h3>Project 11</h3>
<hr />
<p><strong>Motivation:</strong> The ability to understand a problem, know what tools are available to you, and select the right tools to get the job done, takes practice. In this project we will use what you've learned so far this semester to solve data-driven problems. In previous projects, we've directed you towards certain tools. In this project, there will be less direction, and you will have the freedom to choose the tools you'd like.</p>
<p><strong>Context:</strong> You've learned lots this semester about the R environment. You now have experience using a very balanced &quot;portfolio&quot; of R tools. We will practice using these tools on a set of economic data from Zillow.</p>
<p><strong>Scope:</strong> R</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Read and write basic (csv) data.
</li>
<li>
Explain and demonstrate: positional, named, and logical indexing.
</li>
<li>
Utilize apply functions in order to solve a data-driven problem.
</li>
<li>
Gain proficiency using split, merge, and subset.
</li>
<li>
Comprehend what a function is, and the components of a function in R.
</li>
<li>
Demonstrate the ability to use nested apply functions to solve a data-driven problem.
</li>
</ul>
</div>
<div id="dataset-10" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/zillow</code></p>
</div>
<div id="questions-10" class="section level4">
<h4>Questions</h4>
<div id="read-classdataminedatazillowzip_time_series.csv-into-a-data.frame-called-zipc.-look-at-the-regionname-column.-it-is-supposed-to-be-a-5-digit-zip-code.-either-fix-the-column-by-writing-a-function-and-applying-it-to-the-column-or-take-the-time-to-read-the-read.csv-documentation-by-running-read.csv-and-use-an-argument-to-make-sure-that-column-is-not-read-in-as-an-integer-which-is-why-zip-codes-starting-with-0-lose-the-leading-0-when-being-read-in." class="section level5">
<h5>1. Read <code>/class/datamine/data/zillow/Zip_time_series.csv</code> into a data.frame called <code>zipc</code>. Look at the <code>RegionName</code> column. It is supposed to be a 5-digit zip code. Either fix the column by writing a function and applying it to the column, or take the time to read the <code>read.csv</code> documentation by running <code>?read.csv</code> and use an argument to make sure that column is not read in as an integer (which is <em>why</em> zip codes starting with <code>0</code> lose the leading <code>0</code> when being read in).</h5>
<p><strong>Hint:</strong> This video demonstrates how to read in data and respect the leading zeroes.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_6l6wrk8s&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_kl5d8d0k">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="#read">read.csv</a>, <a href="r.html#r-sapply">sapply</a>, <a href="r.html#r-writing-functions">functions</a>, <a href="r.html#r-strrep">strrep</a>, <a href="r.html#r-nchar">nchar</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
<code>head</code> of the <code>RegionName</code> column.
</li>
</ul>
</div>
</div>
<div id="solution-59" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">zipc &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/zillow/Zip_time_series.csv&quot;</span>)
fix_zip &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
    <span class="cf">if</span> (<span class="kw">nchar</span>(x) <span class="op">==</span><span class="st"> </span><span class="dv">5</span>) {
        <span class="kw">return</span>(<span class="kw">as.character</span>(x))
    }
    <span class="kw">paste0</span>(<span class="kw">strrep</span>(<span class="st">&quot;0&quot;</span>, <span class="dv">5</span><span class="op">-</span><span class="kw">nchar</span>(x)), x)
}
<span class="kw">sapply</span>(zipc<span class="op">$</span>RegionName, fix_zip)

<span class="co"># OR</span>

zipc &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/zillow/Zip_time_series.csv&quot;</span>, <span class="dt">colClasses =</span> <span class="kw">c</span>(<span class="st">&quot;RegionName&quot;</span>=<span class="st">&quot;character&quot;</span>))

<span class="co"># OR</span>

zipc &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">fread</span>(<span class="st">&quot;/class/datamine/data/zillow/Zip_time_series.csv&quot;</span>))
zipc<span class="op">$</span>Date &lt;-<span class="st"> </span><span class="kw">as.Date</span>(zipc<span class="op">$</span>Date)</code></pre></div>
</div>
<div id="one-might-assume-that-the-owner-of-a-house-tends-to-value-that-house-more-than-the-buyer.-if-that-was-the-case-perhaps-the-median-listing-price-the-price-which-the-seller-puts-the-house-on-the-market-or-ask-price-would-be-higher-than-the-zhvi-zillow-home-value-index----essentially-an-estimate-of-the-home-value.-for-those-rows-where-both-medianlistingprice_allhomes-and-zhvi_allhomes-have-non-na-values-on-average-how-much-higher-or-lower-is-the-median-listing-price-can-you-think-of-any-other-reasons-why-this-may-be" class="section level5">
<h5>2. One might assume that the owner of a house tends to value that house more than the buyer. If that was the case, perhaps the median listing price (the price which the seller puts the house on the market, or ask price) would be higher than the ZHVI (Zillow Home Value Index -- essentially an estimate of the home value). For those rows where both <code>MedianListingPrice_AllHomes</code> and <code>ZHVI_AllHomes</code> have non-NA values, on average how much higher or lower is the median listing price? Can you think of any other reasons why this may be?</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-mean">mean</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The result itself and 1-2 sentences talking about whether or not you can think of any other reasons that may explain the result.
</li>
</ul>
</div>
</div>
<div id="solution-60" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(zipc<span class="op">$</span>MedianListingPrice_AllHomes <span class="op">-</span><span class="st"> </span>zipc<span class="op">$</span>ZHVI_AllHomes, <span class="dt">na.rm=</span>T)</code></pre></div>
</div>
<div id="convert-the-date-column-to-a-date-using-as.date.-how-many-years-of-data-do-we-have-in-this-dataset-create-a-line-plot-with-lines-for-the-average-medianlistingprice_allhomes-and-average-zhvi_allhomes-by-year.-the-result-should-be-a-single-plot-with-multiple-lines-on-it." class="section level5">
<h5>3. Convert the <code>Date</code> column to a date using <code>as.Date</code>. How many years of data do we have in this dataset? Create a line plot with lines for the average <code>MedianListingPrice_AllHomes</code> and average <code>ZHVI_AllHomes</code> by year. The result should be a single plot with multiple lines on it.</h5>
<p><strong>Hint:</strong> Here we give two videos to help you with this question. The first video gives some examples about working with dates in R.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_9jlukubf&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_va98txxh">Click here for video</a></p>
<p><strong>Hint:</strong> This second video gives an example about how to plot two line graphs at the same time in R.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_bz037ypd&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_5tk66x0a">Click here for video</a></p>
<p><strong>Hint:</strong> For a nice addition, add a dotted vertical line on year 2008 near the housing crisis:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">abline</span>(<span class="dt">v=</span><span class="st">&quot;2008&quot;</span>, <span class="dt">lty=</span><span class="st">&quot;dotted&quot;</span>)</code></pre></div>
<p><strong>Relevant topics:</strong> <a href="unix.html#cut">cut</a>, <a href="r.html#r-dates">as.Date</a>, <a href="r.html#r-tapply">tapply</a>, <a href="r.html#r-plotting">plot</a>, <a href="r.html#r-lines">lines</a>, <a href="r.html#r-legend">legend</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The results of running the code.
</li>
</ul>
</div>
</div>
<div id="solution-61" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">zipc<span class="op">$</span>Date &lt;-<span class="st"> </span><span class="kw">as.Date</span>(zipc<span class="op">$</span>Date, <span class="dt">format=</span><span class="st">&quot;%Y-%m-%d&quot;</span>)

zipc<span class="op">$</span>Year &lt;-<span class="st"> </span><span class="kw">cut</span>(zipc<span class="op">$</span>Date, <span class="dt">breaks=</span><span class="st">&quot;year&quot;</span>)
zipc<span class="op">$</span>Year &lt;-<span class="st"> </span><span class="kw">substr</span>(zipc<span class="op">$</span>Year, <span class="dv">1</span>, <span class="dv">4</span>)

listings &lt;-<span class="st"> </span><span class="kw">tapply</span>(zipc<span class="op">$</span>MedianListingPrice_AllHomes, zipc<span class="op">$</span>Year, mean, <span class="dt">na.rm=</span>T)
zhvis &lt;-<span class="st"> </span><span class="kw">tapply</span>(zipc<span class="op">$</span>ZHVI_AllHomes, zipc<span class="op">$</span>Year, mean, <span class="dt">na.rm=</span>T)

<span class="kw">plot</span>(<span class="kw">names</span>(listings), listings, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">118000</span>, <span class="dv">320000</span>), <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)
<span class="kw">lines</span>(<span class="kw">names</span>(zhvis), zhvis, <span class="dt">col=</span><span class="st">&quot;tomato&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)
<span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;Listing price&quot;</span>, <span class="st">&quot;ZHVI&quot;</span>), <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;tomato&quot;</span>))
<span class="kw">abline</span>(<span class="dt">v=</span><span class="st">&quot;2008&quot;</span>, <span class="dt">lty=</span><span class="st">&quot;dotted&quot;</span>)</code></pre></div>
</div>
<div id="read-classdataminedatazillowstate_time_series.csv-into-a-data.frame-called-states.-calculate-the-average-median-listing-price-by-state-and-create-a-map-using-plot_usmap-from-the-usmap-package-that-shows-the-average-median-price-by-state." class="section level5">
<h5>4. Read <code>/class/datamine/data/zillow/State_time_series.csv</code> into a data.frame called <code>states</code>. Calculate the average median listing price by state, and create a map using <code>plot_usmap</code> from the <code>usmap</code> package that shows the average median price by state.</h5>
<p><strong>Hint:</strong> We give a full example about how to plot values, by State, on a map.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_mre0bnx7&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_1lg9v4jl">Click here for video</a></p>
<p><strong>Hint:</strong> In order for <code>plot_usmap</code> to work, you must name the column containing states' names to &quot;state&quot;.</p>
<p><strong>Hint:</strong> To split words like &quot;OhSoCool&quot; into &quot;Oh So Cool&quot;, try this: <code>trimws(gsub('([[:upper:]])', ' \\1', &quot;OhSoCool&quot;))</code>. This will be useful as you'll need to correct the <code>RegionName</code> column at some point in time. Notice that this will not completely fix &quot;DistrictofColumbia&quot;. You will need to fix that one manually.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-tapply">tapply</a>, <a href="r.html#r-plot_usmap">plot_usmap</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The resulting map.
</li>
</ul>
</div>
</div>
<div id="solution-62" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">states &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/zillow/State_time_series.csv&quot;</span>)
aux &lt;-<span class="st"> </span><span class="kw">tapply</span>(states<span class="op">$</span>MedianListingPrice_AllHomes, states<span class="op">$</span>RegionName, mean, <span class="dt">na.rm=</span>T)
dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">state=</span><span class="kw">names</span>(aux), <span class="dt">val=</span>aux)
dat<span class="op">$</span>state &lt;-<span class="st"> </span><span class="kw">trimws</span>(<span class="kw">gsub</span>(<span class="st">&#39;([[:upper:]])&#39;</span>, <span class="st">&#39; </span><span class="ch">\\</span><span class="st">1&#39;</span>, dat<span class="op">$</span>state))
dat<span class="op">$</span>state[dat<span class="op">$</span>state<span class="op">==</span><span class="st">&quot;Districtof Columbia&quot;</span>] &lt;-<span class="st"> &quot;District of Columbia&quot;</span>

<span class="kw">plot_usmap</span>(<span class="dt">data =</span> dat, <span class="dt">values =</span> <span class="st">&quot;val&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_fill_continuous</span>(<span class="dt">low =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;#C28E0E&quot;</span>,
                          <span class="dt">name =</span> <span class="st">&quot;Median price listing&quot;</span>,
                          <span class="dt">label =</span> scales<span class="op">::</span>dollar) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>)</code></pre></div>
</div>
<div id="read-classdataminedatazillowcounty_time_series.csv-into-a-data.frame-named-counties.-choose-a-state-or-states-that-you-would-like-to-dig-down-into-county-level-data-for-and-create-a-plot-or-plots-like-in-4-that-show-some-interesting-statistic-by-county.-you-can-choose-average-median-listing-price-if-you-so-desire-however-you-dont-need-to-there-are-other-cool-data" class="section level5">
<h5>5. Read <code>/class/datamine/data/zillow/County_time_series.csv</code> into a data.frame named <code>counties</code>. Choose a state (or states) that you would like to &quot;dig down&quot; into county-level data for, and create a plot (or plots) like in (4) that show some interesting statistic by county. You can choose average median listing price if you so desire, however, you don't need to! There are other cool data!</h5>
<p><strong>Hint:</strong> Make sure that you remember to aggregate your data by <code>RegionName</code> so the plot renders correctly.</p>
<p><strong>Hint:</strong> <code>plot_usmap</code> looks for a column named <code>fips</code>. Make sure to rename the <code>RegionName</code> column to <code>fips</code> prior to passing the data.frame to <code>plot_usmap</code>.</p>
<p><strong>Hint:</strong> If you get Question 4 working correctly, here are the main differences for Question 5. You need the <code>regions</code> to be <code>&quot;counties&quot;</code> instead of <code>&quot;states&quot;</code>, and you need the <code>data.frame</code> to have a column called <code>fips</code> instead of <code>state</code>. These are the main differences between Question 4 and Question 5.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-tapply">tapply</a>, <a href="r.html#r-plot_usmap">plot_usmap</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The resulting map.
</li>
</ul>
</div>
</div>
<div id="solution-63" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">counties_avg &lt;-<span class="st"> </span><span class="kw">tapply</span>(counties<span class="op">$</span>MedianListingPrice_AllHomes, counties<span class="op">$</span>RegionName, mean, <span class="dt">na.rm=</span>T)
counties_avg &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">fips =</span> <span class="kw">names</span>(counties_avg), <span class="dt">MedianListingPrice =</span> <span class="kw">unname</span>(counties_avg))

<span class="kw">plot_usmap</span>(<span class="dt">data =</span> counties_avg, <span class="dt">values =</span> <span class="st">&quot;MedianListingPrice&quot;</span>, <span class="dt">include=</span><span class="kw">c</span>(<span class="st">&quot;CA&quot;</span>), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_fill_continuous</span>(<span class="dt">low =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;#C28E0E&quot;</span>,
                          <span class="dt">name =</span> <span class="st">&quot;Average median price listing&quot;</span>,
                          <span class="dt">label =</span> scales<span class="op">::</span>dollar) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>)</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p12-190" class="section level3">
<h3>Project 12</h3>
<hr />
<p><strong>Motivation:</strong> In the previous project you were forced to do a little bit of date manipulation. Dates <em>can</em> be very difficult to work with, regardless of the language you are using. <code>lubridate</code> is a package within the famous <a href="https://www.tidyverse.org/">tidyverse</a>, that greatly simplifies some of the most common tasks one needs to perform with date data.</p>
<p><strong>Context:</strong> We've been reviewing topics learned this semester. In this project we will continue solving data-driven problems, wrangling data, and creating graphics. We will introduce a <a href="https://www.tidyverse.org/">tidyverse</a> package that adds great stand-alone value when working with dates.</p>
<p><strong>Scope:</strong> r</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Read and write basic (csv) data.
</li>
<li>
Explain and demonstrate: positional, named, and logical indexing.
</li>
<li>
Utilize apply functions in order to solve a data-driven problem.
</li>
<li>
Gain proficiency using split, merge, and subset.
</li>
<li>
Demostrate the ability to create basic graphs with default settings.
</li>
<li>
Demonstratre the ability to modify axes labels and titles.
</li>
<li>
Incorporate legends using legend().
</li>
<li>
Demonstrate the ability to customize a plot (color, shape/linetype).
</li>
<li>
Convert strings to dates, and format dates using the lubridate package.
</li>
</ul>
</div>
<div id="questions-11" class="section level4">
<h4>Questions</h4>
<div id="lets-continue-our-exploration-of-the-zillow-time-series-data.-a-useful-package-for-dealing-with-dates-is-called-lubridate.-this-is-part-of-the-famous-tidyverse-suite-of-packages.-run-the-code-below-to-load-it.-read-the-classdataminedatazillowstate_time_series.csv-dataset-into-a-data.frame-named-states.-what-class-and-type-is-the-column-date" class="section level5">
<h5>1. Let's continue our exploration of the Zillow time series data. A useful package for dealing with dates is called <code>lubridate</code>. This is part of the famous <a href="https://www.tidyverse.org/">tidyverse</a> suite of packages. Run the code below to load it. Read the <code>/class/datamine/data/zillow/State_time_series.csv</code> dataset into a data.frame named <code>states</code>. What class and type is the column <code>Date</code>?</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lubridate)</code></pre></div>
<p><strong>Relevant topics:</strong> <a href="r.html#r-lists-and-vectors">class</a>, <a href="r.html#r-type">typeof</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the question.
</li>
<li>
<code>class</code> and <code>typeof</code> column <code>Date</code>.
</li>
</ul>
</div>
</div>
<div id="solution-64" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lubridate)
states &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/zillow/State_time_series.csv&quot;</span>)
<span class="kw">typeof</span>(states<span class="op">$</span>Date)
<span class="kw">class</span>(states<span class="op">$</span>Date)</code></pre></div>
</div>
<div id="convert-column-date-to-a-corresponding-date-format-using-lubridate.-check-that-you-correctly-transformed-it-by-checking-its-class-like-we-did-in-question-1.-compare-and-contrast-this-method-of-conversion-with-the-solution-you-came-up-with-for-question-3-in-the-previous-project.-which-method-do-you-prefer" class="section level5">
<h5>2. Convert column <code>Date</code> to a corresponding date format using <code>lubridate</code>. Check that you correctly transformed it by checking its class like we did in question (1). Compare and contrast this method of conversion with the solution you came up with for question (3) in the previous project. Which method do you prefer?</h5>
<p><strong>Hint:</strong> Take a look at the following functions from <code>lubridate</code>: <code>ymd</code>, <code>mdy</code>, <code>dym</code>.</p>
<p><strong>Hint:</strong> Here is a video about <code>ymd</code>, <code>mdy</code>, <code>dym</code></p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_t9xobenm&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_y7tw95sl">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-dates">dates</a>, <a href="r.html#r-lubridate">lubridate</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the question.
</li>
<li>
<code>class</code> of modified column <code>Date</code>.
</li>
<li>
1-2 sentences stating which method you prefer (if any) and why.
</li>
</ul>
</div>
</div>
<div id="solution-65" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">states<span class="op">$</span>Date &lt;-<span class="st"> </span><span class="kw">ymd</span>(states<span class="op">$</span>Date)
<span class="kw">class</span>(states<span class="op">$</span>Date)</code></pre></div>
</div>
<div id="create-3-new-columns-in-states-called-year-month-day_of_week-sun-sat-using-lubridate.-get-the-frequency-table-for-your-newly-created-columns.-do-we-have-the-same-amount-of-data-for-all-years-for-all-months-and-for-all-days-of-the-week-we-did-something-similar-in-question-3-in-the-previous-project----specifically-we-broke-each-date-down-by-year.-which-method-do-you-prefer-and-why" class="section level5">
<h5>3. Create 3 new columns in <code>states</code> called <code>year</code>, <code>month</code>, <code>day_of_week</code> (Sun-Sat) using <code>lubridate</code>. Get the frequency table for your newly created columns. Do we have the same amount of data for all years, for all months, and for all days of the week? We did something similar in question (3) in the previous project -- specifically, we broke each date down by year. Which method do you prefer and why?</h5>
<p><strong>Hint:</strong> Take a look at functions <code>month</code>, <code>year</code>, <code>day</code>, <code>wday</code>.</p>
<p><strong>Hint:</strong> You may find the argument of <code>label</code> in <code>wday</code> useful.</p>
<p><strong>Hint:</strong> Here is a video about <code>month</code>, <code>year</code>, <code>day</code>, <code>wday</code></p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_s8ww6bi5&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_hfz21x5n">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-dates">dates</a>, <a href="r.html#r-lubridate">lubridate</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the question.
</li>
<li>
Frequency table for newly created columns.
</li>
<li>
1-2 sentences answering whether or not we have the same amount of data for all years, months, and days of the week.
</li>
<li>
1-2 sentences stating which method you prefer (if any) and why.
</li>
</ul>
</div>
</div>
<div id="solution-66" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">states<span class="op">$</span>year &lt;-<span class="st"> </span><span class="kw">year</span>(states<span class="op">$</span>Date)
states<span class="op">$</span>month &lt;-<span class="st"> </span><span class="kw">month</span>(states<span class="op">$</span>Date)
states<span class="op">$</span>day_of_week &lt;-<span class="st"> </span><span class="kw">wday</span>(states<span class="op">$</span>Date, <span class="dt">label=</span><span class="ot">TRUE</span>)
<span class="kw">table</span>(states<span class="op">$</span>year)
<span class="kw">table</span>(states<span class="op">$</span>month)
<span class="kw">table</span>(states<span class="op">$</span>day_of_week)</code></pre></div>
</div>
<div id="is-there-a-better-month-or-set-of-months-to-put-your-house-on-the-market-use-tapply-to-compare-the-average-daysonzillow_allhomes-for-all-months.-make-a-barplot-showing-our-results.-make-sure-your-barplot-includes-all-of-the-fixings-title-labeled-axes-legend-if-necessary-etc.-make-it-look-good.." class="section level5">
<h5>4. Is there a better month or set of months to put your house on the market? Use <code>tapply</code> to compare the average <code>DaysOnZillow_AllHomes</code> for all months. Make a barplot showing our results. Make sure your barplot includes &quot;all of the fixings&quot; (title, labeled axes, legend if necessary, etc. Make it look good.).</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-tapply">tapply</a>, <a href="r.html#r-barplot">barplot</a></p>
<p><strong>Hint:</strong> If you want to have the month's abbreviation in your plot, you may find both the <code>month.abb</code> object and the argument <code>names.arg</code> in <code>barplot</code> useful.</p>
<p><strong>Hint:</strong> This video might help with Question 4.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_qd75ftfw&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_qf87ck9a">Click here for video</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the question.
</li>
<li>
The barplot of the average <code>DaysOnZillow_AllHomes</code> for all months.
</li>
<li>
1-2 sentences answering the question &quot;Is there a better time to put your house on the market?&quot; based on your results.
</li>
</ul>
</div>
</div>
<div id="solution-67" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">avgDaysPerMonth &lt;-<span class="st"> </span><span class="kw">tapply</span>(states<span class="op">$</span>DaysOnZillow_AllHomes, states<span class="op">$</span>month, mean, <span class="dt">na.rm=</span>T)
<span class="kw">barplot</span>(avgDaysPerMonth, <span class="dt">names.arg=</span>month.abb, <span class="dt">col=</span><span class="st">&#39;steelblue&#39;</span>, <span class="dt">main=</span><span class="st">&quot;Avg days on Zillow&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;# Days&quot;</span>)</code></pre></div>
</div>
<div id="filter-the-states-data-to-contain-only-years-from-2010-and-call-it-states2010plus.-make-a-lineplot-showing-the-average-daysonzillow_allhomes-by-date-using-states2010plus-data.-can-you-spot-any-trends-write-1-2-sentences-explaining-what-if-any-trends-you-see." class="section level5">
<h5>5. Filter the <code>states</code> data to contain only years from 2010+ and call it <code>states2010plus</code>. Make a lineplot showing the average <code>DaysOnZillow_AllHomes</code> by <code>Date</code> using <code>states2010plus</code> data. Can you spot any trends? Write 1-2 sentences explaining what (if any) trends you see.</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-subset">subset</a>, <a href="r.html#r-tapply">tapply</a>, <a href="r.html#r-plot">plot</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the question.
</li>
<li>
The time series lineplot for the average <code>DaysOnZillow_AllHomes</code> per date.
</li>
<li>
1-2 sentences commenting on the patterns found in the plot, and your impressions of it.
</li>
</ul>
</div>
</div>
<div id="solution-68" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">states2010plus &lt;-<span class="st"> </span><span class="kw">subset</span>(states, year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2010</span>)
avgdays &lt;-<span class="st"> </span><span class="kw">tapply</span>(states2010plus<span class="op">$</span>DaysOnZillow_AllHomes, states2010plus<span class="op">$</span>Date, mean, <span class="dt">na.rm=</span>T)
<span class="kw">plot</span>(<span class="kw">ymd</span>(<span class="kw">names</span>(avgdays)), avgdays, <span class="dt">type=</span><span class="st">&#39;l&#39;</span>)</code></pre></div>
</div>
<div id="do-homes-sell-faster-in-certain-states-for-the-following-states-california-indiana-newyork-and-florida-make-a-lineplot-for-daysonzillow_allhomes-by-date-with-one-line-per-state.-use-the-states2010plus-dataset-for-this-question.-make-sure-to-have-each-state-line-colored-differently-and-to-add-a-legend-to-your-plot.-examine-the-plot-and-write-1-2-sentences-about-any-observations-you-have." class="section level5">
<h5>6. Do homes sell faster in certain states? For the following states: 'California', 'Indiana', 'NewYork' and 'Florida', make a lineplot for <code>DaysOnZillow_AllHomes</code> by <code>Date</code> with one line per state. Use the <code>states2010plus</code> dataset for this question. Make sure to have each state line colored differently, and to add a legend to your plot. Examine the plot and write 1-2 sentences about any observations you have.</h5>
<p><strong>Hint:</strong> You may want to use the <code>lines</code> function to add the lines for different state.</p>
<p><strong>Hint:</strong> Make sure to fix the y-axis limits using the <code>ylim</code> argument in <code>plot</code> to properly show all four lines.</p>
<p><strong>Hint:</strong> You may find the argument <code>col</code> useful to change the color of your line.</p>
<p><strong>Hint:</strong> To make your legend fit, consider using the states abbreviation, and the arguments <code>ncol</code> and <code>cex</code> of the <code>legend</code> function.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-subset">subset</a>, <a href="r.html#r-indexing">indexing</a>, <a href="r.html#r-plot">plot</a>, <a href="r.html#r-lines">lines</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the question.
</li>
<li>
The time series lineplot for <code>DaysOnZillow_AllHomes</code> per date for the 4 states.
</li>
<li>
1-2 sentences commenting on the patterns found in the plot, and your answer to the question &quot;Do homes sell faster in certain states rather than others?&quot;.
</li>
</ul>
</div>
</div>
<div id="solution-69" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">indiana &lt;-<span class="st"> </span><span class="kw">subset</span>(states2010plus, RegionName<span class="op">==</span><span class="st">&quot;Indiana&quot;</span>)
california &lt;-<span class="st"> </span><span class="kw">subset</span>(states2010plus, RegionName<span class="op">==</span><span class="st">&quot;California&quot;</span>)
florida &lt;-<span class="st"> </span><span class="kw">subset</span>(states2010plus, RegionName<span class="op">==</span><span class="st">&quot;Florida&quot;</span>)
new_york &lt;-<span class="st"> </span><span class="kw">subset</span>(states2010plus, RegionName<span class="op">==</span><span class="st">&quot;NewYork&quot;</span>)
<span class="kw">plot</span>(california<span class="op">$</span>Date, california<span class="op">$</span>DaysOnZillow_AllHomes, <span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">col=</span><span class="st">&#39;tomato&#39;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="kw">min</span>(states2010plus<span class="op">$</span>DaysOnZillow_AllHomes, <span class="dt">na.rm=</span>T), <span class="dv">210</span>), <span class="dt">ylab=</span><span class="st">&#39;Days on zillow&#39;</span>, <span class="dt">xlab =</span> <span class="st">&#39;Date&#39;</span>)
<span class="kw">lines</span>(indiana<span class="op">$</span>Date, indiana<span class="op">$</span>DaysOnZillow_AllHomes, <span class="dt">col=</span><span class="st">&#39;steelblue&#39;</span>)
<span class="kw">lines</span>(florida<span class="op">$</span>Date, florida<span class="op">$</span>DaysOnZillow_AllHomes, <span class="dt">col=</span><span class="st">&#39;green&#39;</span>)
<span class="kw">lines</span>(new_york<span class="op">$</span>Date, new_york<span class="op">$</span>DaysOnZillow_AllHomes, <span class="dt">col=</span><span class="st">&#39;black&#39;</span>)
<span class="kw">legend</span>(<span class="st">&#39;topright&#39;</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&#39;CA&#39;</span>,<span class="st">&#39;IN&#39;</span>,<span class="st">&#39;FL&#39;</span>, <span class="st">&#39;NY&#39;</span>),<span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;tomato&#39;</span>,<span class="st">&#39;steelblue&#39;</span>,<span class="st">&#39;green&#39;</span>,<span class="st">&#39;black&#39;</span>), <span class="dt">ncol=</span><span class="dv">2</span>, <span class="dt">cex=</span>.<span class="dv">7</span>)</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p13-190" class="section level3">
<h3>Project 13</h3>
<hr />
<p><strong>Motivation:</strong> It's important to be able to lookup and understand the documentation of a new function. You may have looked up the documentation of functions like <code>paste0</code> or <code>sapply</code>, and noticed that in the &quot;usage&quot; section, one of the arguments is an ellipsis (<code>...</code>). Well, unless you understand what this does, it's hard to really <em>get</em> it. In this project, we will experiment with ellipsis, and write our own function that utilizes one.</p>
<p><strong>Context:</strong> We've learned about, used, and written functions in many projects this semester. In this project, we will utilize some of the less-known features of functions.</p>
<p><strong>Scope:</strong> r, functions</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Read and write basic (csv) data.
</li>
<li>
Explain and demonstrate: positional, named, and logical indexing.
</li>
<li>
Utilize apply functions in order to solve a data-driven problem.
</li>
<li>
Gain proficiency using split, merge, and subset.
</li>
<li>
Demostrate the ability to create basic graphs with default settings.
</li>
<li>
Demonstratre the ability to modify axes labels and titles.
</li>
<li>
Incorporate legends using legend().
</li>
<li>
Demonstrate the ability to customize a plot (color, shape/linetype).
</li>
<li>
Convert strings to dates, and format dates using the lubridate package.
</li>
</ul>
</div>
<div id="dataset-11" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/beer/</code></p>
</div>
<div id="questions-12" class="section level4">
<h4>Questions</h4>
<div id="read-classdataminedatabeerbeers.csv-into-a-data.frame-named-beers.-read-classdataminedatabeerbreweries.csv-into-a-data.frame-named-breweries.-read-classdataminedatabeerreviews.csv-into-a-data.frame-named-reviews." class="section level5">
<h5>1. Read <code>/class/datamine/data/beer/beers.csv</code> into a data.frame named <code>beers</code>. Read <code>/class/datamine/data/beer/breweries.csv</code> into a data.frame named <code>breweries</code>. Read <code>/class/datamine/data/beer/reviews.csv</code> into a data.frame named <code>reviews</code>.</h5>
<p><strong>Hint:</strong> Notice that <code>reviews.csv</code> is a <em>large</em> file. Luckily, you can use a function from the famous <code>data.table</code> package called <code>fread</code>. The function <code>fread</code> is <em>much</em> faster at reading large file compared to <code>read.csv</code>. It reads the data into a class called <code>data.table</code>. We will learn more about this later on. For now, use <code>fread</code> to read in the <code>reviews.csv</code> data then convert it from the <code>data.table</code> class into a <code>data.frame</code> by wrapping the result of <code>fread</code> in the <code>data.frame</code> function.</p>
<p><strong>Hint:</strong> Do not forget to load the <code>data.table</code> library before attempeting to use the <code>fread</code> function.</p>
<p>Below we show you an example of how fast the <code>fread</code> function is compared to<code>read.csv</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">microbenchmark</span>(<span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/beer/reviews.csv&quot;</span>, <span class="dt">nrows=</span><span class="dv">100000</span>), <span class="kw">data.frame</span>(<span class="kw">fread</span>(<span class="st">&quot;/class/datamine/data/beer/reviews.csv&quot;</span>, <span class="dt">nrows=</span><span class="dv">100000</span>)), <span class="dt">times=</span><span class="dv">5</span>)</code></pre></div>
<pre class="txt"><code>Unit: milliseconds
expr
read.csv(&quot;/class/datamine/data/beer/reviews.csv&quot;, nrows = 1e+05)
data.frame(fread(&quot;/class/datamine/data/beer/reviews.csv&quot;, nrows = 1e+05))
       min        lq      mean    median        uq       max neval
 5948.6289 6482.3395 6746.8976 7040.5881 7086.6728 7176.2589     5
  120.7705  122.3812  127.9842  128.7794  133.7695  134.2205     5</code></pre>
<p><strong>Hint:</strong> This video demonstrates how to read the <code>reviews</code> data using <code>fread</code>.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_ehwecfrs&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_59izstx6">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-fread">fread</a>, <a href="r.html#r-data-frames">data.frame</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
</ul>
</div>
</div>
<div id="take-some-time-to-explore-the-datasets.-like-many-datasets-our-data-is-broken-into-3-tables.-what-columns-connect-each-table-how-many-breweries-in-breweries-dont-have-an-associated-beer-in-beers-how-many-beers-in-beers-dont-have-an-associated-brewery-in-breweries" class="section level5">
<h5>2. Take some time to explore the datasets. Like many datasets, our data is broken into 3 &quot;tables&quot;. What columns connect each table? How many breweries in <code>breweries</code> don't have an associated beer in <code>beers</code>? How many beers in <code>beers</code> don't have an associated brewery in <code>breweries</code>?</h5>
<p><strong>Hint:</strong> We compare lists of names using <code>sum</code> or <code>intersect</code>. Similar techniques can be used for Question 2.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_l3rehgyu&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_nqqp8016">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-names">names</a>, <a href="r.html#r-in">in</a>, <a href="r.html#r-logical-operators">logical operators</a>, <a href="r.html#r-unique">unique</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
A description of columns which connect each of the files.
</li>
<li>
How many breweries don't have an associated beer in <code>beers</code>.
</li>
<li>
How many beers don't have an associated brewery in <code>breweries</code>.
</li>
</ul>
</div>
</div>
<div id="run-sapply-and-look-at-the-usage-section-for-sapply.-if-you-look-at-the-description-for-the-...-argument-youll-see-it-is-optional-arguments-to-fun.-what-this-means-is-you-can-specify-additional-input-for-the-function-you-are-passing-to-sapply.-one-example-would-be-passing-t-to-na.rm-in-the-mean-function-sapplydat-mean-na.rmt.-use-sapply-and-the-strsplit-function-to-separate-the-types-of-breweries-types-by-commas.-use-another-sapply-to-loop-through-your-results-and-count-the-number-of-types-for-each-brewery.-be-sure-to-name-your-final-results-n_types.-what-is-the-average-amount-of-services-n_types-breweries-in-in-and-mi-offer-we-are-looking-for-the-average-of-in-and-mi-combined-does-that-surprise-you" class="section level5">
<h5>3. Run <code>?sapply</code> and look at the usage section for <code>sapply</code>. If you look at the description for the <code>...</code> argument, you'll see it is &quot;optional arguments to <code>FUN</code>&quot;. What this means is you can specify additional input for the function you are passing to <code>sapply</code>. One example would be passing <code>T</code> to <code>na.rm</code> in the mean function: <code>sapply(dat, mean, na.rm=T)</code>. Use <code>sapply</code> and the <code>strsplit</code> function to separate the types of breweries (<code>types</code>) by commas. Use another <code>sapply</code> to loop through your results and count the number of types for each brewery. Be sure to name your final results <code>n_types</code>. What is the average amount of services (<code>n_types</code>) breweries in IN and MI offer (we are looking for the average of IN and MI <em>combined</em>)? Does that surprise you?</h5>
<p><strong>Note:</strong> When you have one <code>sapply</code> inside of another, or one loop inside of another, or an if/else statement inside of another, this is commonly referred to as nesting. So when Googling, you can type &quot;nested sapply&quot; or &quot;nested if statements&quot;, etc.</p>
<p><strong>Hint:</strong> We show, in this video, how to find the average number of parts in a midwesterner's name. Perhaps surprisingly, this same technique will be useful in solving Question 3.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_yypsv2ab&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_bc0lctho">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-sapply">sapply</a>, <a href="r.html#r-ellipsis">...</a>,<a href="r.html#r-writing-functions">strplit</a>, <a href="r.html#r-in">in</a>, <a href="r.html#r-mean">mean</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the question.
</li>
<li>
1-2 sentences answering the average amount of services breweries in Indiana and Michigan offer, and commenting on this answer.
</li>
</ul>
</div>
</div>
<div id="write-a-function-called-compare_beers-that-accepts-a-function-that-you-will-call-fun-and-any-number-of-vectors-of-beer-ids.-the-function-compare_beers-should-cycle-through-each-vectorgroups-of-beer_ids-compute-the-function-fun-on-the-subset-of-reviews-and-print-group-x-some_score-where-x-is-the-number-1-and-some_score-is-the-result-of-applying-fun-on-the-subset-of-the-reviews-data." class="section level5">
<h5>4. Write a function called <code>compare_beers</code> that accepts a function that you will call <code>FUN</code>, and any number of vectors of beer ids. The function, <code>compare_beers</code>, should cycle through each vector/groups of <code>beer_id</code>s, compute the function, <code>FUN</code>, on the subset of <code>reviews</code>, and print &quot;Group X: some_score&quot; where X is the number 1+, and some_score is the result of applying <code>FUN</code> on the subset of the <code>reviews</code> data.</h5>
<p>In the example below the function <code>FUN</code> is the <code>median</code> function and we have two vectors/groups of <code>beer_id</code>s passed with c(271781) being group 1 and c(125646, 82352) group 2. Note that even though our example only passes two vectors to our <code>compare_beers</code> function, we want to write the function in a way that we could pass as many vectors as we want to.</p>
<p>Example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">compare_beers</span>(reviews, median, <span class="kw">c</span>(<span class="dv">271781</span>), <span class="kw">c</span>(<span class="dv">125646</span>, <span class="dv">82352</span>))</code></pre></div>
<p>This example gives the output:</p>
<pre class="txt"><code>Group 1: 4
Group 2: 4.56</code></pre>
<p>For your solution to this question, find the behavior of <code>compare_beers</code> in this example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">compare_beers</span>(reviews, median, <span class="kw">c</span>(<span class="dv">88</span>,<span class="dv">92</span>,<span class="dv">7971</span>), <span class="kw">c</span>(<span class="dv">74986</span>,<span class="dv">1904</span>), <span class="kw">c</span>(<span class="dv">34</span>,<span class="dv">102</span>,<span class="dv">104</span>,<span class="dv">355</span>))</code></pre></div>
<p><strong>Hint:</strong> There are different approaches to this question. You can use for loops or <code>sapply</code>. It will probably help to start small and build slowly toward the solution.</p>
<p><strong>Hint:</strong> This first video shows how to use <code>...</code> in defining a function.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_ic3jh9iz&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_wr4fpano">Click here for video</a></p>
<p><strong>Hint:</strong> This second video basically walks students through how to build this function. If you use this video to learn how to build this function, please be sure to acknowledge this in your project solutions.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_llfzgpvc&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_gzsmppek">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-in">in</a>, <a href="r.html#r-ellipsis">...</a>, <a href="r.html#r-indexing">indexing</a>, <a href="r.html#r-paste">paste0</a>, <a href="r.html#r-for-loops">for loops</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The result from running the provided example.
</li>
</ul>
</div>
</div>
<div id="beer-wars-in-and-mi-against-az-and-co.-use-the-function-you-wrote-in-question-4-to-compare-beer_id-from-each-group-of-states.-make-a-cool-plot-of-some-sort.-be-sure-to-comment-on-your-plot." class="section level5">
<h5>5. Beer wars! IN and MI against AZ and CO. Use the function you wrote in question (4) to compare beer_id from each group of states. Make a cool plot of some sort. Be sure to comment on your plot.</h5>
<p><strong>Hint:</strong> Create a vector of <code>beer_ids</code> per group before passing it to your function from (4).</p>
<p><strong>Hint:</strong> This video demonstrates an example of how to use the <code>compare_beers</code> function.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_8jjxs470&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_ebc161jc">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-in">in</a>, <a href="r.html#r-ellipsis">...</a>, <a href="r.html#r-indexing">indexing</a>, <a href="r.html#r-paste">paste0</a>, <a href="r.html#r-for-loops">for loops</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The result from running your function.
</li>
<li>
The resulting plot.
</li>
<li>
1-2 sentence commenting on your plot.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p14-190" class="section level3">
<h3>Project 14</h3>
<hr />
<p><strong>Motivation:</strong> Functions are the building blocks of more complex programming. It's vital that you understand how to read and write functions. In this project we will incrementally build and improve upon a function designed to recommend a beer. Note that you will not be winning any awards for this recommendation system, it is just for fun!</p>
<p><strong>Context:</strong> One of the main focuses throughout the semester has been on functions, and for good reason. In this project we will continue to exercise our R skills and build up our recommender function.</p>
<p><strong>Scope:</strong> r, functions</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Read and write basic (csv) data.
</li>
<li>
Explain and demonstrate: positional, named, and logical indexing.
</li>
<li>
Utilize apply functions in order to solve a data-driven problem.
</li>
<li>
Gain proficiency using split, merge, and subset.
</li>
</ul>
</div>
<div id="dataset-12" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/beer/</code></p>
</div>
<div id="questions-13" class="section level4">
<h4>Questions</h4>
<div id="read-classdataminedatabeerbeers.csv-into-a-data.frame-named-beers.-read-classdataminedatabeerbreweries.csv-into-a-data.frame-named-breweries.-read-classdataminedatabeerreviews.csv-into-a-data.frame-named-reviews.-as-in-the-previous-project-make-sure-you-used-the-fread-function-from-the-data.table-package-and-convert-the-data.table-to-a-data.frame.-we-want-to-create-a-very-basic-beer-recommender.-we-will-start-simple.-create-a-function-called-recommend_a_beer-that-takes-as-input-my_beer_id-a-single-value-and-returns-a-vector-of-beer_ids-from-the-same-style.-test-your-function-on-2093." class="section level5">
<h5>1. Read <code>/class/datamine/data/beer/beers.csv</code> into a data.frame named <code>beers</code>. Read <code>/class/datamine/data/beer/breweries.csv</code> into a data.frame named <code>breweries</code>. Read <code>/class/datamine/data/beer/reviews.csv</code> into a data.frame named <code>reviews</code>. As in the previous project, make sure you used the <code>fread</code> function from the <code>data.table</code> package, and convert the <code>data.table</code> to a <code>data.frame</code>. We want to create a very basic beer recommender. We will start simple. Create a function called <code>recommend_a_beer</code> that takes as input <code>my_beer_id</code> (a single value) and returns a vector of <code>beer_ids</code> from the same <code>style</code>. Test your function on <code>2093</code>.</h5>
<p><strong>Hint:</strong> Make sure you do not include the given <code>my_beer_id</code> in the vector of <code>beer_ids</code> containing the <code>beer_ids</code>of your recommended beers.</p>
<p><strong>Hint:</strong> You may find the function <code>setdiff</code> useful. Run the example below to get an idea of what it does.</p>
<p><strong>Note:</strong> You will not win any awards for this recommendation system!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>,<span class="st">&#39;b&#39;</span>,<span class="st">&#39;c&#39;</span>)
y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;c&#39;</span>,<span class="st">&#39;b&#39;</span>,<span class="st">&#39;d&#39;</span>,<span class="st">&#39;e&#39;</span>,<span class="st">&#39;f&#39;</span>)
<span class="kw">setdiff</span>(x,y)</code></pre></div>
<pre><code>## [1] &quot;a&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setdiff</span>(y,x)</code></pre></div>
<pre><code>## [1] &quot;d&quot; &quot;e&quot; &quot;f&quot;</code></pre>
<p><strong>Relevant topics:</strong> <a href="r.html#r-fread">fread</a>, <a href="r.html#r-data-frames">data.frame</a>, <a href="r.html#r-writing-functions">function</a>, <a href="r.html#r-setdiff">setdiff</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Length of result from <code>recommend_a_beer(2093)</code>.
</li>
<li>
The result of <code>2093 %in% recommend_a_beer(2093)</code>.
</li>
</ul>
</div>
</div>
<div id="that-is-a-lot-of-beer-recommendations-lets-try-to-narrow-it-down.-include-an-argument-in-your-function-called-min_score-with-default-value-of-4.5.-our-recommender-will-only-recommend-beer_ids-with-a-review-score-of-at-least-min_score.-test-your-improved-beer-recommender-with-the-same-beer_id-from-question-1." class="section level5">
<h5>2. That is a lot of beer recommendations! Let's try to narrow it down. Include an argument in your function called <code>min_score</code> with default value of 4.5. Our recommender will only recommend <code>beer_ids</code> with a review score of at least <code>min_score</code>. Test your improved beer recommender with the same <code>beer_id</code> from question (1).</h5>
<p><strong>Hint:</strong> Note that now we need to look at both <code>beers</code> and <code>reviews</code> datasets.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-in">in</a>, <a href="r.html#r-unique">unique</a>, <a href="r.html#r-subset">subset</a>/<a href="r.html#r-indexing">indexing</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Length of result from <code>recommend_a_beer(2093)</code>.
</li>
</ul>
</div>
</div>
<div id="there-is-still-room-for-improvement-obviously-for-our-beer-recommender.-include-a-new-argument-in-your-function-called-same_brewery_only-with-default-value-false.-this-argument-will-determine-whether-or-not-our-beer-recommender-will-return-only-beers-from-the-same-brewery.-test-our-newly-improved-beer-recommender-with-the-same-beer_id-from-question-1-with-the-argument-same_brewery_only-set-to-true." class="section level5">
<h5>3. There is still room for improvement (obviously) for our beer recommender. Include a new argument in your function called <code>same_brewery_only</code> with default value <code>FALSE</code>. This argument will determine whether or not our beer recommender will return only beers from the same brewery. Test our newly improved beer recommender with the same <code>beer_id</code> from question (1) with the argument <code>same_brewery_only</code> set to <code>TRUE</code>.</h5>
<p><strong>Hint:</strong> You may find the function <code>intersect</code> useful. Run the example below to get an idea of what it does.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>,<span class="st">&#39;b&#39;</span>,<span class="st">&#39;c&#39;</span>)
y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;c&#39;</span>,<span class="st">&#39;b&#39;</span>,<span class="st">&#39;d&#39;</span>,<span class="st">&#39;e&#39;</span>,<span class="st">&#39;f&#39;</span>)
<span class="kw">intersect</span>(x,y)</code></pre></div>
<pre><code>## [1] &quot;b&quot; &quot;c&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">intersect</span>(y,x)</code></pre></div>
<pre><code>## [1] &quot;c&quot; &quot;b&quot;</code></pre>
<p><strong>Relevant topics:</strong> <a href="r.html#r-if-else">if/else</a>, <a href="r.html#r-subset">subset</a>, <a href="r.html#r-intersect">intersect</a>, <a href="r.html#r-indexing">indexing</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Length of result from <code>recommend_a_beer(2093, same_brewery_only=TRUE)</code>.
</li>
</ul>
</div>
</div>
<div id="oops-bad-idea-maybe-including-only-beers-from-the-same-brewery-is-not-the-best-idea.-add-an-argument-to-our-beer-recommender-named-type.-if-typestyle-our-recommender-will-recommend-beers-based-on-the-style-as-we-did-in-question-3.-if-typereviewers-our-recommender-will-recommend-beers-based-on-reviewers-with-similar-taste.-select-reviewers-that-gave-score-equal-to-or-greater-than-min_score-for-the-given-beer-id-my_beer_id.-for-those-reviewers-find-the-beer_ids-for-other-beers-that-these-reviewers-have-given-a-score-of-at-least-min_score.-these-beer_ids-are-the-ones-our-recommender-will-return.-be-sure-to-test-our-improved-recommender-on-the-same-beer_id-as-in-1-3." class="section level5">
<h5>4. Oops! Bad idea! Maybe including only beers from the same brewery is not the best idea. Add an argument to our beer recommender named <code>type</code>. If <code>type=style</code> our recommender will recommend beers based on the <code>style</code> as we did in question (3). If <code>type=reviewers</code>, our recommender will recommend beers based on reviewers with &quot;similar taste&quot;. Select reviewers that gave score equal to or greater than <code>min_score</code> for the given beer id (<code>my_beer_id</code>). For those reviewers, find the <code>beer_ids</code> for other beers that these reviewers have given a score of at least <code>min_score</code>. These <code>beer_ids</code> are the ones our recommender will return. Be sure to test our improved recommender on the same <code>beer_id</code> as in (1)-(3).</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-if-else">if</a>, <a href="r.html#r-subset">subset</a>, <a href="r.html#r-in">in</a>, <a href="r.html#r-setdiff">setdiff</a>, <a href="r.html#r-unique">unique</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Length of result from <code>recommend_a_beer(2093, type=&quot;reviewers&quot;)</code>.
</li>
</ul>
</div>
</div>
<div id="lets-try-to-narrow-down-the-recommendations.-include-an-argument-called-abv_range-that-indicates-the-abv-range-we-would-like-the-recommended-beers-to-be-at.-set-abv_range-default-value-to-null-so-that-if-a-user-does-not-specify-the-abv_range-our-recommender-does-not-consider-it.-test-our-recommender-for-beer_id-2093-with-abv_range-c8.99.1-and-min_score4.9." class="section level5">
<h5>5. Let's try to narrow down the recommendations. Include an argument called <code>abv_range</code> that indicates the abv range we would like the recommended beers to be at. Set <code>abv_range</code> default value to <code>NULL</code> so that if a user does not specify the <code>abv_range</code> our recommender does not consider it. Test our recommender for <code>beer_id</code> 2093, with <code>abv_range = c(8.9,9.1)</code> and <code>min_score=4.9</code>.</h5>
<p><strong>Hint:</strong> You may find the function <code>is.null</code> useful.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-if-else">if</a>, <a href="r.html#r-logical-operators">&gt;=</a>, <a href="r.html#r-logical-operators">&lt;=</a>, <a href="r.html#r-intersect">intersect</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Length of result from <code>recommend_a_beer(2093, abv_range=c(8.9, 9.1), type=&quot;reviewers&quot;, min_score=4.9)</code>.
</li>
</ul>
</div>
</div>
<div id="play-with-our-recommend_a_beer-function.-include-another-feature-to-it.-some-ideas-are-putting-a-limit-on-the-number-of-beer_ids-we-will-return-error-catching-what-if-we-dont-have-reviews-for-a-given-beer_id-including-a-plot-to-the-output-returning-beer-names-instead-of-ids-or-new-arguments-to-decide-what-beer_ids-to-recommend.-be-creative-and-have-fun" class="section level5">
<h5>6. Play with our <code>recommend_a_beer</code> function. Include another feature to it. Some ideas are: putting a limit on the number of <code>beer_id</code>s we will return, error catching (what if we don't have reviews for a given <code>beer_id</code>?), including a plot to the output, returning beer names instead of ids or new arguments to decide what <code>beer_id</code>s to recommend. Be creative and have fun!</h5>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The result from running the improved <code>recommend_a_beer</code> function showcasing your improvements to it.
</li>
<li>
1-2 sentecens commenting on what you decided to include and why.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p15-190" class="section level3">
<h3>Project 15</h3>
<hr />
<p><strong>Motivation:</strong> Some people say it takes 20 hours to learn a skill, some say 10,000 hours. What is certain is it definitely takes time. In this project we will explore an interesting dataset and exercise some of the skills learned this semester.</p>
<p><strong>Context:</strong> This is the final project of the semester. We sincerely hope that you've learned something, and that we've provided you with first hand experience digging through data.</p>
<p><strong>Scope:</strong> r</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Read and write basic (csv) data.
</li>
<li>
Explain and demonstrate: positional, named, and logical indexing.
</li>
<li>
Utilize apply functions in order to solve a data-driven problem.
</li>
<li>
Gain proficiency using split, merge, and subset.
</li>
</ul>
</div>
<div id="dataset-13" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/donerschoose/</code></p>
</div>
<div id="questions-14" class="section level4">
<h4>Questions</h4>
<div id="read-the-data-classdataminedatadonerschooseprojects.csv-into-a-data.frame-called-projects.-make-sure-you-use-the-function-you-learned-in-project-13-fread-from-the-data.table-package-to-read-the-data.-dont-forget-to-then-convert-the-data.table-into-a-data.frame.-lets-do-an-initial-exploration-of-this-data.-what-types-of-projects-project.type-are-there-how-many-resource-categories-project.resource.category-are-there" class="section level5">
<h5>1. Read the data <code>/class/datamine/data/donerschoose/Projects.csv</code> into a data.frame called <code>projects</code>. Make sure you use the function you learned in Project 13 (<code>fread</code>) from the <code>data.table</code> package to read the data. Don't forget to then convert the <code>data.table</code> into a <code>data.frame</code>. Let's do an initial exploration of this data. What types of projects (<code>Project.Type</code>) are there? How many resource categories (<code>Project.Resource.Category</code>) are there?</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-fread">fread</a>, <a href="r.html#r-unique">unique</a>, <a href="r.html#r-length">length</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the question.
</li>
<li>
1-2 sentences containing the project's types and how many resource categories are in the dataset.
</li>
</ul>
</div>
</div>
<div id="create-two-new-variables-in-projects-the-number-of-days-a-projects-lasted-and-the-number-of-days-until-the-project-was-fully-funded.-name-those-variables-project_duration-and-time_until_funded-respectively.-to-calculate-them-use-the-projects-posted-date-project.posted.date-expiration-date-project.expiration.date-and-fully-funded-date-project.fully.funded.date.-what-are-the-shortest-and-longest-times-until-a-project-is-fully-funded-for-consistency-check-see-if-we-have-any-negative-projects-duration.-if-so-how-many" class="section level5">
<h5>2. Create two new variables in <code>projects</code>, the number of days a project's lasted and the number of days until the project was fully funded. Name those variables <code>project_duration</code> and <code>time_until_funded</code>, respectively. To calculate them use the project's posted date (<code>Project.Posted.Date</code>), expiration date (<code>Project.Expiration.Date</code>), and fully funded date (<code>Project.Fully.Funded.Date</code>). What are the shortest and longest times until a project is fully funded? For consistency check, see if we have any negative project's duration. If so, how many?</h5>
<p><strong>Hint:</strong> You <em>may</em> find the argument <code>units</code> in the function <code>difftime</code> useful.</p>
<p><strong>Hint:</strong> Be sure to pay attention to the order of operations of <code>difftime</code>.</p>
<p><strong>Hint:</strong> Note that if you used the <code>fread</code> function from <code>data.table</code> to read in the data, you will not need to convert the columns as date.</p>
<p><strong>Hint:</strong> It is <em>not</em> required that you use <code>difftime</code>.</p>
<p><strong>Relevant topics:</strong> <a href="r#-difftime">difftime</a>, <a href="r.html#r-lubridate">lubridate</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the question.
</li>
<li>
Shortest and longest times until a project is fully funded.
</li>
<li>
1-2 sentences answering whether we have if we have negative project's duration, and if so how many.
</li>
</ul>
</div>
</div>
<div id="as-you-noted-in-question-2-there-may-be-some-projects-with-negative-duration-time.-as-we-may-have-some-concerns-for-the-data-regarding-these-projects-filter-the-projects-data-to-exclude-the-projects-with-negative-duration-and-call-this-filtered-data-selected_projects.-with-that-filtered-data-make-a-dotchart-for-mean-time-until-the-project-is-fully-funded-time_until_funded-for-the-various-resource-categories-project.resource.category.-make-sure-to-comment-on-your-results.-are-they-surprising-could-there-be-another-variable-influencing-this-result-if-so-name-at-least-one." class="section level5">
<h5>3. As you noted in question (2) there may be some project's with negative duration time. As we may have some concerns for the data regarding these projects, filter the <code>projects</code> data to exclude the projects with negative duration, and call this filtered data <code>selected_projects</code>. With that filtered data, make a <code>dotchart</code> for mean time until the project is fully funded (<code>time_until_funded</code>) for the various resource categories (<code>Project.Resource.Category</code>). Make sure to comment on your results. Are they surprising? Could there be another variable influencing this result? If so, name at least one.</h5>
<p><strong>Hint:</strong> You will first need to average time until fully funded for the different categories before making your plot.</p>
<p><strong>Hint:</strong> To make your <code>dotchart</code> look nicer, you may want to first order the average time until fully funded before passing it to the <code>dotchart</code> function. In addition, consider reducing the y-axis font size using the argument <code>cex</code>.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-indexing">indexing</a>, <a href="r.html#r-subset">subset</a>, <a href="r.html#r-tapply">tapply</a>, <a href="r.html#r-dotchart">dotchart</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the question.
</li>
<li>
Resulting dotchart.
</li>
<li>
1-2 sentences commenting on your plot. Make sure to mention whether you are surprised or not by the results. Don't forget to add if you think there could be more factors influencing your answer, and if so, be sure to give examples.
</li>
</ul>
</div>
</div>
<div id="read-classdataminedatadonerschooseschools.csv-into-a-data.frame-called-schools.-combine-selected_projects-and-schools-by-school.id-keeping-only-school.ids-present-in-both-datasets.-name-the-combined-data.frame-selected_projects.-use-the-newly-combined-data-to-determine-the-percentage-of-already-fully-funded-projects-project.current.status-for-schools-in-west-lafayette-in.-in-addition-determine-the-state-school.state-with-the-highest-number-of-projects.-be-sure-to-specify-the-number-of-projects-this-state-has." class="section level5">
<h5>4. Read <code>/class/datamine/data/donerschoose/Schools.csv</code> into a data.frame called <code>schools</code>. Combine <code>selected_projects</code> and <code>schools</code> by <code>School.ID</code> keeping only <code>School.ID</code>s present in both datasets. Name the combined data.frame <code>selected_projects</code>. Use the newly combined data to determine the percentage of already fully funded projects (<code>Project.Current.Status</code>) for schools in West Lafayette, IN. In addition, determine the state (<code>School.State</code>) with the highest number of projects. Be sure to specify the number of projects this state has.</h5>
<p><strong>Hint:</strong> West Lafayette, IN zip codes are 47906 and 47907.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-fread">fread</a>, <a href="r.html#r-subset">subset</a>, <a href="r.html#r-indexing">indexing</a>, <a href="r.html#r-merge">merge</a>, <a href="r.html#r-table">table</a>, <a href="r.html#r-table">prop.table</a>, <a href="r.html#r-which">which.max</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the question.
</li>
<li>
1-2 sentences answering the percentage of already fully funded projects for schools in West Lafayette, IN, the state with the highest number of projects, and the number of projects this state has.
</li>
</ul>
</div>
</div>
<div id="using-the-combined-selected_projects-data-get-the-schools-school.name-citycities-school.city-and-states-school.state-for-the-teacher-with-the-highest-percentage-of-fully-funded-projects-project.current.status." class="section level5">
<h5>5. Using the combined <code>selected_projects</code> data, get the school(s) (<code>School.Name</code>), city/cities (<code>School.City</code>) and state(s) (<code>School.State</code>) for the teacher with the highest percentage of fully funded projects (<code>Project.Current.Status</code>).</h5>
<p><strong>Hint:</strong> There are many ways to solve this problem. For example, one option to get the teacher's ID is to create a variable indicating whether or not the project is fully funded and use <code>tapply</code>. Another option is to create <code>prop.table</code> and select the corresponding column/row.</p>
<p><strong>Hint:</strong> Note that each row in the data corresponds to a unique project ID.</p>
<p><strong>Hint:</strong> Once you have the teacher's ID, consider filtering <code>projects</code> to contain only rows for which the corresponding teacher's ID is in, and only the columns we are interested in: <code>School.Name</code>, <code>School.City</code>, and <code>School.State</code>. Then, you can get the unique values in this shortened data.</p>
<p><strong>Hint:</strong> To get only certain columns when subetting, you may find the argument <code>select</code> from <code>subset</code> useful.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-indexing">indexing</a>, <a href="r.html#r-which">which</a>, <a href="r.html#r-max">max</a>, <a href="r.html#r-subset">subset</a>, <a href="r.html#r-unique">unique</a>, <a href="r.html#r-data-frames">row.names</a> (if using <code>table</code>), <a href="r.html#r-names">names</a> (if using <code>tapply</code>)</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the question.
</li>
<li>
Output of your code containing school(s), city(s) and state(s) of the selected teacher.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
</div>
<div id="fall2020-stat-29000" class="section level2">
<h2>STAT 29000</h2>
<div id="fall2020-p01-290" class="section level3">
<h3>Project 1</h3>
<hr />
<p><strong>Motivation:</strong> In this project we will jump right into an R review. In this project we are going to break one larger data-wrangling problem into discrete parts. There is a slight emphasis on writing functions and dealing with strings. At the end of this project we will have greatly simplified a dataset, making it easy to dig into.</p>
<p><strong>Context:</strong> We just started the semester and are digging into a large dataset, and in doing so, reviewing R concepts we've previously learned.</p>
<p><strong>Scope:</strong> data wrangling in R, functions</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Comprehend what a function is, and the components of a function in R.
</li>
<li>
Read and write basic (csv) data.
</li>
<li>
Utilize apply functions in order to solve a data-driven problem.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<p>You can find useful examples that walk you through relevant material in The Examples Book:</p>
<p><a href="https://thedatamine.github.io/the-examples-book" class="uri">https://thedatamine.github.io/the-examples-book</a></p>
<p>It is highly recommended to read through, search, and explore these examples to help solve problems in this project.</p>
<p><strong>Important note:</strong> It is highly recommended that you use <a href="https://rstudio.scholar.rcac.purdue.edu/" class="uri">https://rstudio.scholar.rcac.purdue.edu/</a>. Simply click on the link and login using your Purdue account credentials.</p>
<p>We decided to move away from ThinLinc and away from the version of RStudio used last year (<a href="https://desktop.scholar.rcac.purdue.edu" class="uri">https://desktop.scholar.rcac.purdue.edu</a>). That version of RStudio is known to have some strange issues when running code chunks.</p>
<p>Remember the very useful documentation shortcut <code>?</code>. To use, simply type <code>?</code> in the console, followed by the name of the function you are interested in.</p>
<p>You can also look for package documentation by using <code>help(package=PACKAGENAME)</code>, so for example, to see the documentation for the package <code>ggplot2</code>, we could run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">help</span>(<span class="dt">package=</span>ggplot2)</code></pre></div>
<p>Sometimes it can be helpful to see the source code of a defined function. A <a href="https://www.tutorialspoint.com/r/r_functions.htm">function</a> is any chunk of organized code that is used to perform an operation. Source code is the underlying <code>R</code> or <code>c</code> or <code>c++</code> code that is used to create the function. To see the source code of a defined function, type the function's name without the <code>()</code>. For example, if we were curious about what the function <code>Reduce</code> does, we could run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Reduce</code></pre></div>
<p>Occasionally this will be less useful as the resulting code will be code that calls <code>c</code> code we can't see. Other times it will allow you to understand the function better.</p>
<div id="dataset-14" class="section level4">
<h4>Dataset:</h4>
<p><code>/class/datamine/data/airbnb</code></p>
<p>Often times (maybe even the majority of the time) data doesn’t come in one nice file or database. Explore the datasets in <code>/class/datamine/data/airbnb</code>.</p>
<div id="you-may-have-noted-that-for-each-country-city-and-date-we-can-find-3-files-calendar.csv.gz-listings.csv.gz-and-reviews.csv.gz-for-now-we-will-ignore-all-files-in-the-visualisations-folders." class="section level5">
<h5>1. You may have noted that, for each country, city, and date we can find 3 files: <code>calendar.csv.gz</code>, <code>listings.csv.gz</code>, and <code>reviews.csv.gz</code> (for now, we will ignore all files in the &quot;visualisations&quot; folders).</h5>
</div>
<div id="lets-take-a-look-at-the-data-in-each-of-the-three-types-of-files.-pick-a-country-city-and-date-and-read-the-first-50-rows-of-each-of-the-3-datasets-calendar.csv.gz-listings.csv.gz-and-reviews.csv.gz.-provide-1-2-sentences-explaining-the-type-of-information-found-in-each-and-what-variables-could-be-used-to-join-them." class="section level5">
<h5>Let's take a look at the data in each of the three types of files. Pick a country, city and date, and read the first 50 rows of each of the 3 datasets (<code>calendar.csv.gz</code>, <code>listings.csv.gz</code>, and <code>reviews.csv.gz</code>). Provide 1-2 sentences explaining the type of information found in each, and what variable(s) could be used to join them.</h5>
<p><strong>Hint:</strong> <code>read.csv</code> has an argument to select the number of rows we want to read.</p>
<p><strong>Hint:</strong> Depending on the country that you pick, the listings and/or the reviews might not display properly in RMarkdown. So you do not need to display the first 50 rows of the listings and/or reviews, in your RMarkdown document. It is OK to just display the first 50 rows of the calendar entries.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Chunk of code used to read the first 50 rows of each dataset.
</li>
<li>
1-2 sentences briefly describing the information contained in each dataset.
</li>
<li>
Name(s) of variable(s) that could be used to join them.
</li>
</ul>
</div>
<p>To read a compressed csv, simply use the <code>read.csv</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/airbnb/brazil/rj/rio-de-janeiro/2019-06-19/data/calendar.csv.gz&quot;</span>)
<span class="kw">head</span>(dat)</code></pre></div>
</div>
<div id="solution-70" class="section level5">
<h5>Solution</h5>
<p>The <code>calendar.csv.gz</code> file for 2019-07-08 in Hawaii describes the <code>listing_id</code>, <code>date</code>, <code>available</code> (t or f), <code>price</code>, <code>adjusted_price</code>, <code>minimum_nights</code>, and <code>maximum_nights</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hawaii_calendar &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/airbnb/united-states/hi/hawaii/2019-07-08/data/calendar.csv.gz&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(hawaii_calendar, <span class="dt">n=</span><span class="dv">50</span>)</code></pre></div>
<p>The <code>listings.csv.gz</code> file for 2019-07-08 in Hawaii has 106 variables, which describe the very specific attributes of the airbnb listings.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hawaii_listings &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/airbnb/united-states/hi/hawaii/2019-07-08/data/listings.csv.gz&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(hawaii_listings)</code></pre></div>
<p>The <code>reviews.csv.gz</code> file for 2019-07-08 in Hawaii describes the <code>listing_id</code>, <code>id</code>, <code>date</code>, <code>reviewer_id</code>, <code>reviewer_name</code>, and <code>comments</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hawaii_reviews &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/airbnb/united-states/hi/hawaii/2019-07-08/data/reviews.csv.gz&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(hawaii_reviews, <span class="dt">n=</span><span class="dv">50</span>)</code></pre></div>
<p>The variables that might be used to compare the tables are: <code>date</code>, <code>id</code>, <code>listing_id</code>, <code>maximum_nights</code>, <code>minimum_nights</code>, <code>price</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t &lt;-<span class="st"> </span><span class="kw">table</span>(<span class="kw">c</span>(<span class="kw">names</span>(hawaii_calendar), <span class="kw">names</span>(hawaii_listings), <span class="kw">names</span>(hawaii_reviews)))
t[t <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>]</code></pre></div>
<p>Let's work towards getting this data into an easier format to analyze. From now on, we will focus on the <code>listings.csv.gz</code> datasets.</p>
</div>
<div id="write-a-function-called-get_paths_for_country-that-given-a-string-with-the-country-name-returns-a-vector-with-the-full-paths-for-all-listings.csv.gz-files-starting-with-classdataminedataairbnb...." class="section level5">
<h5>2. Write a function called <code>get_paths_for_country</code>, that, given a string with the country name, returns a vector with the full paths for all <code>listings.csv.gz</code> files, starting with <code>/class/datamine/data/airbnb/...</code>.</h5>
</div>
<div id="for-example-the-output-from-get_paths_for_countryunited-states-should-have-28-entries.-here-are-the-first-5-entries-in-the-output" class="section level5">
<h5>For example, the output from <code>get_paths_for_country(&quot;united-states&quot;)</code> should have 28 entries. Here are the first 5 entries in the output:</h5>
<pre class="txt"><code> [1] &quot;/class/datamine/data/airbnb/united-states/ca/los-angeles/2019-07-08/data/listings.csv.gz&quot;       
 [2] &quot;/class/datamine/data/airbnb/united-states/ca/oakland/2019-07-13/data/listings.csv.gz&quot;           
 [3] &quot;/class/datamine/data/airbnb/united-states/ca/pacific-grove/2019-07-01/data/listings.csv.gz&quot;     
 [4] &quot;/class/datamine/data/airbnb/united-states/ca/san-diego/2019-07-14/data/listings.csv.gz&quot;         
 [5] &quot;/class/datamine/data/airbnb/united-states/ca/san-francisco/2019-07-08/data/listings.csv.gz&quot;     </code></pre>
<p><strong>Hint:</strong> <code>list.files</code> is useful with the <code>recursive=T</code> option.</p>
<p><strong>Hint:</strong> Use <code>grep</code> to search for the pattern <code>listings.csv.gz</code> (within the results from the first hint), and use the option <code>value=T</code> to display the values found by the <code>grep</code> function.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Chunk of code for your <code>get_paths_for_country</code> function.
</li>
</ul>
</div>
</div>
<div id="solution-71" class="section level5">
<h5>Solution</h5>
<p>We extract all 28 of the listings for the United States first:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myprefix &lt;-<span class="st"> &quot;/class/datamine/data/airbnb/united-states/&quot;</span>
<span class="kw">paste0</span>(myprefix, <span class="kw">grep</span>(<span class="st">&quot;listings.csv.gz&quot;</span>, <span class="kw">list.files</span>(myprefix, <span class="dt">recursive=</span>T), <span class="dt">value=</span>T))</code></pre></div>
<p>Now we build a function that can do the same thing, for any country</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">get_paths_for_country &lt;-<span class="st"> </span><span class="cf">function</span>(mycountry) {
  myprefix &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;/class/datamine/data/airbnb/&quot;</span>, mycountry, <span class="st">&quot;/&quot;</span>)
  <span class="kw">paste0</span>(myprefix, <span class="kw">grep</span>(<span class="st">&quot;listings.csv.gz&quot;</span>, <span class="kw">list.files</span>(myprefix, <span class="dt">recursive=</span>T), <span class="dt">value=</span>T))
}</code></pre></div>
<p>and we test this for several countries:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_paths_for_country</span>(<span class="st">&quot;united-states&quot;</span>)
<span class="kw">get_paths_for_country</span>(<span class="st">&quot;brazil&quot;</span>)
<span class="kw">get_paths_for_country</span>(<span class="st">&quot;south-africa&quot;</span>)
<span class="kw">get_paths_for_country</span>(<span class="st">&quot;canada&quot;</span>)</code></pre></div>
</div>
<div id="write-a-function-called-get_data_for_country-that-given-a-string-with-the-country-name-returns-a-data.frame-containing-the-all-listings-data-for-that-country.-use-your-previously-written-function-to-help-you." class="section level5">
<h5>3. Write a function called <code>get_data_for_country</code> that, given a string with the country name, returns a data.frame containing the all listings data for that country. Use your previously written function to help you.</h5>
<p><strong>Hint:</strong> Use <code>stringsAsFactors=F</code> in the <code>read.csv</code> function.</p>
<p><strong>Hint:</strong> Use <code>do.call(rbind, &lt;listofdataframes&gt;)</code> to combine a list of dataframes into a single dataframe.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-bind">rbind</a>, <a href="r.html#r-lapply">lapply</a>, <a href="r.html#r-writing-functions">function</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Chunk of code for your <code>get_data_for_country</code> function.
</li>
</ul>
</div>
</div>
<div id="solution-72" class="section level5">
<h5>Solution</h5>
<p>We first get the data from the Canada entries. To do this, we sapply the <code>read.csv</code> function to each of the 6 results from <code>get_paths_for_country(&quot;canada&quot;)</code> In other words, we read in these 6 data frames.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myresults &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">get_paths_for_country</span>(<span class="st">&quot;canada&quot;</span>), read.csv, <span class="dt">stringsAsFactors=</span>F, <span class="dt">simplify=</span>F)</code></pre></div>
<p>We get a list of 6 data frames:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(myresults)
<span class="kw">class</span>(myresults)
<span class="kw">class</span>(myresults[[<span class="dv">1</span>]])
<span class="kw">class</span>(myresults[[<span class="dv">6</span>]])</code></pre></div>
<p>and we can check the dimensions of each of the 6 data frames</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(myresults[[<span class="dv">1</span>]])
<span class="kw">dim</span>(myresults[[<span class="dv">2</span>]])
<span class="kw">dim</span>(myresults[[<span class="dv">3</span>]])
<span class="kw">dim</span>(myresults[[<span class="dv">4</span>]])
<span class="kw">dim</span>(myresults[[<span class="dv">5</span>]])
<span class="kw">dim</span>(myresults[[<span class="dv">6</span>]])</code></pre></div>
<p>this is more easily accomplished with another <code>sapply</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(myresults, dim)</code></pre></div>
<p>We can <code>rbind</code> all 6 of these data frames into one big data frame as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bigDF &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, myresults)
<span class="kw">class</span>(bigDF)
<span class="kw">dim</span>(bigDF)</code></pre></div>
<p>Now we create the desired function called <code>get_data_for_country</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">get_data_for_country &lt;-<span class="st"> </span><span class="cf">function</span>(mycountry) {
  myresults &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">get_paths_for_country</span>(mycountry), read.csv, <span class="dt">stringsAsFactors=</span>F, <span class="dt">simplify=</span>F)
  <span class="kw">do.call</span>(rbind, myresults)
}</code></pre></div>
<p>and we test it on Canada.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mynewbigDF &lt;-<span class="st"> </span><span class="kw">get_data_for_country</span>(<span class="st">&quot;canada&quot;</span>)</code></pre></div>
<p>The result has the same size as before</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(mynewbigDF)</code></pre></div>
</div>
<div id="use-your-get_data_for_country-to-get-the-data-for-a-country-of-your-choice-and-make-sure-to-name-the-data.frame-listings.-take-a-look-at-the-following-columns-host_is_superhost-host_has_profile_pic-host_identity_verified-and-is_location_exact.-what-is-the-data-type-for-each-column-you-can-use-class-or-typeof-or-str-to-see-the-data-type." class="section level5">
<h5>4. Use your <code>get_data_for_country</code> to get the data for a country of your choice, and make sure to name the data.frame <code>listings</code>. Take a look at the following columns: <code>host_is_superhost</code>, <code>host_has_profile_pic</code>, <code>host_identity_verified</code>, and <code>is_location_exact</code>. What is the data type for each column? (You can use <code>class</code> or <code>typeof</code> or <code>str</code> to see the data type.)</h5>
</div>
<div id="these-columns-would-make-more-sense-as-logical-values-truefalsena." class="section level5">
<h5>These columns would make more sense as logical values (TRUE/FALSE/NA).</h5>
</div>
<div id="write-a-function-called-transform_column-that-given-a-column-containing-lowercase-ts-and-fs-your-function-will-transform-it-to-logical-truefalsena-values.-note-that-na-values-for-these-columns-appear-as-blank-and-we-need-to-be-careful-when-transforming-the-data.-test-your-function-on-column-host_is_superhost." class="section level5">
<h5>Write a function called <code>transform_column</code> that, given a column containing lowercase &quot;t&quot;s and &quot;f&quot;s, your function will transform it to logical (TRUE/FALSE/NA) values. Note that NA values for these columns appear as blank (<code>&quot;&quot;</code>), and we need to be careful when transforming the data. Test your function on column <code>host_is_superhost</code>.</h5>
<p><strong>Relevant topics:</strong> class, typeof, str, toupper, as.logical</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Chunk of code for your <code>transform_column</code> function.
</li>
<li>
Type of <code>transform_column(listings$host_is_superhost)</code>.
</li>
</ul>
</div>
</div>
<div id="solution-73" class="section level5">
<h5>Solution</h5>
<p>These 4 columns from <code>mynewbigDF</code> (which has the data for Canada) only have values <code>&quot;t&quot;, &quot;f&quot;, &quot;&quot;</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(mynewbigDF<span class="op">$</span>host_is_superhost)
<span class="kw">head</span>(mynewbigDF<span class="op">$</span>host_has_profile_pic)
<span class="kw">head</span>(mynewbigDF<span class="op">$</span>host_identity_verified)
<span class="kw">head</span>(mynewbigDF<span class="op">$</span>is_location_exact)</code></pre></div>
<p>Please note the 44 values of <code>&quot;&quot;</code> (which are easy to miss) In the first 3 out of 4 of these columns:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(mynewbigDF<span class="op">$</span>host_is_superhost)
<span class="kw">table</span>(mynewbigDF<span class="op">$</span>host_has_profile_pic)
<span class="kw">table</span>(mynewbigDF<span class="op">$</span>host_identity_verified)
<span class="kw">table</span>(mynewbigDF<span class="op">$</span>is_location_exact)</code></pre></div>
<p>These are all character vectors, which we can check using <code>class</code>, <code>typeof</code>, or <code>str</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(mynewbigDF<span class="op">$</span>host_is_superhost)
<span class="kw">class</span>(mynewbigDF<span class="op">$</span>host_has_profile_pic)
<span class="kw">class</span>(mynewbigDF<span class="op">$</span>host_identity_verified)
<span class="kw">class</span>(mynewbigDF<span class="op">$</span>is_location_exact)

<span class="kw">typeof</span>(mynewbigDF<span class="op">$</span>host_is_superhost)
<span class="kw">typeof</span>(mynewbigDF<span class="op">$</span>host_has_profile_pic)
<span class="kw">typeof</span>(mynewbigDF<span class="op">$</span>host_identity_verified)
<span class="kw">typeof</span>(mynewbigDF<span class="op">$</span>is_location_exact)

<span class="kw">str</span>(mynewbigDF<span class="op">$</span>host_is_superhost)
<span class="kw">str</span>(mynewbigDF<span class="op">$</span>host_has_profile_pic)
<span class="kw">str</span>(mynewbigDF<span class="op">$</span>host_identity_verified)
<span class="kw">str</span>(mynewbigDF<span class="op">$</span>is_location_exact)</code></pre></div>
<p>We have several ways to transform a column. For example, we could go element-by-element, and make substitutions, like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span>mynewbigDF<span class="op">$</span>host_is_superhost</code></pre></div>
<p>Here is the way that the values look at the start:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(v)
v[<span class="kw">toupper</span>(v)<span class="op">==</span><span class="st">&quot;T&quot;</span>] &lt;-<span class="st"> </span><span class="ot">TRUE</span>
v[<span class="kw">toupper</span>(v)<span class="op">==</span><span class="st">&quot;F&quot;</span>] &lt;-<span class="st"> </span><span class="ot">FALSE</span>
v[<span class="kw">toupper</span>(v)<span class="op">==</span><span class="st">&quot;&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></code></pre></div>
<p>and here are the values now:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(v)</code></pre></div>
<p>You might think that the <code>NA</code> values disappeared, but they just do not show up in the table by default. You can force them to appear, and then we see that the counts of the three values are the same as before.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(v, <span class="dt">useNA=</span><span class="st">&quot;always&quot;</span>)</code></pre></div>
<p>Here is the function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transform_column &lt;-<span class="st"> </span><span class="cf">function</span>(v) {
  v[<span class="kw">toupper</span>(v)<span class="op">==</span><span class="st">&quot;T&quot;</span>] &lt;-<span class="st"> </span><span class="ot">TRUE</span>
  v[<span class="kw">toupper</span>(v)<span class="op">==</span><span class="st">&quot;F&quot;</span>] &lt;-<span class="st"> </span><span class="ot">FALSE</span>
  v[<span class="kw">toupper</span>(v)<span class="op">==</span><span class="st">&quot;&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span>
  v
}</code></pre></div>
<p>We can try the function on <code>mynewbigDF$host_is_superhost</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">transform_column</span>(mynewbigDF<span class="op">$</span>host_is_superhost))
<span class="kw">table</span>(<span class="kw">transform_column</span>(mynewbigDF<span class="op">$</span>host_is_superhost))</code></pre></div>
<p>Another possibility is to make a map, in which we put the old values as the names, and the new values as the values in the vector:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mymap &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">NA</span>)
<span class="kw">names</span>(mymap) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;T&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;&quot;</span>)
<span class="kw">head</span>(mymap[<span class="kw">toupper</span>(mynewbigDF<span class="op">$</span>host_is_superhost)])</code></pre></div>
<p>and if you do not want the names to appear on the vector, you can remove them, like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">unname</span>(mymap[<span class="kw">toupper</span>(mynewbigDF<span class="op">$</span>host_is_superhost)]))</code></pre></div>
<p>Finally we can check the table of the results:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(mymap[<span class="kw">toupper</span>(mynewbigDF<span class="op">$</span>host_is_superhost)])</code></pre></div>
<p>This might seem strange, and if you do not like it, you can just use the solution given above. If you do like this, and want to wrap it into a function, we can write:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transform_column &lt;-<span class="st"> </span><span class="cf">function</span>(v) {
  mymap &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">NA</span>)
  <span class="kw">names</span>(mymap) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;T&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;&quot;</span>)
  <span class="kw">unname</span>(mymap[<span class="kw">toupper</span>(v)])
}</code></pre></div>
<p>and again we can try this new version of the function on <code>mynewbigDF$host_is_superhost</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">transform_column</span>(mynewbigDF<span class="op">$</span>host_is_superhost))
<span class="kw">table</span>(<span class="kw">transform_column</span>(mynewbigDF<span class="op">$</span>host_is_superhost))</code></pre></div>
</div>
<div id="apply-your-function-transform_column-to-the-columns-instant_bookable-and-is_location_exact-in-your-listings-data." class="section level5">
<h5>5. Apply your function <code>transform_column</code> to the columns <code>instant_bookable</code> and <code>is_location_exact</code> in your <code>listings</code> data.</h5>
</div>
<div id="based-on-your-listings-data-if-you-are-looking-at-an-instant-bookable-listing-where-instant_bookable-is-true-would-you-expect-the-location-to-be-exact-where-is_location_exact-is-true-why-or-why-not" class="section level5">
<h5>Based on your <code>listings</code> data, if you are looking at an instant bookable listing (where <code>instant_bookable</code> is <code>TRUE</code>), would you expect the location to be exact (where <code>is_location_exact</code> is <code>TRUE</code>)? Why or why not?</h5>
<p><strong>Hint:</strong> Make a frequency table, and see how many instant bookable listings have exact location.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-apply">apply</a>, <a href="r.html#r-table">table</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Chunk of code to get a frequency table.
</li>
<li>
1-2 sentences explaining whether or not we would expect the location to be exact if we were looking at a instant bookable listing.
</li>
</ul>
</div>
</div>
<div id="solution-74" class="section level5">
<h5>Solution</h5>
<p>Now we look at the Canada results, for which <code>instant_bookable</code> is <code>TRUE</code>, to see if <code>is_location_exact</code> is <code>TRUE</code> or <code>FALSE</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(<span class="kw">transform_column</span>(mynewbigDF<span class="op">$</span>is_location_exact)[<span class="kw">transform_column</span>(mynewbigDF<span class="op">$</span>instant_bookable) <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>])</code></pre></div>
<p>In other words, if <code>instant_bookable</code> is <code>TRUE</code>, then we expect the value for <code>is_location_exact</code> to usually be <code>TRUE</code> as well.</p>
<p>As a closing note, we could remove the check to see whether the inner values are <code>TRUE</code> because, by default, we will only exact the <code>TRUE</code> values when we do a lookup like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(<span class="kw">transform_column</span>(mynewbigDF<span class="op">$</span>is_location_exact)[<span class="kw">transform_column</span>(mynewbigDF<span class="op">$</span>instant_bookable)])</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p02-290" class="section level3">
<h3>Project 2</h3>
<hr />
<p><strong>Motivation:</strong> The ability to quickly reproduce an analysis is important. It is often necessary that other individuals will need to be able to understand and reproduce an analysis. This concept is so important there are classes solely on reproducible research! In fact, there are papers that investigate and highlight the lack of reproducibility in various fields. If you are interested in reading about this topic, a good place to start is the paper titled <a href="https://journals.plos.org/plosmedicine/article?id=10.1371/journal.pmed.0020124">&quot;Why Most Published Research Findings Are False&quot;</a>, by John Ioannidis (2005).</p>
<p><strong>Context:</strong> Making your work reproducible is extremely important. We will focus on the computational part of reproducibility. We will learn RMarkdown to document your analyses so others can easily understand and reproduce the computations that led to your conclusions. Pay close attention as future project templates will be RMarkdown templates.</p>
<p><strong>Scope:</strong> Understand Markdown, RMarkdown, and how to use it to make your data analysis reproducible.</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Use Markdown syntax within an Rmarkdown document to achieve various text transformations.
</li>
<li>
Use RMarkdown code chunks to display and/or run snippets of code.
</li>
</ul>
</div>
<div id="questions-15" class="section level4">
<h4>Questions</h4>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_8rsq5yrn&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_bjrv34ss">Click here for video</a></p>
<div id="make-the-following-text-including-the-asterisks-bold-this-needs-to-be-very-bold.-make-the-following-text-including-the-underscores-italicized-this-needs-to-be-_very_-italicized." class="section level5">
<h5>1. Make the following text (including the asterisks) bold: <code>This needs to be **very** bold</code>. Make the following text (including the underscores) italicized: <code>This needs to be _very_ italicized.</code></h5>
<p><strong>Important note:</strong> Surround your answer in 4 backticks. This will allow you to display the markdown <em>without</em> having the markdown &quot;take effect&quot;. For example:</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">````
Some *marked* **up** text.
````</code></pre></div>
<p><strong>Hint:</strong> <em>Be sure to check out the <a href="https://rstudio.com/wp-content/uploads/2016/03/rmarkdown-cheatsheet-2.0.pdf">Rmarkdown Cheatsheet</a> and our section on <a href="https://thedatamine.github.io/the-examples-book/r.html#r-rmarkdown">Rmarkdown in the book</a>.</em></p>
<p><strong>Note:</strong> <em>Rmarkdown is essentially Markdown + the ability to run and display code chunks. In this question, we are actually using Markdown within Rmarkdown!</em></p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-rmarkdown">rmarkdown</a>, <a href="#escape-characters">escaping characters</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong> - 2 lines of markdown text, surrounded by 4 backticks. Note that when compiled, this text will be unmodified, regular text.
</p>
</div>
</div>
<div id="solution-75" class="section level5">
<h5>Solution</h5>
<p>We can achieve this style of text:</p>
<p><strong>This needs to be **very** bold</strong></p>
<p><em>This needs to be _very_ italicized.</em></p>
<p>by using this Markdown text:</p>
<pre><code>**This needs to be \*\*very\*\* bold**
_This needs to be \_very\_ italicized._</code></pre>
<p>The backslashes specify that we want the asterisks and underscores to appear.</p>
</div>
<div id="create-an-unordered-list-of-your-top-3-favorite-academic-interests-some-examples-could-include-machine-learning-operating-systems-forensic-accounting-etc..-create-another-ordered-list-that-ranks-your-academic-interests-in-order-of-most-interested-to-least-interested." class="section level5">
<h5>2. Create an unordered list of your top 3 favorite academic interests (some examples could include: machine learning, operating systems, forensic accounting, etc.). Create another <em>ordered</em> list that ranks your academic interests in order of most interested to least interested.</h5>
<p><strong>Hint:</strong> <em>You can learn what ordered and unordered lists are <a href="https://rstudio.com/wp-content/uploads/2016/03/rmarkdown-cheatsheet-2.0.pdf">here</a>.</em></p>
<p><strong>Note:</strong> <em>Similar to (1), in this question we are dealing with Markdown. If we were to copy and paste the solution to this problem in a Markdown editor, it would be the same result as when we Knit it here.</em></p>
<p><strong>Relevant topics:</strong> <em><a href="r.html#r-rmarkdown">rmarkdown</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong> - Create the lists, this time don't surround your code in backticks. Note that when compiled, this text will appear as nice, formatted lists.
</p>
</div>
</div>
<div id="solution-76" class="section level5">
<h5>Solution</h5>
<p>An unordered list of my top 3 favorite academic interests is:</p>
<ul>
<li>asymptotic analysis of sequences</li>
<li>data science</li>
<li>analysis of algorithms</li>
</ul>
<p>An ordered list of my top 3 favorite academic interests is:</p>
<ol style="list-style-type: decimal">
<li>analysis of algorithms</li>
<li>asymptotic analysis of sequences</li>
<li>data science</li>
</ol>
</div>
<div id="browse-httpswww.linkedin.com-and-read-some-profiles.-pay-special-attention-to-accounts-with-an-about-section.-write-your-own-personal-about-section-using-markdown.-include-the-following" class="section level5">
<h5>3. Browse <a href="https://www.linkedin.com/" class="uri">https://www.linkedin.com/</a> and read some profiles. Pay special attention to accounts with an &quot;About&quot; section. Write your own personal &quot;About&quot; section using Markdown. Include the following:</h5>
<ul>
<li>A header for this section (your choice of size) that says &quot;About&quot;.</li>
<li>The text of your personal &quot;About&quot; section that you would feel comfortable uploading to linkedin, including at least 1 link.</li>
</ul>
<p><strong>Relevant topics:</strong> <em><a href="r.html#r-rmarkdown">rmarkdown</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong> - Create the described profile, don't surround your code in backticks.
</p>
</div>
</div>
<div id="solution-77" class="section level5">
<h5>Solution</h5>
</div>
<div id="about" class="section level5">
<h5>About</h5>
<p>I am Professor in Statistics and (by courtesy) of Mathematics and Public Health at Purdue University. My research is in probabilistic, combinatorial, and analytic techniques for the analysis of algorithms and data structures; I am also interested in science of information, game theory, and large-scale computation. I currently serve as</p>
<ul>
<li>Director of The Data Mine</li>
<li>Interim Co-Director of the Integrative Data Science Initiative</li>
<li>Principal Investigator for the Purdue Statistics Living Learning Community, funded by the National Science Foundation</li>
<li>Associate Director for the <a href="https://www.soihub.org">NSF Center for Science of Information</a> (now a core center in Purdue's Discovery Park)</li>
<li>Associate Director of the Actuarial Science Program</li>
</ul>
</div>
<div id="your-co-worker-wrote-a-report-and-has-asked-you-to-beautify-it.-knowing-rmarkdown-you-agreed.-make-improvements-to-this-section.-at-a-minimum" class="section level5">
<h5>4. Your co-worker wrote a report, and has asked you to beautify it. Knowing Rmarkdown, you agreed. Make improvements to this section. At a minimum:</h5>
<ul>
<li>Make the title pronounced.</li>
<li>Make all links appear as a word or words, rather than the long-form URL.</li>
<li>Organize all code into code chunks where code and output are displayed. If the output is really long, just display the code.</li>
<li>Make the calls to the <code>library</code> function be evaluated but not displayed.</li>
<li>Make sure all warnings and errors that may eventually occur, do not appear in the final document.</li>
</ul>
<p>Feel free to make any other changes that make the report more visually pleasing.</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{r my-load-packages}
library(ggplot2)
```

```{r declare-variable-290, eval=FALSE}
my_variable &lt;- c(1,2,3)
```

All About the Iris Dataset

This paper goes into detail about the <span class="bn">`iris`</span> dataset that is built into r. You can find a list of built-in datasets by visiting https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/00Index.html or by running the following code:

data()

The iris dataset has 5 columns. You can get the names of the columns by running the following code:

names(iris)

Alternatively, you could just run the following code:

iris

The second option provides more detail about the dataset.

According to https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/iris.html there is another dataset built-in to r called <span class="bn">`iris3`</span>. This dataset is 3 dimensional instead of 2 dimensional.

An iris is a really pretty flower. You can see a picture of one here:

https://www.gardenia.net/storage/app/public/guides/detail/83847060_mOptimized.jpg

In summary. I really like irises, and there is a dataset in r called <span class="bn">`iris`</span>.</code></pre></div>
<p><strong>Relevant topics:</strong> <em><a href="r.html#r-rmarkdown">rmarkdown</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Make improvements to this section, and place it all under the Question 4 header in your template.
</li>
</ul>
</div>
</div>
<div id="solution-78" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_variable &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</code></pre></div>
<p>*** All About the Iris Dataset</p>
<p>This paper goes into detail about the <code>iris</code> dataset that is built into r. You can find a list of built-in datasets by visiting <a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/00Index.html">the R datasets index</a> or by running the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>()</code></pre></div>
<p>The iris dataset has 5 columns. You can get the names of the columns by running the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(iris)</code></pre></div>
<pre><code>## [1] &quot;Sepal.Length&quot; &quot;Sepal.Width&quot;  &quot;Petal.Length&quot; &quot;Petal.Width&quot;  &quot;Species&quot;</code></pre>
<p>Alternatively, you could just run the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris</code></pre></div>
<p>The second option provides more detail about the dataset.</p>
<p>According to <a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/iris.html">the R iris help page</a> there is another dataset built-in to <code>R</code> called <code>iris3</code>. This dataset is 3 dimensional instead of 2 dimensional.</p>
<p>An iris is a really pretty flower. You can see a picture of one <a href="https://www.gardenia.net/storage/app/public/guides/detail/83847060_mOptimized.jpg">here</a>:</p>
<p>In summary. I really like irises, and there is a dataset in <code>R</code> called <code>iris</code>.</p>
</div>
<div id="create-a-plot-using-a-built-in-dataset-like-iris-mtcars-or-titanic-and-display-the-plot-using-a-code-chunk.-make-sure-the-code-used-to-generate-the-plot-is-hidden.-include-a-descriptive-caption-for-the-image.-make-sure-to-use-an-rmarkdown-chunk-option-to-create-the-caption." class="section level5">
<h5>5. Create a plot using a built-in dataset like <code>iris</code>, <code>mtcars</code>, or <code>Titanic</code>, and display the plot using a code chunk. Make sure the code used to generate the plot is hidden. Include a descriptive caption for the image. Make sure to use an RMarkdown chunk option to create the caption.</h5>
<p><strong>Relevant topics:</strong> <em><a href="r.html#r-rmarkdown">rmarkdown</a>, <a href="r.html#r-plotting">plotting in r</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Code chunk under that creates and displays a plot using a built-in dataset like <code>iris</code>, <code>mtcars</code>, or <code>Titanic</code>.
</li>
</ul>
</div>
</div>
<div id="solution-79" class="section level5">
<h5>Solution</h5>
<p>We create the figure called &quot;Sepal Length for the Iris Data Set&quot;.</p>
<div class="figure"><span id="fig:unnamed-chunk-1185"></span>
<img src="the-datamine-examples_files/figure-html/unnamed-chunk-1185-1.png" alt="Sepal Length for the Iris Data Set" width="672" />
<p class="caption">
Figure 1: Sepal Length for the Iris Data Set
</p>
</div>
</div>
<div id="insert-the-following-code-chunk-under-the-question-6-header-in-your-template.-try-knitting-the-document.-two-things-will-go-wrong.-what-is-the-first-problem-what-is-the-second-problem" class="section level5">
<h5>6. Insert the following code chunk under the Question 6 header in your template. Try knitting the document. Two things will go wrong. What is the first problem? What is the second problem?</h5>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{r my-load-packages}
plot(my_variable)
```</code></pre></div>
<p><strong>Hint:</strong> <em>Take a close look at the name we give our code chunk.</em></p>
<p><strong>Hint:</strong> <em>Take a look at the code chunk where <code>my_variable</code> is declared.</em></p>
<p><strong>Relevant topics:</strong> <em><a href="r.html#r-rmarkdown">rmarkdown</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The modified version of the inserted code that fixes both problems.
</li>
<li>
A sentence explaining what the first problem was.
</li>
<li>
A sentence explaining what the second problem was.
</li>
</ul>
</div>
</div>
<div id="solution-80" class="section level5">
<h5>Solution</h5>
<p>We needed to change the section title from <code>install-packages</code> to a new name, since we already had a section with this same title.</p>
<p>In the section called <code>declare-variable</code>, we had <code>eval=F</code>, and as a result, the variable <code>my_variable</code> was never declared. So we removed the option <code>eval=F</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(my_variable)</code></pre></div>
</div>
<div id="for-project-2-please-submit-your-.rmd-file-and-the-resulting-.pdf-file.-for-this-project-you-do-not-need-to-submit-a-.r-file." class="section level5">
<h5>For Project 2, please submit your .Rmd file and the resulting .pdf file. (For this project, you do not need to submit a .R file.)</h5>
<hr />
</div>
</div>
</div>
<div id="fall2020-p03-290" class="section level3">
<h3>Project 3</h3>
<hr />
<p><strong>Motivation:</strong> The ability to navigate a shell, like <code>bash</code>, and use some of its powerful tools, is very useful. The number of disciplines utilizing data in new ways is ever-growing, and as such, it is very likely that many of you will eventually encounter a scenario where knowing your way around a terminal will be useful. We want to expose you to some of the most useful <code>bash</code> tools, help you navigate a filesystem, and even run <code>bash</code> tools from within an RMarkdown file in RStudio.</p>
<p><strong>Context:</strong> At this point in time, you will each have varying levels of familiarity with Scholar. In this project we will learn how to use the terminal to navigate a UNIX-like system, experiment with various useful commands, and learn how to execute bash commands from within RStudio in an RMarkdown file.</p>
<p><strong>Scope:</strong> bash, RStudio</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Distinguish differences in /home, /scratch, and /class.
</li>
<li>
Navigating UNIX via a terminal: ls, pwd, cd, ., .., ~, etc.
</li>
<li>
Analyzing file in a UNIX filesystem: wc, du, cat, head, tail, etc.
</li>
<li>
Creating and destroying files and folder in UNIX: scp, rm, touch, cp, mv, mkdir, rmdir, etc.
</li>
<li>
Utilize other Scholar resources: rstudio.scholar.rcac.purdue.edu, notebook.scholar.rcac.purdue.edu, desktop.scholar.rcac.purdue.edu, etc.
</li>
<li>
Use <code>man</code> to read and learn about UNIX utilities.
</li>
<li>
Run <code>bash</code> commands from within and RMarkdown file in RStudio.
</li>
</ul>
</div>
<p>There are a variety of ways to connect to Scholar. In this class, we will <em>primarily</em> connect to RStudio Server by opening a browser and navigating to <a href="https://rstudio.scholar.rcac.purdue.edu/" class="uri">https://rstudio.scholar.rcac.purdue.edu/</a>, entering credentials, and using the excellent RStudio interface.</p>
<p>Here is a video to remind you about some of the basic tools you can use in UNIX/Linux:</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_9mz5s0wd&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_0y4x1feo">Click here for video</a></p>
<p>This is the easiest book for learning this stuff; it is short and gets right to the point:</p>
<p><a href="https://go.oreilly.com/purdue-university/library/view/-/0596002610" class="uri">https://go.oreilly.com/purdue-university/library/view/-/0596002610</a></p>
<p>you just log in and you can see it all; we suggest Chapters 1, 3, 4, 5, 7 (you can basically skip chapters 2 and 6 the first time through).</p>
<p>It is a very short read (maybe, say, 2 or 3 hours altogether?), just a thin book that gets right to the details.</p>
<div id="navigate-to-httpsrstudio.scholar.rcac.purdue.edu-and-login.-take-some-time-to-click-around-and-explore-this-tool.-we-will-be-writing-and-running-python-r-sql-and-bash-all-from-within-this-interface.-navigate-to-tools-global-options-....-explore-this-interface-and-make-at-least-2-modifications.-list-what-you-changed." class="section level5">
<h5>1. Navigate to <a href="https://rstudio.scholar.rcac.purdue.edu/" class="uri">https://rstudio.scholar.rcac.purdue.edu/</a> and login. Take some time to click around and explore this tool. We will be writing and running Python, R, SQL, and <code>bash</code> all from within this interface. Navigate to <code>Tools &gt; Global Options ...</code>. Explore this interface and make at least 2 modifications. List what you changed.</h5>
<p>Here are some changes Kevin likes:</p>
<ul>
<li>Uncheck &quot;Restore .Rdata into workspace at startup&quot;.</li>
<li>Change tab width 4.</li>
<li>Check &quot;Soft-wrap R source files&quot;.</li>
<li>Check &quot;Highlight selected line&quot;.</li>
<li>Check &quot;Strip trailing horizontal whitespace when saving&quot;.</li>
<li>Uncheck &quot;Show margin&quot;.</li>
</ul>
<p>(Dr Ward does not like to customize his own environment, but he does use the emacs key bindings: Tools &gt; Global Options &gt; Code &gt; Keybindings, but this is only recommended if you already know emacs.)</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
List of modifications you made to your Global Options.
</li>
</ul>
</div>
</div>
<div id="solution-81" class="section level5">
<h5>Solution</h5>
<p>Here are some changes Kevin likes:</p>
<ul>
<li>Uncheck &quot;Restore .Rdata into workspace at startup&quot;.</li>
<li>Change tab width 4.</li>
<li>Check &quot;Soft-wrap R source files&quot;.</li>
<li>Check &quot;Highlight selected line&quot;.</li>
<li>Check &quot;Strip trailing horizontal whitespace when saving&quot;.</li>
<li>Uncheck &quot;Show margin&quot;.</li>
</ul>
</div>
<div id="there-are-four-primary-panes-each-with-various-tabs.-in-one-of-the-panes-there-will-be-a-tab-labeled-terminal.-click-on-that-tab.-this-terminal-by-default-will-run-a-bash-shell-right-within-scholar-the-same-as-if-you-connected-to-scholar-using-thinlinc-and-opened-a-terminal.-very-convenient" class="section level5">
<h5>2. There are four primary panes, each with various tabs. In one of the panes there will be a tab labeled &quot;Terminal&quot;. Click on that tab. This terminal by default will run a <code>bash</code> shell right within Scholar, the same as if you connected to Scholar using ThinLinc, and opened a terminal. Very convenient!</h5>
</div>
<div id="what-is-the-default-directory-of-your-bash-shell" class="section level5">
<h5>What is the default directory of your bash shell?</h5>
<p><strong>Hint:</strong> Start by reading the section on <code>man</code>. <code>man</code> stands for manual, and you can find the &quot;official&quot; documentation for the command by typing <code>man &lt;command_of_interest&gt;</code>. For example:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># read the manual for the `man` command</span>
<span class="co"># use &quot;k&quot; or the up arrow to scroll up, &quot;j&quot; or the down arrow to scroll down</span>
<span class="fu">man</span> man </code></pre></div>
<p><strong>Relevant topics:</strong> <a href="unix.html#man">man</a>, <a href="unix.html#pwd">pwd</a>, <a href="unix.html#dots">~</a>, <a href="unix.html#dots">..</a>, <a href="unix.html#dots">.</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The full filepath of default directory (home directory). Ex: Kevin's is: <code>/home/kamstut</code>
</li>
<li>
The <code>bash</code> code used to show your home directory or current directory (also known as the working directory) when the <code>bash</code> shell is first launched.
</li>
</ul>
</div>
</div>
<div id="solution-82" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># whatever is stored in the $HOME environment variable </span>
<span class="co"># is what ~ represents</span>
<span class="bu">cd</span> ~
<span class="bu">pwd</span>

<span class="co"># if we change $HOME, ~ changes too!</span>
<span class="va">HOME=</span>/home/kamstut/projects
<span class="bu">cd</span> ~
<span class="bu">pwd</span>

<span class="co"># if other users on the linux system share certain files or folders</span>
<span class="co"># in their home directory, you can access their home folder similarly</span>
<span class="fu">ls</span> ~mdw

<span class="co"># but they _have_ to give you permissions </span></code></pre></div>
</div>
<div id="learning-to-navigate-away-from-our-home-directory-to-other-folders-and-back-again-is-vital.-perform-the-following-actions-in-order" class="section level5">
<h5>3. Learning to navigate away from our home directory to other folders, and back again, is vital. Perform the following actions, in order:</h5>
<ul>
<li>Write a single command to navigate to the folder containing our full datasets: <code>/class/datamine/data</code>.</li>
<li>Write a command to confirm you are in the correct folder.</li>
<li>Write a command to list the files and directories within the data directory. (You do not need to recursively list subdirectories and files contained therein.) What are the names of the files and directories?</li>
<li>Write another command to return back to your home directory.</li>
<li>Write a command to confirm you are in the correct folder.</li>
</ul>
<p>Note: <code>/</code> is commonly referred to as the root directory in a linux/unix filesystem. Think of it as a folder that contains <em>every</em> other folder in the computer. <code>/home</code> is a folder within the root directory. <code>/home/kamstut</code> is the full filepath of Kevin's home directory. There is a folder <code>home</code> inside the root directory. Inside <code>home</code> is another folder named <code>kamstut</code> which is Kevin's home directory.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#man">man</a>, <a href="unix.html#cd">cd</a>, <a href="unix.html#pwd">pwd</a>, <a href="unix.html#ls">ls</a>, <a href="unix.html#dots">~</a>, <a href="unix.html#dots">..</a>, <a href="unix.html#dots">.</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Command used to navigate to the data directory.
</li>
<li>
Command used to confirm you are in the data directory.
</li>
<li>
Command used to list files and folders.
</li>
<li>
List of files and folders in the data directory.
</li>
<li>
Command used to navigate back to the home directory.
</li>
<li>
Command used to confirm you are in the home directory.
</li>
</ul>
</div>
</div>
<div id="solution-83" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># navigate to the data directory using `cd` (change directory)</span>
<span class="bu">cd</span> /class/datamine/data

<span class="co"># confirm the location using `pwd` (print working directory)</span>
<span class="bu">pwd</span>

<span class="co"># list files</span>
<span class="fu">ls</span>

<span class="co"># cd without any arguments automatically returns to the directory</span>
<span class="co"># saved in the $HOME environment variable</span>
<span class="bu">cd</span>

<span class="co"># another trick, if you wanted to _quickly_ return to the data </span>
<span class="co"># directory, or most recent directory is the following (uncommented)</span>
<span class="bu">cd</span> ~-

<span class="co"># confirm the location using pwd</span>
<span class="bu">pwd</span></code></pre></div>
</div>
<div id="lets-learn-about-two-more-important-concepts.-.-refers-to-the-current-working-directory-or-the-directory-displayed-when-you-run-pwd.-unlike-pwd-you-can-use-this-when-navigating-the-filesystem-so-for-example-if-you-wanted-to-see-the-contents-of-a-file-called-my_file.txt-that-lives-in-homekamstut-so-a-full-path-of-homekamstutmy_file.txt-and-you-are-currently-in-homekamstut-you-could-run-cat-.my_file.txt." class="section level5">
<h5>4. Let's learn about two more important concepts. <code>.</code> refers to the current working directory, or the directory displayed when you run <code>pwd</code>. Unlike <code>pwd</code> you can use this when navigating the filesystem! So, for example, if you wanted to see the contents of a file called <code>my_file.txt</code> that lives in <code>/home/kamstut</code> (so, a full path of <code>/home/kamstut/my_file.txt</code>), and you are currently in <code>/home/kamstut</code>, you could run: <code>cat ./my_file.txt</code>.</h5>
</div>
<div id="represents-the-parent-folder-or-the-folder-in-which-your-current-folder-is-contained.-so-lets-say-i-was-in-homekamstutprojects-and-i-wanted-to-get-the-contents-of-the-file-homekamstutmy_file.txt.-you-could-do-cat-..my_file.txt." class="section level5">
<h5><code>..</code> represents the parent folder or the folder in which your current folder is contained. So let's say I was in <code>/home/kamstut/projects/</code> and I wanted to get the contents of the file <code>/home/kamstut/my_file.txt</code>. You could do: <code>cat ../my_file.txt</code>.</h5>
</div>
<div id="when-you-navigate-a-directory-tree-using-.-and-..-you-create-paths-that-are-called-relative-paths-because-they-are-relative-to-your-current-directory.-alternatively-a-full-path-or-absolute-path-is-the-path-starting-from-the-root-directory.-so-homekamstutmy_file.txt-is-the-absolute-path-for-my_file.txt-and-..my_file.txt-is-a-relative-path.-perform-the-following-actions-in-order" class="section level5">
<h5>When you navigate a directory tree using <code>.</code> and <code>..</code> you create paths that are called <em>relative</em> paths because they are <em>relative</em> to your current directory. Alternatively, a <em>full</em> path or (<em>absolute</em> path) is the path starting from the root directory. So <code>/home/kamstut/my_file.txt</code> is the <em>absolute</em> path for <code>my_file.txt</code> and <code>../my_file.txt</code> is a <em>relative</em> path. Perform the following actions, in order:</h5>
<ul>
<li>Write a single command to navigate to the data directory.</li>
<li>Write a single command to navigate back to your home directory using a <em>relative</em> path. Do not use <code>~</code> or the <code>cd</code> command without a path argument.</li>
</ul>
<p><strong>Relevant topics:</strong> <a href="unix.html#man">man</a>, <a href="unix.html#cd">cd</a>, <a href="unix.html#pwd">pwd</a>, <a href="unix.html#ls">ls</a>, <a href="unix.html#dots">~</a>, <a href="unix.html#dots">..</a>, <a href="unix.html#dots">.</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Command used to navigate to the data directory.
</li>
<li>
Command used to navigate back to your home directory that uses a <em>relative</em> path.
</li>
</ul>
</div>
</div>
<div id="solution-84" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="bu">cd</span> /class/datamine/data
<span class="bu">pwd</span>
<span class="bu">cd</span> ../../../home/kamstut
<span class="bu">pwd</span></code></pre></div>
</div>
<div id="in-scholar-when-you-want-to-deal-with-really-large-amounts-of-data-you-want-to-access-scratch-you-can-read-more-here.-your-scratch-directory-on-scholar-is-located-here-scratchscholaruser.-user-is-an-environment-variable-containing-your-username.-test-it-out-echo-scratchscholaruser.-perform-the-following-actions" class="section level5">
<h5>5. In Scholar, when you want to deal with <em>really</em> large amounts of data, you want to access scratch (you can read more <a href="https://www.rcac.purdue.edu/policies/scholar/">here</a>). Your scratch directory on Scholar is located here: <code>/scratch/scholar/$USER</code>. <code>$USER</code> is an environment variable containing your username. Test it out: <code>echo /scratch/scholar/$USER</code>. Perform the following actions:</h5>
<ul>
<li>Navigate to your scratch directory.</li>
<li>Confirm you are in the correct location.</li>
<li>Execute <code>myquota</code>.</li>
<li>Find the location of the <code>myquota</code> bash script.</li>
<li>Output the first 5 and last 5 lines of the bash script.</li>
<li>Count the number of lines in the bash script.</li>
<li>How many kilobytes is the script?</li>
</ul>
<p><strong>Hint:</strong> You could use each of the commands in the relevant topics once.</p>
<p><strong>Hint:</strong> When you type <code>myquota</code> on Scholar there are sometimes two warnings about <code>xauth</code> but sometimes there are no warnings. If you get a warning that says <code>Warning: untrusted X11 forwarding setup failed: xauth key data not generated</code> it is safe to ignore this error.</p>
<p><strong>Hint:</strong> Commands often have <em>options</em>. <em>Options</em> are features of the program that you can trigger specifically. You can see the <em>options</em> of a command in the <code>DESCRIPTION</code> section of the <code>man</code> pages. For example: <code>man wc</code>. You can see <code>-m</code>, <code>-l</code>, and <code>-w</code> are all options for <code>wc</code>. To test this out:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># using the default wc command. &quot;/class/datamine/data/flights/1987.csv&quot; is the first &quot;argument&quot; given to the command.</span>
<span class="fu">wc</span> /class/datamine/data/flights/1987.csv
<span class="co"># to count the lines, use the -l option</span>
<span class="fu">wc</span> -l /class/datamine/data/flights/1987.csv
<span class="co"># to count the words, use the -w option</span>
<span class="fu">wc</span> -w /class/datamine/data/flights/1987.csv
<span class="co"># you can combine options as well</span>
<span class="fu">wc</span> -w -l /class/datamine/data/flights/1987.csv
<span class="co"># some people like to use a single tack `-`</span>
<span class="fu">wc</span> -wl /class/datamine/data/flights/1987.csv
<span class="co"># order doesn&#39;t matter</span>
<span class="fu">wc</span> -lw /class/datamine/data/flights/1987.csv</code></pre></div>
<p><strong>Hint:</strong> The <code>-h</code> option for the <code>du</code> command is useful.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#cd">cd</a>, <a href="unix.html#pwd">pwd</a>, <a href="unix.html#type">type</a>, <a href="unix.html#head">head</a>, <a href="unix.html#tail">tail</a>, <a href="unix.html#wc">wc</a>, <a href="unix.html#du">du</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Command used to navigate to your scratch directory.
</li>
<li>
Command used to confirm your location.
</li>
<li>
Output of <code>myquota</code>.
</li>
<li>
Command used to find the location of the <code>myquota</code> script.
</li>
<li>
Absolute path of the <code>myquota</code> script.
</li>
<li>
Command used to output the first 5 lines of the <code>myquota</code> script.
</li>
<li>
Command used to output the last 5 lines of the <code>myquota</code> script.
</li>
<li>
Command used to find the number of lines in the <code>myquota</code> script.
</li>
<li>
Number of lines in the script.
</li>
<li>
Command used to find out how many kilobytes the script is.
</li>
<li>
Number of kilobytes that the script takes up.
</li>
</ul>
</div>
</div>
<div id="solution-85" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># navigate to my scratch folder</span>
<span class="bu">cd</span> /scratch/scholar/<span class="va">$USER</span>

<span class="co"># confirm</span>
<span class="bu">pwd</span>

<span class="co"># what is my quota, execute the myquota script</span>
<span class="ex">myquota</span>

<span class="co"># get the location of the myquota script</span>
<span class="bu">type</span> myquota

<span class="co"># get the first 5 lines of the myquota script</span>
<span class="fu">head</span> /usr/local/bin/myquota

<span class="co"># get the last 5 lines of the myquota script</span>
<span class="fu">tail</span> /usr/local/bin/myquota

<span class="co"># get the number of lines in the myquota script</span>
<span class="fu">wc</span> -l /usr/local/bin/myquota

<span class="co"># get the number of kilobytes of the myquota script</span>
<span class="fu">du</span> -h --apparent-size /usr/local/bin/myquota
<span class="fu">ls</span> -la /usr/local/bin/myquota</code></pre></div>
</div>
<div id="perform-the-following-operations" class="section level5">
<h5>6. Perform the following operations:</h5>
<ul>
<li>Navigate to your scratch directory.</li>
<li>Copy and paste the file: <code>/class/datamine/data/flights/1987.csv</code> to your current directory (scratch).</li>
<li>Create a new directory called <code>my_test_dir</code> in your scratch folder.</li>
<li>Move the file you copied to your scratch directory, into your new folder.</li>
<li>Use <code>touch</code> to create an empty file named <code>im_empty.txt</code> in your scratch folder.</li>
<li>Remove the directory <code>my_test_dir</code> <em>and</em> the contents of the directory.</li>
<li>Remove the <code>im_empty.txt</code> file.</li>
</ul>
<p><strong>Hint:</strong> <code>rmdir</code> may not be able to do what you think, instead, check out the options for <code>rm</code> using <code>man rm</code>.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#cd">cd</a>, <a href="unix.html#cp">cp</a>, <a href="unix.html#mv">mv</a>, <a href="unix.html#mkdir">mkdir</a>, <a href="unix.html#touch">touch</a>, <a href="unix.html#rmdir">rmdir</a>, <a href="unix.html#rm">rm</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Command used to navigate to your scratch directory.
</li>
<li>
Command used to copy the file, <code>/class/datamine/data/flights/1987.csv</code> to your current directory (scratch).
</li>
<li>
Command used to create a new directory called <code>my_test_dir</code> in your scratch folder.
</li>
<li>
Command used to move the file you copied earlier <code>1987.csv</code> into your new <code>my_test_dir</code> folder.
</li>
<li>
Command used to create an empty file named <code>im_empty.txt</code> in your scratch folder.
</li>
<li>
Command used to remove the directory <em>and</em> the contents of the directory <code>my_test_dir</code>.
</li>
<li>
Command used to remove the <code>im_empty.txt</code> file.
</li>
</ul>
</div>
</div>
<div id="solution-86" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># navigate to the scratch folder</span>
<span class="bu">cd</span> /scratch/scholar/<span class="va">$USER</span>

<span class="co"># copy the 1987.csv file to the current directory (scratch)</span>
<span class="fu">cp</span> /class/datamine/data/flights/1987.csv .

<span class="co"># make a directory in the scratch directory called `my_test_dir`</span>
<span class="fu">mkdir</span> my_test_dir

<span class="co"># move 1987.csv to the new folder</span>
<span class="fu">mv</span> 1987.csv my_test_dir

<span class="co"># create an empty file in the scratch folder</span>
<span class="fu">touch</span> im_empty.txt

<span class="co"># remove the directory and the contents of the directory</span>
<span class="fu">rm</span> -r my_test_dir

<span class="co"># remove the im_empty.txt file</span>
<span class="fu">rm</span> im_empty.txt</code></pre></div>
</div>
<div id="please-include-a-statement-in-project-3-that-says-i-acknowledge-that-the-stat-190002900039000-1-credit-data-mine-seminar-will-be-recorded-and-posted-on-piazza-for-participants-in-this-course.-or-if-you-disagree-with-this-statement-please-consult-with-us-at-dataminepurdue.edu-for-an-alternative-plan.-1" class="section level5">
<h5>7. Please include a statement in Project 3 that says, &quot;I acknowledge that the STAT 19000/29000/39000 1-credit Data Mine seminar will be recorded and posted on Piazza, for participants in this course.&quot; or if you disagree with this statement, please consult with us at <a href="mailto:datamine@purdue.edu">datamine@purdue.edu</a> for an alternative plan.</h5>
<hr />
</div>
</div>
<div id="fall2020-p04-290" class="section level3">
<h3>Project 4</h3>
<hr />
<p><strong>Motivation:</strong> The need to search files and datasets based on the text held within is common during various parts of the data wrangling process. <code>grep</code> is an extremely powerful UNIX tool that allows you to do so using regular expressions. Regular expressions are a structured method for searching for specified patterns. Regular expressions can be very complicated, <a href="https://blog.cloudflare.com/details-of-the-cloudflare-outage-on-july-2-2019/">even professionals can make critical mistakes</a>. With that being said, learning some of the basics is an incredible tool that will come in handy regardless of the language you are working in.</p>
<p><strong>Context:</strong> We've just begun to learn the basics of navigating a file system in UNIX using various terminal commands. Now we will go into more depth with one of the most useful command line tools, <code>grep</code>, and experiment with regular expressions using <code>grep</code>, R, and later on, Python.</p>
<p><strong>Scope:</strong> grep, regular expression basics, utilizing regular expression tools in R and Python</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Use <code>grep</code> to search for patterns within a dataset.
</li>
<li>
Use <code>cut</code> to section off and slice up data from the command line.
</li>
<li>
Use <code>wc</code> to count the number of lines of input.
</li>
</ul>
</div>
<p>You can find useful examples that walk you through relevant material in The Examples Book:</p>
<p><a href="https://thedatamine.github.io/the-examples-book" class="uri">https://thedatamine.github.io/the-examples-book</a></p>
<p>It is highly recommended to read through, search, and explore these examples to help solve problems in this project.</p>
<p><strong>Important note:</strong> I would highly recommend using single quotes <code>'</code> to surround your regular expressions. Double quotes can have unexpected behavior due to some shell's expansion rules. In addition, pay close attention to <a href="faqs.html#faq-escape-characters">escaping</a> certain <a href="https://unix.stackexchange.com/questions/20804/in-a-regular-expression-which-characters-need-escaping">characters</a> in your regular expressions.</p>
<div id="dataset-15" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset <code>the_office_dialogue.csv</code> found in Scholar under the data directory <code>/class/datamine/data/</code>. A public sample of the data can be found here: <a href="https://www.datadepot.rcac.purdue.edu/datamine/data/movies-and-tv/the_office_dialogue.csv">the_office_dialogue.csv</a></p>
<p>Answers to questions should all be answered using the full dataset located on Scholar. You may use the public samples of data to experiment with your solutions prior to running them using the full dataset.</p>
<p><code>grep</code> stands for (g)lobally search for a (r)egular (e)xpression and (p)rint matching lines. As such, to best demonstrate <code>grep</code>, we will be using it with textual data. You can read about and see examples of <code>grep</code> <a href="https://thedatamine.github.io/the-examples-book/unix.html#grep">here</a>.</p>
<div id="login-to-scholar-and-use-grep-to-find-the-dataset-we-will-use-this-project.-the-dataset-we-will-use-is-the-only-dataset-to-have-the-text-bears.-beets.-battlestar-galactica..-where-is-it-located-exactly" class="section level5">
<h5>1. Login to Scholar and use <code>grep</code> to find the dataset we will use this project. The dataset we will use is the only dataset to have the text &quot;Bears. Beets. Battlestar Galactica.&quot;. Where is it located exactly?</h5>
<p><strong>Relevant topics:</strong> <em><a href="https://thedatamine.github.io/the-examples-book/unix.html#grep">grep</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The <code>grep</code> command used to find the dataset.
</li>
<li>
The name and location in Scholar of the dataset.
</li>
</ul>
</div>
</div>
<div id="solution-87" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">grep</span> -Ri <span class="st">&quot;bears. beets. battlestar galactica.&quot;</span> /class/datamine </code></pre></div>
<p><code>/class/datamine/data/movies_and_tv/the_office_dialogue.csv</code></p>
</div>
<div id="grep-prints-the-line-that-the-text-you-are-searching-for-appears-in.-in-project-3-we-learned-a-unix-command-to-quickly-print-the-first-n-lines-from-a-file.-use-this-command-to-get-the-headers-for-the-dataset.-as-you-can-see-each-line-in-the-tv-show-is-a-row-in-the-dataset.-you-can-count-to-see-which-column-the-various-bits-of-data-live-in." class="section level5">
<h5>2. <code>grep</code> prints the line that the text you are searching for appears in. In project 3 we learned a UNIX command to quickly print the first <em>n</em> lines from a file. Use this command to get the headers for the dataset. As you can see, each line in the tv show is a row in the dataset. You can count to see which column the various bits of data live in.</h5>
</div>
<div id="write-a-line-of-unix-commands-that-searches-for-bears.-beets.-battlestar-galactica.-and-rather-than-printing-the-entire-line-prints-only-the-character-who-speaks-the-line-as-well-as-the-line-itself." class="section level5">
<h5>Write a line of UNIX commands that searches for &quot;bears. beets. battlestar galactica.&quot; and, rather than printing the entire line, prints only the character who speaks the line, as well as the line itself.</h5>
<p><strong>Hint:</strong> <em>The result if you were to search for &quot;bears. beets. battlestar galactica.&quot; should be:</em></p>
<pre class="txt"><code>&quot;Jim&quot;,&quot;Fact. Bears eat beets. Bears. Beets. Battlestar Galactica.&quot;</code></pre>
<p><strong>Hint:</strong> <em>One method to solve this problem would be to <a href="https://thedatamine.github.io/the-examples-book/unix.html#piping-and-redirection">pipe</a> the output from <code>grep</code> to <a href="https://thedatamine.github.io/the-examples-book/unix.html#cut"><code>cut</code></a>.</em></p>
<p><strong>Relevant topics:</strong> <em><a href="unix.html#cut">cut</a>, <a href="unix.html#grep">grep</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The line of UNIX commands used to find the character and original dialogue line that contains &quot;bears. beets. battlestar galactica.&quot;.
</li>
</ul>
</div>
</div>
<div id="solution-88" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">grep</span> -i <span class="st">&quot;bears. beets. battlestar galactica.&quot;</span> /class/datamine/data/movies_and_tv/the_office_dialogue.csv <span class="kw">|</span> <span class="fu">cut</span> -d <span class="st">&quot;,&quot;</span> -f 7,8  </code></pre></div>
</div>
<div id="this-particular-dataset-happens-to-be-very-small.-you-could-imagine-a-scenario-where-the-file-is-many-gigabytes-and-not-easy-to-load-completely-into-r-or-python.-we-are-interested-in-learning-what-makes-jim-and-pam-tick-as-a-couple.-use-a-line-of-unix-commands-to-create-a-new-dataset-called-jim_and_pam.csv-remember-a-good-place-to-store-data-temporarily-is-scratchscholaruser.-include-only-lines-that-are-spoken-by-either-jim-or-pam-or-reference-jim-or-pam-in-any-way.-how-many-rows-of-data-are-in-the-new-file-how-many-megabytes-is-the-new-file-to-the-nearest-110th-of-a-megabyte" class="section level5">
<h5>3. This particular dataset happens to be very small. You could imagine a scenario where the file is many gigabytes and not easy to load completely into R or Python. We are interested in learning what makes Jim and Pam tick as a couple. Use a line of UNIX commands to create a new dataset called <code>jim_and_pam.csv</code> (remember, a good place to store data temporarily is <code>/scratch/scholar/$USER</code>). Include only lines that are spoken by either Jim or Pam, or reference Jim or Pam in any way. How many rows of data are in the new file? How many megabytes is the new file (to the nearest 1/10th of a megabyte)?</h5>
<p><strong>Hint:</strong> <em><a href="https://thedatamine.github.io/the-examples-book/unix.html#piping-and-redirection">Redirection</a>.</em></p>
<p><strong>Hint:</strong> <em>It is OK if you get an erroneous line where the word &quot;jim&quot; or &quot;pam&quot; appears as a part of another word.</em></p>
<p><strong>Relevant topics:</strong> <em><a href="unix.html#grep">grep</a>, <a href="unix.html#ls">ls</a>, <a href="unix.html#wc">wc</a>, <a href="unix.html#piping-and-redirection">redirection</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The line of UNIX commands used to create the new file.
</li>
<li>
The number of rows of data in the new file, and the accompanying UNIX command used to find this out.
</li>
<li>
The number of megabytes (to the nearest 1/10th of a megabyte) that the new file has, and the accompanying UNIX command used to find this out.
</li>
</ul>
</div>
</div>
<div id="solution-89" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">grep</span> -i <span class="st">&quot;jim\|pam&quot;</span> /class/datamine/data/movies_and_tv/the_office_dialogue.csv <span class="kw">|</span> <span class="fu">cut</span> -d <span class="st">&quot;,&quot;</span> -f4,7,8,9,12 <span class="op">&gt;</span> jim_and_pam.csv</code></pre></div>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">wc</span> -l jim_and_pam.csv</code></pre></div>
<p>13779 lines</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">ls</span> -h jim_and_pam.csv</code></pre></div>
<p>1.4mb</p>
</div>
<div id="find-all-lines-where-either-jimpammichaeldwights-name-is-followed-by-an-exclamation-mark.-use-only-1-within-your-regular-expression.-how-many-lines-are-there-ignore-case-whether-or-not-parts-of-the-names-are-capitalized-or-not." class="section level5">
<h5>4. Find all lines where either Jim/Pam/Michael/Dwight's name is followed by an exclamation mark. Use only 1 &quot;!&quot; within your regular expression. How many lines are there? Ignore case (whether or not parts of the names are capitalized or not).</h5>
<p><strong>Relevant topics:</strong> <em><a href="unix.html#grep">grep</a>, <a href="https://r4ds.had.co.nz/strings.html#basic-matches">basic matches</a>, <a href="faqs.html#faq-escape-characters">escaping characters</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The UNIX command(s) used to solve this problem.
</li>
<li>
The number of lines where either Jim/Pam/Michael/Dwight's name is followed by an exclamation mark.
</li>
</ul>
</div>
</div>
<div id="solution-90" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">grep</span> -E <span class="st">&#39;(Jim|Pam|Michael|Dwight)!&#39;</span> the_office_dialogue.csv

<span class="co"># or</span>

<span class="fu">grep</span> <span class="st">&#39;\(Jim\|Pam\|Michael\|Dwight\)!&#39;</span> the_office_dialogue.csv<span class="kw">|</span> <span class="fu">wc</span> -l</code></pre></div>
</div>
<div id="find-all-lines-that-contain-the-text-thats-what-followed-by-any-amount-of-any-text-and-then-said.-how-many-lines-are-there" class="section level5">
<h5>5. Find all lines that contain the text &quot;that's what&quot; followed by any amount of any text and then &quot;said&quot;. How many lines are there?</h5>
<p><strong>Relevant topics:</strong> <em><a href="unix.html#grep">grep</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The UNIX command used to solve this problem.
</li>
<li>
The number of lines that contain the text &quot;that's what&quot; followed by any amount of text and then &quot;said&quot;.
</li>
</ul>
</div>
</div>
<div id="solution-91" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">grep</span> -i <span class="st">&quot;that&#39;s what .* said&quot;</span> /class/datamine/data/movies_and_tv/the_office_dialogue.csv</code></pre></div>
<p>Regular expressions are really a useful semi language-agnostic tool. What this means is regardless of the programming language your are using, there will be some package that allows you to use regular expressions. In fact, we can use them in both R and Python! This can be particularly useful when dealing with strings. Load up the dataset you discovered in (1) using <code>read.csv</code>. Name the resulting data.frame <code>dat</code>.</p>
</div>
<div id="the-text_w_direction-column-in-dat-contains-the-characters-lines-with-inserted-direction-that-helps-characters-know-what-to-do-as-they-are-reciting-the-lines.-direction-is-shown-between-square-brackets-.-in-this-two-part-question-we-are-going-to-use-regular-expression-to-detect-the-directions." class="section level5">
<h5>6. The <code>text_w_direction</code> column in <code>dat</code> contains the characters' lines with inserted direction that helps characters know what to do as they are reciting the lines. Direction is shown between square brackets &quot;[&quot; &quot;]&quot;. In this two-part question, we are going to use regular expression to detect the directions.</h5>
</div>
<div id="a-create-a-new-column-called-has_direction-that-is-set-to-true-if-the-text_w_direction-column-has-direction-and-false-otherwise.-use-the-grepl-function-in-r-to-accomplish-this." class="section level5">
<h5>(a) Create a new column called <code>has_direction</code> that is set to <code>TRUE</code> if the <code>text_w_direction</code> column has direction, and <code>FALSE</code> otherwise. Use the <code>grepl</code> function in R to accomplish this.</h5>
<p><strong>Hint:</strong> <em>Make sure all opening brackets &quot;[&quot; have a corresponding closing bracket &quot;]&quot;.</em></p>
<p><strong>Hint:</strong> <em>Think of the pattern as any line that has a [, followed by any amount of any text, followed by a ], followed by any amount of any text.</em></p>
</div>
<div id="b-modify-your-regular-expression-to-find-lines-with-2-or-more-sets-of-direction.-how-many-lines-have-more-than-2-directions-modify-your-code-again-and-find-how-many-have-more-than-5." class="section level5">
<h5>(b) Modify your regular expression to find lines with 2 or more sets of direction. How many lines have more than 2 directions? Modify your code again and find how many have more than 5.</h5>
<p>We count the sets of direction in each line by the pairs of square brackets. The following are two simple example sentences.</p>
<pre class="txt"><code>This is a line with [emphasize this] only 1 direction!
This is a line with [emphasize this] 2 sets of direction, do you see the difference [shrug].</code></pre>
<p>Your solution to part (a) should find both lines a match. However, in part (b) we want the regular expression pattern to find only lines with 2+ directions, so the first line would not be a match.</p>
<p>In our actual dataset, for example, <code>dat$text_w_direction[2789]</code> is a line with 2 directions.</p>
<p><strong>Relevant topics:</strong> <em><a href="r.html#r-grep">grep</a>, <a href="r.html#r-grep">grepl</a>, <a href="https://r4ds.had.co.nz/strings.html#basic-matches">basic matches</a>, <a href="faqs.html#faq-escape-characters">escaping characters</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The R code and regular expression used to solve the first part of this problem.
</li>
<li>
The R code and regular expression used to solve the second part of this problem.
</li>
<li>
How many lines have &gt;= 2 directions?
</li>
<li>
How many lines have &gt;= 5 directions?
</li>
</ul>
</div>
</div>
<div id="solution-92" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat<span class="op">$</span>has_direction &lt;-<span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;(</span><span class="ch">\\</span><span class="st">[.*</span><span class="ch">\\</span><span class="st">])+&quot;</span>, dat<span class="op">$</span>text_w_direction)

<span class="co">#</span>

<span class="kw">length</span>(<span class="kw">grep</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">[.*</span><span class="ch">\\</span><span class="st">].*</span><span class="ch">\\</span><span class="st">[.*</span><span class="ch">\\</span><span class="st">]&quot;</span>, dat<span class="op">$</span>text_w_direction))
<span class="kw">length</span>(<span class="kw">grep</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">[.*</span><span class="ch">\\</span><span class="st">].*</span><span class="ch">\\</span><span class="st">[.*</span><span class="ch">\\</span><span class="st">].*</span><span class="ch">\\</span><span class="st">[.*</span><span class="ch">\\</span><span class="st">].*</span><span class="ch">\\</span><span class="st">[.*</span><span class="ch">\\</span><span class="st">].*</span><span class="ch">\\</span><span class="st">[.*</span><span class="ch">\\</span><span class="st">]&quot;</span>, dat<span class="op">$</span>text_w_direction))</code></pre></div>
</div>
<div id="optional-question.-use-the-str_extract_all-function-from-the-stringr-package-to-extract-the-directions-as-well-as-the-text-between-directions-from-each-line.-put-the-strings-in-a-new-column-called-direction." class="section level5">
<h5>OPTIONAL QUESTION. Use the <code>str_extract_all</code> function from the <code>stringr</code> package to extract the direction(s) as well as the text between direction(s) from each line. Put the strings in a new column called <code>direction</code>.</h5>
<pre class="txt"><code>This is a line with [emphasize this] only 1 direction!
This is a line with [emphasize this] 2 sets of direction, do you see the difference [shrug].</code></pre>
<p>In this question, your solution may have extracted:</p>
<pre class="txt"><code>[emphasize this]
[emphasize this] 2 sets of direction, do you see the difference [shrug]</code></pre>
<p>(It is okay to keep the text between neighboring pairs of &quot;[&quot; and &quot;]&quot; for the second line.)</p>
<p><strong>Relevant topics:</strong> <em><a href="r.html#r-str-extract">str_extract_all</a>, <a href="https://r4ds.had.co.nz/strings.html#basic-matches">basic matches</a>, <a href="faqs.html#faq-escape-characters">escaping characters</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The R code used to solve this problem.
</li>
</ul>
</div>
</div>
<div id="solution-93" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat<span class="op">$</span>direction_correct &lt;-<span class="st"> </span><span class="kw">str_extract_all</span>(dat<span class="op">$</span>text_w_direction, <span class="st">&quot;(</span><span class="ch">\\</span><span class="st">[[^</span><span class="ch">\\</span><span class="st">[</span><span class="ch">\\</span><span class="st">]]*</span><span class="ch">\\</span><span class="st">])&quot;</span>, <span class="dt">simplify=</span>F)

<span class="co"># or </span>

dat<span class="op">$</span>direction_correct &lt;-<span class="st"> </span><span class="kw">str_extract_all</span>(dat<span class="op">$</span>text_w_direction, <span class="st">&quot;(</span><span class="ch">\\</span><span class="st">[.*?</span><span class="ch">\\</span><span class="st">])&quot;</span>, <span class="dt">simplify=</span>F)</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p05-290" class="section level3">
<h3>Project 5</h3>
<hr />
<p><strong>Motivation:</strong> Becoming comfortable stringing together commands and getting used to navigating files in a terminal is important for every data scientist to do. By learning the basics of a few useful tools, you will have the ability to quickly understand and manipulate files in a way which is just not possible using tools like Microsoft Office, Google Sheets, etc.</p>
<p><strong>Context:</strong> We've been using UNIX tools in a terminal to solve a variety of problems. In this project we will continue to solve problems by combining a variety of tools using a form of redirection called piping.</p>
<p><strong>Scope:</strong> grep, regular expression basics, UNIX utilities, redirection, piping</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Use <code>cut</code> to section off and slice up data from the command line.
</li>
<li>
Use piping to string UNIX commands together.
</li>
<li>
Use <code>sort</code> and it's options to sort data in different ways.
</li>
<li>
Use <code>head</code> to isolate <em>n</em> lines of output.
</li>
<li>
Use <code>wc</code> to summarize the number of lines in a file or in output.
</li>
<li>
Use <code>uniq</code> to filter out non-unique lines.
</li>
<li>
Use <code>grep</code> to search files effectively.
</li>
</ul>
</div>
<p>You can find useful examples that walk you through relevant material in The Examples Book:</p>
<p><a href="https://thedatamine.github.io/the-examples-book" class="uri">https://thedatamine.github.io/the-examples-book</a></p>
<p>It is highly recommended to read through, search, and explore these examples to help solve problems in this project.</p>
<p>Don't forget the very useful documentation shortcut <code>?</code> for R code. To use, simply type <code>?</code> in the console, followed by the name of the function you are interested in. In the Terminal, you can use the <code>man</code> command to check the documentation of <code>bash</code> code.</p>
<div id="dataset-16" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/amazon/amazon_fine_food_reviews.csv</code></p>
<p>A public sample of the data can be found here: <a href="https://www.datadepot.rcac.purdue.edu/datamine/data/amazon/amazon_fine_food_reviews.csv">amazon_fine_food_reviews.csv</a></p>
<p>Answers to questions should all be answered using the full dataset located on Scholar. You may use the public samples of data to experiment with your solutions prior to running them using the full dataset.</p>
<p>Here are three videos that might also be useful, as you work on Project 5:</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_033gzti4&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_s3x23xpl">Click here for video</a></p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_b3pvmwfh&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_b01m3m83">Click here for video</a></p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_wf3zmtmy&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_v55nhwhp">Click here for video</a></p>
</div>
<div id="questions-16" class="section level4">
<h4>Questions</h4>
<div id="what-is-the-id-of-the-most-helpful-review-according-to-the-highest-helpfulnessnumerator" class="section level5">
<h5>1. What is the <code>Id</code> of the most helpful review, according to the highest <code>HelpfulnessNumerator</code>?</h5>
<p><strong>Important note:</strong> You can always pipe output to <code>head</code> in case you want the first few values of a lot of output. Note that if you used <code>sort</code> before <code>head</code>, you may see the following error messages:</p>
<pre><code>sort: write failed: standard output: Broken pipe
sort: write error</code></pre>
<p>This is because <code>head</code> would truncate the output from <code>sort</code>. This is okay. See <a href="https://stackoverflow.com/questions/46202653/bash-error-in-sort-sort-write-failed-standard-output-broken-pipe">this discussion</a> for more details.</p>
<p><strong>Relevant topics:</strong> <em><a href="unix.html#cut">cut</a>, <a href="unix.html#sort">sort</a>, <a href="unix.html#head">head</a>, <a href="unix.html#piping-and-redirection">piping</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Line of UNIX commands used to solve the problem.
</li>
<li>
The <code>Id</code> of the most helpful review.
</li>
</ul>
</div>
</div>
<div id="solution-94" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cut</span> -d, -f5 amazon_fine_food_reviews.csv<span class="kw">|</span> <span class="fu">sort</span> -nr <span class="kw">|</span> <span class="fu">head</span> -n3</code></pre></div>
</div>
<div id="some-entries-under-the-summary-column-appear-more-than-once.-calculate-the-proportion-of-unique-summaries-over-the-total-number-of-summaries.-use-two-lines-of-unix-commands-to-find-the-numerator-and-the-denominator-and-manually-calculate-the-proportion." class="section level5">
<h5>2. Some entries under the <code>Summary</code> column appear more than once. Calculate the proportion of unique summaries over the total number of summaries. Use two lines of UNIX commands to find the numerator and the denominator, and manually calculate the proportion.</h5>
</div>
<div id="to-further-clarify-what-we-mean-by-unique-if-we-had-the-following-vector-in-r-ca-b-a-c-its-unique-values-are-ca-b-c." class="section level5">
<h5>To further clarify what we mean by <em>unique</em>, if we had the following vector in R, <code>c(&quot;a&quot;, &quot;b&quot;, &quot;a&quot;, &quot;c&quot;)</code>, its unique values are <code>c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)</code>.</h5>
<p><strong>Relevant topics:</strong> <em><a href="unix.html#cut">cut</a>, <a href="unix.html#uniq">uniq</a>, <a href="unix.html#sort">sort</a>, <a href="unix.html#wc">wc</a>, <a href="unix.html#piping-and-redirection">piping</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Two lines of UNIX commands used to solve the problem.
</li>
<li>
The ratio of unique <code>Summary</code>'s.
</li>
</ul>
</div>
</div>
<div id="solution-95" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cut</span> -d, -f9 amazon_fine_food_reviews.csv <span class="kw">|</span> <span class="fu">sort</span> -u <span class="kw">|</span> <span class="fu">wc</span> -l
<span class="fu">cut</span> -d, -f9 amazon_fine_food_reviews.csv <span class="kw">|</span> <span class="fu">wc</span> -l

<span class="co"># 295162/568455</span></code></pre></div>
</div>
<div id="use-a-chain-of-unix-commands-piped-in-a-sequence-to-create-a-frequency-table-of-score." class="section level5">
<h5>3. Use a chain of UNIX commands, piped in a sequence, to create a frequency table of <code>Score</code>.</h5>
<p><strong>Relevant topics:</strong> <em><a href="unix.html#cut">cut</a>, <a href="unix.html#uniq">uniq</a>, <a href="unix.html#sort">sort</a>, <a href="unix.html#piping-and-redirection">piping</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The line of UNIX commands used to solve the problem.
</li>
<li>
The frequency table.
</li>
</ul>
</div>
</div>
<div id="solution-96" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cut</span> -d, -f7 amazon_fine_food_reviews.csv <span class="kw">|</span> <span class="fu">sort</span> -n <span class="kw">|</span> <span class="fu">uniq</span> -c</code></pre></div>
</div>
<div id="who-is-the-user-with-the-highest-number-of-reviews-there-are-two-columns-you-could-use-to-answer-this-question-but-which-column-do-you-think-would-be-most-appropriate-and-why" class="section level5">
<h5>4. Who is the user with the highest number of reviews? There are two columns you could use to answer this question, but which column do you think would be most appropriate and why?</h5>
<p><strong>Hint:</strong> <em>You may need to pipe the output to <code>sort</code> multiple times.</em></p>
<p><strong>Hint:</strong> <em>To create the frequency table, read through the <code>man</code> pages for <code>uniq</code>. Man pages are the &quot;manual&quot; pages for UNIX commands. You can read through the man pages for uniq by running the following:</em></p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">man</span> uniq</code></pre></div>
<p><strong>Relevant topics:</strong> <em><a href="unix.html#cut">cut</a>, <a href="unix.html#uniq">uniq</a>, <a href="unix.html#sort">sort</a>, <a href="unix.html#head">head</a>, <a href="unix.html#piping-and-redirection">piping</a>, <a href="unix.html#man">man</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The line of UNIX commands used to solve the problem.
</li>
<li>
The frequency table.
</li>
</ul>
</div>
</div>
<div id="solution-97" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cut</span> -d, -f3 amazon_fine_food_reviews.csv <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span> -c <span class="kw">|</span> <span class="fu">sort</span> -nr <span class="kw">|</span> <span class="fu">head</span> -n1

<span class="co"># You should use UserId instead of ProfileName as the former is a unique identifier</span></code></pre></div>
</div>
<div id="anecdotally-there-seems-to-be-a-tendency-to-leave-reviews-when-we-feel-strongly-either-positive-or-negative-about-a-product.-for-the-user-with-the-highest-number-of-reviews-i.e.-the-user-identified-in-question-4-would-you-say-that-they-follow-this-pattern-of-extremes-lets-consider-5-star-reviews-to-be-strongly-positive-and-1-star-reviews-to-be-strongly-negative.-lets-consider-anything-in-between-neither-strongly-positive-nor-negative." class="section level5">
<h5>5. Anecdotally, there seems to be a tendency to leave reviews when we feel strongly (either positive or negative) about a product. For the user with the highest number of reviews (i.e., the user identified in question 4), would you say that they follow this pattern of extremes? Let's consider 5 star reviews to be strongly positive and 1 star reviews to be strongly negative. Let's consider anything in between neither strongly positive nor negative.</h5>
<p><strong>Hint:</strong> <em>You may find the solution to problem (3) useful.</em></p>
<p><strong>Relevant topics:</strong> <em><a href="unix.html#cut">cut</a>, <a href="unix.html#uniq">uniq</a>, <a href="unix.html#sort">sort</a>, <a href="unix.html#grep">grep</a>, <a href="unix.html#piping-and-redirection">piping</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The line of UNIX commands used to solve the problem.
</li>
</ul>
</div>
</div>
<div id="solution-98" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">grep</span> -i <span class="st">&#39;A3OXHLG6DIBRW8&#39;</span> amazon_fine_food_reviews.csv <span class="kw">|</span> <span class="fu">cut</span> -d, -f7 <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span> -c</code></pre></div>
</div>
<div id="find-the-most-helpful-review-with-a-score-of-5.-then-separately-find-the-most-helpful-review-with-a-score-of-1.-as-before-we-are-considering-the-most-helpful-review-to-be-the-review-with-the-highest-helpfulnessnumerator." class="section level5">
<h5>6. Find the most helpful review with a <code>Score</code> of 5. Then (separately) find the most helpful review with a <code>Score</code> of 1. As before, we are considering the most helpful review to be the review with the highest <code>HelpfulnessNumerator</code>.</h5>
<p><strong>Hint:</strong> <em>You can use multiple lines to solve this problem.</em></p>
<p><strong>Relevant topics:</strong> <em><a href="unix.html#sort">sort</a>, <a href="unix.html#head">head</a>, <a href="unix.html#piping-and-redirection">piping</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The lines of UNIX commands used to solve the problem.
</li>
<li>
<code>ProductId</code>'s of both requested reviews.
</li>
</ul>
</div>
</div>
<div id="solution-99" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">sort</span> -t, -k7rn,7 -k5rn,5 amazon_fine_food_reviews.csv <span class="kw">|</span> <span class="fu">head</span> -n2
<span class="fu">sort</span> -t, -k7n,7 -k5rn,5 amazon_fine_food_reviews.csv <span class="kw">|</span> <span class="fu">head</span> -n2</code></pre></div>
</div>
<div id="optional-question.-for-only-the-two-productids-from-the-previous-question-create-a-new-dataset-called-scores.csv-that-contains-the-productids-and-scores-from-all-reviews-for-these-two-items." class="section level5">
<h5>OPTIONAL QUESTION. For <strong>only</strong> the two <code>ProductId</code>s from the previous question, create a new dataset called <code>scores.csv</code> that contains the <code>ProductId</code>s and <code>Score</code>s from all reviews for these two items.</h5>
<p><strong>Relevant topics:</strong> <em><a href="unix.html#cut">cut</a>, <a href="unix.html#head">grep</a>, <a href="unix.html#piping-and-redirection">redirection</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The line of UNIX commands used to solve the problem.
</li>
</ul>
</div>
</div>
<div id="solution-100" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cut</span> -d, -f2,7 amazon_fine_food_reviews.csv<span class="kw">|</span> <span class="fu">grep</span> -Ei <span class="st">&#39;(B00012182G|B003EMQGVI|B00065LI0A)&#39;</span> <span class="op">&gt;</span> scores.csv</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p06-290" class="section level3">
<h3>Project 6</h3>
<hr />
<p><strong>Motivation:</strong> A bash script is a powerful tool to perform repeated tasks. RCAC uses bash scripts to automate a variety of tasks. In fact, we use bash scripts on Scholar to do things like link Python kernels to your account, fix potential isues with Firefox, etc. <code>awk</code> is a programming language designed for text processing. The combination of these tools can be really powerful and useful for a variety of quick tasks.</p>
<p><strong>Context:</strong> This is the first part in a series of projects that are designed to exercise skills around UNIX utilities, with a focus on writing bash scripts and <code>awk</code>. You will get the opportunity to manipulate data without leaving the terminal. At first it may seem overwhelming, however, with just a little practice you will be able to accomplish data wrangling tasks really efficiently.</p>
<p><strong>Scope:</strong> awk, UNIX utilities, bash scripts</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Use <code>awk</code> to process and manipulate textual data.
</li>
<li>
Use piping and redirection within the terminal to pass around data between utilities.
</li>
</ul>
</div>
<div id="dataset-17" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found <a href="https://www.datadepot.rcac.purdue.edu/datamine/data/flights/subset/YYYY.csv">here</a> or in Scholar:</p>
<p><code>/class/datamine/data/flights/subset/YYYY.csv</code></p>
<p>An example from 1987 data can be found <a href="https://www.datadepot.rcac.purdue.edu/datamine/data/flights/subset/1987.csv">here</a> or in Scholar:</p>
<p><code>/class/datamine/data/flights/subset/1987.csv</code></p>
</div>
<div id="questions-17" class="section level4">
<h4>Questions</h4>
<p><strong>Important note:</strong> Please make sure to <strong>double check</strong> that the your submission does indeed contain the files you think it does. You can do this by downloading your submission from Gradescope after uploading. If you can see all of your files and they open up properly on your computer, you should be good to go.</p>
<p><strong>Important note:</strong> Please make sure to look at your knit PDF <em>before</em> submitting. PDFs should be relatively short and not contain huge amounts of printed data. Remember you can use functions like <code>head</code> to print a sample of the data or output. Extremely large PDFs will be subject to lose points.</p>
<div id="in-previous-projects-we-learned-how-to-get-a-single-column-of-data-from-a-csv-file.-write-1-line-of-unix-commands-to-print-the-17th-column-the-origin-from-1987.csv.-write-another-line-this-time-using-awk-to-do-the-same-thing.-which-one-do-you-prefer-and-why" class="section level5">
<h5>1. In previous projects we learned how to get a single column of data from a csv file. Write 1 line of UNIX commands to print the 17th column, the <code>Origin</code>, from <code>1987.csv</code>. Write another line, this time using <code>awk</code> to do the same thing. Which one do you prefer, and why?</h5>
<p>Here is an example, from a different data set, to illustrate some differences and similarities between cut and awk:</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_hmf7lr7b&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_6tkg6zzx">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="unix.html#cut">cut</a>, <a href="unix.html#awk">awk</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
One line of UNIX commands to solve the problem <em>without</em> using <code>awk</code>.
</li>
<li>
One line of UNIX commands to solve the problem using <code>awk</code>.
</li>
<li>
1-2 sentences describing which method you prefer and why.
</li>
</ul>
</div>
</div>
<div id="solution-101" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cut</span> -d, -f17 1987.csv
<span class="fu">awk</span> -F, <span class="st">&#39;{print $17}&#39;</span> 1987.csv</code></pre></div>
</div>
<div id="write-a-bash-script-that-accepts-a-year-1987-1988-etc.-and-a-column-n-and-returns-the-nth-column-of-the-associated-year-of-data." class="section level5">
<h5>2. Write a bash script that accepts a year (1987, 1988, etc.) and a column <em>n</em> and returns the <em>nth</em> column of the associated year of data.</h5>
<p>Here are two examples to illustrate how to write a bash script:</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_gkirnxfb&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_0qtbjjlt">Click here for video</a></p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_e14gbfiq&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_8tyncb6q">Click here for video</a></p>
<p><strong>Hint:</strong> In this example, you only need to turn in the content of your bash script (starting with <code>#!/bin/bash</code>) without evaluation in a code chunk. However, you should test your script before submission to make sure it works. To actually test out your bash script, take the following example. The script is simple and just prints out the first two arguments given to it:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>

<span class="bu">echo</span> <span class="st">&quot;First argument: </span><span class="va">$1</span><span class="st">&quot;</span>
<span class="bu">echo</span> <span class="st">&quot;Second argument: </span><span class="va">$2</span><span class="st">&quot;</span></code></pre></div>
<p>If you simply drop that text into a file called <code>my_script.sh</code>, located here: <code>/home/$USER/my_script.sh</code>, and if you run the following:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># Setup bash to run; this only needs to be run one time per session.</span>
<span class="co"># It makes bash behave a little more naturally in RStudio.</span>
<span class="bu">exec</span> bash

<span class="co"># Navigate to the location of my_script.sh</span>
<span class="bu">cd</span> /home/<span class="va">$USER</span>

<span class="co"># Make sure that the script is runable.</span>
<span class="co"># This only needs to be done one time for each new script that you write.</span>
<span class="fu">chmod</span> 755 my_script.sh

<span class="co"># Execute my_script.sh</span>
<span class="ex">./my_script.sh</span> okay cool</code></pre></div>
<p>then it will print:</p>
<pre><code>First argument: okay
Second argument: cool</code></pre>
<p>In this example, if we were to turn in the &quot;content of your bash script (starting with <code>#!/bin/bash</code>) in a code chunk, our solution would look like this:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>

<span class="bu">echo</span> <span class="st">&quot;First argument: </span><span class="va">$1</span><span class="st">&quot;</span>
<span class="bu">echo</span> <span class="st">&quot;Second argument: </span><span class="va">$2</span><span class="st">&quot;</span></code></pre></div>
<p>And although we aren't running the code chunk above, we know that it works because we tested it in the terminal.</p>
<p><strong>Hint:</strong> Using <code>awk</code> you could have a script with just two lines: 1 with the &quot;hash-bang&quot; (<code>#!/bin/bash</code>), and 1 with a single <code>awk</code> command.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a>, <a href="unix.html#unix-writing-scripts">bash scripts</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The content of your bash script (starting with <code>#!/bin/bash</code>) in a code chunk.
</li>
</ul>
</div>
</div>
<div id="solution-102" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>
<span class="fu">awk</span> -F, -v col=<span class="va">$2</span> <span class="st">&#39;{print $col}&#39;</span> <span class="va">$1</span>.csv</code></pre></div>
</div>
<div id="how-many-flights-arrived-at-indianapolis-ind-in-2008-first-solve-this-problem-without-using-awk-then-solve-this-problem-using-only-awk." class="section level5">
<h5>3. How many flights arrived at Indianapolis (IND) in 2008? First solve this problem without using <code>awk</code>, then solve this problem using <em>only</em> <code>awk</code>.</h5>
<p>Here is a similar example, using the election data set:</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_mzv1gtb1&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_mv06yedm">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="unix.html#cut">cut</a>, <a href="unix.html#grep">grep</a>, <a href="unix.html#wc">wc</a>, <a href="unix.html#awk">awk</a>, <a href="unix.html#piping-and-redirection">piping</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
One line of UNIX commands to solve the problem <em>without</em> using <code>awk</code>.
</li>
<li>
One line of UNIX commands to solve the problem using <code>awk</code>.
</li>
<li>
The number of flights that arrived at Indianapolis (IND) in 2008.
</li>
</ul>
</div>
</div>
<div id="solution-103" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cut</span> -d, -f18 2008.csv <span class="kw">|</span> <span class="fu">grep</span> <span class="st">&#39;IND&#39;</span> <span class="kw">|</span> <span class="fu">wc</span> -l
<span class="fu">awk</span> -F, <span class="st">&#39;{if ($18 == &quot;IND&quot;) count++}END{print count}&#39;</span> 2008.csv</code></pre></div>
</div>
<div id="do-you-expect-the-number-of-unique-origins-and-destinations-to-be-the-same-based-on-flight-data-in-the-year-2008-find-out-using-any-command-line-tool-youd-like.-are-they-indeed-the-same-how-many-unique-values-do-we-have-per-category-origin-dest" class="section level5">
<h5>4. Do you expect the number of unique origins and destinations to be the same based on flight data in the year 2008? Find out, using any command line tool you'd like. Are they indeed the same? How many unique values do we have per category (<code>Origin</code>, <code>Dest</code>)?</h5>
<p>Here is an example to help you with the last part of the question, about Origin-to-Destination pairs. We analyze the city-state pairs from the election data:</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_7vly78sw&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_tba174p2">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="unix.html#cut">cut</a>, <a href="unix.html#sort">sort</a>, <a href="unix.html#uniq">uniq</a>, <a href="unix.html#wc">wc</a>, <a href="unix.html#awk">awk</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
1-2 sentences explaining whether or not you expect the number of unique origins and destinations to be the same.
</li>
<li>
The UNIX command(s) used to figure out if the number of unique origins and destinations are the same.
</li>
<li>
The number of unique values per category (<code>Origin</code>, <code>Dest</code>).
</li>
</ul>
</div>
</div>
<div id="solution-104" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cut</span> -d, -f17 2008.csv <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span> <span class="kw">|</span> <span class="fu">wc</span> -l
<span class="fu">cut</span> -d, -f18 2008.csv <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span> <span class="kw">|</span> <span class="fu">wc</span> -l</code></pre></div>
</div>
<div id="in-4-we-found-that-there-are-not-the-same-number-of-unique-origins-as-dests.-find-the-iata-airport-code-for-all-origins-that-dont-appear-in-a-dest-and-all-dests-that-dont-appear-in-an-origin-in-the-2008-data." class="section level5">
<h5>5. In (4) we found that there are not the same number of unique <code>Origin</code>'s as <code>Dest</code>'s. Find the <a href="https://en.wikipedia.org/wiki/International_Air_Transport_Association_code#Airport_codes">IATA airport code</a> for all <code>Origin</code>'s that don't appear in a <code>Dest</code> and all <code>Dest</code>'s that don't appear in an <code>Origin</code> in the 2008 data.</h5>
<p><strong>Hint:</strong> The examples on <a href="https://www.tutorialspoint.com/unix_commands/comm.htm">this</a> page should help. Note that these examples are based on <a href="https://tldp.org/LDP/abs/html/process-sub.html">Process Substitution</a>, which basically allows you to specify commands whose output would be used as the input of <code>comm</code>. There should be no space between <code>&lt;</code> and <code>(</code>, otherwise your bash will not work as intended.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#unix">comm</a>, <a href="unix.html#cut">cut</a>, <a href="unix.html#sort">sort</a>, <a href="unix.html#uniq">uniq</a>, <a href="unix.html#piping-and-redirection">redirection</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The line(s) of UNIX command(s) used to answer the question.
</li>
<li>
The list of <code>Origin</code>s that don't appear in <code>Dest</code>.
</li>
<li>
The list of <code>Dest</code>s that don't appear in <code>Origin</code>.
</li>
</ul>
</div>
</div>
<div id="solution-105" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">comm</span> -23 <span class="op">&lt;(</span><span class="fu">cut</span> -d, -f17 2008.csv <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span><span class="op">)</span> <span class="op">&lt;(</span><span class="fu">cut</span> -d, -f18 2008.csv <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span><span class="op">)</span>
<span class="fu">comm</span> -13 <span class="op">&lt;(</span><span class="fu">cut</span> -d, -f17 2008.csv <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span><span class="op">)</span> <span class="op">&lt;(</span><span class="fu">cut</span> -d, -f18 2008.csv <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span><span class="op">)</span></code></pre></div>
</div>
<div id="what-was-the-percentage-of-flights-in-2008-per-unique-origin-with-the-dest-of-ind-what-percentage-of-flights-had-phx-as-origin-among-all-flights-with-dest-of-ind" class="section level5">
<h5>6. What was the percentage of flights in 2008 per unique <code>Origin</code> with the <code>Dest</code> of &quot;IND&quot;? What percentage of flights had &quot;PHX&quot; as <code>Origin</code> (among all flights with <code>Dest</code> of &quot;IND&quot;?</h5>
<p>Here is an example using the percentages of donations contributed from CEOs from various States:</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_4r4bx3by&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_43qkeojx">Click here for video</a></p>
<p><strong>Hint:</strong> You can do the mean calculation in awk by dividing the result from (3) by the number of unique <code>Origin</code>'s that have a <code>Dest</code> of &quot;IND&quot;.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a>, <a href="unix.html#sort">sort</a>, <a href="unix.html#grep">grep</a>, <a href="unix.html#wc">wc</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The percentage of flights in 2008 per unique <code>Origin</code> with the <code>Dest</code> of &quot;IND&quot;.
</li>
<li>
1-2 sentences explaining how &quot;PHX&quot; compares (as a unique <code>ORIGIN</code>) to the other <code>Origin</code>s (all with the <code>Dest</code> of &quot;IND&quot;)?
</li>
</ul>
</div>
</div>
<div id="solution-106" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">awk</span> -F, <span class="st">&#39;{if($18==&quot;IND&quot;) print $17}&#39;</span> 2008.csv <span class="kw">|</span> <span class="fu">sort</span> -u <span class="kw">|</span> <span class="fu">wc</span> -l
<span class="fu">awk</span> -F, <span class="st">&#39;{if($18==&quot;IND&quot;) print $17}&#39;</span> 2008.csv <span class="kw">|</span> <span class="fu">grep</span> -i PHX <span class="kw">|</span> <span class="fu">wc</span> -l</code></pre></div>
</div>
<div id="optional-question.-write-a-bash-script-that-takes-a-year-and-iata-airport-code-and-returns-the-year-and-the-total-number-of-flights-to-and-from-the-given-airport.-example-rows-may-look-like" class="section level5">
<h5>OPTIONAL QUESTION. Write a bash script that takes a year and IATA airport code and returns the year, and the total number of flights to and from the given airport. Example rows may look like:</h5>
<pre class="txt"><code>1987, 12345
1988, 44</code></pre>
<p>Run the script with inputs: <code>1991</code> and <code>ORD</code>. Include the output in your submission.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#unix-writing-scripts">bash scripts</a>, <a href="unix.html#cut">cut</a>, <a href="unix.html#piping-and-redirection">piping</a>, <a href="unix.html#grep">grep</a>, <a href="unix.html#wc">wc</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The content of your bash script (starting with &quot;#!/bin/bash&quot;) in a code chunk.
</li>
<li>
The output of the script given <code>1991</code> and <code>ORD</code> as inputs.
</li>
</ul>
</div>
</div>
<div id="solution-107" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>
<span class="va">FLIGHTS_OUT=</span><span class="st">&quot;</span><span class="va">$(</span><span class="fu">cut</span> -d, -f17 <span class="va">$1</span>.csv <span class="kw">|</span> <span class="fu">grep</span> -i <span class="va">$2</span> <span class="kw">|</span> <span class="fu">wc</span> -l<span class="va">)</span><span class="st">&quot;</span>
<span class="va">FLIGHTS_IN=</span><span class="st">&quot;</span><span class="va">$(</span><span class="fu">cut</span> -d, -f18 <span class="va">$1</span>.csv <span class="kw">|</span> <span class="fu">grep</span> -i <span class="va">$2</span> <span class="kw">|</span> <span class="fu">wc</span> -l<span class="va">)</span><span class="st">&quot;</span>
<span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$((</span>FLIGHTS_OUT + FLIGHTS_IN<span class="va">))</span><span class="st">, </span><span class="va">$1</span><span class="st">&quot;</span></code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p07-290" class="section level3">
<h3>Project 7</h3>
<hr />
<p><strong>Motivation:</strong> A bash script is a powerful tool to perform repeated tasks. RCAC uses bash scripts to automate a variety of tasks. In fact, we use bash scripts on Scholar to do things like link Python kernels to your account, fix potential isues with Firefox, etc. <code>awk</code> is a programming language designed for text processing. The combination of these tools can be really powerful and useful for a variety of quick tasks.</p>
<p><strong>Context:</strong> This is the first part in a series of projects that are designed to exercise skills around UNIX utilities, with a focus on writing bash scripts and <code>awk</code>. You will get the opportunity to manipulate data without leaving the terminal. At first it may seem overwhelming, however, with just a little practice you will be able to accomplish data wrangling tasks really efficiently.</p>
<p><strong>Scope:</strong> awk, UNIX utilities, bash scripts</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Use <code>awk</code> to process and manipulate textual data.
</li>
<li>
Use piping and redirection within the terminal to pass around data between utilities.
</li>
</ul>
</div>
<div id="dataset-18" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar: <code>/class/datamine/data/flights/subset/YYYY.csv</code></p>
<p>An example of the data for the year 1987 can be found <a href="https://www.datadepot.rcac.purdue.edu/datamine/data/flights/subset/1987.csv">here</a>.</p>
<p>Sometimes if you are about to dig into a dataset, it is good to quickly do some sanity checks early on to make sure the data is what you expect it to be.</p>
</div>
<div id="questions-18" class="section level4">
<h4>Questions</h4>
<p><strong>Important note:</strong> Please make sure to <strong>double check</strong> that the your submission does indeed contain the files you think it does. You can do this by downloading your submission from Gradescope after uploading. If you can see all of your files and they open up properly on your computer, you should be good to go.</p>
<p><strong>Important note:</strong> Please make sure to look at your knit PDF <em>before</em> submitting. PDFs should be relatively short and not contain huge amounts of printed data. Remember you can use functions like <code>head</code> to print a sample of the data or output. Extremely large PDFs will be subject to lose points.</p>
<div id="write-a-line-of-code-that-prints-a-list-of-the-unique-values-in-the-dayofweek-column.-write-a-line-of-code-that-prints-a-list-of-the-unique-values-in-the-dayofmonth-column.-write-a-line-of-code-that-prints-a-list-of-the-unique-values-in-the-month-column.-use-the-1987.csv-dataset.-are-the-results-what-you-expected" class="section level5">
<h5>1. Write a line of code that prints a list of the unique values in the <code>DayOfWeek</code> column. Write a line of code that prints a list of the unique values in the <code>DayOfMonth</code> column. Write a line of code that prints a list of the unique values in the <code>Month</code> column. Use the <code>1987.csv</code> dataset. Are the results what you expected?</h5>
<p><strong>Relevant topics:</strong> <a href="unix.html#cut">cut</a>, <a href="unix.html#sort">sort</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
3 lines of code used to get a list of unique values for the chosen columns.
</li>
<li>
1-2 sentences explaining whether or not the results are what you expected.
</li>
</ul>
</div>
</div>
<div id="solution-108" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cut</span> -d, -f3 1987.csv <span class="kw">|</span> <span class="fu">sort</span> -nu
<span class="fu">cut</span> -d, -f4 1987.csv <span class="kw">|</span> <span class="fu">sort</span> -nu
<span class="fu">cut</span> -d, -f2 1987.csv <span class="kw">|</span> <span class="fu">sort</span> -nu</code></pre></div>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># We can print the unique values in the DayOfWeek, DayOfMonth, and Month,</span>
<span class="co"># using these three respectively pipelines in bash shell:</span>
<span class="fu">cat</span> /class/datamine/data/flights/subset/1987.csv <span class="kw">|</span> <span class="fu">cut</span> -d, -f4 <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span>
<span class="fu">cat</span> /class/datamine/data/flights/subset/1987.csv <span class="kw">|</span> <span class="fu">cut</span> -d, -f3 <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span>
<span class="fu">cat</span> /class/datamine/data/flights/subset/1987.csv <span class="kw">|</span> <span class="fu">cut</span> -d, -f2 <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span>

<span class="co"># or we can do this equivalently with awk:</span>
<span class="fu">cat</span> /class/datamine/data/flights/subset/1987.csv <span class="kw">|</span> <span class="fu">awk</span> -F, <span class="st">&#39;{print $4}&#39;</span> <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span>
<span class="fu">cat</span> /class/datamine/data/flights/subset/1987.csv <span class="kw">|</span> <span class="fu">awk</span> -F, <span class="st">&#39;{print $3}&#39;</span> <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span>
<span class="fu">cat</span> /class/datamine/data/flights/subset/1987.csv <span class="kw">|</span> <span class="fu">awk</span> -F, <span class="st">&#39;{print $2}&#39;</span> <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span></code></pre></div>
</div>
<div id="our-files-should-have-29-columns.-for-a-given-file-write-a-line-of-code-that-prints-any-lines-that-do-not-have-29-columns.-test-it-on-1987.csv-were-there-any-rows-without-29-columns" class="section level5">
<h5>2. Our files should have 29 columns. For a given file, write a line of code that prints any lines that do <em>not</em> have 29 columns. Test it on <code>1987.csv</code>, were there any rows without 29 columns?</h5>
<p><strong>Hint:</strong> See <a href="unix.html#unix-awk-built-in-variables">here</a>. <code>NF</code> looks like it may be useful!</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Line of code used to solve the problem.
</li>
<li>
1-2 sentences explaining whether or not there were any rows without 29 columns.
</li>
</ul>
</div>
</div>
<div id="solution-109" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">awk</span> -F, <span class="st">&#39;{if (NF != 29) print $0}&#39;</span> 1987.csv</code></pre></div>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># We can print any lines that do not have 29 columns, as follows:</span>
<span class="fu">cat</span> /class/datamine/data/flights/subset/1987.csv <span class="kw">|</span> <span class="fu">awk</span> -F, <span class="st">&#39;{if (NF !=</span>
<span class="st">29) {print $0}}&#39;</span>
<span class="co"># Note that there are no such lines.</span>
<span class="co"># In other words, every line has exactly 29 columns.</span></code></pre></div>
</div>
<div id="write-a-bash-script-that-given-a-begin-year-and-end-year-cycles-through-the-associated-files-and-prints-any-lines-that-do-not-have-29-columns." class="section level5">
<h5>3. Write a bash script that, given a &quot;begin&quot; year and &quot;end&quot; year, cycles through the associated files and prints any lines that do <em>not</em> have 29 columns.</h5>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a>, <a href="unix.html#unix-writing-scripts">bash scripts</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The content of your bash script (starting with &quot;#!/bin/bash&quot;) in a code chunk.
</li>
<li>
The results of running your bash scripts from year 1987 to 2008.
</li>
</ul>
</div>
</div>
<div id="solution-110" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>
<span class="kw">for</span> <span class="kw">((</span>f=<span class="va">$1</span>; f&lt;=<span class="va">$2</span>; f++<span class="kw">))</span>; <span class="kw">do</span>
  <span class="fu">awk</span> -F, <span class="st">&#39;{if (NF != 29) print $0}&#39;</span> <span class="va">$f</span>.csv
<span class="kw">done</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># Here is a bash script for which the variable i cycles through the</span>
<span class="co"># desired years, and the script prints any lines that do not have 29 fields.</span>

<span class="co">#!/bin/bash</span>
<span class="kw">for</span> <span class="kw">((</span> i=<span class="va">$1</span>; i&lt;=<span class="va">$2</span>; i++ <span class="kw">))</span>
  <span class="kw">do</span>
<span class="fu">cat</span> /class/datamine/data/flights/subset/<span class="va">${i}</span>.csv <span class="kw">|</span> <span class="fu">awk</span> -F, <span class="st">&#39;{if (NF</span>
<span class="st">!= 29) {print $0}}&#39;</span>
<span class="kw">done</span>

<span class="co"># change permissions, to make the script executable</span>
<span class="fu">chmod</span> 755 myscript.sh 

<span class="ex">./myscript.sh</span> 1987 2008  # run the bash script

<span class="co"># As in question 2, note that there are no such lines.</span>
<span class="co"># In other words, every line has exactly 29 columns.</span></code></pre></div>
</div>
<div id="awk-is-a-really-good-tool-to-quickly-get-some-data-and-manipulate-it-a-little-bit.-the-column-distance-contains-the-distances-of-the-flights-in-miles.-use-awk-to-calculate-the-total-distance-traveled-by-the-flights-in-1990-and-show-the-results-in-both-miles-and-kilometers.-to-convert-from-miles-to-kilometers-simply-multiply-by-1.609344." class="section level5">
<h5>4. <code>awk</code> is a really good tool to quickly get some data and manipulate it a little bit. The column <code>Distance</code> contains the distances of the flights in miles. Use <code>awk</code> to calculate the total distance traveled by the flights in 1990, and show the results in both miles and kilometers. To convert from miles to kilometers, simply multiply by 1.609344.</h5>
<p><strong>Example output:</strong></p>
<pre class="txt"><code>Miles: 12345
Kilometers: 19867.35168</code></pre>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a>, <a href="unix.html#piping-and-redirection">piping</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The code used to solve the problem.
</li>
<li>
The results of running the code.
</li>
</ul>
</div>
</div>
<div id="solution-111" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">awk</span> -F, <span class="st">&#39;{miles=miles+$19}END{print &quot;Miles: &quot; miles, &quot;\nKilometers:&quot; miles*1.609344}&#39;</span> 1990.csv</code></pre></div>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># The total distance traveled in miles is stored in mytotaldistance</span>
<span class="co"># and at the end, we print mytotaldistance (which is given in miles)</span>
<span class="co"># and also mytotaldistance*1.609344 (which is the total distance in</span>
<span class="co"># kilometers).</span>
<span class="fu">cat</span> /class/datamine/data/flights/subset/1990.csv <span class="kw">|</span> <span class="fu">awk</span> -F, <span class="st">&#39;{mytotaldistance = mytotaldistance + $19} END{print &quot;The total distance is &quot;, mytotaldistance, &quot; miles.&quot;; print &quot;Equivalently, this is &quot;, mytotaldistance*1.609344, &quot; kilometers.&quot;}&#39;</span></code></pre></div>
</div>
<div id="use-awk-to-calculate-the-sum-of-the-number-of-depdelay-minutes-grouped-according-to-dayofweek.-use-2007.csv." class="section level5">
<h5>5. Use <code>awk</code> to calculate the sum of the number of <code>DepDelay</code> minutes, grouped according to <code>DayOfWeek</code>. Use <code>2007.csv</code>.</h5>
<p><strong>Example output:</strong></p>
<pre class="txt"><code>DayOfWeek:  0
1:  1234567
2:  1234567
3:  1234567
4:  1234567
5:  1234567
6:  1234567
7:  1234567</code></pre>
<p><strong>Note:</strong> 1 is Monday.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a>, <a href="unix.html#sort">sort</a>, <a href="unix.html#piping-and-redirection">piping</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The code used to solve the problem.
</li>
<li>
The output from running the code.
</li>
</ul>
</div>
</div>
<div id="solution-112" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">awk</span> -F, <span class="st">&#39;{delay[$4]=delay[$4]+$16}END{for (d in delay) print d&quot;: &quot;, delay[d]}&#39;</span> 2007.csv <span class="kw">|</span> <span class="fu">sort</span> -n</code></pre></div>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># We store the DepDelay in an array called mytotaldelays:</span>
<span class="fu">cat</span> /class/datamine/data/flights/subset/2007.csv <span class="kw">|</span> <span class="fu">awk</span> -F, <span class="st">&#39;{mytotaldelays[$4] = mytotaldelays[$4] + $16} END{for (i=1; i&lt;=7; i++) {print &quot;The total DepDelay in minutes is &quot;, mytotaldelays[i], &quot; on day</span>
<span class="st">&quot;, i, &quot; of the week.&quot;}}&#39;</span></code></pre></div>
</div>
<div id="it-wouldnt-be-fair-to-compare-the-total-depdelay-minutes-by-dayofweek-as-the-number-of-flights-may-vary.-one-way-to-take-this-into-account-is-to-instead-calculate-an-average.-modify-5-to-calculate-the-average-number-of-depdelay-minutes-by-the-number-of-flights-per-dayofweek.-use-2007.csv." class="section level5">
<h5>6. It wouldn't be fair to compare the total <code>DepDelay</code> minutes by <code>DayOfWeek</code> as the number of flights may vary. One way to take this into account is to instead calculate an average. Modify (5) to calculate the average number of <code>DepDelay</code> minutes by the number of flights per <code>DayOfWeek</code>. Use <code>2007.csv</code>.</h5>
<p><strong>Example output:</strong></p>
<pre class="txt"><code>DayOfWeek:  0
1:  1.234567
2:  1.234567
3:  1.234567
4:  1.234567
5:  1.234567
6:  1.234567
7:  1.234567</code></pre>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a>, <a href="unix.html#sort">sort</a>, <a href="unix.html#piping-and-redirection">piping</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The code used to solve the problem.
</li>
<li>
The output from running the code.
</li>
</ul>
</div>
</div>
<div id="solution-113" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">awk</span> -F, <span class="st">&#39;{delay[$4]=delay[$4]+$16; flights[$4]++}END{for (d in delay) print d&quot;: &quot;, delay[d]/flights[d]}&#39;</span> 2007.csv <span class="kw">|</span> <span class="fu">sort</span> -n</code></pre></div>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># Now we also keep track of mynumberofflights on each day of the week.</span>
<span class="fu">cat</span> /class/datamine/data/flights/subset/2007.csv <span class="kw">|</span> <span class="fu">awk</span> -F, <span class="st">&#39;{mytotaldelays[$4] = mytotaldelays[$4] + $16; mynumberofflights[$4] = mynumberofflights[$4] + 1} END{for (i=1; i&lt;=7; i++) {print &quot;The average DepDelay in minutes is &quot;, mytotaldelays[i]/mynumberofflights[i], &quot; on day &quot;, i, &quot; of the week.&quot;}}&#39;</span></code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p08-290" class="section level3">
<h3>Project 8</h3>
<hr />
<p><strong>Motivation:</strong> A bash script is a powerful tool to perform repeated tasks. RCAC uses bash scripts to automate a variety of tasks. In fact, we use bash scripts on Scholar to do things like link Python kernels to your account, fix potential isues with Firefox, etc. <code>awk</code> is a programming language designed for text processing. The combination of these tools can be really powerful and useful for a variety of quick tasks.</p>
<p><strong>Context:</strong> This is the last part in a series of projects that are designed to exercise skills around UNIX utilities, with a focus on writing bash scripts and <code>awk</code>. You will get the opportunity to manipulate data without leaving the terminal. At first it may seem overwhelming, however, with just a little practice you will be able to accomplish data wrangling tasks really efficiently.</p>
<p><strong>Scope:</strong> awk, UNIX utilities, bash scripts</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Use <code>awk</code> to process and manipulate textual data.
</li>
<li>
Use piping and redirection within the terminal to pass around data between utilities.
</li>
</ul>
</div>
<div id="dataset-19" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar: <code>/class/datamine/data/flights/subset/YYYY.csv</code></p>
<p>An example of the data for the year 1987 can be found <a href="https://www.datadepot.rcac.purdue.edu/datamine/data/flights/subset/1987.csv">here</a>.</p>
</div>
<div id="questions-19" class="section level4">
<h4>Questions</h4>
<p><strong>Important note:</strong> Please make sure to <strong>double check</strong> that the your submission does indeed contain the files you think it does. You can do this by downloading your submission from Gradescope after uploading. If you can see all of your files and they open up properly on your computer, you should be good to go.</p>
<p><strong>Important note:</strong> Please make sure to look at your knit PDF <em>before</em> submitting. PDFs should be relatively short and not contain huge amounts of printed data. Remember you can use functions like <code>head</code> to print a sample of the data or output. Extremely large PDFs will be subject to lose points.</p>
<div id="lets-say-we-have-a-theory-that-there-are-more-flights-on-the-weekend-days-friday-saturday-sunday-than-the-rest-of-the-days-on-average.-we-can-use-awk-to-quickly-check-it-out-and-see-if-maybe-this-looks-like-something-that-is-true" class="section level5">
<h5>1. Let's say we have a theory that there are more flights on the weekend days (Friday, Saturday, Sunday) than the rest of the days, on average. We can use awk to quickly check it out and see if maybe this looks like something that is true!</h5>
</div>
<div id="write-a-line-of-awk-code-that-prints-the-total-number-of-flights-that-occur-on-weekend-days-followed-by-the-total-number-of-flights-that-occur-on-the-weekdays.-complete-this-calculation-for-2008-using-the-2008.csv-file." class="section level5">
<h5>Write a line of <code>awk</code> code that, prints the <em>total number of flights</em> that occur on weekend days, followed by the <em>total number of flights</em> that occur on the weekdays. Complete this calculation for 2008 using the <code>2008.csv</code> file.</h5>
<p><strong>Note:</strong> Under the column <code>DayOfWeek</code>, Monday through Sunday are represented by 1-7, respectively.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Line of <code>awk</code> code that solves the problem.
</li>
<li>
The result: the number of flights on the weekend days, followed by the number of flights on the weekdays for the flights during 2008.
</li>
</ul>
</div>
</div>
<div id="solution-114" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">awk</span> -F, <span class="st">&#39;{if ($4==1 || $4==2 || $4==3 || $4==4) weekday++; else (weekend++)}END{print weekend,weekday}&#39;</span> 2008.csv
<span class="fu">awk</span> -F, <span class="st">&#39;{if ($4 ~ /1|2|3|4/) weekday++; else (weekend++)}END{print weekend,weekday}&#39;</span> 2008.csv</code></pre></div>
</div>
<div id="note-that-in-1-we-are-comparing-3-days-to-4-write-a-line-of-awk-code-that-prints-the-average-number-of-flights-on-a-weekend-day-followed-by-the-average-number-of-flights-on-the-weekdays.-continue-to-use-data-for-2008." class="section level5">
<h5>2. Note that in (1), we are comparing 3 days to 4! Write a line of <code>awk</code> code that, prints the average number of flights on a weekend day, followed by the average number of flights on the weekdays. Continue to use data for 2008.</h5>
<p><strong>Hint:</strong> You don't need a large if statement to do this, you can use the <code>~</code> comparison operator.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Line of <code>awk</code> code that solves the problem.
</li>
<li>
The result: the average number of flights on the weekend days, followed by the average number of flights on the weekdays for the flights during 2008.
</li>
</ul>
</div>
</div>
<div id="solution-115" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">awk</span> -F, <span class="st">&#39;{if ($4==1 || $4==2 || $4==3 || $4==4) weekday++; else (weekend++)}END{print weekend/3,weekday/4}&#39;</span> 2008.csv
<span class="fu">awk</span> -F, <span class="st">&#39;{if ($4 ~ /1|2|3|4/) weekday++; else (weekend++)}END{print weekend/3,weekday/4}&#39;</span> 2008.csv</code></pre></div>
</div>
<div id="we-want-to-look-to-see-if-there-may-be-some-truth-to-the-whole-snow-bird-concept-where-people-will-travel-to-warmer-states-like-florida-and-arizona-during-the-winter.-lets-use-the-tools-weve-learned-to-explore-this-a-little-bit." class="section level5">
<h5>3. We want to look to see if there may be some truth to the whole &quot;snow bird&quot; concept where people will travel to warmer states like Florida and Arizona during the Winter. Let's use the tools we've learned to explore this a little bit.</h5>
</div>
<div id="take-a-look-at-airports.csv.-in-particular-run-the-following" class="section level5">
<h5>Take a look at <code>airports.csv</code>. In particular run the following:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">head</span> airports.csv</code></pre></div>
</div>
<div id="notice-how-all-of-the-non-numeric-text-is-surrounded-by-quotes.-the-surrounding-quotes-would-need-to-be-escaped-for-any-comparison-within-awk.-this-is-messy-and-we-would-prefer-to-create-a-new-file-called-new_airports.csv-without-any-quotes.-write-a-line-of-code-to-do-this." class="section level5">
<h5>Notice how all of the non-numeric text is surrounded by quotes. The surrounding quotes would need to be escaped for any comparison within <code>awk</code>. This is messy and we would prefer to create a new file called <code>new_airports.csv</code> without any quotes. Write a line of code to do this.</h5>
<p><strong>Note:</strong> You may be wondering <em>why</em> we are asking you to do this. This sort of situation (where you need to deal with quotes) happens a lot! It's important to practice and learn ways to fix these things.</p>
<p><strong>Hint:</strong> You could use <code>gsub</code> within <code>awk</code> to replace '&quot;' with ''. You can find how to use <code>gsub</code> <a href="https://www.gnu.org/software/gawk/manual/html_node/String-Functions.html">here</a>.</p>
<p><strong>Hint:</strong> If you leave out the column number argument to <code>gsub</code> it will apply the substitution to every field in every column.</p>
<p><strong>Hint:</strong></p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cat</span> new_airports.csv <span class="kw">|</span> <span class="fu">wc</span> -l <span class="co"># should be 159 without header</span></code></pre></div>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a>, <a href="unix.html#piping-and-redirection">redirection</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Line of <code>awk</code> code used to create the new dataset.
</li>
</ul>
</div>
</div>
<div id="solution-116" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">awk</span> -F, <span class="st">&#39;{gsub(/&quot;/, &quot;&quot;); print $0}&#39;</span> airports.csv <span class="op">&gt;</span> new_airports.csv</code></pre></div>
</div>
<div id="write-a-line-of-commands-that-creates-a-new-dataset-called-az_fl_airports.txt.-az_fl_airports.txt-should-only-contain-a-list-of-airport-codes-for-all-airports-from-both-arizona-az-and-florida-fl.-use-the-file-we-created-in-3new_airports.csv-as-a-starting-point." class="section level5">
<h5>4. Write a line of commands that creates a new dataset called <code>az_fl_airports.txt</code>. <code>az_fl_airports.txt</code> should <em>only</em> contain a list of airport codes for all airports from both Arizona (AZ) and Florida (FL). Use the file we created in (3),<code>new_airports.csv</code> as a starting point.</h5>
</div>
<div id="how-many-airports-are-there-did-you-expect-this-use-a-line-of-bash-code-to-count-this." class="section level5">
<h5>How many airports are there? Did you expect this? Use a line of bash code to count this.</h5>
</div>
<div id="create-a-new-dataset-called-az_fl_flights.txt-that-contains-all-of-the-data-for-flights-into-or-out-of-florida-and-arizona-using-the-2008.csv-file.-use-the-newly-created-dataset-az_fl_airports.txt-to-accomplish-this." class="section level5">
<h5>Create a new dataset (called <code>az_fl_flights.txt</code>) that contains all of the data for flights into or out of Florida and Arizona (using the <code>2008.csv</code> file). Use the newly created dataset, <code>az_fl_airports.txt</code> to accomplish this.</h5>
<p><strong>Hint:</strong> <a href="https://unix.stackexchange.com/questions/293684/basic-grep-awk-help-extracting-all-lines-containing-a-list-of-terms-from-one-f" class="uri">https://unix.stackexchange.com/questions/293684/basic-grep-awk-help-extracting-all-lines-containing-a-list-of-terms-from-one-f</a></p>
<p><strong>Hint:</strong></p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cat</span> az_fl_flights.txt <span class="kw">|</span> <span class="fu">wc</span> -l <span class="co"># should be 484705</span></code></pre></div>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a>, <a href="unix.html#wc">wc</a>, <a href="unix.html#piping-and-redirection">piping</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
All UNIX commands used to answer the questions.
</li>
<li>
The number of airports.
</li>
<li>
1-2 sentences explaining whether you expected this number of airports.
</li>
</ul>
</div>
</div>
<div id="solution-117" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">awk</span> -F, <span class="st">&#39;{if ($4 == &quot;AZ&quot; || $4 == &quot;FL&quot;) print $1}&#39;</span> new_airports.csv <span class="op">&gt;</span> az_fl_airports.txt
<span class="fu">wc</span> -l az_fl_airports.txt
<span class="fu">grep</span> -w -F -f az_fl_airports.txt 2008.csv</code></pre></div>
</div>
<div id="write-a-bash-script-that-accepts-the-year-as-an-argument-and-performs-the-same-operations-as-in-question-4-returning-the-number-of-flights-into-and-out-of-both-az-and-fl-for-any-given-year." class="section level5">
<h5>5. Write a bash script that accepts the year as an argument and performs the same operations as in question 4, returning the number of flights into and out of both AZ and FL for any given year.</h5>
<p><strong>Relevant topics:</strong> <a href="#writing-scripts">bash scripts</a>, <a href="unix.html#grep">grep</a>, <a href="r.html#r-for-loops">for loop</a>, <a href="unix.html#redirection">redirection</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The content of your bash script (starting with &quot;#!/bin/bash&quot;) in a code chunk.
</li>
<li>
The line of UNIX code you used to execute the script and create the new dataset.
</li>
</ul>
</div>
</div>
<div id="solution-118" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>
<span class="kw">for</span> <span class="kw">((</span>f=<span class="va">$1</span>; f&lt;=<span class="va">$2</span>; f++<span class="kw">))</span>; <span class="kw">do</span>
  <span class="fu">grep</span> -w -F -f <span class="va">$3</span> <span class="va">$f</span>.csv
<span class="kw">done</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">./my_script.sh</span> 1987 2008 az_fl_airports.txt <span class="op">&gt;</span> az_fl_flights.csv</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p09-290" class="section level3">
<h3>Project 9</h3>
<hr />
<p><strong>Motivation:</strong> Structured Query Language (SQL) is a language used for querying and manipulating data in a database. SQL can handle much larger amounts of data than R and Python can alone. SQL is incredibly powerful. In fact, <a href="https://www.cloudflare.com/">cloudflare</a>, a billion dollar company, had much of its starting infrastructure built on top of a Postgresql database (per <a href="https://news.ycombinator.com/item?id=22878136">this thread on hackernews</a>). Learning SQL is <em>well</em> worth your time!</p>
<p><strong>Context:</strong> There are a multitude of RDBMSs (relational database management systems). Among the most popular are: MySQL, MariaDB, Postgresql, and SQLite. As we've spent much of this semester in the terminal, we will start in the terminal using SQLite.</p>
<p><strong>Scope:</strong> SQL, sqlite</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Explain the advantages and disadvantages of using a database over a tool like a spreadsheet.
</li>
<li>
Describe basic database concepts like: rdbms, tables, indexes, fields, query, clause.
</li>
<li>
Basic clauses: select, order by, limit, desc, asc, count, where, from, etc.
</li>
</ul>
</div>
<div id="dataset-20" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/lahman/lahman.db</code></p>
<p>This is the Lahman Baseball Database. You can find its documentation <a href="http://www.seanlahman.com/files/database/readme2017.txt">here</a>, including the definitions of the tables and columns.</p>
</div>
<div id="questions-20" class="section level4">
<h4>Questions</h4>
<p><strong>Important note:</strong> Please make sure to <strong>double check</strong> that the your submission does indeed contain the files you think it does. You can do this by downloading your submission from Gradescope after uploading. If you can see all of your files and they open up properly on your computer, you should be good to go.</p>
<p><strong>Important note:</strong> Please make sure to look at your knit PDF <em>before</em> submitting. PDFs should be relatively short and not contain huge amounts of printed data. Remember you can use functions like <code>head</code> to print a sample of the data or output. Extremely large PDFs will be subject to lose points.</p>
<p><strong>Important note:</strong> For this project all solutions should be done using SQL code chunks. To connect to the database, copy and paste the following before your solutions in your .Rmd:</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{r, include=F}
library(RSQLite)
lahman &lt;- dbConnect(RSQLite::SQLite(), &quot;/class/datamine/data/lahman/lahman.db&quot;)
```</code></pre></div>
<p>Each solution should then be placed in a code chunk like this:</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{sql, connection=lahman}
SELECT * FROM batting LIMIT 1;
```</code></pre></div>
<p>If you want to use a SQLite-specific function like <code>.tables</code> (or prefer to test things in the Terminal), you will need to use the Terminal to connect to the database and run queries. To do so, you can connect to RStudio Server at <a href="https://rstudio.scholar.rcac.purdue.edu" class="uri">https://rstudio.scholar.rcac.purdue.edu</a>, and navigate to the terminal. In the terminal execute the command:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">sqlite3</span> /class/datamine/data/lahman/lahman.db</code></pre></div>
<p>From there, the SQLite-specific commands will function properly. They will <em>not</em> function properly in an SQL code chunk. To display the SQLite-specific commands in a code chunk without running the code, use a code chunk with the option <code>eval=F</code> like this:</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{sql, connection=lahman, eval=F}
SELECT * FROM batting LIMIT 1;
```</code></pre></div>
<p>This will allow the code to be displayed without throwing an error.</p>
<div id="connect-to-rstudio-server-httpsrstudio.scholar.rcac.purdue.edu-and-navigate-to-the-terminal-and-access-the-lahman-database.-how-many-tables-are-available" class="section level5">
<h5>1. Connect to RStudio Server <a href="https://rstudio.scholar.rcac.purdue.edu" class="uri">https://rstudio.scholar.rcac.purdue.edu</a>, and navigate to the terminal and access the Lahman database. How many tables are available?</h5>
<p><strong>Hint:</strong> To connect to the database, do the following:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">sqlite3</span> /class/datamine/data/lahman/lahman.db</code></pre></div>
<p><strong>Hint:</strong> <a href="https://database.guide/2-ways-to-list-tables-in-sqlite-database/">This</a> is a good resource.</p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql">sqlite3</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
How many tables are available in the Lahman database?
</li>
<li>
The sqlite3 commands used to figure out how many tables are available.
</li>
</ul>
</div>
</div>
<div id="solution-119" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql">.tables</code></pre></div>
</div>
<div id="some-people-like-to-try-to-visit-all-30-mlb-ballparks-in-their-lifetime.-use-sql-commands-to-get-a-list-of-parks-and-the-cities-theyre-located-in.-for-your-final-answer-limit-the-output-to-10-recordsrows." class="section level5">
<h5>2. Some people like to try to <a href="https://www.washingtonpost.com/graphics/2017/sports/how-many-mlb-parks-have-you-visited/">visit all 30 MLB ballparks</a> in their lifetime. Use SQL commands to get a list of <code>parks</code> and the cities they're located in. For your final answer, limit the output to 10 records/rows.</h5>
<p><strong>Note:</strong> There may be more than 30 parks in your result, this is ok. For long results, you can limit the number of printed results using the <code>LIMIT</code> clause.</p>
<p><strong>Hint:</strong> Make sure you take a look at the column names and get familiar with the data tables. If working from the Terminal, to see the header row as a part of each query result, run the following:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql">.headers <span class="kw">on</span></code></pre></div>
<p><strong>Relevant topics:</strong> SELECT, FROM, LIMIT</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL code used to solve the problem.
</li>
<li>
The first 10 results of the query.
</li>
</ul>
</div>
</div>
<div id="solution-120" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> parkname, city <span class="kw">FROM</span> parks <span class="kw">LIMIT</span> <span class="dv">10</span>;</code></pre></div>
</div>
<div id="there-is-nothing-more-exciting-to-witness-than-a-home-run-hit-by-a-batter.-its-impressive-if-a-player-hits-more-than-40-in-a-season.-find-the-hitters-who-have-hit-60-or-more-home-runs-hr-in-a-season.-list-their-playerid-yearid-home-run-total-and-the-teamid-they-played-for." class="section level5">
<h5>3. There is nothing more exciting to witness than a home run hit by a batter. It's impressive if a player hits more than 40 in a season. Find the hitters who have hit 60 or more home runs (<code>HR</code>) in a season. List their <code>playerID</code>, <code>yearID</code>, home run total, and the <code>teamID</code> they played for.</h5>
<p><strong>Hint:</strong> There are 8 occurrences of home runs greater than or equal to 60.</p>
<p><strong>Hint:</strong> The <code>batting</code> table is where you should look for this question.</p>
<p><strong>Relevant topics:</strong> SELECT, FROM, WHERE, LIMIT</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL code used to solve the problem.
</li>
<li>
The first 10 results of the query.
</li>
</ul>
</div>
</div>
<div id="solution-121" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> teamID, yearID, teamID, HR <span class="kw">FROM</span> batting <span class="kw">WHERE</span> HR&gt;=<span class="dv">60</span>;</code></pre></div>
</div>
<div id="make-a-list-of-players-born-on-your-birth-day-dont-worry-about-the-year.-display-their-first-names-last-names-and-birth-year.-order-the-list-descending-by-their-birth-year." class="section level5">
<h5>4. Make a list of players born on your birth day (don't worry about the year). Display their first names, last names, and birth year. Order the list descending by their birth year.</h5>
<p><strong>Hint:</strong> The <code>people</code> table is where you should look for this question.</p>
<p><strong>Relevant topics:</strong> SELECT, FROM, WHERE, AND, ORDER BY, DESC, LIMIT</p>
<p><strong>Note</strong>: Examples that utilize the relevant topics in this problem can be found <a href="sql.html#sql-examples">here</a>.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL code used to solve the problem.
</li>
<li>
The first 10 results of the query.
</li>
</ul>
</div>
</div>
<div id="solution-122" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> nameFirst, nameLast, birthYear <span class="kw">FROM</span> people
  <span class="kw">WHERE</span> birthMonth==<span class="dv">5</span> <span class="kw">AND</span> birthDay==<span class="dv">29</span>
  <span class="kw">ORDER</span> <span class="kw">BY</span> birthYear <span class="kw">DESC</span> <span class="kw">LIMIT</span> <span class="dv">10</span>;</code></pre></div>
</div>
<div id="get-the-cleveland-cle-pitching-roster-from-the-2016-season-playerid-w-l-so.-order-the-pitchers-by-number-of-strikeouts-so-in-descending-order." class="section level5">
<h5>5. Get the Cleveland (CLE) Pitching Roster from the 2016 season (<code>playerID</code>, <code>W</code>, <code>L</code>, <code>SO</code>). Order the pitchers by number of Strikeouts (SO) in descending order.</h5>
<p><strong>Hint:</strong> The <code>pitching</code> table is where you should look for this question.</p>
<p><strong>Relevant topics:</strong> SELECT, FROM, WHERE, AND, ORDER BY, DESC, LIMIT</p>
<p><strong>Note</strong>: Examples that utilize the relevant topics in this problem can be found <a href="sql.html#sql-examples">here</a>.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL code used to solve the problem.
</li>
<li>
The first 10 results of the query.
</li>
</ul>
</div>
</div>
<div id="solution-123" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> playerID, W, L, SO <span class="kw">FROM</span> pitching 
    <span class="kw">WHERE</span> teamID==<span class="st">&#39;CLE&#39;</span> <span class="kw">AND</span> yearID==<span class="dv">2016</span>
    <span class="kw">ORDER</span> <span class="kw">BY</span> SO <span class="kw">DESC</span> <span class="kw">LIMIT</span> <span class="dv">10</span>;</code></pre></div>
</div>
<div id="find-the-10-team-and-year-pairs-that-have-the-most-number-of-errors-e-between-1960-and-1970.-display-their-win-and-loss-counts-too.-what-is-the-name-of-the-team-that-appears-in-3rd-place-in-the-ranking-of-the-team-and-year-pairs" class="section level5">
<h5>6. Find the 10 team and year pairs that have the most number of Errors (<code>E</code>) between 1960 and 1970. Display their Win and Loss counts too. What is the name of the team that appears in 3rd place in the ranking of the team and year pairs?</h5>
<p><strong>Hint:</strong> The <code>teams</code> table is where you should look for this question.</p>
<p><strong>Hint:</strong> The <code>BETWEEN</code> clause is useful here.</p>
<p><strong>Hint:</strong> It is OK to use multiple queries to answer the question.</p>
<p><strong>Relevant topics:</strong> SELECT, FROM, WHERE, AND, ORDER BY, DESC, LIMIT, BETWEEN</p>
<p><strong>Note</strong>: Examples that utilize the relevant topics in this problem can be found <a href="sql.html#sql-examples">here</a>.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL code used to solve the problem.
</li>
<li>
The first 10 results of the query.
</li>
</ul>
</div>
</div>
<div id="solution-124" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> teamID, franchID, yearID, W, L, E <span class="kw">FROM</span> teams
  <span class="kw">WHERE</span> yearID <span class="kw">BETWEEN</span> <span class="dv">1960</span> <span class="kw">AND</span> <span class="dv">1970</span>
  <span class="kw">ORDER</span> <span class="kw">BY</span> E <span class="kw">DESC</span>
  <span class="kw">LIMIT</span> <span class="dv">10</span>;</code></pre></div>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> franchName <span class="kw">FROM</span> teamsfranchises <span class="kw">WHERE</span> franchID==<span class="st">&#39;LAA&#39;</span>;</code></pre></div>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> teamID, franchID, yearID, W, L, E <span class="kw">FROM</span> teams
  <span class="kw">WHERE</span> yearID &gt;= <span class="dv">1960</span> <span class="kw">AND</span> yearID &lt;= <span class="dv">1970</span>
  <span class="kw">ORDER</span> <span class="kw">BY</span> E <span class="kw">DESC</span>
  <span class="kw">LIMIT</span> <span class="dv">10</span>;</code></pre></div>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> franchName <span class="kw">FROM</span> teamsfranchises <span class="kw">WHERE</span> franchID==<span class="st">&#39;LAA&#39;</span>;</code></pre></div>
</div>
<div id="find-the-playerid-for-bob-lemon.-what-year-and-team-was-he-on-when-he-got-the-most-wins-as-a-pitcher-use-table-pitching-what-year-and-team-did-he-win-the-most-games-as-a-manager-use-table-managers" class="section level5">
<h5>7. Find the <code>playerID</code> for Bob Lemon. What year and team was he on when he got the most wins as a pitcher (use table <code>pitching</code>)? What year and team did he win the most games as a manager (use table <code>managers</code>)?</h5>
<p><strong>Hint:</strong> It is OK to use multiple queries to answer the question.</p>
<p><strong>Note</strong>: There was a tie among the two years in which Bob Lemon had the most wins as a pitcher.</p>
<p><strong>Relevant topics:</strong> SELECT, FROM, WHERE, AND, ORDER BY, DESC, LIMIT, BETWEEN</p>
<p><strong>Note</strong>: Examples that utilize the relevant topics in this problem can be found <a href="sql.html#sql-examples">here</a>.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL code used to solve the problem.
</li>
<li>
The first 10 results of the query.
</li>
</ul>
</div>
</div>
<div id="solution-125" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> playerID <span class="kw">FROM</span> people
  <span class="kw">WHERE</span> nameFirst==<span class="st">&#39;Bob&#39;</span> <span class="kw">AND</span> nameLast==<span class="st">&#39;Lemon&#39;</span>;</code></pre></div>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> teamID, yearID, W <span class="kw">FROM</span> pitching
  <span class="kw">WHERE</span> playerID==<span class="st">&#39;lemonbo01&#39;</span>
  <span class="kw">ORDER</span> <span class="kw">BY</span> W <span class="kw">DESC</span>;</code></pre></div>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> teamID, yearID, W <span class="kw">FROM</span> managers
  <span class="kw">WHERE</span> playerID==<span class="st">&#39;lemonbo01&#39;</span>
  <span class="kw">ORDER</span> <span class="kw">BY</span> W <span class="kw">DESC</span>;</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p10-290" class="section level3">
<h3>Project 10</h3>
<hr />
<p><strong>Motivation:</strong> Although SQL syntax may still feel unnatural and foreign, with more practice it <em>will</em> start to make more sense. The ability to read and write SQL queries is a bread-and-butter skill for anyone working with data.</p>
<p><strong>Context:</strong> We are in the second of a series of projects that focus on learning the basics of SQL. In this project, we will continue to harden our understanding of SQL syntax, and introduce common SQL functions like <code>AVG</code>, <code>MIN</code>, and <code>MAX</code>.</p>
<p><strong>Scope:</strong> SQL, sqlite</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Explain the advantages and disadvantages of using a database over a tool like a spreadsheet.
</li>
<li>
Describe basic database concepts like: rdbms, tables, indexes, fields, query, clause.
</li>
<li>
Basic clauses: select, order by, limit, desc, asc, count, where, from, etc.
</li>
<li>
Utilize SQL functions like min, max, avg, sum, and count to solve data-driven problems.
</li>
</ul>
</div>
<div id="dataset-21" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset similar to the one from Project 9, but this time we will use a MariaDB version of the database, which is also hosted on Scholar, at <code>scholar-db.rcac.purdue.edu</code>. As in Project 9, this is the Lahman Baseball Database. You can find its documentation <a href="http://www.seanlahman.com/files/database/readme2017.txt">here</a>, including the definitions of the tables and columns.</p>
</div>
<div id="questions-21" class="section level4">
<h4>Questions</h4>
<p><strong>Important note:</strong> Please make sure to <strong>double check</strong> that the your submission does indeed contain the files you think it does. You can do this by downloading your submission from Gradescope after uploading. If you can see all of your files and they open up properly on your computer, you should be good to go.</p>
<p><strong>Important note:</strong> Please make sure to look at your knit PDF <em>before</em> submitting. PDFs should be relatively short and not contain huge amounts of printed data. Remember you can use functions like <code>head</code> to print a sample of the data or output. Extremely large PDFs will be subject to lose points.</p>
<p><strong>Important note:</strong> For this project all solutions should be done using R code chunks, and the <code>RMariaDB</code> package. Run the following code to load the library:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RMariaDB)</code></pre></div>
<div id="connect-to-rstudio-server-httpsrstudio.scholar.rcac.purdue.edu-and-rather-than-navigating-to-the-terminal-like-we-did-in-the-previous-project-instead-create-a-connection-to-our-mariadb-lahman-database-using-the-rmariadb-package-in-r-and-the-credentials-below.-confirm-the-connection-by-running-the-following-code-chunk" class="section level5">
<h5>1. Connect to RStudio Server <a href="https://rstudio.scholar.rcac.purdue.edu" class="uri">https://rstudio.scholar.rcac.purdue.edu</a>, and, rather than navigating to the terminal like we did in the previous project, instead, create a connection to our MariaDB lahman database using the <code>RMariaDB</code> package in R, and the credentials below. Confirm the connection by running the following code chunk:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">con &lt;-<span class="st"> </span><span class="kw">dbConnect</span>(RMariaDB<span class="op">::</span><span class="kw">MariaDB</span>(), 
                 <span class="dt">host=</span><span class="st">&quot;scholar-db.rcac.purdue.edu&quot;</span>, 
                 <span class="dt">db=</span><span class="st">&quot;lahmandb&quot;</span>, 
                 <span class="dt">user=</span><span class="st">&quot;lahman_user&quot;</span>, 
                 <span class="dt">password=</span><span class="st">&quot;HitAH0merun&quot;</span>)

<span class="kw">head</span>(<span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SHOW tables;&quot;</span>))</code></pre></div>
<p><strong>Hint:</strong> In the example provided, the variable <code>con</code> from the <code>dbConnect</code> function is the connection. Each query that you make, using the <code>dbGetQuery</code>, needs to use this connection <code>con</code>. You can change the name <code>con</code> if you want to (it is user defined), but if you change the name <code>con</code>, you need to change it on all of your connections. If your connection to the database dies while you are working on the project, you can always re-run the <code>dbConnect</code> line again, to reset your connection to the database.</p>
<p><strong>Relevant topics:</strong> RMariaDB, dbConnect, dbGetQuery</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your (potentially modified) <code>head(dbGetQuery(con, &quot;SHOW tables;&quot;))</code>.
</li>
</ul>
</div>
</div>
<div id="solution-126" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RMariaDB)
host &lt;-<span class="st"> &quot;scholar-db.rcac.purdue.edu&quot;</span>
dbname &lt;-<span class="st"> &quot;lahmandb&quot;</span>
user &lt;-<span class="st"> &quot;lahman_user&quot;</span>
password &lt;-<span class="st"> &quot;HitAH0merun&quot;</span>
con &lt;-<span class="st"> </span><span class="kw">dbConnect</span>(<span class="kw">MariaDB</span>(),<span class="dt">host=</span>host,
                 <span class="dt">dbname=</span>dbname,
                 <span class="dt">user=</span>user,
                 <span class="dt">password=</span>password)
<span class="kw">head</span>(<span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SHOW tables;&quot;</span>))</code></pre></div>
</div>
<div id="how-many-players-are-members-of-the-4040-club-these-are-players-that-have-stolen-at-least-40-bases-sb-and-hit-at-least-40-home-runs-hr-in-one-year." class="section level5">
<h5>2. How many players are members of the 40/40 club? These are players that have stolen at least 40 bases (<code>SB</code>) and hit at least 40 home runs (<code>HR</code>) in one year.</h5>
<p><strong>Hint:</strong> Use the <code>batting</code> table.</p>
<p><strong>Important note:</strong> You only need to run <code>library(RMariaDB)</code> and the <code>dbConnect</code> portion of the code a single time towards the top of your project. After that, you can simply reuse your connection <code>con</code> to run queries.</p>
<p><strong>Important note:</strong> In our <a href="https://raw.githubusercontent.com/TheDataMine/the-examples-book/master/files/project_template.Rmd">project template</a>, for this project, make all of the SQL queries using the <code>dbGetQuery</code> function, which returns the results directly in <code>R</code>. Therefore, your <code>RMarkdown</code> blocks for this project should all be <code>{r}</code> blocks (as opposed to the <code>{sql}</code> blocks used in Project 9).</p>
<p><strong>Hint:</strong> You can use <code>dbGetQuery</code> to run your queries from within R. Example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT * FROM battings LIMIT 5;&quot;</span>)</code></pre></div>
<p><strong>Note:</strong> We already demonstrated the correct SQL query to use for the 40/40 club in this video, but now we want you to use <code>RMariaDB</code> to solve this query:</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_os59oucz&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_gy4f8y6j">Click here for video</a></p>
<p><strong>Relevant topics:</strong> dbGetQuery, AND/OR, DISTINCT, COUNT</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The result of running the R code.
</li>
</ul>
</div>
</div>
<div id="solution-127" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dbGetQuery</span>(con,<span class="st">&quot;SELECT DISTINCT COUNT(*) FROM batting WHERE HR&gt;=40 AND SB&gt;=40;&quot;</span>)</code></pre></div>
</div>
<div id="find-corey-klubers-lifetime-across-his-career-i.e.-use-sum-from-sql-to-summarize-his-achievements-in-two-categories-strikeouts-so-and-walks-bb.-also-display-his-strikeouts-to-walks-ratio.-a-strikeout-to-walks-ratio-is-calculated-by-this-equation-fracstrikeoutswalks." class="section level5">
<h5>3. Find Corey Kluber's lifetime across his career (i.e., use <code>SUM</code> from <code>SQL</code> to summarize his achievements) in two categories: strikeouts (<code>SO</code>) and walks (<code>BB</code>). Also display his Strikeouts to Walks ratio. A Strikeout to Walks ratio is calculated by this equation: <span class="math inline">\(\frac{Strikeouts}{Walks}\)</span>.</h5>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_whzcdsrc&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_ruufmsf4">Click here for video</a></p>
<p><strong>Important note:</strong> Questions in this project need to be solved using SQL when possible. You will not receive credit for a question if you use <code>sum</code> in R rather than <code>SUM</code> in SQL.</p>
<p><strong>Hint:</strong> Use the <code>people</code> table to find the <code>playerID</code> and use the <code>pitching</code> table to find the statistics.</p>
<p><strong>Relevant topics:</strong> dbGetQuery, SUM, SELECT, FROM, WHERE</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The result of running the R code.
</li>
</ul>
</div>
</div>
<div id="solution-128" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT playerID FROM people WHERE nameFirst =&#39;Corey&#39; AND nameLast = &#39;Kluber&#39;;&quot;</span>)
<span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT SUM(SO), SUM(BB), SUM(SO)/SUM(BB) FROM pitching WHERE playerID =&#39;klubeco01&#39;;&quot;</span>)</code></pre></div>
</div>
<div id="how-many-times-in-total-has-giancarlo-stanton-struck-out-in-years-in-which-he-played-for-mia-or-flo" class="section level5">
<h5>4. How many times in total has Giancarlo Stanton struck out in years in which he played for &quot;MIA&quot; or &quot;FLO&quot;?</h5>
<p><strong>Hint:</strong> Use the <code>people</code> table to find the <code>playerID</code> and use the <code>batting</code> table to find the statistics.</p>
<p><strong>Relevant topics:</strong> dbGetQuery, AND/OR, SUM</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The result of running the R code.
</li>
</ul>
</div>
</div>
<div id="solution-129" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT playerID FROM people WHERE nameFirst =&#39;Giancarlo&#39; AND nameLast = &#39;Stanton&#39;;&quot;</span>)
<span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT COUNT(*), SUM(SO) FROM batting WHERE playerID = &#39;stantmi03&#39; AND (teamID = &#39;MIA&#39; OR teamID = &#39;FLO&#39;);&quot;</span>)</code></pre></div>
</div>
<div id="the-batting-average-is-a-metric-for-a-batters-performance.-the-batting-average-in-a-year-is-calculated-by-frachab-the-number-of-hits-divided-by-at-bats.-considering-only-the-years-between-2000-and-2010-calculate-the-seasonal-batting-average-for-each-batter-who-had-more-than-300-at-bats-in-a-season.-list-the-top-5-batting-averages-next-to-playerid-teamid-and-yearid." class="section level5">
<h5>5. The <a href="https://en.wikipedia.org/wiki/Batting_average_(baseball)">Batting Average</a> is a metric for a batter's performance. The Batting Average in a year is calculated by <span class="math inline">\(\frac{H}{AB}\)</span> (the number of hits divided by at-bats). Considering (only) the years between 2000 and 2010, calculate the (seasonal) Batting Average for each batter who had more than 300 at-bats in a season. List the top 5 batting averages next to <code>playerID</code>, <code>teamID</code>, and <code>yearID.</code></h5>
<p><strong>Hint:</strong> Use the <code>batting</code> table.</p>
<p><strong>Relevant topics:</strong> dbGetQuery, ORDER BY, BETWEEN</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The result of running the R code.
</li>
</ul>
</div>
</div>
<div id="solution-130" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dbGetQuery</span>(con,<span class="st">&quot;SELECT playerID, teamID, yearID, H, AB, H/AB FROM batting</span>
<span class="st">  WHERE yearID BETWEEN 2000 AND 2010 AND AB&gt;300</span>
<span class="st">  ORDER BY H/AB DESC LIMIT 5;&quot;</span>)</code></pre></div>
</div>
<div id="how-many-unique-players-have-hit-50-home-runs-hr-in-a-season" class="section level5">
<h5>6. How many unique players have hit &gt; 50 home runs (<code>HR</code>) in a season?</h5>
<p><strong>Hint:</strong> Use the <code>batting</code> table.</p>
<p><strong>Hint:</strong> If you view <code>DISTINCT</code> as being paired with <code>SELECT</code>, instead, think of it as being paired with one of the fields you are selecting.</p>
<p><strong>Relevant topics:</strong> dbGetQuery, DISTINCT, COUNT</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The result of running the R code.
</li>
</ul>
</div>
</div>
<div id="solution-131" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT COUNT(DISTINCT playerID) FROM batting WHERE HR&gt;50;&quot;</span>)
<span class="co"># As you can see, DISTINCT is with the field playerID, not with SELECT. </span>
<span class="co"># The following query should help distinguish this.</span>
<span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT COUNT(DISTINCT playerID), COUNT(playerID) FROM batting WHERE HR&gt;50;&quot;</span>)</code></pre></div>
</div>
<div id="find-the-number-of-unique-players-that-attended-purdue-university.-start-by-finding-the-schoolid-for-purdue-and-then-find-the-number-of-players-who-played-there.-do-the-same-for-iu.-who-had-more-purdue-or-iu-use-the-information-you-have-in-the-database-and-the-power-of-r-to-create-a-misleading-graphic-that-makes-purdue-look-better-than-iu-even-if-just-at-first-glance.-make-sure-you-label-the-graphic." class="section level5">
<h5>7. Find the number of unique players that attended Purdue University. Start by finding the <code>schoolID</code> for Purdue and then find the number of players who played there. Do the same for IU. Who had more? Purdue or IU? Use the information you have in the database, and the power of R to create a misleading graphic that makes Purdue look better than IU, even if just at first glance. Make sure you label the graphic.</h5>
<p><strong>Hint:</strong> Use the <code>schools</code> table to get the <code>schoolID</code>s, and the <code>collegeplaying</code> table to get the statistics.</p>
<p><strong>Hint:</strong> You can mess with the scale of the y-axis. You could (potentially) filter the data to start from a certain year or be between two dates.</p>
<p><strong>Hint:</strong> To find IU's id, try the following query: <code>SELECT schoolID FROM schools WHERE name_full LIKE '%indiana%';</code>. You can find more about the LIKE clause and <code>%</code> <a href="https://www.tutorialspoint.com/sql/sql-like-clause.htm">here</a>.</p>
<p><strong>Relevant topics:</strong> dbGetQuery, <a href="r.html#r-plotting">plotting in R</a>, DISTINCT, COUNT</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The result of running the R code.
</li>
</ul>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT schoolID FROM schools WHERE name_full=&#39;Purdue University&#39;;&quot;</span>)
<span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT schoolID FROM schools WHERE LIKE &#39;%indiana%&#39;;&quot;</span>)
<span class="kw">dbGetQuery</span>(con,<span class="st">&quot;SELECT COUNT(DISTINCT playerID) FROM collegeplaying WHERE schoolID =&#39;purdue&#39;;&quot;</span>)
<span class="kw">dbGetQuery</span>(con,<span class="st">&quot;SELECT DISTINCT playerID FROM collegeplaying WHERE schoolID =&#39;indiana&#39;;&quot;</span>)
purdue &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(<span class="kw">dbGetQuery</span>(con,<span class="st">&quot;SELECT playerID FROM collegeplaying WHERE schoolID =&#39;purdue&#39;;&quot;</span>))<span class="op">$</span>playerID)
iu &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(<span class="kw">dbGetQuery</span>(con,<span class="st">&quot;SELECT playerID FROM collegeplaying WHERE schoolID =&#39;indiana&#39;;&quot;</span>))<span class="op">$</span>playerID)
<span class="kw">barplot</span>(purdue, iu)
<span class="kw">barplot</span>(<span class="kw">log</span>(<span class="kw">c</span>(purdue, iu)), <span class="dt">main=</span><span class="st">&quot;Pro baseball players: Indiana vs. Purdue&quot;</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;#990000&quot;</span>,<span class="st">&quot;#CFB53B&quot;</span>), <span class="dt">names.arg=</span><span class="kw">c</span>(<span class="st">&quot;Purdue&quot;</span>, <span class="st">&quot;IU&quot;</span>), <span class="dt">cex.names=</span>.<span class="dv">5</span>, <span class="dt">ylab=</span><span class="st">&quot;Log count&quot;</span>)</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p11-290" class="section level3">
<h3>Project 11</h3>
<hr />
<p><strong>Motivation:</strong> Being able to use results of queries as tables in new queries (also known as writing sub-queries), and calculating values like MIN, MAX, and AVG in aggregate are key skills to have in order to write more complex queries. In this project we will learn about aliasing, writing sub-queries, and calculating aggregate values.</p>
<p><strong>Context:</strong> We are in the middle of a series of projects focused on working with databases and SQL. In this project we introduce aliasing, sub-queries, and calculating aggregate values using a much larger dataset!</p>
<p><strong>Scope:</strong> SQL, SQL in R</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Demonstrate the ability to interact with popular database management systems within R.
</li>
<li>
Solve data-driven problems using a combination of SQL and R.
</li>
<li>
Basic clauses: SELECT, ORDER BY, LIMIT, DESC, ASC, COUNT, WHERE, FROM, etc.
</li>
<li>
Showcase the ability to filter, alias, and write subqueries.
</li>
<li>
Perform grouping and aggregate data using group by and the following functions: COUNT, MAX, SUM, AVG, LIKE, HAVING. Explain when to use having, and when to use where.
</li>
</ul>
</div>
<div id="dataset-22" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the <code>elections</code> database. Similar to Project 10, this database is hosted on Scholar. Moreover, Question 1 also involves the following data files found in Scholar:</p>
<p><code>/class/datamine/data/election/itcontYYYY.txt</code> (for example, data for year 1980 would be <code>/class/datamine/data/election/itcont1980.txt</code>)</p>
<p>A public sample of the data can be found here:</p>
<p><a href="https://www.datadepot.rcac.purdue.edu/datamine/data/election/itcontYYYY.txt" class="uri">https://www.datadepot.rcac.purdue.edu/datamine/data/election/itcontYYYY.txt</a> (for example, data for year 1980 would be <a href="https://www.datadepot.rcac.purdue.edu/datamine/data/election/itcont1980.txt" class="uri">https://www.datadepot.rcac.purdue.edu/datamine/data/election/itcont1980.txt</a>)</p>
</div>
<div id="questions-22" class="section level4">
<h4>Questions</h4>
<p><strong>Important note:</strong> For this project you will need to connect to the database <code>elections</code> using the <code>RMariaDB</code> package in R. Include the following code chunk in the beginning of your RMarkdown file:</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{r setup-database-connection}
library(RMariaDB)
con &lt;- dbConnect(RMariaDB::MariaDB(), 
<span class="bn">                 host=&quot;scholar-db.rcac.purdue.edu&quot;, </span>
<span class="bn">                 db=&quot;elections&quot;, </span>
<span class="bn">                 user=&quot;elections_user&quot;, </span>
<span class="bn">                 password=&quot;Dataelect!98&quot;)</span>
```</code></pre></div>
<p>When a question involves SQL queries in this project, you may use a SQL code chunk (with <code>{sql}</code>), or an R code chunk (with <code>{r}</code>) and functions like <code>dbGetQuery</code> as you did in Project 10. Please refer to Question 5 in the <a href="https://raw.githubusercontent.com/TheDataMine/the-examples-book/master/files/project_template.Rmd">project template</a> for examples.</p>
<div id="approximately-how-large-was-the-lahman-database-use-the-sqlite-database-in-scholar-classdataminedatalahmanlahman.db-use-unix-utilities-youve-learned-about-this-semester-to-write-a-line-of-code-to-return-the-size-of-that-.db-file-in-mb." class="section level5">
<h5>1. Approximately how large was the lahman database (use the sqlite database in Scholar: <code>/class/datamine/data/lahman/lahman.db</code>)? Use UNIX utilities you've learned about this semester to write a line of code to return the size of that .db file (in MB).</h5>
</div>
<div id="the-data-we-consider-in-this-project-are-much-larger.-use-unix-utilities-bash-and-awk-to-write-another-line-of-code-that-calculates-the-total-amount-of-data-in-the-elections-folder-classdataminedataelection.-how-much-data-in-mb-is-there" class="section level5">
<h5>The data we consider in this project are much larger. Use UNIX utilities (bash and awk) to write another line of code that calculates the total amount of data in the elections folder <code>/class/datamine/data/election/</code>. How much data (in MB) is there?</h5>
</div>
<div id="the-data-in-that-folder-has-been-added-to-the-elections-database-all-aggregated-in-the-elections-table.-write-a-sql-query-that-returns-the-number-of-rows-of-data-are-in-the-database.-how-many-rows-of-data-are-in-the-table-elections" class="section level5">
<h5>The data in that folder has been added to the <code>elections</code> database, all aggregated in the <code>elections</code> table. Write a SQL query that returns the number of rows of data are in the database. How many rows of data are in the table <code>elections</code>?</h5>
<p><strong>Note:</strong> These are some examples of how to get the sizes of collections of files in UNIX.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_edernjri&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_7g6c4dt2">Click here for video</a></p>
<p><strong>Hint:</strong> The SQL query will take some time! Be patient.</p>
<p><strong>Note:</strong> You may use more than one code chunk in your RMarkdown file for the different tasks.</p>
<p><strong>Note:</strong> We will accept values that represent either apparent or allocated size, as well as estimated disk usage. To get the size from <code>ls</code> and <code>du</code> to match, use the <code>--apparent-size</code> option with <code>du</code>.</p>
<p><strong>Note:</strong> A Megabyte (MB) is actually 1000^2 bytes, not 1024^2. A Mebibyte (MiB) is 1024^2 bytes. See <a href="https://en.wikipedia.org/wiki/Gigabyte">here</a> for more information. For this question, either solution will be given full credit. <a href="https://thedatamine.github.io/the-examples-book/unix.html#why-is-the-result-of-du--b-.metadata.csv-divided-by-1024-not-the-result-of-du--k-.metadata.csv">This</a> is a potentially useful example.</p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql">SQL</a>, <a href="r.html#r-sql">SQL in R</a>, <a href="unix.html#awk">awk</a>, <a href="unix.html#ls">ls</a>, <a href="unix.html#du">du</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Line of code (bash/awk) to show the size (in MB) of the lahman database file.
</li>
<li>
Approximate size of the lahman database in MB.
</li>
<li>
Line of code (bash/awk) to calculate the size (in MB) of the entire elections dataset in <code>/class/datamine/data/election</code>.
</li>
<li>
The size of the elections data in MB.
</li>
<li>
SQL query used to find the number of rows of data in the <code>elections</code> table in the <code>elections</code> database.
</li>
<li>
The number of rows in the <code>elections</code> table in the <code>elections</code> database.
</li>
</ul>
</div>
</div>
<div id="solution-132" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">ls</span> -la *.txt <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ total += $4; }END{print total/1000000}&#39;</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> <span class="fu">COUNT</span>(*) <span class="kw">FROM</span> elections;</code></pre></div>
</div>
<div id="write-a-sql-query-using-the-like-command-to-find-a-unique-list-of-zip_codes-that-start-with-479." class="section level5">
<h5>2. Write a SQL query using the <code>LIKE</code> command to find a unique list of <code>zip_code</code>s that start with &quot;479&quot;.</h5>
</div>
<div id="write-another-sql-query-and-answer-how-many-unique-zip_codes-are-there-that-begin-with-479" class="section level5">
<h5>Write another SQL query and answer: How many unique <code>zip_code</code>s are there that begin with &quot;479&quot;?</h5>
<p><strong>Note:</strong> Here are some examples about SQL that might be relevant for Questions 2 and 3 in this project.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_gplhe4dj&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_o71dngd6">Click here for video</a></p>
<p><strong>Hint:</strong> The first query returns a list of zip codes, and the second returns a count.</p>
<p><strong>Hint:</strong> Make sure you only select <code>zip_code</code>s.</p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql">SQL</a>, <a href="https://www.tutorialspoint.com/sql/sql-like-clause.htm">LIKE</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL queries used to answer the question.
</li>
<li>
The first 5 results from running the query.
</li>
</ul>
</div>
</div>
<div id="solution-133" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> <span class="kw">DISTINCT</span> zip_code <span class="kw">FROM</span> elections <span class="kw">WHERE</span> zip_code <span class="kw">LIKE</span> <span class="st">&#39;479%&#39;</span> <span class="kw">LIMIT</span> <span class="dv">5</span>;
<span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="kw">DISTINCT</span> zip_code) <span class="kw">FROM</span> elections <span class="kw">WHERE</span> zip_code <span class="kw">LIKE</span> <span class="st">&#39;479%&#39;</span>;</code></pre></div>
</div>
<div id="write-a-sql-query-that-counts-the-number-of-donations-rows-that-are-from-indiana.-how-many-donations-are-from-indiana-rewrite-the-query-and-create-an-alias-for-our-field-so-it-doesnt-read-count-but-rather-indiana-donations." class="section level5">
<h5>3. Write a SQL query that counts the number of donations (rows) that are from Indiana. How many donations are from Indiana? Rewrite the query and create an <em>alias</em> for our field so it doesn't read <code>COUNT(*)</code> but rather <code>Indiana Donations</code>.</h5>
<p><strong>Hint:</strong> You may enclose an alias's name in quotation marks (single or double) when the name contains space.</p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql">SQL</a>, <a href="sql.html#sql-where">WHERE</a>, <a href="sql.html#sql-aliasing">aliasing</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to answer the question.
</li>
<li>
The result of the SQL query.
</li>
</ul>
</div>
</div>
<div id="solution-134" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> <span class="fu">COUNT</span>(*) <span class="kw">FROM</span> elections <span class="kw">WHERE</span> state=<span class="st">&#39;IN&#39;</span>;
<span class="kw">SELECT</span> <span class="fu">COUNT</span>(*) <span class="kw">AS</span> <span class="st">&#39;Indiana Donations&#39;</span> <span class="kw">FROM</span> elections <span class="kw">WHERE</span> state=<span class="st">&#39;IN&#39;</span>;</code></pre></div>
</div>
<div id="rewrite-the-query-in-3-so-the-result-is-displayed-like-in-1234567.-note-if-instead-of-in-we-wanted-oh-only-the-where-clause-should-be-modified-and-the-display-should-automatically-change-to-oh-1234567.-in-other-words-the-state-abbreviation-should-be-dynamic-not-static." class="section level5">
<h5>4. Rewrite the query in (3) so the result is displayed like: <code>IN: 1234567</code>. Note, if instead of &quot;IN&quot; we wanted &quot;OH&quot;, only the WHERE clause should be modified, and the display should automatically change to <code>OH: 1234567</code>. In other words, the state abbreviation should be dynamic, not static.</h5>
<p><strong>Note:</strong> This video demonstrates how to use CONCAT in a MySQL query.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_nu7iovqo&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_31dt64kx">Click here for video</a></p>
<p><strong>Hint:</strong> Use CONCAT and aliasing to accomplish this.</p>
<p><strong>Hint:</strong> Remember, <code>state</code> contains the state abbreviation.</p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql">SQL</a>, <a href="sql.html#sql-aliasing">aliasing</a>, <a href="https://www.tutorialspoint.com/sql/sql-concat-function.htm">CONCAT</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to answer the question.
</li>
</ul>
</div>
</div>
<div id="solution-135" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> <span class="fu">CONCAT</span>(state, <span class="ot">&quot;: &quot;</span>, <span class="fu">COUNT</span>(*)) <span class="kw">AS</span> <span class="st">&#39;Donations&#39;</span> <span class="kw">FROM</span> elections <span class="kw">WHERE</span> state=<span class="st">&#39;IN&#39;</span>;</code></pre></div>
</div>
<div id="in-2-we-wrote-a-query-that-returns-a-unique-list-of-zip_codes-that-start-with-479.-in-3-we-wrote-a-query-that-counts-the-number-of-donations-that-are-from-indiana.-use-our-query-from-2-as-a-sub-query-to-find-how-many-donations-come-from-areas-with-zip_codes-starting-with-479.-what-percent-of-donations-in-indiana-come-from-said-zip_codes" class="section level5">
<h5>5. In (2) we wrote a query that returns a unique list of <code>zip_code</code>s that start with &quot;479&quot;. In (3) we wrote a query that counts the number of donations that are from Indiana. Use our query from (2) as a sub-query to find how many donations come from areas with <code>zip_code</code>s starting with &quot;479&quot;. What percent of donations in Indiana come from said <code>zip_code</code>s?</h5>
<p><strong>Note:</strong> This video gives two examples of sub-queries.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_d2zr7cmo&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_4us9nsy9">Click here for video</a></p>
<p><strong>Hint:</strong> You can simply manually calculate the percent using the count in (2) and (5).</p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql">SQL</a>, <a href="sql.html#sql-aliasing">aliasing</a>, subqueries, <a href="https://www.tutorialspoint.com/mysql/mysql-in-clause.htm">IN</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL queries used to answer the question.
</li>
<li>
The percentage of donations from Indiana from <code>zip_code</code>s starting with &quot;479&quot;.
</li>
</ul>
</div>
</div>
<div id="solution-136" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> <span class="fu">COUNT</span>(*) <span class="kw">FROM</span> elections <span class="kw">WHERE</span> zip_code <span class="kw">IN</span> (<span class="kw">SELECT</span> <span class="kw">DISTINCT</span> zip_code <span class="kw">FROM</span> elections <span class="kw">WHERE</span> zip_code <span class="kw">LIKE</span> <span class="st">&#39;479%&#39;</span>);</code></pre></div>
</div>
<div id="in-3-we-wrote-a-query-that-counts-the-number-of-donations-that-are-from-indiana.-when-running-queries-like-this-a-natural-next-question-is-to-ask-the-same-question-about-another-state.-sql-gives-us-the-ability-to-calculate-functions-in-aggregate-when-grouping-by-a-certain-column.-write-a-sql-query-that-returns-the-state-number-of-donations-from-each-state-the-sum-of-the-donations-transaction_amt.-which-5-states-gave-the-most-donations-highest-count-order-you-result-from-most-to-least." class="section level5">
<h5>6. In (3) we wrote a query that counts the number of donations that are from Indiana. When running queries like this, a natural &quot;next question&quot; is to ask the same question about another state. SQL gives us the ability to calculate functions in aggregate when grouping by a certain column. Write a SQL query that returns the state, number of donations from each state, the sum of the donations (<code>transaction_amt</code>). Which 5 states gave the most donations (highest count)? Order you result from most to least.</h5>
<p><strong>Note:</strong> In this video we demonstrate <code>GROUP BY</code>, <code>ORDER BY</code>, <code>DESC</code>, and other aspects of MySQL that might help with this question.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_530klfwl&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_iej3zqtf">Click here for video</a></p>
<p><strong>Hint:</strong> You may want to create an alias in order to sort.</p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql">SQL</a>, <a href="sql.html#sql-groupby">GROUP BY</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to answer the question.
</li>
<li>
Which 5 states gave the most donations?
</li>
</ul>
</div>
</div>
<div id="solution-137" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> state, <span class="fu">COUNT</span>(*) <span class="kw">AS</span> <span class="st">&#39;cnt&#39;</span>, <span class="fu">SUM</span>(transaction_amt) <span class="kw">AS</span> <span class="st">&#39;total&#39;</span> <span class="kw">FROM</span> elections <span class="kw">GROUP</span> <span class="kw">BY</span> state <span class="kw">ORDER</span> <span class="kw">BY</span> cnt <span class="kw">DESC</span>;</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p12-290" class="section level3">
<h3>Project 12</h3>
<hr />
<p><strong>Motivation:</strong> Databases are comprised of many tables. It is imperative that we learn how to combine data from multiple tables using queries. To do so we perform joins! In this project we will explore learn about and practice using joins on a database containing bike trip information from the Bay Area Bike Share.</p>
<p><strong>Context:</strong> We've introduced a variety of SQL commands that let you filter and extract information from a database in an systematic way. In this project we will introduce joins, a powerful method to combine data from different tables.</p>
<p><strong>Scope:</strong> SQL, sqlite, joins</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Briefly explain the differences between left and inner join and demonstrate the ability to use the join statements to solve a data-driven problem.
</li>
<li>
Perform grouping and aggregate data using group by and the following functions: COUNT, MAX, SUM, AVG, LIKE, HAVING.
</li>
<li>
Showcase the ability to filter, alias, and write subqueries.
</li>
</ul>
</div>
<div id="dataset-23" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/bay_area_bike_share/bay_area_bike_share.db</code></p>
<p>A public sample of the data can be found <a href="https://www.datadepot.rcac.purdue.edu/datamine/data/bay_area_bike_share/bay_area_bike_share.db">here</a>.</p>
<p><strong>Important note:</strong> For this project all solutions should be done using SQL code chunks. To connect to the database, copy and paste the following before your solutions in your .Rmd:</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{r, include=F}
library(RSQLite)
bikeshare &lt;- dbConnect(RSQLite::SQLite(), &quot;/class/datamine/data/bay_area_bike_share/bay_area_bike_share.db&quot;)
```</code></pre></div>
<p>Each solution should then be placed in a code chunk like this:</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{sql, connection=bikeshare}
SELECT * FROM station LIMIT 5;
```</code></pre></div>
<p>If you want to use a SQLite-specific function like <code>.tables</code> (or prefer to test things in the Terminal), you will need to use the Terminal to connect to the database and run queries. To do so, you can connect to RStudio Server at <a href="https://rstudio.scholar.rcac.purdue.edu" class="uri">https://rstudio.scholar.rcac.purdue.edu</a>, and navigate to the terminal. In the terminal execute the command:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">sqlite3</span> /class/datamine/data/bay_area_bike_share/bay_area_bike_share.db</code></pre></div>
<p>From there, the SQLite-specific commands will function properly. They will <em>not</em> function properly in an SQL code chunk. To display the SQLite-specific commands in a code chunk without running the code, use a code chunk with the option <code>eval=F</code> like this:</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{sql, connection=bikeshare, eval=F}
SELECT * FROM station LIMIT 5;
```</code></pre></div>
<p>This will allow the code to be displayed without throwing an error.</p>
<div id="there-are-a-variety-of-ways-to-join-data-using-sql.-with-that-being-said-if-you-are-able-to-understand-and-use-a-left-join-and-inner-join-you-can-perform-all-of-the-other-types-of-joins-right-join-full-outer-join.-you-can-see-the-documentation-here-sql-inner-join-left-join" class="section level5">
<h5>There are a variety of ways to join data using SQL. With that being said, if you are able to understand and use a LEFT JOIN and INNER JOIN, you can perform <em>all</em> of the other types of joins (RIGHT JOIN, FULL OUTER JOIN). You can see the documentation here: <a href="sql.html#sql">SQL</a>, <a href="sql.html#sql-inner-join">INNER JOIN</a>, <a href="sql.html#sql-left-join">LEFT JOIN</a></h5>
</div>
</div>
<div id="questions-23" class="section level4">
<h4>Questions</h4>
<div id="aliases-can-be-created-for-tables-fields-and-even-results-of-aggregate-functions-like-min-max-count-avg-etc..-in-addition-you-can-combine-fields-using-the-sqlite-concatenate-operator-see-here.-write-a-query-that-returns-the-first-5-records-of-information-from-the-station-table-formatted-in-the-following-way" class="section level5">
<h5>1. Aliases can be created for tables, fields, and even results of aggregate functions (like MIN, MAX, COUNT, AVG, etc.). In addition, you can combine fields using the <code>sqlite</code> concatenate operator <code>||</code> (see <a href="https://www.sqlitetutorial.net/sqlite-string-functions/sqlite-concat/">here</a>). Write a query that returns the first 5 records of information from the <code>station</code> table formatted in the following way:</h5>
<p><code>(id) name @ (lat, long)</code></p>
<p>For example:</p>
<p><code>(84) Ryland Park @ (37.342725, -121.895617)</code></p>
<p><strong>Hint:</strong> Here is a video about how to concatenate strings in SQLite.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_40z55oz9&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_a4f4x2k9">Click here for vidoe</a></p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-aliasing">aliasing</a>, concat</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to solve this problem.
</li>
<li>
The first 5 records of information from the <code>station</code> table.
</li>
</ul>
</div>
</div>
<div id="solution-138" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> <span class="st">&#39;(&#39;</span>||id||<span class="st">&#39;) &#39;</span>||name||<span class="st">&#39; @ (&#39;</span>||lat||<span class="st">&#39;,&#39;</span>||long||<span class="st">&#39;)&#39;</span> <span class="kw">FROM</span> station <span class="kw">LIMIT</span> <span class="dv">5</span>;</code></pre></div>
</div>
<div id="there-is-a-variety-of-interesting-weather-information-in-the-weather-table.-write-a-query-that-finds-the-average-mean_temperature_f-by-zip_code.-which-is-on-average-the-warmest-zip_code" class="section level5">
<h5>2. There is a variety of interesting weather information in the <code>weather</code> table. Write a query that finds the average <code>mean_temperature_f</code> by <code>zip_code</code>. Which is on average the warmest <code>zip_code</code>?</h5>
<p>Use aliases to format the result in the following way:</p>
<pre class="txt"><code>Zip Code|Avg Temperature
94041|61.3808219178082</code></pre>
<p>Note that this is the output if you use <code>sqlite</code> in the terminal. While the output in your knitted pdf file may look different, you should name the columns accordingly.</p>
<p><strong>Hint:</strong> Here is a video about GROUP BY, ORDER BY, DISTINCT, and COUNT</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_soilqf5i&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_hwehjhwd">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-aliasing">aliasing</a>, <a href="https://www.w3schools.com/sql/sql_groupby.asp">GROUP BY</a>, <a href="https://www.w3schools.com/sql/sql_count_avg_sum.asp">AVG</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to solve this problem.
</li>
<li>
The results of the query copy and pasted.
</li>
</ul>
</div>
</div>
<div id="solution-139" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> zip_code <span class="kw">AS</span> <span class="st">&#39;Zip Code&#39;</span>, <span class="fu">AVG</span>(mean_temperature_f) <span class="kw">AS</span> <span class="st">&#39;Avg Temperature&#39;</span> <span class="kw">FROM</span> weather <span class="kw">GROUP</span> <span class="kw">BY</span> zip_code;</code></pre></div>
</div>
<div id="from-2-we-can-see-that-there-are-only-5-zip_codes-with-weather-information.-how-many-unique-zip_codes-do-we-have-in-the-trip-table-write-a-query-that-finds-the-number-of-unique-zip_codes-in-the-trip-table.-write-another-query-that-lists-the-zip_code-and-count-of-the-number-of-times-the-zip_code-appears.-if-we-had-originally-assumed-that-the-zip_code-was-related-to-the-location-of-the-trip-itself-we-were-wrong.-can-you-think-of-a-likely-explanation-for-the-unexpected-zip_code-values-in-the-trip-table" class="section level5">
<h5>3. From (2) we can see that there are only 5 <code>zip_code</code>s with weather information. How many unique <code>zip_code</code>s do we have in the <code>trip</code> table? Write a query that finds the number of unique <code>zip_code</code>s in the <code>trip</code> table. Write another query that lists the <code>zip_code</code> and count of the number of times the <code>zip_code</code> appears. If we had originally assumed that the <code>zip_code</code> was related to the location of the trip itself, we were wrong. Can you think of a likely explanation for the unexpected <code>zip_code</code> values in the <code>trip</code> table?</h5>
<p><strong>Hint:</strong> There could be missing values in <code>zip_code</code>. We want to avoid them in SQL queries, for now. You can learn more about the missing values (or NULL) in SQL <a href="https://www.w3schools.com/sql/sql_null_values.asp">here</a>.</p>
<p><strong>Relevant topics:</strong> <a href="https://www.w3schools.com/sql/sql_groupby.asp">GROUP BY</a>, <a href="https://www.w3schools.com/sql/sql_count_avg_sum.asp">COUNT</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL queries used to solve this problem.
</li>
<li>
1-2 sentences explainging what a possible explanation for the <code>zip_code</code>s could be.
</li>
</ul>
</div>
</div>
<div id="solution-140" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="kw">DISTINCT</span> zip_code) <span class="kw">FROM</span> trip;
<span class="kw">SELECT</span> zip_code, <span class="fu">COUNT</span>(zip_code) <span class="kw">FROM</span> trip <span class="kw">GROUP</span> <span class="kw">BY</span> zip_code;</code></pre></div>
</div>
<div id="in-2-we-wrote-a-query-that-finds-the-average-mean_temperature_f-by-zip_code.-what-if-we-want-to-tack-on-our-results-in-2-to-information-from-each-row-in-the-station-table-based-on-the-zip_codes-to-do-this-use-an-inner-join.-inner-join-combines-tables-based-on-specified-fields-and-returns-only-rows-where-there-is-a-match-in-both-the-left-and-right-tables." class="section level5">
<h5>4. In (2) we wrote a query that finds the average <code>mean_temperature_f</code> by <code>zip_code</code>. What if we want to tack on our results in (2) to information from each row in the <code>station</code> table based on the <code>zip_code</code>s? To do this, use an INNER JOIN. INNER JOIN combines tables based on specified fields, and returns only rows where there is a match in both the &quot;left&quot; and &quot;right&quot; tables.</h5>
<p><strong>Hint:</strong> Use the query from (2) as a sub query within your solution.</p>
<p><strong>Hint:</strong> Here is a video about JOIN and LEFT JOIN.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_5ugjqrhk&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_i4qp5bam">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-inner-join">INNER JOIN</a>, subqueries, <a href="sql.html#sql-aliasing">aliasing</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to solve this problem.
</li>
</ul>
</div>
</div>
<div id="solution-141" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> * <span class="kw">FROM</span> station <span class="kw">as</span> s <span class="kw">INNER</span> <span class="kw">JOIN</span> (<span class="kw">SELECT</span> zip_code <span class="kw">AS</span> <span class="st">&#39;Zip Code&#39;</span>, <span class="fu">AVG</span>(mean_temperature_f) <span class="kw">AS</span> <span class="st">&#39;Avg Temperature&#39;</span> <span class="kw">FROM</span> weather <span class="kw">GROUP</span> <span class="kw">BY</span> zip_code) <span class="kw">AS</span> sub <span class="kw">ON</span> s.zip_code=sub.<span class="st">&#39;Zip Code&#39;</span>;</code></pre></div>
</div>
<div id="in-3-we-alluded-to-the-fact-that-the-zip_codes-in-the-trip-table-arent-very-consistent.-users-can-enter-a-zip-code-when-using-the-app.-this-means-that-zip_code-can-be-from-anywhere-in-the-world-with-that-being-said-if-the-zip_code-is-one-of-the-5-zip_codes-for-which-we-have-weather-data-from-question-2-we-can-add-that-weather-information-to-matching-rows-of-the-trip-table.-in-4-we-used-an-inner-join-to-append-some-weather-information-to-each-row-in-the-station-table.-for-this-question-write-a-query-that-performs-an-inner-join-and-appends-weather-data-from-the-weather-table-to-the-trip-data-from-the-trip-table.-limit-your-output-to-5-lines." class="section level5">
<h5>5. In (3) we alluded to the fact that the <code>zip_code</code>s in the <code>trip</code> table aren't very consistent. Users can enter a zip code when using the app. This means that <code>zip_code</code> can be from anywhere in the world! With that being said, if the <code>zip_code</code> is one of the 5 <code>zip_code</code>s for which we have weather data (from question 2), we can add that weather information to matching rows of the <code>trip</code> table. In (4) we used an INNER JOIN to append some weather information to each row in the <code>station</code> table. For this question, write a query that performs an INNER JOIN and appends weather data from the <code>weather</code> table to the trip data from the <code>trip</code> table. Limit your output to 5 lines.</h5>
<p><strong>Important note:</strong> Notice that the weather data has about 1 row of weather information for each date and each zip code. This means you may have to join your data based on multiple constraints instead of just 1 like in (4). In the <code>trip</code> table, you can use <code>start_date</code> for for the date information.</p>
<p><strong>Hint:</strong> You will want to wrap your dates and datetimes in <a href="https://www.sqlitetutorial.net/sqlite-date-functions/sqlite-date-function/">sqlite's <code>date</code> function</a> prior to comparison.</p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-inner-join">INNER JOIN</a>, <a href="sql.html#sql-aliasing">aliasing</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to solve this problem.
</li>
<li>
First 5 lines of output.
</li>
</ul>
</div>
</div>
<div id="solution-142" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> * <span class="kw">FROM</span> trip <span class="kw">AS</span> t <span class="kw">INNER</span> <span class="kw">JOIN</span> weather <span class="kw">AS</span> w <span class="kw">ON</span> t.zip_code=w.zip_code <span class="kw">AND</span> <span class="dt">date</span>(t.start_date)=date(w.date) <span class="kw">LIMIT</span> <span class="dv">5</span>;</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p13-290" class="section level3">
<h3>Project 13</h3>
<hr />
<p><strong>Motivation:</strong> Databases you will work with won't necessarily come organized in the way that you like. Getting really comfortable writing longer queries where you have to perform many joins, alias fields and tables, and aggregate results, is important. In addition, gaining some familiarity with terms like <em>primary key</em>, and <em>foreign key</em> will prove useful when you need to search for help online. In this project we will write some more complicated queries with a fun database. Proper preparation prevents poor performance, and that means practice!</p>
<p><strong>Context:</strong> We are towards the end of a series of projects that give you an opportunity to practice using SQL. In this project, we will reinforce topics you've already learned, with a focus on subqueries and joins.</p>
<p><strong>Scope:</strong> SQL, sqlite</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Write and run SQL queries in <code>sqlite</code> on real-world data.
</li>
<li>
Identify primary and foreign keys in a SQL table.
</li>
</ul>
</div>
<div id="dataset-24" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/movies_and_tv/imdb.db</code></p>
<p><strong>Important note:</strong> For this project you will use SQLite to access the data. To connect to the database, copy and paste the following before your solutions in your .Rmd:</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{r, include=F}
library(RSQLite)
imdb &lt;- dbConnect(RSQLite::SQLite(), &quot;/class/datamine/data/movies_and_tv/imdb.db&quot;)
```</code></pre></div>
<p>If you want to use a SQLite-specific function like <code>.tables</code> (or prefer to test things in the Terminal), you will need to use the Terminal to connect to the database and run queries. To do so, you can connect to RStudio Server at <a href="https://rstudio.scholar.rcac.purdue.edu" class="uri">https://rstudio.scholar.rcac.purdue.edu</a>, and navigate to the terminal. In the terminal execute the command:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">sqlite3</span> /class/datamine/data/movies_and_tv/imdb.db</code></pre></div>
<p>From there, the SQLite-specific commands will function properly. They will <em>not</em> function properly in an SQL code chunk. To display the SQLite-specific commands in a code chunk without running the code, use a code chunk with the option <code>eval=F</code> like this:</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{sql, connection=imdb, eval=F}
SELECT * FROM titles LIMIT 5;
```</code></pre></div>
<p>This will allow the code to be displayed without throwing an error.</p>
</div>
<div id="questions-24" class="section level4">
<h4>Questions</h4>
<div id="a-primary-key-is-a-field-in-a-table-which-uniquely-identifies-a-row-in-the-table.-primary-keys-must-be-unique-values-and-this-is-enforced-at-the-database-level.-a-foreign-key-is-a-field-whose-value-matches-a-primary-key-in-a-different-table.-a-table-can-have-0-1-primary-key-but-it-can-have-0-foreign-keys.-examine-the-titles-table.-do-you-think-there-are-any-primary-keys-how-about-foreign-keys-now-examine-the-episodes-table.-based-on-observation-and-the-column-names-do-you-think-there-are-any-primary-keys-how-about-foreign-keys" class="section level5">
<h5>1. A primary key is a field in a table which uniquely identifies a row in the table. Primary keys <em>must</em> be unique values, and this is enforced at the database level. A foreign key is a field whose value matches a primary key in a different table. A table can have 0-1 primary key, but it can have 0+ foreign keys. Examine the <code>titles</code> table. Do you think there are any primary keys? How about foreign keys? Now examine the <code>episodes</code> table. Based on observation and the column names, do you think there are any primary keys? How about foreign keys?</h5>
<p><strong>Hint:</strong> A primary key can also be a foreign key.</p>
<p><strong>Hint:</strong> Here are two videos. The first video will remind you how to find the names of all of the tables in the <code>imdb</code> database. The second video will introduce you to the <code>titles</code> and <code>episodes</code> tables in the <code>imdb</code> database.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_7ktvbhc9&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_ae112udc">Click here for video</a></p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_wc2hl3xm&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_y7qo7jpu">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="https://www.geeksforgeeks.org/difference-between-primary-key-and-foreign-key/">primary key</a>, <a href="https://www.geeksforgeeks.org/difference-between-primary-key-and-foreign-key/">foreign key</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
List any primary or foreign keys in the <code>titles</code> table.
</li>
<li>
List any primary or foreign keys in the <code>episodes</code> table.
</li>
</ul>
</div>
</div>
<div id="if-you-paste-a-title_id-to-the-end-of-the-following-url-it-will-pull-up-the-page-for-the-title.-for-example-httpswww.imdb.comtitlett0413573-leads-to-the-page-for-the-tv-series-greys-anatomy.-write-a-sql-query-to-confirm-that-the-title_id-tt0413573-does-indeed-belong-to-greys-anatomy.-then-browse-imdb.com-and-find-your-favorite-tv-show.-get-the-title_id-from-the-url-of-your-favorite-tv-show-and-run-the-following-query-to-confirm-that-the-tv-show-is-in-our-database" class="section level5">
<h5>2. If you paste a <code>title_id</code> to the end of the following url, it will pull up the page for the title. For example, <a href="https://www.imdb.com/title/tt0413573" class="uri">https://www.imdb.com/title/tt0413573</a> leads to the page for the TV series <em>Grey's Anatomy</em>. Write a SQL query to confirm that the <code>title_id</code> tt0413573 does indeed belong to <em>Grey's Anatomy</em>. Then browse imdb.com and find your favorite TV show. Get the <code>title_id</code> from the url of your favorite TV show and run the following query, to confirm that the TV show is in our database:</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> * <span class="kw">FROM</span> titles <span class="kw">WHERE</span> title_id=<span class="st">&#39;&lt;title id here&gt;&#39;</span>;</code></pre></div>
<p>Make sure to replace &quot;&lt;title id here&gt;&quot; with the <code>title_id</code> of your favorite show. If your show does not appear, or has only a single season, pick another show until you find one we have in our database with multiple seasons.</p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-examples">SELECT</a>, WHERE</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to confirm that <code>title_id</code> tt0413573 does indeed belong to <em>Grey's Anatomy</em>.
</li>
<li>
The output of the query.
</li>
<li>
The <code>title_id</code> of your favorite TV show.
</li>
<li>
SQL query used to confirm the <code>title_id</code> for your favorite TV show.
</li>
<li>
The output of the query.
</li>
</ul>
</div>
</div>
<div id="the-episode_title_id-column-in-the-episodes-table-references-titles-of-individual-episodes-of-a-tv-series.-the-show_title_id-references-the-titles-of-the-show-itself.-with-that-in-mind-write-a-query-that-gets-a-list-of-all-of-the-episodes_title_ids-found-in-the-episodes-table-with-the-associated-primary_title-found-in-the-titles-table-for-each-episode-of-greys-anatomy." class="section level5">
<h5>3. The <code>episode_title_id</code> column in the <code>episodes</code> table references titles of individual episodes of a TV series. The <code>show_title_id</code> references the titles of the show itself. With that in mind, write a query that gets a list of all of the <code>episodes_title_id</code>s (found in the <code>episodes</code> table), with the associated <code>primary_title</code> (found in the <code>titles</code> table) for each episode of <em>Grey's Anatomy</em>.</h5>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-inner-join">INNER JOIN</a></p>
<p><strong>Hint:</strong> This video shows how to extract titles of episodes in the <code>imdb</code> database.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_uhg3atol&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_wmo98brv">Click here for video</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to solve the problem in a code chunk.
</li>
</ul>
</div>
</div>
<div id="we-want-to-write-a-query-that-returns-the-title-and-rating-of-the-highest-rated-episode-of-your-favorite-tv-show-which-you-chose-in-2.-in-order-to-do-so-we-will-break-the-task-into-two-parts-in-4-and-5.-first-write-a-query-that-returns-a-list-of-episode_title_ids-found-in-the-episodes-table-with-the-associated-primary_title-found-in-the-titles-table-for-each-episode." class="section level5">
<h5>4. We want to write a query that returns the title and rating of the highest rated episode of your favorite TV show, which you chose in (2). In order to do so, we will break the task into two parts in (4) and (5). First, write a query that returns a list of <code>episode_title_id</code>s (found in the <code>episodes</code> table), with the associated <code>primary_title</code> (found in the <code>titles</code> table) for each episode.</h5>
<p><strong>Hint:</strong> This part is just like question (3) but this time with your favorite TV show, which you chose in (2).</p>
<p><strong>Hint:</strong> This video shows how to use a subquery, to <code>JOIN</code> a total of three tables in the <code>imdb</code> database.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_jb8vd4nc&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_sc5yje1a">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-inner-join">INNER JOIN</a>, <a href="sql.html#sql-aliasing">aliasing</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to solve the problem in a code chunk.
</li>
<li>
The first 5 results from your query.
</li>
</ul>
</div>
</div>
<div id="write-a-query-that-adds-the-rating-to-the-end-of-each-episode.-to-do-so-use-the-query-you-wrote-in-4-as-a-subquery.-which-episode-has-the-highest-rating-is-it-also-your-favorite-episode" class="section level5">
<h5>5. Write a query that adds the rating to the end of each episode. To do so, use the query you wrote in (4) as a subquery. Which episode has the highest rating? Is it also your favorite episode?</h5>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-inner-join">INNER JOIN</a>, <a href="sql.html#sql-aliasing">aliasing</a>, subqueries, ORDER BY, DESC, LIMIT</p>
<p><strong>Note</strong>: Various helpful examples that utilize the relevant topics in this problem can be found <a href="sql.html#sql-examples">here</a>.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to solve the problem in a code chunk.
</li>
<li>
The <code>episode_title_id</code>, <code>primary_title</code>, and <code>rating</code> of the top rated episode from your favorite TV series, in question (2).
</li>
<li>
A statement saying whether the highest rated episode is also your favorite episode.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p14-290" class="section level3">
<h3>Project 14</h3>
<hr />
<p><strong>Motivation:</strong> As we learned earlier in the semester, bash scripts are a powerful tool when you need to perform repeated tasks in a UNIX-like system. In addition, sometimes preprocessing data using UNIX tools prior to analysis in R or Python is useful. Ample practice is integral to becoming proficient with these tools. As such, we will be reviewing topics learned earlier in the semester.</p>
<p><strong>Context:</strong> We've just ended a series of projects focused on SQL. In this project we will begin to review topics learned throughout the semester, starting writing bash scripts using the various UNIX tools we learned about in Projects 3 through 8.</p>
<p><strong>Scope:</strong> awk, UNIX utilities, bash scripts, fread</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Navigating UNIX via a terminal: ls, pwd, cd, ., .., ~, etc.
</li>
<li>
Analyzing file in a UNIX filesystem: wc, du, cat, head, tail, etc.
</li>
<li>
Creating and destroying files and folder in UNIX: scp, rm, touch, cp, mv, mkdir, rmdir, etc.
</li>
<li>
Use grep to search files effectively.
</li>
<li>
Use cut to section off data from the command line.
</li>
<li>
Use piping to string UNIX commands together.
</li>
<li>
Use awk for data extraction, and preprocessing.
</li>
<li>
Create bash scripts to automate a process or processes.
</li>
</ul>
</div>
<div id="dataset-25" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use PLOTSNAP.csv from the data folder found in Scholar:</p>
<p><code>/class/datamine/data/forest</code></p>
<p>To read more about PLOTSNAP.csv that you will be working with:</p>
<p><a href="https://www.uvm.edu/femc/data/archive/project/federal-forest-inventory-analysis-data-for/dataset/plot-level-data-gathered-through-forest/metadata#fields" class="uri">https://www.uvm.edu/femc/data/archive/project/federal-forest-inventory-analysis-data-for/dataset/plot-level-data-gathered-through-forest/metadata#fields</a></p>
</div>
<div id="questions-25" class="section level4">
<h4>Questions</h4>
<div id="take-a-look-at-at-plotsnap.csv.-write-a-line-of-awk-code-that-displays-the-statecd-followed-by-the-number-of-rows-with-that-statecd." class="section level5">
<h5>1. Take a look at at <code>PLOTSNAP.csv</code>. Write a line of awk code that displays the <code>STATECD</code> followed by the number of rows with that <code>STATECD</code>.</h5>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Code used to solve the problem.
</li>
<li>
Count of the following <code>STATECD</code>s: 1, 2, 4, 5, 6
</li>
</ul>
</div>
</div>
<div id="unfortunately-there-isnt-a-very-accessible-list-available-that-shows-which-state-each-statecd-represents.-this-is-no-problem-for-us-though-the-dataset-has-lat-and-lon-write-some-bash-that-prints-just-the-statecd-lat-and-lon." class="section level5">
<h5>2. Unfortunately, there isn't a very accessible list available that shows which state each <code>STATECD</code> represents. This is no problem for us though, the dataset has <code>LAT</code> and <code>LON</code>! Write some bash that prints just the <code>STATECD</code>, <code>LAT</code>, and <code>LON</code>.</h5>
<p><strong>Note:</strong> There are 92 columns in our dataset: <code>awk -F, 'NR==1{print NF}' PLOTSNAP.csv</code>. To create a list of <code>STATECD</code> to state, we only really need <code>STATECD</code>, <code>LAT</code>, and <code>LON</code>. Keeping the other 89 variables will keep our data at 2.1gb.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#cut">cut</a>, <a href="unix.html#awk">awk</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Code used to solve the problem.
</li>
<li>
The output of your code piped to <code>head</code>.
</li>
</ul>
</div>
</div>
<div id="fread-is-a-fast-and-friendly-file-finagler.-it-is-part-of-the-very-popular-data.table-package-in-r.-we-will-learn-more-about-this-package-next-semester.-for-now-read-the-documentation-here-and-use-the-cmd-argument-in-conjunction-with-your-bash-code-from-2-to-read-the-data-of-statecd-lat-and-lon-into-a-data.table-in-your-r-environment." class="section level5">
<h5>3. <code>fread</code> is a &quot;Fast and Friendly File Finagler&quot;. It is part of the very popular <code>data.table</code> package in R. We will learn more about this package next semester. For now, read the documentation <a href="https://www.rdocumentation.org/packages/data.table/versions/1.12.8/topics/fread">here</a> and use the <code>cmd</code> argument in conjunction with your bash code from (2) to read the data of <code>STATECD</code>, <code>LAT</code>, and <code>LON</code> into a <code>data.table</code> in your R environment.</h5>
<p><strong>Relevant topics:</strong> fread</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Code used to solve the problem.
</li>
<li>
The <code>head</code> of the resulting <code>data.table</code>.
</li>
</ul>
</div>
</div>
<div id="we-are-going-to-further-understand-the-data-from-question-3-by-finding-the-actual-locations-based-on-the-lat-and-lon-columns.-we-can-use-the-library-revgeo-to-get-a-location-given-a-pair-of-longitude-and-latitude-values.-revgeo-uses-a-free-api-hosted-by-photon-in-order-to-do-so." class="section level5">
<h5>4. We are going to further understand the data from question (3) by finding the actual locations based on the <code>LAT</code> and <code>LON</code> columns. We can use the library <code>revgeo</code> to get a location given a pair of longitude and latitude values. <code>revgeo</code> uses a free API hosted by <a href="https://github.com/komoot/photon">photon</a> in order to do so.</h5>
</div>
<div id="for-example" class="section level5">
<h5>For example:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(revgeo)
<span class="kw">revgeo</span>(<span class="dt">longitude=</span><span class="op">-</span><span class="fl">86.926153</span>, <span class="dt">latitude=</span><span class="fl">40.427055</span>, <span class="dt">output=</span><span class="st">&#39;frame&#39;</span>)</code></pre></div>
</div>
<div id="the-code-above-will-give-you-the-address-information-in-six-columns-from-the-most-granular-housenumber-to-the-least-granular-country.-depending-on-the-coordinates-revgeo-may-or-may-not-give-you-results-for-each-column.-for-this-question-we-are-going-to-keep-only-the-state-column." class="section level5">
<h5>The code above will give you the address information in six columns, from the most-granular <code>housenumber</code> to the least-granular <code>country</code>. Depending on the coordinates, <code>revgeo</code> may or may not give you results for each column. For this question, we are going to keep only the <code>state</code> column.</h5>
</div>
<div id="there-are-over-4-million-rows-in-our-dataset----we-do-not-want-to-hit-photons-api-that-many-times.-instead-we-are-going-to-do-the-following" class="section level5">
<h5>There are over 4 million rows in our dataset -- we do <em>not</em> want to hit <a href="https://github.com/komoot/photon">photon's</a> API that many times. Instead, we are going to do the following:</h5>
</div>
<div id="first-unless-you-feel-comfortable-using-data.table-convert-your-data.table-to-a-data.frame" class="section level5">
<h5>First: Unless you feel comfortable using <code>data.table</code>, convert your <code>data.table</code> to a <code>data.frame</code>:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_dataframe &lt;-<span class="st"> </span><span class="kw">data.frame</span>(my_datatable)</code></pre></div>
</div>
<div id="second-calculate-the-average-lat-and-lon-for-each-statecd-and-call-the-new-data.frame-dat.-this-should-result-in-57-rows-of-latlong-pairs." class="section level5">
<h5>Second: Calculate the average <code>LAT</code> and <code>LON</code> for each <code>STATECD</code>, and call the new <code>data.frame</code>, <code>dat</code>. This should result in 57 rows of lat/long pairs.</h5>
</div>
<div id="third-for-each-row-in-dat-run-a-reverse-geocode-and-append-the-state-to-a-new-column-called-state." class="section level5">
<h5>Third: For each row in <code>dat</code>, run a reverse geocode and append the <code>state</code> to a new column called <code>STATE</code>.</h5>
<p><strong>Hint:</strong> To calculate the average <code>LAT</code> and <code>LON</code> for each <code>STATECD</code>, you could use the <a href="https://www.rdocumentation.org/packages/sqldf/versions/0.4-11"><code>sqldf</code></a> package to run SQL queries on your <code>data.frame</code>.</p>
<p><strong>Hint:</strong> <a href="https://stackoverflow.com/questions/3505701/grouping-functions-tapply-by-aggregate-and-the-apply-family"><code>mapply</code></a> is a useful apply function to use to solve this problem.</p>
<p><strong>Hint:</strong> Here is some extra help:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(revgeo)

points &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">latitude=</span><span class="kw">c</span>(<span class="fl">40.433663</span>, <span class="fl">40.432104</span>, <span class="fl">40.428486</span>), <span class="dt">longitude=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">86.916584</span>, <span class="fl">-86.919610</span>, <span class="fl">-86.920866</span>))

<span class="co"># Note that the &quot;output&quot; argument gets passed to the &quot;revgeo&quot; function.</span>
<span class="kw">mapply</span>(revgeo, points<span class="op">$</span>longitude, points<span class="op">$</span>latitude, <span class="dt">output=</span><span class="st">&quot;frame&quot;</span>)

<span class="co"># The output isn&#39;t in a great format, and we&#39;d prefer to just get the &quot;state&quot; data.</span>
<span class="co"># Let&#39;s wrap &quot;revgeo&quot; into another function that just gets &quot;state&quot; and try again.</span>
get_state &lt;-<span class="st"> </span><span class="cf">function</span>(lon, lat) {
  <span class="kw">return</span>(<span class="kw">revgeo</span>(lon, lat, <span class="dt">output=</span><span class="st">&quot;frame&quot;</span>)[<span class="st">&quot;state&quot;</span>])
}

<span class="kw">mapply</span>(get_state, points<span class="op">$</span>longitude, points<span class="op">$</span>latitude)</code></pre></div>
<p><strong>Important note:</strong> It is okay to get &quot;Not Found&quot; for some of the addresses.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-apply-functions">apply functions</a>, sqldf</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Code used to solve the problem.
</li>
<li>
The <code>head</code> of the resulting <code>data.frame</code>.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p15-290" class="section level3">
<h3>Project 15</h3>
<hr />
<p><strong>Motivation:</strong> We've done a lot of work with SQL this semester. Let's review concepts in this project and mix and match R and SQL to solve data-driven problems.</p>
<p><strong>Context:</strong> In this project, we will reinforce topics you've already learned, with a focus on SQL.</p>
<p><strong>Scope:</strong> SQL, sqlite, R</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Write and run SQL queries in <code>sqlite</code> on real-world data.
</li>
<li>
Use SQL from within R.
</li>
</ul>
</div>
<div id="dataset-26" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/movies_and_tv/imdb.db</code></p>
</div>
<div id="questions-26" class="section level4">
<h4>Questions</h4>
<div id="what-is-the-first-year-where-our-database-has-1000-titles-use-the-premiered-column-in-the-titles-table-as-our-year.-what-year-has-the-most-titles" class="section level5">
<h5>1. What is the first year where our database has &gt; 1000 titles? Use the <code>premiered</code> column in the <code>titles</code> table as our year. What year has the most titles?</h5>
<p><strong>Hint:</strong> There could be missing values in <code>premiered</code>. We want to avoid them in SQL queries, for now. You can learn more about the missing values (or NULL) in SQL <a href="https://www.w3schools.com/sql/sql_null_values.asp">here</a>.</p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-count">COUNT</a>, <a href="sql.html#sql-groupby">GROUP BY</a>, <a href="sql.html#sql-order-by">ORDER BY</a>, <a href="sql.html#sql-examples">DESC</a>, <a href="https://www.tutorialspoint.com/sql/sql-having-clause.htm">HAVING</a>, <a href="https://www.w3schools.com/sql/sql_null_values.asp">NULL</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL queries used to answer the questions.
</li>
<li>
What year is the first year to have &gt; 1000 titles?
</li>
<li>
What year has the most titles?
</li>
</ul>
</div>
</div>
<div id="how-many-and-what-are-the-unique-types-from-the-titles-table-fpr-the-year-found-in-question-1-with-the-most-titles-how-many-titles-of-each-type-are-there" class="section level5">
<h5>2. How many, and what are the unique <code>type</code>s from the <code>titles</code> table? Fpr the year found in question (1) with the most <code>titles</code>, how many titles of each <code>type</code> are there?</h5>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL queries used to answer the questions.
</li>
<li>
How many and what are the unique <code>types</code> from the <code>titles</code> table?
</li>
<li>
A list of <code>type</code> and and count for the year (<code>premiered</code>) that had the most <code>titles</code>.
</li>
</ul>
</div>
</div>
<div id="f.r.i.e.n.d.s-is-a-popular-tv-show.-they-have-an-interesting-naming-convention-for-the-names-of-their-episodes.-they-all-begin-with-the-text-the-one-....-there-are-6-primary-characters-in-the-show-chandler-joey-monica-phoebe-rachel-and-ross.-lets-use-sql-and-r-to-take-a-look-at-how-many-times-each-characters-names-appear-in-the-title-of-the-episodes." class="section level5">
<h5>F.R.I.E.N.D.S is a popular tv show. They have an interesting naming convention for the names of their episodes. They all begin with the text &quot;The One ...&quot;. There are 6 primary characters in the show: Chandler, Joey, Monica, Phoebe, Rachel, and Ross. Let's use SQL and R to take a look at how many times each characters' names appear in the title of the episodes.</h5>
</div>
<div id="write-a-query-that-gets-the-episode_title_id-primary_title-rating-and-votes-of-all-of-the-episodes-of-friends-title_id-is-tt0108778." class="section level5">
<h5>3. Write a query that gets the <code>episode_title_id</code>, <code>primary_title</code>, <code>rating</code>, and <code>votes</code>, of all of the episodes of Friends (<code>title_id</code> is tt0108778).</h5>
<p><strong>Hint:</strong> You can slightly modify the solution to question (5) in project 13.</p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-inner-join">INNER JOIN</a>, subqueries, <a href="sql.html#sql-aliasing">aliasing</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to answer the question.
</li>
<li>
First 5 results of the query.
</li>
</ul>
</div>
</div>
<div id="now-that-you-have-a-working-query-connect-to-the-database-and-run-the-query-to-get-the-data-into-an-r-data-frame.-in-previous-projects-we-learned-how-to-used-regular-expressions-to-search-for-text.-for-each-character-how-many-episodes-primary_titles-contained-their-name" class="section level5">
<h5>4. Now that you have a working query, connect to the database and run the query to get the data into an R data frame. In previous projects, we learned how to used regular expressions to search for text. For each character, how many episodes <code>primary_title</code>s contained their name?</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-sql">SQL in R</a>, <a href="r.html#r-grep">grep</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code in a code chunk that was used to find the solution.
</li>
<li>
The solution pasted below the code chunk.
</li>
</ul>
</div>
</div>
<div id="create-a-graphic-showing-our-results-in-4-using-your-favorite-package.-make-sure-the-plot-has-a-good-title-x-label-y-label-and-try-to-incorporate-some-of-the-following-colors-273c8b-bd253a-016f7c-f56934-016c5a-9055b1-eaab37." class="section level5">
<h5>5. Create a graphic showing our results in (4) using your favorite package. Make sure the plot has a good title, x-label, y-label, and try to incorporate some of the following colors: #273c8b, #bd253a, #016f7c, #f56934, #016c5a, #9055b1, #eaab37.</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-plotting">plotting</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The R code used to generate the graphic.
</li>
<li>
The graphic in a png or jpg/jpeg format.
</li>
</ul>
</div>
</div>
<div id="use-a-combination-of-sql-and-r-to-find-which-of-the-following-3-genres-has-the-highest-average-rating-for-movies-see-type-column-from-titles-table-romance-comedy-animation.-in-the-titles-table-you-can-find-the-genres-in-the-genres-column.-there-may-be-some-overlap-i.e.-a-movie-may-have-more-than-one-genre-this-is-ok." class="section level5">
<h5>6. Use a combination of SQL and R to find which of the following 3 genres has the highest average rating for movies (see <code>type</code> column from <code>titles</code> table): Romance, Comedy, Animation. In the <code>titles</code> table, you can find the genres in the <code>genres</code> column. There may be some overlap (i.e. a movie may have more than one genre), this is ok.</h5>
<p>To query rows which have the genre Action as one of its genres:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> * <span class="kw">FROM</span> titles <span class="kw">WHERE</span> genres <span class="kw">LIKE</span> <span class="st">&#39;%action%&#39;</span>;</code></pre></div>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-examples">LIKE</a>, <a href="sql.html#sql-inner-join">INNER JOIN</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Any code you used to solve the problem in a code chunk.
</li>
<li>
The average rating of each of the genres listed for movies.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
</div>
<div id="fall2020-stat-39000" class="section level2">
<h2>STAT 39000</h2>
<div id="fall2020-p01-390" class="section level3">
<h3>Project 1</h3>
<hr />
<p><strong>Motivation:</strong> In this project we will jump right into an R review. In this project we are going to break one larger data-wrangling problem into discrete parts. There is a slight emphasis on writing functions and dealing with strings. At the end of this project we will have greatly simplified a dataset, making it easy to dig into.</p>
<p><strong>Context:</strong> We just started the semester and are digging into a large dataset, and in doing so, reviewing R concepts we've previously learned.</p>
<p><strong>Scope:</strong> data wrangling in R, functions</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Comprehend what a function is, and the components of a function in R.
</li>
<li>
Read and write basic (csv) data.
</li>
<li>
Utilize apply functions in order to solve a data-driven problem.
</li>
</ul>
</div>
<p>Make sure to read about, and use the template found <a href="projects.html#templates">here</a>, and the important information about projects submissions <a href="projects.html#submissions">here</a>.</p>
<p>You can find useful examples that walk you through relevant material in The Examples Book:</p>
<p><a href="https://thedatamine.github.io/the-examples-book" class="uri">https://thedatamine.github.io/the-examples-book</a></p>
<p>It is highly recommended to read through, search, and explore these examples to help solve problems in this project.</p>
<p><strong>Important note:</strong> It is highly recommended that you use <a href="https://rstudio.scholar.rcac.purdue.edu/" class="uri">https://rstudio.scholar.rcac.purdue.edu/</a>. Simply click on the link and login using your Purdue account credentials.</p>
<p>We decided to move away from ThinLinc and away from the version of RStudio used last year (<a href="https://desktop.scholar.rcac.purdue.edu" class="uri">https://desktop.scholar.rcac.purdue.edu</a>). The version of RStudio is known to have some strange issues when running code chunks.</p>
<p>Remember the very useful documentation shortcut <code>?</code>. To use, simply type <code>?</code> in the console, followed by the name of the function you are interested in.</p>
<p>You can also look for package documentation by using <code>help(package=PACKAGENAME)</code>, so for example, to see the documentation for the package <code>ggplot2</code>, we could run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">help</span>(<span class="dt">package=</span>ggplot2)</code></pre></div>
<p>Sometimes it can be helpful to see the source code of a defined function. A <a href="https://www.tutorialspoint.com/r/r_functions.htm">function</a> is any chunk of organized code that is used to perform an operation. Source code is the underlying <code>R</code> or <code>c</code> or <code>c++</code> code that is used to create the function. To see the source code of a defined function, type the function's name without the <code>()</code>. For example, if we were curious about what the function <code>Reduce</code> does, we could run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Reduce</code></pre></div>
<p>Occasionally this will be less useful as the resulting code will be code that calls <code>c</code> code we can't see. Other times it will allow you to understand the function better.</p>
<div id="dataset-27" class="section level4">
<h4>Dataset:</h4>
<p><code>/class/datamine/data/airbnb</code></p>
<p>Often times (maybe even the majority of the time) data doesn’t come in one nice file or database. Explore the datasets in <code>/class/datamine/data/airbnb</code>.</p>
</div>
<div id="questions-27" class="section level4">
<h4>Questions</h4>
<p><strong>Important note:</strong> Please make sure to <strong>double check</strong> that the your submission does indeed contain the files you think it does. You can do this by downloading your submission from Gradescope after uploading. If you can see all of your files and they open up properly on your computer, you should be good to go.</p>
<p><strong>Important note:</strong> Please make sure to look at your knit PDF <em>before</em> submitting. PDFs should be relatively short and not contain huge amounts of printed data. Remember you can use functions like <code>head</code> to print a sample of the data or output. Extremely large PDFs will be subject to lose points.</p>
<div id="you-may-have-noted-that-for-each-country-city-and-date-we-can-find-3-files-calendar.csv.gz-listings.csv.gz-and-reviews.csv.gz-for-now-we-will-ignore-all-files-in-the-visualisations-folders.-1" class="section level5">
<h5>1. You may have noted that, for each country, city, and date we can find 3 files: <code>calendar.csv.gz</code>, <code>listings.csv.gz</code>, and <code>reviews.csv.gz</code> (for now, we will ignore all files in the &quot;visualisations&quot; folders).</h5>
</div>
<div id="lets-take-a-look-at-the-data-in-each-of-the-three-types-of-files.-pick-a-country-city-and-date-and-read-the-first-50-rows-of-each-of-the-3-datasets-calendar.csv.gz-listings.csv.gz-and-reviews.csv.gz.-provide-1-2-sentences-explaining-the-type-of-information-found-in-each-and-what-variables-could-be-used-to-join-them.-1" class="section level5">
<h5>Let's take a look at the data in each of the three types of files. Pick a country, city and date, and read the first 50 rows of each of the 3 datasets (<code>calendar.csv.gz</code>, <code>listings.csv.gz</code>, and <code>reviews.csv.gz</code>). Provide 1-2 sentences explaining the type of information found in each, and what variable(s) could be used to join them.</h5>
<p><strong>Hint:</strong> <code>read.csv</code> has an argument to select the number of rows we want to read.</p>
<p><strong>Hint:</strong> Depending on the country that you pick, the listings and/or the reviews might not display properly in RMarkdown. So you do not need to display the first 50 rows of the listings and/or reviews, in your RMarkdown document. It is OK to just display the first 50 rows of the calendar entries.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Chunk of code used to read the first 50 rows of each dataset.
</li>
<li>
1-2 sentences briefly describing the information contained in each dataset.
</li>
<li>
Name(s) of variable(s) that could be used to join them.
</li>
</ul>
</div>
<p>To read a compressed csv, simply use the <code>read.csv</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/airbnb/brazil/rj/rio-de-janeiro/2019-06-19/data/calendar.csv.gz&quot;</span>)
<span class="kw">head</span>(dat)</code></pre></div>
<p>Let's work towards getting this data into an easier format to analyze. From now on, we will focus on the <code>listings.csv.gz</code> datasets.</p>
</div>
<div id="solution-143" class="section level5">
<h5>Solution</h5>
<p>The <code>calendar.csv.gz</code> file for 2019-07-08 in Hawaii describes the <code>listing_id</code>, <code>date</code>, <code>available</code> (t or f), <code>price</code>, <code>adjusted_price</code>, <code>minimum_nights</code>, and <code>maximum_nights</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hawaii_calendar &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/airbnb/united-states/hi/hawaii/2019-07-08/data/calendar.csv.gz&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(hawaii_calendar, <span class="dt">n=</span><span class="dv">50</span>)</code></pre></div>
<p>The <code>listings.csv.gz</code> file for 2019-07-08 in Hawaii has 106 variables, which describe the very specific attributes of the airbnb listings.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hawaii_calendar &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/airbnb/united-states/hi/hawaii/2019-07-08/data/listings.csv.gz&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(hawaii_listings)</code></pre></div>
<p>The <code>reviews.csv.gz</code> file for 2019-07-08 in Hawaii describes the <code>listing_id</code>, <code>id</code>, <code>date</code>, <code>reviewer_id</code>, <code>reviewer_name</code>, and <code>comments</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hawaii_calendar &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/class/datamine/data/airbnb/united-states/hi/hawaii/2019-07-08/data/reviews.csv.gz&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(hawaii_reviews, <span class="dt">n=</span><span class="dv">50</span>)</code></pre></div>
<p>The variables that might be used to compare the tables are: <code>date</code>, <code>id</code>, <code>listing_id</code>, <code>maximum_nights</code>, <code>minimum_nights</code>, <code>price</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t &lt;-<span class="st"> </span><span class="kw">table</span>(<span class="kw">c</span>(<span class="kw">names</span>(hawaii_calendar), <span class="kw">names</span>(hawaii_listings), <span class="kw">names</span>(hawaii_reviews)))
t[t <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>]</code></pre></div>
</div>
<div id="write-a-function-called-get_paths_for_country-that-given-a-string-with-the-country-name-returns-a-vector-with-the-full-paths-for-all-listings.csv.gz-files-starting-with-classdataminedataairbnb....-1" class="section level5">
<h5>2. Write a function called <code>get_paths_for_country</code>, that, given a string with the country name, returns a vector with the full paths for all <code>listings.csv.gz</code> files, starting with <code>/class/datamine/data/airbnb/...</code>.</h5>
</div>
<div id="for-example-the-output-from-get_paths_for_countryunited-states-should-have-28-entries.-here-are-the-first-5-entries-in-the-output-1" class="section level5">
<h5>For example, the output from <code>get_paths_for_country(&quot;united-states&quot;)</code> should have 28 entries. Here are the first 5 entries in the output:</h5>
<pre class="txt"><code> [1] &quot;/class/datamine/data/airbnb/united-states/ca/los-angeles/2019-07-08/data/listings.csv.gz&quot;       
 [2] &quot;/class/datamine/data/airbnb/united-states/ca/oakland/2019-07-13/data/listings.csv.gz&quot;           
 [3] &quot;/class/datamine/data/airbnb/united-states/ca/pacific-grove/2019-07-01/data/listings.csv.gz&quot;     
 [4] &quot;/class/datamine/data/airbnb/united-states/ca/san-diego/2019-07-14/data/listings.csv.gz&quot;         
 [5] &quot;/class/datamine/data/airbnb/united-states/ca/san-francisco/2019-07-08/data/listings.csv.gz&quot;     </code></pre>
<p><strong>Hint:</strong> <code>list.files</code> is useful with the <code>recursive=T</code> option.</p>
<p><strong>Hint:</strong> Use <code>grep</code> to search for the pattern <code>listings.csv.gz</code> (within the results from the first hint), and use the option <code>value=T</code> to display the values found by the <code>grep</code> function.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Chunk of code for your <code>get_paths_for_country</code> function.
</li>
</ul>
</div>
</div>
<div id="solution-144" class="section level5">
<h5>Solution</h5>
<p>We extract all 28 of the listings for the United States first:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myprefix &lt;-<span class="st"> &quot;/class/datamine/data/airbnb/united-states/&quot;</span>
<span class="kw">paste0</span>(myprefix, <span class="kw">grep</span>(<span class="st">&quot;listings.csv.gz&quot;</span>, <span class="kw">list.files</span>(myprefix, <span class="dt">recursive=</span>T), <span class="dt">value=</span>T))</code></pre></div>
<p>Now we build a function that can do the same thing, for any country</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">get_paths_for_country &lt;-<span class="st"> </span><span class="cf">function</span>(mycountry) {
  myprefix &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;/class/datamine/data/airbnb/&quot;</span>, mycountry, <span class="st">&quot;/&quot;</span>)
  <span class="kw">paste0</span>(myprefix, <span class="kw">grep</span>(<span class="st">&quot;listings.csv.gz&quot;</span>, <span class="kw">list.files</span>(myprefix, <span class="dt">recursive=</span>T), <span class="dt">value=</span>T))
}</code></pre></div>
<p>and we test this for several countries:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_paths_for_country</span>(<span class="st">&quot;united-states&quot;</span>)
<span class="kw">get_paths_for_country</span>(<span class="st">&quot;brazil&quot;</span>)
<span class="kw">get_paths_for_country</span>(<span class="st">&quot;south-africa&quot;</span>)
<span class="kw">get_paths_for_country</span>(<span class="st">&quot;canada&quot;</span>)</code></pre></div>
</div>
<div id="write-a-function-called-get_data_for_country-that-given-a-string-with-the-country-name-returns-a-data.frame-containing-the-all-listings-data-for-that-country.-use-your-previously-written-function-to-help-you.-1" class="section level5">
<h5>3. Write a function called <code>get_data_for_country</code> that, given a string with the country name, returns a data.frame containing the all listings data for that country. Use your previously written function to help you.</h5>
<p><strong>Hint:</strong> Use <code>stringsAsFactors=F</code> in the <code>read.csv</code> function.</p>
<p><strong>Hint:</strong> Use <code>do.call(rbind, &lt;listofdataframes&gt;)</code> to combine a list of dataframes into a single dataframe.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-bind">rbind</a>, <a href="r.html#r-lapply">lapply</a>, <a href="r.html#r-writing-functions">function</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Chunk of code for your <code>get_data_for_country</code> function.
</li>
</ul>
</div>
</div>
<div id="solution-145" class="section level5">
<h5>Solution</h5>
<p>We first get the data from the Canada entries. To do this, we sapply the <code>read.csv</code> function to each of the 6 results from <code>get_paths_for_country(&quot;canada&quot;)</code> In other words, we read in these 6 data frames.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myresults &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">get_paths_for_country</span>(<span class="st">&quot;canada&quot;</span>), read.csv, <span class="dt">stringsAsFactors=</span>F, <span class="dt">simplify=</span>F)</code></pre></div>
<p>We get a list of 6 data frames:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(myresults)
<span class="kw">class</span>(myresults)
<span class="kw">class</span>(myresults[[<span class="dv">1</span>]])
<span class="kw">class</span>(myresults[[<span class="dv">6</span>]])</code></pre></div>
<p>and we can check the dimensions of each of the 6 data frames</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(myresults[[<span class="dv">1</span>]])
<span class="kw">dim</span>(myresults[[<span class="dv">2</span>]])
<span class="kw">dim</span>(myresults[[<span class="dv">3</span>]])
<span class="kw">dim</span>(myresults[[<span class="dv">4</span>]])
<span class="kw">dim</span>(myresults[[<span class="dv">5</span>]])
<span class="kw">dim</span>(myresults[[<span class="dv">6</span>]])</code></pre></div>
<p>this is more easily accomplished with another <code>sapply</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(myresults, dim)</code></pre></div>
<p>We can <code>rbind</code> all 6 of these data frames into one big data frame as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bigDF &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, myresults)
<span class="kw">class</span>(bigDF)
<span class="kw">dim</span>(bigDF)</code></pre></div>
<p>Now we create the desired function called <code>get_data_for_country</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">get_data_for_country &lt;-<span class="st"> </span><span class="cf">function</span>(mycountry) {
  myresults &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">get_paths_for_country</span>(mycountry), read.csv, <span class="dt">stringsAsFactors=</span>F, <span class="dt">simplify=</span>F)
  <span class="kw">do.call</span>(rbind, myresults)
}</code></pre></div>
<p>and we test it on Canada.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mynewbigDF &lt;-<span class="st"> </span><span class="kw">get_data_for_country</span>(<span class="st">&quot;canada&quot;</span>)</code></pre></div>
<p>The result has the same size as before</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(mynewbigDF)</code></pre></div>
</div>
<div id="use-your-get_data_for_country-to-get-the-data-for-a-country-of-your-choice-and-make-sure-to-name-the-data.frame-listings.-take-a-look-at-the-following-columns-host_is_superhost-host_has_profile_pic-host_identity_verified-and-is_location_exact.-what-is-the-data-type-for-each-column-you-can-use-class-or-typeof-or-str-to-see-the-data-type.-1" class="section level5">
<h5>4. Use your <code>get_data_for_country</code> to get the data for a country of your choice, and make sure to name the data.frame <code>listings</code>. Take a look at the following columns: <code>host_is_superhost</code>, <code>host_has_profile_pic</code>, <code>host_identity_verified</code>, and <code>is_location_exact</code>. What is the data type for each column? (You can use <code>class</code> or <code>typeof</code> or <code>str</code> to see the data type.)</h5>
</div>
<div id="these-columns-would-make-more-sense-as-logical-values-truefalsena.-1" class="section level5">
<h5>These columns would make more sense as logical values (TRUE/FALSE/NA).</h5>
</div>
<div id="write-a-function-called-transform_column-that-given-a-column-containing-lowercase-ts-and-fs-your-function-will-transform-it-to-logical-truefalsena-values.-note-that-na-values-for-these-columns-appear-as-blank-and-we-need-to-be-careful-when-transforming-the-data.-test-your-function-on-column-host_is_superhost.-1" class="section level5">
<h5>Write a function called <code>transform_column</code> that, given a column containing lowercase &quot;t&quot;s and &quot;f&quot;s, your function will transform it to logical (TRUE/FALSE/NA) values. Note that NA values for these columns appear as blank (<code>&quot;&quot;</code>), and we need to be careful when transforming the data. Test your function on column <code>host_is_superhost</code>.</h5>
<p><strong>Relevant topics:</strong> class, typeof, str, toupper, as.logical</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Chunk of code for your <code>transform_column</code> function.
</li>
<li>
Type of <code>transform_column(listings$host_is_superhost)</code>.
</li>
</ul>
</div>
</div>
<div id="solution-146" class="section level5">
<h5>Solution</h5>
<p>These 4 columns from <code>mynewbigDF</code> (which has the data for Canada) only have values <code>&quot;t&quot;, &quot;f&quot;, &quot;&quot;</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(mynewbigDF<span class="op">$</span>host_is_superhost)
<span class="kw">head</span>(mynewbigDF<span class="op">$</span>host_has_profile_pic)
<span class="kw">head</span>(mynewbigDF<span class="op">$</span>host_identity_verified)
<span class="kw">head</span>(mynewbigDF<span class="op">$</span>is_location_exact)</code></pre></div>
<p>Please note the 44 values of <code>&quot;&quot;</code> (which are easy to miss) In the first 3 out of 4 of these columns:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(mynewbigDF<span class="op">$</span>host_is_superhost)
<span class="kw">table</span>(mynewbigDF<span class="op">$</span>host_has_profile_pic)
<span class="kw">table</span>(mynewbigDF<span class="op">$</span>host_identity_verified)
<span class="kw">table</span>(mynewbigDF<span class="op">$</span>is_location_exact)</code></pre></div>
<p>These are all character vectors, which we can check using <code>class</code>, <code>typeof</code>, or <code>str</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(mynewbigDF<span class="op">$</span>host_is_superhost)
<span class="kw">class</span>(mynewbigDF<span class="op">$</span>host_has_profile_pic)
<span class="kw">class</span>(mynewbigDF<span class="op">$</span>host_identity_verified)
<span class="kw">class</span>(mynewbigDF<span class="op">$</span>is_location_exact)

<span class="kw">typeof</span>(mynewbigDF<span class="op">$</span>host_is_superhost)
<span class="kw">typeof</span>(mynewbigDF<span class="op">$</span>host_has_profile_pic)
<span class="kw">typeof</span>(mynewbigDF<span class="op">$</span>host_identity_verified)
<span class="kw">typeof</span>(mynewbigDF<span class="op">$</span>is_location_exact)

<span class="kw">str</span>(mynewbigDF<span class="op">$</span>host_is_superhost)
<span class="kw">str</span>(mynewbigDF<span class="op">$</span>host_has_profile_pic)
<span class="kw">str</span>(mynewbigDF<span class="op">$</span>host_identity_verified)
<span class="kw">str</span>(mynewbigDF<span class="op">$</span>is_location_exact)</code></pre></div>
<p>We have several ways to transform a column. For example, we could go element-by-element, and make substitutions, like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span>mynewbigDF<span class="op">$</span>host_is_superhost</code></pre></div>
<p>Here is the way that the values look at the start:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(v)
v[<span class="kw">toupper</span>(v)<span class="op">==</span><span class="st">&quot;T&quot;</span>] &lt;-<span class="st"> </span><span class="ot">TRUE</span>
v[<span class="kw">toupper</span>(v)<span class="op">==</span><span class="st">&quot;F&quot;</span>] &lt;-<span class="st"> </span><span class="ot">FALSE</span>
v[<span class="kw">toupper</span>(v)<span class="op">==</span><span class="st">&quot;&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></code></pre></div>
<p>and here are the values now:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(v)</code></pre></div>
<p>You might think that the <code>NA</code> values disappeared, but they just do not show up in the table by default. You can force them to appear, and then we see that the counts of the three values are the same as before.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(v, <span class="dt">useNA=</span><span class="st">&quot;always&quot;</span>)</code></pre></div>
<p>Here is the function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transform_column &lt;-<span class="st"> </span><span class="cf">function</span>(v) {
  v[<span class="kw">toupper</span>(v)<span class="op">==</span><span class="st">&quot;T&quot;</span>] &lt;-<span class="st"> </span><span class="ot">TRUE</span>
  v[<span class="kw">toupper</span>(v)<span class="op">==</span><span class="st">&quot;F&quot;</span>] &lt;-<span class="st"> </span><span class="ot">FALSE</span>
  v[<span class="kw">toupper</span>(v)<span class="op">==</span><span class="st">&quot;&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span>
  v
}</code></pre></div>
<p>We can try the function on <code>mynewbigDF$host_is_superhost</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">transform_column</span>(mynewbigDF<span class="op">$</span>host_is_superhost))
<span class="kw">table</span>(<span class="kw">transform_column</span>(mynewbigDF<span class="op">$</span>host_is_superhost))</code></pre></div>
<p>Another possibility is to make a map, in which we put the old values as the names, and the new values as the values in the vector:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mymap &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">NA</span>)
<span class="kw">names</span>(mymap) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;T&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;&quot;</span>)
<span class="kw">head</span>(mymap[<span class="kw">toupper</span>(mynewbigDF<span class="op">$</span>host_is_superhost)])</code></pre></div>
<p>and if you do not want the names to appear on the vector, you can remove them, like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">unname</span>(mymap[<span class="kw">toupper</span>(mynewbigDF<span class="op">$</span>host_is_superhost)]))</code></pre></div>
<p>Finally we can check the table of the results:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(mymap[<span class="kw">toupper</span>(mynewbigDF<span class="op">$</span>host_is_superhost)])</code></pre></div>
<p>This might seem strange, and if you do not like it, you can just use the solution given above. If you do like this, and want to wrap it into a function, we can write:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transform_column &lt;-<span class="st"> </span><span class="cf">function</span>(v) {
  mymap &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">NA</span>)
  <span class="kw">names</span>(mymap) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;T&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;&quot;</span>)
  <span class="kw">unname</span>(mymap[<span class="kw">toupper</span>(v)])
}</code></pre></div>
<p>and again we can try this new version of the function on <code>mynewbigDF$host_is_superhost</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">transform_column</span>(mynewbigDF<span class="op">$</span>host_is_superhost))
<span class="kw">table</span>(<span class="kw">transform_column</span>(mynewbigDF<span class="op">$</span>host_is_superhost))</code></pre></div>
</div>
<div id="create-a-histogram-for-response-rates-host_response_rate-for-super-hosts-where-host_is_superhost-is-true.-if-your-listings-do-not-contain-any-super-hosts-load-data-from-a-different-country.-note-that-we-first-need-to-convert-host_response_rate-from-a-character-containing-signs-to-a-numeric-variable." class="section level5">
<h5>5. Create a histogram for response rates (<code>host_response_rate</code>) for super hosts (where <code>host_is_superhost</code> is <code>TRUE</code>). If your listings do not contain any super hosts, load data from a different country. Note that we first need to convert <code>host_response_rate</code> from a character containing &quot;%&quot; signs to a numeric variable.</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-writing-functions">gsub</a>, as.numeric</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Chunk of code used to answer the question.
</li>
<li>
Histogram of response rates for super hosts.
</li>
</ul>
</div>
</div>
<div id="solution-147" class="section level5">
<h5>Solution</h5>
<p>Now we look at the Canada results, for which <code>host_is_superhost</code> is <code>TRUE</code>. We make a histogram of the <code>host_response_rate</code> for those values. To do this, we first get the <code>host_response_rate</code> values (for which <code>host_is_superhost</code> is <code>TRUE</code>)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myvalues &lt;-<span class="st"> </span>mynewbigDF<span class="op">$</span>host_response_rate[<span class="kw">transform_column</span>(mynewbigDF<span class="op">$</span>host_is_superhost) <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>]</code></pre></div>
<p>and then we remove the percentage symbols from <code>myvalues</code> and convert the character vector to numbers, and then finally make the histogram.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(<span class="kw">as.numeric</span>(<span class="kw">gsub</span>(<span class="st">&quot;%&quot;</span>, <span class="st">&quot;&quot;</span>, myvalues)))</code></pre></div>
<p>As a closing note, we could remove the check to see whether the inner values are <code>TRUE</code> because, by default, we will only exact the <code>TRUE</code> values when we do a lookup like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myvalues &lt;-<span class="st"> </span>mynewbigDF<span class="op">$</span>host_response_rate[<span class="kw">transform_column</span>(mynewbigDF<span class="op">$</span>host_is_superhost)]
<span class="kw">hist</span>(<span class="kw">as.numeric</span>(<span class="kw">gsub</span>(<span class="st">&quot;%&quot;</span>, <span class="st">&quot;&quot;</span>, myvalues)))</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p02-390" class="section level3">
<h3>Project 2</h3>
<hr />
<p><strong>Motivation:</strong> The ability to quickly reproduce an analysis is important. It is often necessary that other individuals will need to be able to understand and reproduce an analysis. This concept is so important there are classes solely on reproducible research! In fact, there are papers that investigate and highlight the lack of reproducibility in various fields. If you are interested in reading about this topic, a good place to start is the paper titled <a href="https://journals.plos.org/plosmedicine/article?id=10.1371/journal.pmed.0020124">&quot;Why Most Published Research Findings Are False&quot;</a>, by John Ioannidis (2005).</p>
<p><strong>Context:</strong> Making your work reproducible is extremely important. We will focus on the computational part of reproducibility. We will learn RMarkdown to document your analyses so others can easily understand and reproduce the computations that led to your conclusions. Pay close attention as future project templates will be RMarkdown templates.</p>
<p><strong>Scope:</strong> Understand Markdown, RMarkdown, and how to use it to make your data analysis reproducible.</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Use Markdown syntax within an Rmarkdown document to achieve various text transformations.
</li>
<li>
Use RMarkdown code chunks to display and/or run snippets of code.
</li>
</ul>
</div>
<div id="questions-28" class="section level4">
<h4>Questions</h4>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_8rsq5yrn&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_bjrv34ss">Click here for video</a></p>
<div id="make-the-following-text-including-the-asterisks-bold-this-needs-to-be-very-bold.-make-the-following-text-including-the-underscores-italicized-this-needs-to-be-_very_-italicized.-1" class="section level5">
<h5>1. Make the following text (including the asterisks) bold: <code>This needs to be **very** bold</code>. Make the following text (including the underscores) italicized: <code>This needs to be _very_ italicized.</code></h5>
<p><strong>Important note:</strong> Surround your answer in 4 backticks. This will allow you to display the markdown <em>without</em> having the markdown &quot;take effect&quot;. For example:</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">````
Some *marked* **up** text.
````</code></pre></div>
<p><strong>Hint:</strong> <em>Be sure to check out the <a href="https://rstudio.com/wp-content/uploads/2016/03/rmarkdown-cheatsheet-2.0.pdf">Rmarkdown Cheatsheet</a> and our section on <a href="https://thedatamine.github.io/the-examples-book/r.html#r-rmarkdown">Rmarkdown in the book</a>.</em></p>
<p><strong>Note:</strong> <em>Rmarkdown is essentially Markdown + the ability to run and display code chunks. In this question, we are actually using Markdown within Rmarkdown!</em></p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-rmarkdown">rmarkdown</a>, <a href="#escape-characters">escaping characters</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong> - 2 lines of markdown text, surrounded by 4 backticks. Note that when compiled, this text will be unmodified, regular text.
</p>
</div>
</div>
<div id="solution-148" class="section level5">
<h5>Solution</h5>
<p>We can achieve this style of text:</p>
<p><strong>This needs to be **very** bold</strong></p>
<p><em>This needs to be _very_ italicized.</em></p>
<p>by using this Markdown text:</p>
<pre><code>**This needs to be \*\*very\*\* bold**
_This needs to be \_very\_ italicized._</code></pre>
<p>The backslashes specify that we want the asterisks and underscores to appear.</p>
</div>
<div id="create-an-unordered-list-of-your-top-3-favorite-academic-interests-some-examples-could-include-machine-learning-operating-systems-forensic-accounting-etc..-create-another-ordered-list-that-ranks-your-academic-interests-in-order-of-most-interested-to-least-interested.-1" class="section level5">
<h5>2. Create an unordered list of your top 3 favorite academic interests (some examples could include: machine learning, operating systems, forensic accounting, etc.). Create another <em>ordered</em> list that ranks your academic interests in order of most interested to least interested.</h5>
<p><strong>Hint:</strong> <em>You can learn what ordered and unordered lists are <a href="https://rstudio.com/wp-content/uploads/2016/03/rmarkdown-cheatsheet-2.0.pdf">here</a>.</em></p>
<p><strong>Note:</strong> <em>Similar to (1), in this question we are dealing with Markdown. If we were to copy and paste the solution to this problem in a Markdown editor, it would be the same result as when we Knit it here.</em></p>
<p><strong>Relevant topics:</strong> <em><a href="r.html#r-rmarkdown">rmarkdown</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong> - Create the lists, this time don't surround your code in backticks. Note that when compiled, this text will appear as nice, formatted lists.
</p>
</div>
</div>
<div id="solution-149" class="section level5">
<h5>Solution</h5>
<p>An unordered list of my top 3 favorite academic interests is:</p>
<ul>
<li>asymptotic analysis of sequences</li>
<li>data science</li>
<li>analysis of algorithms</li>
</ul>
<p>An ordered list of my top 3 favorite academic interests is:</p>
<ol style="list-style-type: decimal">
<li>analysis of algorithms</li>
<li>asymptotic analysis of sequences</li>
<li>data science</li>
</ol>
</div>
<div id="browse-httpswww.linkedin.com-and-read-some-profiles.-pay-special-attention-to-accounts-with-an-about-section.-write-your-own-personal-about-section-using-markdown.-include-the-following-1" class="section level5">
<h5>3. Browse <a href="https://www.linkedin.com/" class="uri">https://www.linkedin.com/</a> and read some profiles. Pay special attention to accounts with an &quot;About&quot; section. Write your own personal &quot;About&quot; section using Markdown. Include the following:</h5>
<ul>
<li>A header for this section (your choice of size) that says &quot;About&quot;.</li>
<li>The text of your personal &quot;About&quot; section that you would feel comfortable uploading to linkedin, including at least 1 link.</li>
</ul>
<p><strong>Relevant topics:</strong> <em><a href="r.html#r-rmarkdown">rmarkdown</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong> - Create the described profile, don't surround your code in backticks.
</p>
</div>
</div>
<div id="solution-150" class="section level5">
<h5>Solution</h5>
</div>
<div id="about-1" class="section level5">
<h5>About</h5>
<p>I am Professor in Statistics and (by courtesy) of Mathematics and Public Health at Purdue University. My research is in probabilistic, combinatorial, and analytic techniques for the analysis of algorithms and data structures; I am also interested in science of information, game theory, and large-scale computation. I currently serve as</p>
<ul>
<li>Director of The Data Mine</li>
<li>Interim Co-Director of the Integrative Data Science Initiative</li>
<li>Principal Investigator for the Purdue Statistics Living Learning Community, funded by the National Science Foundation</li>
<li>Associate Director for the <a href="https://www.soihub.org">NSF Center for Science of Information</a> (now a core center in Purdue's Discovery Park)</li>
<li>Associate Director of the Actuarial Science Program ##### Solution</li>
</ul>
<p>The  equation is <span class="math display">\[P(A\ |\ B) = \frac{P(B\ |\ A)P(A)}{P(B)}\]</span></p>
</div>
<div id="latex-is-a-powerful-editing-tool-where-you-can-create-beautifully-formatted-equations-and-formulas.-replicate-the-equation-found-here-as-closely-as-possible." class="section level5">
<h5>4. LaTeX is a powerful editing tool where you can create beautifully formatted equations and formulas. Replicate the equation found <a href="https://wikimedia.org/api/rest_v1/media/math/render/svg/87c061fe1c7430a5201eef3fa50f9d00eac78810">here</a> as closely as possible.</h5>
<p><strong>Hint:</strong> <em>Lookup &quot;latex mid&quot; and &quot;latex frac&quot;.</em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Replicate the equation using LaTeX under the Question 4 header in your template.
</li>
</ul>
</div>
</div>
<div id="solution-151" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_variable &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</code></pre></div>
<p>*** All About the Iris Dataset</p>
<p>This paper goes into detail about the <code>iris</code> dataset that is built into r. You can find a list of built-in datasets by visiting <a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/00Index.html">the R datasets index</a> or by running the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>()</code></pre></div>
<p>The iris dataset has 5 columns. You can get the names of the columns by running the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(iris)</code></pre></div>
<pre><code>## [1] &quot;Sepal.Length&quot; &quot;Sepal.Width&quot;  &quot;Petal.Length&quot; &quot;Petal.Width&quot;  &quot;Species&quot;</code></pre>
<p>Alternatively, you could just run the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris</code></pre></div>
<p>The second option provides more detail about the dataset.</p>
<p>According to <a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/iris.html">the R iris help page</a> there is another dataset built-in to <code>R</code> called <code>iris3</code>. This dataset is 3 dimensional instead of 2 dimensional.</p>
<p>An iris is a really pretty flower. You can see a picture of one <a href="https://www.gardenia.net/storage/app/public/guides/detail/83847060_mOptimized.jpg">here</a>:</p>
<p>In summary. I really like irises, and there is a dataset in <code>R</code> called <code>iris</code>.</p>
</div>
<div id="your-co-worker-wrote-a-report-and-has-asked-you-to-beautify-it.-knowing-rmarkdown-you-agreed.-make-improvements-to-this-section.-at-a-minimum-1" class="section level5">
<h5>5. Your co-worker wrote a report, and has asked you to beautify it. Knowing Rmarkdown, you agreed. Make improvements to this section. At a minimum:</h5>
<ul>
<li>Make the title pronounced.</li>
<li>Make all links appear as a word or words, rather than the long-form URL.</li>
<li>Organize all code into code chunks where code and output are displayed. If the output is really long, just display the code.</li>
<li>Make the calls to the <code>library</code> function be evaluated but not displayed.</li>
<li>Make sure all warnings and errors that may eventually occur, do not appear in the final document.</li>
</ul>
<p>Feel free to make any other changes that make the report more visually pleasing.</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{r my-load-packages}
library(ggplot2)
```

```{r declare-variable-390, eval=FALSE}
my_variable &lt;- c(1,2,3)
```

All About the Iris Dataset

This paper goes into detail about the <span class="bn">`iris`</span> dataset that is built into r. You can find a list of built-in datasets by visiting https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/00Index.html or by running the following code:

data()

The iris dataset has 5 columns. You can get the names of the columns by running the following code:

names(iris)

Alternatively, you could just run the following code:

iris

The second option provides more detail about the dataset.

According to https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/iris.html there is another dataset built-in to r called <span class="bn">`iris3`</span>. This dataset is 3 dimensional instead of 2 dimensional.

An iris is a really pretty flower. You can see a picture of one here:

https://www.gardenia.net/storage/app/public/guides/detail/83847060_mOptimized.jpg

In summary. I really like irises, and there is a dataset in r called <span class="bn">`iris`</span>.</code></pre></div>
<p><strong>Relevant topics:</strong> <em><a href="r.html#r-rmarkdown">rmarkdown</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Make improvements to this section, and place it all under the Question 5 header in your template.
</li>
</ul>
</div>
</div>
<div id="solution-152" class="section level5">
<h5>Solution</h5>
<p>Here are the <code>Sepal.Length</code> values from the <code>iris</code> data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(iris<span class="op">$</span>Sepal.Length, <span class="dt">main=</span><span class="st">&quot;Iris Sepal Lengths&quot;</span>)</code></pre></div>
<p><img src="the-datamine-examples_files/figure-html/unnamed-chunk-1441-1.png" width="672" /></p>
</div>
<div id="create-a-plot-using-a-built-in-dataset-like-iris-mtcars-or-titanic-and-display-the-plot-using-a-code-chunk.-make-sure-the-code-used-to-generate-the-plot-is-hidden.-include-a-descriptive-caption-for-the-image.-make-sure-to-use-an-rmarkdown-chunk-option-to-create-the-caption.-1" class="section level5">
<h5>6. Create a plot using a built-in dataset like <code>iris</code>, <code>mtcars</code>, or <code>Titanic</code>, and display the plot using a code chunk. Make sure the code used to generate the plot is hidden. Include a descriptive caption for the image. Make sure to use an RMarkdown chunk option to create the caption.</h5>
<p><strong>Relevant topics:</strong> <em><a href="r.html#r-rmarkdown">rmarkdown</a>, <a href="r.html#r-plotting">plotting in r</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Code chunk under that creates and displays a plot using a built-in dataset like <code>iris</code>, <code>mtcars</code>, or <code>Titanic</code>.
</li>
</ul>
</div>
</div>
<div id="insert-the-following-code-chunk-under-the-question-7-header-in-your-template.-try-knitting-the-document.-two-things-will-go-wrong.-what-is-the-first-problem-what-is-the-second-problem" class="section level5">
<h5>7. Insert the following code chunk under the Question 7 header in your template. Try knitting the document. Two things will go wrong. What is the first problem? What is the second problem?</h5>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{r my-load-packages}
plot(my_variable)
```</code></pre></div>
<p><strong>Hint:</strong> <em>Take a close look at the name we give our code chunk.</em></p>
<p><strong>Hint:</strong> <em>Take a look at the code chunk where <code>my_variable</code> is declared.</em></p>
<p><strong>Relevant topics:</strong> <em><a href="r.html#r-rmarkdown">rmarkdown</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The modified version of the inserted code that fixes both problems.
</li>
<li>
A sentence explaining what the first problem was.
</li>
<li>
A sentence explaining what the second problem was.
</li>
</ul>
</div>
</div>
<div id="solution-153" class="section level5">
<h5>Solution</h5>
<p>We needed to change the section title from <code>install-packages</code> to a new name, since we already had a section with this same title.</p>
<p>In the section called <code>declare-variable</code>, we had <code>eval=F</code>, and as a result, the variable <code>my_variable</code> was never declared. So we removed the option <code>eval=F</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(my_variable)</code></pre></div>
</div>
<div id="for-project-2-please-submit-your-.rmd-file-and-the-resulting-.pdf-file.-for-this-project-you-do-not-need-to-submit-a-.r-file.-1" class="section level5">
<h5>For Project 2, please submit your .Rmd file and the resulting .pdf file. (For this project, you do not need to submit a .R file.)</h5>
</div>
<div id="optional-question.-rmarkdown-is-also-an-excellent-tool-to-create-a-slide-deck.-use-the-information-here-or-here-to-convert-your-solutions-into-a-slide-deck-rather-than-the-regular-pdf.-you-may-experiment-with-slidy-ioslides-or-beamer-however-make-your-final-set-of-solutions-use-beamer-as-the-output-is-a-pdf.-make-any-needed-modifications-to-make-the-solutions-knit-into-a-well-organized-slide-deck-for-example-include-slide-breaks-and-make-sure-the-contents-are-shown-completely..-modify-2-so-the-bullets-are-incrementally-presented-as-the-slides-progress." class="section level5">
<h5>OPTIONAL QUESTION. RMarkdown is also an excellent tool to create a slide deck. Use the information <a href="https://rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf">here</a> or <a href="https://thedatamine.github.io/the-examples-book/r.html#how-do-i-create-a-set-of-slides-using-rmarkdown">here</a> to convert your solutions into a slide deck rather than the regular PDF. You may experiment with <code>slidy</code>, <code>ioslides</code> or <code>beamer</code>, however, make your final set of solutions use <code>beamer</code> as the output is a PDF. Make any needed modifications to make the solutions knit into a well-organized slide deck (For example, include slide breaks and make sure the contents are shown completely.). Modify (2) so the bullets are incrementally presented as the slides progress.</h5>
<p><strong>Important note:</strong> You do <em>not</em> need to submit the original PDF for this project, just the <code>beamer</code> slide version of the PDF.</p>
<p><strong>Relevant topics:</strong> <em><a href="r.html#r-rmarkdown">rmarkdown</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The modified version of the solutions in <code>beamer</code> slide form.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p03-390" class="section level3">
<h3>Project 3</h3>
<hr />
<p><strong>Motivation:</strong> The ability to navigate a shell, like <code>bash</code>, and use some of its powerful tools, is very useful. The number of disciplines utilizing data in new ways is ever-growing, and as such, it is very likely that many of you will eventually encounter a scenario where knowing your way around a terminal will be useful. We want to expose you to some of the most useful <code>bash</code> tools, help you navigate a filesystem, and even run <code>bash</code> tools from within an RMarkdown file in RStudio.</p>
<p><strong>Context:</strong> At this point in time, you will each have varying levels of familiarity with Scholar. In this project we will learn how to use the terminal to navigate a UNIX-like system, experiment with various useful commands, and learn how to execute bash commands from within RStudio in an RMarkdown file.</p>
<p><strong>Scope:</strong> bash, RStudio</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Distinguish differences in /home, /scratch, and /class.
</li>
<li>
Navigating UNIX via a terminal: ls, pwd, cd, ., .., ~, etc.
</li>
<li>
Analyzing file in a UNIX filesystem: wc, du, cat, head, tail, etc.
</li>
<li>
Creating and destroying files and folder in UNIX: scp, rm, touch, cp, mv, mkdir, rmdir, etc.
</li>
<li>
Utilize other Scholar resources: rstudio.scholar.rcac.purdue.edu, notebook.scholar.rcac.purdue.edu, desktop.scholar.rcac.purdue.edu, etc.
</li>
<li>
Use <code>man</code> to read and learn about UNIX utilities.
</li>
<li>
Run <code>bash</code> commands from within and RMarkdown file in RStudio.
</li>
</ul>
</div>
<p>There are a variety of ways to connect to Scholar. In this class, we will <em>primarily</em> connect to RStudio Server by opening a browser and navigating to <a href="https://rstudio.scholar.rcac.purdue.edu/" class="uri">https://rstudio.scholar.rcac.purdue.edu/</a>, entering credentials, and using the excellent RStudio interface.</p>
<p>Here is a video to remind you about some of the basic tools you can use in UNIX/Linux:</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_9mz5s0wd&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_0y4x1feo">Click here for video</a></p>
<p>This is the easiest book for learning this stuff; it is short and gets right to the point:</p>
<p><a href="https://go.oreilly.com/purdue-university/library/view/-/0596002610" class="uri">https://go.oreilly.com/purdue-university/library/view/-/0596002610</a></p>
<p>you just log in and you can see it all; we suggest Chapters 1, 3, 4, 5, 7 (you can basically skip chapters 2 and 6 the first time through).</p>
<p>It is a very short read (maybe, say, 2 or 3 hours altogether?), just a thin book that gets right to the details.</p>
<div id="navigate-to-httpsrstudio.scholar.rcac.purdue.edu-and-login.-take-some-time-to-click-around-and-explore-this-tool.-we-will-be-writing-and-running-python-r-sql-and-bash-all-from-within-this-interface.-navigate-to-tools-global-options-....-explore-this-interface-and-make-at-least-2-modifications.-list-what-you-changed.-1" class="section level5">
<h5>1. Navigate to <a href="https://rstudio.scholar.rcac.purdue.edu/" class="uri">https://rstudio.scholar.rcac.purdue.edu/</a> and login. Take some time to click around and explore this tool. We will be writing and running Python, R, SQL, and <code>bash</code> all from within this interface. Navigate to <code>Tools &gt; Global Options ...</code>. Explore this interface and make at least 2 modifications. List what you changed.</h5>
<p>Here are some changes Kevin likes:</p>
<ul>
<li>Uncheck &quot;Restore .Rdata into workspace at startup&quot;.</li>
<li>Change tab width 4.</li>
<li>Check &quot;Soft-wrap R source files&quot;.</li>
<li>Check &quot;Highlight selected line&quot;.</li>
<li>Check &quot;Strip trailing horizontal whitespace when saving&quot;.</li>
<li>Uncheck &quot;Show margin&quot;.</li>
</ul>
<p>(Dr Ward does not like to customize his own environment, but he does use the emacs key bindings: Tools &gt; Global Options &gt; Code &gt; Keybindings, but this is only recommended if you already know emacs.)</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
List of modifications you made to your Global Options.
</li>
</ul>
</div>
</div>
<div id="solution-154" class="section level5">
<h5>Solution</h5>
<p>Here are some changes Kevin likes:</p>
<ul>
<li>Uncheck &quot;Restore .Rdata into workspace at startup&quot;.</li>
<li>Change tab width 4.</li>
<li>Check &quot;Soft-wrap R source files&quot;.</li>
<li>Check &quot;Highlight selected line&quot;.</li>
<li>Check &quot;Strip trailing horizontal whitespace when saving&quot;.</li>
<li>Uncheck &quot;Show margin&quot;.</li>
</ul>
</div>
<div id="there-are-four-primary-panes-each-with-various-tabs.-in-one-of-the-panes-there-will-be-a-tab-labeled-terminal.-click-on-that-tab.-this-terminal-by-default-will-run-a-bash-shell-right-within-scholar-the-same-as-if-you-connected-to-scholar-using-thinlinc-and-opened-a-terminal.-very-convenient-1" class="section level5">
<h5>2. There are four primary panes, each with various tabs. In one of the panes there will be a tab labeled &quot;Terminal&quot;. Click on that tab. This terminal by default will run a <code>bash</code> shell right within Scholar, the same as if you connected to Scholar using ThinLinc, and opened a terminal. Very convenient!</h5>
</div>
<div id="what-is-the-default-directory-of-your-bash-shell-1" class="section level5">
<h5>What is the default directory of your bash shell?</h5>
<p><strong>Hint:</strong> Start by reading the section on <code>man</code>. <code>man</code> stands for manual, and you can find the &quot;official&quot; documentation for the command by typing <code>man &lt;command_of_interest&gt;</code>. For example:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># read the manual for the `man` command</span>
<span class="co"># use &quot;k&quot; or the up arrow to scroll up, &quot;j&quot; or the down arrow to scroll down</span>
<span class="fu">man</span> man </code></pre></div>
<p><strong>Relevant topics:</strong> <a href="unix.html#man">man</a>, <a href="unix.html#pwd">pwd</a>, <a href="unix.html#dots">~</a>, <a href="unix.html#dots">..</a>, <a href="unix.html#dots">.</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The full filepath of default directory (home directory). Ex: Kevin's is: <code>/home/kamstut</code>
</li>
<li>
The <code>bash</code> code used to show your home directory or current directory (also known as the working directory) when the <code>bash</code> shell is first launched.
</li>
</ul>
</div>
</div>
<div id="solution-155" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># whatever is stored in the $HOME environment variable </span>
<span class="co"># is what ~ represents</span>
<span class="bu">cd</span> ~
<span class="bu">pwd</span>

<span class="co"># if we change $HOME, ~ changes too!</span>
<span class="va">HOME=</span>/home/kamstut/projects
<span class="bu">cd</span> ~
<span class="bu">pwd</span>

<span class="co"># if other users on the linux system share certain files or folders</span>
<span class="co"># in their home directory, you can access their home folder similarly</span>
<span class="fu">ls</span> ~mdw

<span class="co"># but they _have_ to give you permissions </span></code></pre></div>
</div>
<div id="learning-to-navigate-away-from-our-home-directory-to-other-folders-and-back-again-is-vital.-perform-the-following-actions-in-order-1" class="section level5">
<h5>3. Learning to navigate away from our home directory to other folders, and back again, is vital. Perform the following actions, in order:</h5>
<ul>
<li>Write a single command to navigate to the folder containing our full datasets: <code>/class/datamine/data</code>.</li>
<li>Write a command to confirm you are in the correct folder.</li>
<li>Write a command to list the files and directories within the data directory. (You do not need to recursively list subdirectories and files contained therein.) What are the names of the files and directories?</li>
<li>Write another command to return back to your home directory.</li>
<li>Write a command to confirm you are in the correct folder.</li>
</ul>
<p>Note: <code>/</code> is commonly referred to as the root directory in a linux/unix filesystem. Think of it as a folder that contains <em>every</em> other folder in the computer. <code>/home</code> is a folder within the root directory. <code>/home/kamstut</code> is the full filepath of Kevin's home directory. There is a folder <code>home</code> inside the root directory. Inside <code>home</code> is another folder named <code>kamstut</code> which is Kevin's home directory.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#man">man</a>, <a href="unix.html#cd">cd</a>, <a href="unix.html#pwd">pwd</a>, <a href="unix.html#ls">ls</a>, <a href="unix.html#dots">~</a>, <a href="unix.html#dots">..</a>, <a href="unix.html#dots">.</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Command used to navigate to the data directory.
</li>
<li>
Command used to confirm you are in the data directory.
</li>
<li>
Command used to list files and folders.
</li>
<li>
List of files and folders in the data directory.
</li>
<li>
Command used to navigate back to the home directory.
</li>
<li>
Commnad used to confirm you are in the home directory.
</li>
</ul>
</div>
</div>
<div id="solution-156" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># navigate to the data directory using `cd` (change directory)</span>
<span class="bu">cd</span> /class/datamine/data

<span class="co"># confirm the location using `pwd` (print working directory)</span>
<span class="bu">pwd</span>

<span class="co"># list files</span>
<span class="fu">ls</span>

<span class="co"># cd without any arguments automatically returns to the directory</span>
<span class="co"># saved in the $HOME environment variable</span>
<span class="bu">cd</span>

<span class="co"># another trick, if you wanted to _quickly_ return to the data </span>
<span class="co"># directory, or most recent directory is the following (uncommented)</span>
<span class="bu">cd</span> ~-

<span class="co"># confirm the location using pwd</span>
<span class="bu">pwd</span></code></pre></div>
</div>
<div id="lets-learn-about-two-more-important-concepts.-.-refers-to-the-current-working-directory-or-the-directory-displayed-when-you-run-pwd.-unlike-pwd-you-can-use-this-when-navigating-the-filesystem-so-for-example-if-you-wanted-to-see-the-contents-of-a-file-called-my_file.txt-that-lives-in-homekamstut-so-a-full-path-of-homekamstutmy_file.txt-and-you-are-currently-in-homekamstut-you-could-run-cat-.my_file.txt.-1" class="section level5">
<h5>4. Let's learn about two more important concepts. <code>.</code> refers to the current working directory, or the directory displayed when you run <code>pwd</code>. Unlike <code>pwd</code> you can use this when navigating the filesystem! So, for example, if you wanted to see the contents of a file called <code>my_file.txt</code> that lives in <code>/home/kamstut</code> (so, a full path of <code>/home/kamstut/my_file.txt</code>), and you are currently in <code>/home/kamstut</code>, you could run: <code>cat ./my_file.txt</code>.</h5>
</div>
<div id="represents-the-parent-folder-or-the-folder-in-which-your-current-folder-is-contained.-so-lets-say-i-was-in-homekamstutprojects-and-i-wanted-to-get-the-contents-of-the-file-homekamstutmy_file.txt.-you-could-do-cat-..my_file.txt.-1" class="section level5">
<h5><code>..</code> represents the parent folder or the folder in which your current folder is contained. So let's say I was in <code>/home/kamstut/projects/</code> and I wanted to get the contents of the file <code>/home/kamstut/my_file.txt</code>. You could do: <code>cat ../my_file.txt</code>.</h5>
</div>
<div id="when-you-navigate-a-directory-tree-using-.-and-..-you-create-paths-that-are-called-relative-paths-because-they-are-relative-to-your-current-directory.-alternatively-a-full-path-or-absolute-path-is-the-path-starting-from-the-root-directory.-so-homekamstutmy_file.txt-is-the-absolute-path-for-my_file.txt-and-..my_file.txt-is-a-relative-path.-perform-the-following-actions-in-order-1" class="section level5">
<h5>When you navigate a directory tree using <code>.</code> and <code>..</code> you create paths that are called <em>relative</em> paths because they are <em>relative</em> to your current directory. Alternatively, a <em>full</em> path or (<em>absolute</em> path) is the path starting from the root directory. So <code>/home/kamstut/my_file.txt</code> is the <em>absolute</em> path for <code>my_file.txt</code> and <code>../my_file.txt</code> is a <em>relative</em> path. Perform the following actions, in order:</h5>
<ul>
<li>Write a single command to navigate to the data directory.</li>
<li>Write a single command to navigate back to your home directory using a <em>relative</em> path. Do not use <code>~</code> or the <code>cd</code> command without a path argument.</li>
</ul>
<p><strong>Relevant topics:</strong> <a href="unix.html#man">man</a>, <a href="unix.html#cd">cd</a>, <a href="unix.html#pwd">pwd</a>, <a href="unix.html#ls">ls</a>, <a href="unix.html#dots">~</a>, <a href="unix.html#dots">..</a>, <a href="unix.html#dots">.</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Command used to navigate to the data directory.
</li>
<li>
Command used to navigate back to your home directory that uses a <em>relative</em> path.
</li>
</ul>
</div>
</div>
<div id="solution-157" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="bu">cd</span> /class/datamine/data
<span class="bu">pwd</span>
<span class="bu">cd</span> ../../../home/kamstut
<span class="bu">pwd</span></code></pre></div>
</div>
<div id="in-scholar-when-you-want-to-deal-with-really-large-amounts-of-data-you-want-to-access-scratch-you-can-read-more-here.-your-scratch-directory-on-scholar-is-located-here-scratchscholaruser.-user-is-an-environment-variable-containing-your-username.-test-it-out-echo-scratchscholaruser.-perform-the-following-actions-1" class="section level5">
<h5>5. In Scholar, when you want to deal with <em>really</em> large amounts of data, you want to access scratch (you can read more <a href="https://www.rcac.purdue.edu/policies/scholar/">here</a>). Your scratch directory on Scholar is located here: <code>/scratch/scholar/$USER</code>. <code>$USER</code> is an environment variable containing your username. Test it out: <code>echo /scratch/scholar/$USER</code>. Perform the following actions:</h5>
<ul>
<li>Navigate to your scratch directory.</li>
<li>Confirm you are in the correct location.</li>
<li>Execute <code>myquota</code>.</li>
<li>Find the location of the <code>myquota</code> bash script.</li>
<li>Output the first 5 and last 5 lines of the bash script.</li>
<li>Count the number of lines in the bash script.</li>
<li>How many kilobytes is the script?</li>
</ul>
<p><strong>Hint:</strong> You could use each of the commands in the relevant topics once.</p>
<p><strong>Hint:</strong> When you type <code>myquota</code> on Scholar there are sometimes two warnings about <code>xauth</code> but sometimes there are no warnings. If you get a warning that says <code>Warning: untrusted X11 forwarding setup failed: xauth key data not generated</code> it is safe to ignore this error.</p>
<p><strong>Hint:</strong> Commands often have <em>options</em>. <em>Options</em> are features of the program that you can trigger specifically. You can see the <em>options</em> of a command in the <code>DESCRIPTION</code> section of the <code>man</code> pages. For example: <code>man wc</code>. You can see <code>-m</code>, <code>-l</code>, and <code>-w</code> are all options for <code>wc</code>. To test this out:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># using the default wc command. &quot;/class/datamine/data/flights/1987.csv&quot; is the first &quot;argument&quot; given to the command.</span>
<span class="fu">wc</span> /class/datamine/data/flights/1987.csv
<span class="co"># to count the lines, use the -l option</span>
<span class="fu">wc</span> -l /class/datamine/data/flights/1987.csv
<span class="co"># to count the words, use the -w option</span>
<span class="fu">wc</span> -w /class/datamine/data/flights/1987.csv
<span class="co"># you can combine options as well</span>
<span class="fu">wc</span> -w -l /class/datamine/data/flights/1987.csv
<span class="co"># some people like to use a single tack `-`</span>
<span class="fu">wc</span> -wl /class/datamine/data/flights/1987.csv
<span class="co"># order doesn&#39;t matter</span>
<span class="fu">wc</span> -lw /class/datamine/data/flights/1987.csv</code></pre></div>
<p><strong>Hint:</strong> The <code>-h</code> option for the <code>du</code> command is useful.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#cd">cd</a>, <a href="unix.html#pwd">pwd</a>, <a href="unix.html#type">type</a>, <a href="unix.html#head">head</a>, <a href="unix.html#tail">tail</a>, <a href="unix.html#wc">wc</a>, <a href="unix.html#du">du</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Command used to navigate to your scratch directory.
</li>
<li>
Command used to confirm your location.
</li>
<li>
Output of <code>myquota</code>.
</li>
<li>
Command used to find the location of the <code>myquota</code> script.
</li>
<li>
Absolute path of the <code>myquota</code> script.
</li>
<li>
Command used to output the first 5 lines of the <code>myquota</code> script.
</li>
<li>
Command used to output the last 5 lines of the <code>myquota</code> script.
</li>
<li>
Command used to find the number of lines in the <code>myquota</code> script.
</li>
<li>
Number of lines in the script.
</li>
<li>
Command used to find out how many kilobytes the script is.
</li>
<li>
Number of kilobytes that the script takes up.
</li>
</ul>
</div>
</div>
<div id="solution-158" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># navigate to my scratch folder</span>
<span class="bu">cd</span> /scratch/scholar/<span class="va">$USER</span>

<span class="co"># confirm</span>
<span class="bu">pwd</span>

<span class="co"># what is my quota, execute the myquota script</span>
<span class="ex">myquota</span>

<span class="co"># get the location of the myquota script</span>
<span class="bu">type</span> myquota

<span class="co"># get the first 5 lines of the myquota script</span>
<span class="fu">head</span> /usr/local/bin/myquota

<span class="co"># get the last 5 lines of the myquota script</span>
<span class="fu">tail</span> /usr/local/bin/myquota

<span class="co"># get the number of lines in the myquota script</span>
<span class="fu">wc</span> -l /usr/local/bin/myquota

<span class="co"># get the number of kilobytes of teh myquota script</span>
<span class="fu">du</span> -h --apparent-size /usr/local/bin/myquota
<span class="fu">ls</span> -la /usr/local/bin/myquota</code></pre></div>
</div>
<div id="perform-the-following-operations-1" class="section level5">
<h5>6. Perform the following operations:</h5>
<ul>
<li>Navigate to your scratch directory.</li>
<li>Copy and paste the file: <code>/class/datamine/data/flights/1987.csv</code> to your current directory (scratch).</li>
<li>Create a new directory called <code>my_test_dir</code> in your scratch folder.</li>
<li>Move the file you copied to your scratch directory, into your new folder.</li>
<li>Use <code>touch</code> to create an empty file named <code>im_empty.txt</code> in your scratch folder.</li>
<li>Remove the directory <code>my_test_dir</code> <em>and</em> the contents of the directory.</li>
<li>Remove the <code>im_empty.txt</code> file.</li>
</ul>
<p><strong>Hint:</strong> <code>rmdir</code> may not be able to do what you think, instead, check out the options for <code>rm</code> using <code>man rm</code>.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#cd">cd</a>, <a href="unix.html#cp">cp</a>, <a href="unix.html#mv">mv</a>, mkdir, touch, rmdir, rm</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Command used to navigate to your scratch directory.
</li>
<li>
Command used to copy the file, <code>/class/datamine/data/flights/1987.csv</code> to your current directory (scratch).
</li>
<li>
Command used to create a new directory called <code>my_test_dir</code> in your scratch folder.
</li>
<li>
Command used to move the file you copied earlier <code>1987.csv</code> into your new <code>my_test_dir</code> folder.
</li>
<li>
Command used to create an empty file named <code>im_empty.txt</code> in your scratch folder.
</li>
<li>
Command used to remove the directory <em>and</em> the contents of the directory <code>my_test_dir</code>.
</li>
<li>
Command used to remove the <code>im_empty.txt</code> file.
</li>
</ul>
</div>
</div>
<div id="solution-159" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># navigate to the scratch folder</span>
<span class="bu">cd</span> /scratch/scholar/<span class="va">$USER</span>

<span class="co"># copy the 1987.csv file to the current directory (scratch)</span>
<span class="fu">cp</span> /class/datamine/data/flights/1987.csv .

<span class="co"># make a directory in the scratch directory called `my_test_dir`</span>
<span class="fu">mkdir</span> my_test_dir

<span class="co"># move 1987.csv to the new folder</span>
<span class="fu">mv</span> 1987.csv my_test_dir

<span class="co"># create an empty file in the scratch folder</span>
<span class="fu">touch</span> im_empty.txt

<span class="co"># remove the directory and the contents of the directory</span>
<span class="fu">rm</span> -r my_test_dir

<span class="co"># remove the im_empty.txt file</span>
<span class="fu">rm</span> im_empty.txt</code></pre></div>
</div>
<div id="please-include-a-statement-in-project-3-that-says-i-acknowledge-that-the-stat-190002900039000-1-credit-data-mine-seminar-will-be-recorded-and-posted-on-piazza-for-participants-in-this-course.-or-if-you-disagree-with-this-statement-please-consult-with-us-at-dataminepurdue.edu-for-an-alternative-plan.-2" class="section level5">
<h5>7. Please include a statement in Project 3 that says, &quot;I acknowledge that the STAT 19000/29000/39000 1-credit Data Mine seminar will be recorded and posted on Piazza, for participants in this course.&quot; or if you disagree with this statement, please consult with us at <a href="mailto:datamine@purdue.edu">datamine@purdue.edu</a> for an alternative plan.</h5>
<hr />
</div>
</div>
<div id="fall2020-p04-390" class="section level3">
<h3>Project 4</h3>
<hr />
<p><strong>Motivation:</strong> The need to search files and datasets based on the text held within is common during various parts of the data wrangling process. <code>grep</code> is an extremely powerful UNIX tool that allows you to do so using regular expressions. Regular expressions are a structured method for searching for specified patterns. Regular expressions can be very complicated, <a href="https://blog.cloudflare.com/details-of-the-cloudflare-outage-on-july-2-2019/">even professionals can make critical mistakes</a>. With that being said, learning some of the basics is an incredible tool that will come in handy regardless of the language you are working in.</p>
<p><strong>Context:</strong> We've just begun to learn the basics of navigating a file system in UNIX using various terminal commands. Now we will go into more depth with one of the most useful command line tools, <code>grep</code>, and experiment with regular expressions using <code>grep</code>, R, and later on, Python.</p>
<p><strong>Scope:</strong> grep, regular expression basics, utilizing regular expression tools in R and Python</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Use <code>grep</code> to search for patterns within a dataset.
</li>
<li>
Use <code>cut</code> to section off and slice up data from the command line.
</li>
<li>
Use <code>wc</code> to count the number of lines of input.
</li>
</ul>
</div>
<p>You can find useful examples that walk you through relevant material in The Examples Book:</p>
<p><a href="https://thedatamine.github.io/the-examples-book" class="uri">https://thedatamine.github.io/the-examples-book</a></p>
<p>It is highly recommended to read through, search, and explore these examples to help solve problems in this project.</p>
<p><strong>Important note:</strong> I would highly recommend using single quotes <code>'</code> to surround your regular expressions. Double quotes can have unexpected behavior due to some shell's expansion rules. In addition, pay close attention to <a href="faqs.html#faq-escape-characters">escaping</a> certain <a href="https://unix.stackexchange.com/questions/20804/in-a-regular-expression-which-characters-need-escaping">characters</a> in your regular expressions.</p>
<div id="dataset-28" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/movies_and_tv/the_office_dialogue.csv</code></p>
<p>A public sample of the data can be found here: <a href="https://www.datadepot.rcac.purdue.edu/datamine/data/movies-and-tv/the_office_dialogue.csv">the_office_dialogue.csv</a></p>
<p>Answers to questions should all be answered using the full dataset located on Scholar. You may use the public samples of data to experiment with your solutions prior to running them using the full dataset.</p>
<p><code>grep</code> stands for (g)lobally search for a (r)egular (e)xpression and (p)rint matching lines. As such, to best demonstrate <code>grep</code>, we will be using it with textual data. You can read about and see examples of <code>grep</code> <a href="https://thedatamine.github.io/the-examples-book/unix.html#grep">here</a>.</p>
<div id="login-to-scholar-and-use-grep-to-find-the-dataset-we-will-use-this-project.-the-dataset-we-will-use-is-the-only-dataset-to-have-the-text-bears.-beets.-battlestar-galactica..-what-is-the-name-of-the-dataset-and-where-is-it-located" class="section level5">
<h5>1. Login to Scholar and use <code>grep</code> to find the dataset we will use this project. The dataset we will use is the only dataset to have the text &quot;Bears. Beets. Battlestar Galactica.&quot;. What is the name of the dataset and where is it located?</h5>
<p><strong>Relevant topics:</strong> <a href="unix.html#grep">grep</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The <code>grep</code> command used to find the dataset.
</li>
<li>
The name and location in Scholar of the dataset.
</li>
<li>
Use <code>grep</code> and <code>grepl</code> within R to solve a data-driven problem.
</li>
</ul>
</div>
</div>
<div id="solution-160" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">grep</span> -Ri <span class="st">&quot;bears. beets. battlestar galactica.&quot;</span> /class/datamine </code></pre></div>
<p><code>/class/datamine/data/the_office/the_office_dialogue.csv</code></p>
</div>
<div id="grep-prints-the-line-that-the-text-you-are-searching-for-appears-in.-in-project-3-we-learned-a-unix-command-to-quickly-print-the-first-n-lines-from-a-file.-use-this-command-to-get-the-headers-for-the-dataset.-as-you-can-see-each-line-in-the-tv-show-is-a-row-in-the-dataset.-you-can-count-to-see-which-column-the-various-bits-of-data-live-in.-1" class="section level5">
<h5>2. <code>grep</code> prints the line that the text you are searching for appears in. In project 3 we learned a UNIX command to quickly print the first <em>n</em> lines from a file. Use this command to get the headers for the dataset. As you can see, each line in the tv show is a row in the dataset. You can count to see which column the various bits of data live in.</h5>
</div>
<div id="write-a-line-of-unix-commands-that-searches-for-bears.-beets.-battlestar-galactica.-and-rather-than-printing-the-entire-line-prints-only-the-character-who-speaks-the-line-as-well-as-the-line-itself.-1" class="section level5">
<h5>Write a line of UNIX commands that searches for &quot;bears. beets. battlestar galactica.&quot; and, rather than printing the entire line, prints only the character who speaks the line, as well as the line itself.</h5>
<p><strong>Hint:</strong> <em>The result if you were to search for &quot;bears. beets. battlestar galactica.&quot; should be:</em></p>
<pre class="txt"><code>&quot;Jim&quot;,&quot;Fact. Bears eat beets. Bears. Beets. Battlestar Galactica.&quot;</code></pre>
<p><strong>Hint:</strong> <em>One method to solve this problem would be to <a href="https://thedatamine.github.io/the-examples-book/unix.html#piping-and-redirection">pipe</a> the output from <code>grep</code> to <a href="https://thedatamine.github.io/the-examples-book/unix.html#cut"><code>cut</code></a>.</em></p>
<p><strong>Relevant topics:</strong> <a href="unix.html#cut">cut</a>, <a href="unix.html#grep">grep</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The line of UNIX commands used to find the character and original dialogue line that contains &quot;bears. beets. battlestar galactica.&quot;.
</li>
</ul>
</div>
</div>
<div id="solution-161" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">grep</span> -i <span class="st">&quot;bears. beets. battlestar galactica.&quot;</span> /class/datamine/data/movies_and_tv/the_office_dialogue.csv <span class="kw">|</span> <span class="fu">cut</span> -d <span class="st">&quot;,&quot;</span> -f 7,8  </code></pre></div>
</div>
<div id="find-all-of-the-lines-where-pam-is-called-beesley-instead-of-pam-or-pam-beesley." class="section level5">
<h5>3. Find all of the lines where Pam is called &quot;Beesley&quot; instead of &quot;Pam&quot; or &quot;Pam Beesley&quot;.</h5>
<p><strong>Hint:</strong> <em>A negative lookbehind would be one way to solve this, in order to use a negative lookbehind with <code>grep</code> make sure to add the -P option. In addition, make sure to use single quotes to make sure your regular expression is taken literally. If you use double quotes, variables are expanded.</em></p>
<p><strong>Relevant topics:</strong> <a href="unix.html#grep">grep</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The UNIX command used to solve this problem.
</li>
</ul>
</div>
</div>
<div id="solution-162" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">grep</span> -Pi <span class="st">&#39;(?&lt;!Pam )Beesley&#39;</span></code></pre></div>
<p>Regular expressions are really a useful semi language-agnostic tool. What this means is regardless of the programming language your are using, there will be some package that allows you to use regular expressions. In fact, we can use them in both R and Python! This can be particularly useful when dealing with strings. Load up the dataset you discovered in (1) using <code>read.csv</code>. Name the resulting data.frame <code>dat</code>.</p>
</div>
<div id="the-text_w_direction-column-in-dat-contains-the-characters-lines-with-inserted-direction-that-helps-characters-know-what-to-do-as-they-are-reciting-the-lines.-direction-is-shown-between-square-brackets-.-in-this-two-part-question-we-are-going-to-use-regular-expression-to-detect-the-directions.-1" class="section level5">
<h5>4. The <code>text_w_direction</code> column in <code>dat</code> contains the characters' lines with inserted direction that helps characters know what to do as they are reciting the lines. Direction is shown between square brackets &quot;[&quot; &quot;]&quot;. In this two-part question, we are going to use regular expression to detect the directions.</h5>
</div>
<div id="a-create-a-new-column-called-has_direction-that-is-set-to-true-if-the-text_w_direction-column-has-direction-and-false-otherwise.-use-the-grepl-function-in-r-to-accomplish-this.-1" class="section level5">
<h5>(a) Create a new column called <code>has_direction</code> that is set to <code>TRUE</code> if the <code>text_w_direction</code> column has direction, and <code>FALSE</code> otherwise. Use the <code>grepl</code> function in R to accomplish this.</h5>
<p><strong>Hint:</strong> <em>Make sure all opening brackets &quot;[&quot; have a corresponding closing bracket &quot;]&quot;.</em></p>
<p><strong>Hint:</strong> <em>Think of the pattern as any line that has a [, followed by any amount of any text, followed by a ], followed by any amount of any text.</em></p>
</div>
<div id="b-modify-your-regular-expression-to-find-lines-with-2-or-more-sets-of-direction.-how-many-lines-have-more-than-2-directions-modify-your-code-again-and-find-how-many-have-more-than-5.-1" class="section level5">
<h5>(b) Modify your regular expression to find lines with 2 or more sets of direction. How many lines have more than 2 directions? Modify your code again and find how many have more than 5.</h5>
<p>We count the sets of direction in each line by the pairs of square brackets. The following are two simple example sentences.</p>
<pre class="txt"><code>This is a line with [emphasize this] only 1 direction!
This is a line with [emphasize this] 2 sets of direction, do you see the difference [shrug].</code></pre>
<p>Your solution to part (a) should find both lines a match. However, in part (b) we want the regular expression pattern to find only lines with 2+ directions, so the first line would not be a match.</p>
<p>In our actual dataset, for example, <code>dat$text_w_direction[2789]</code> is a line with 2 directions.</p>
<p><strong>Relevant topics:</strong> <em><a href="r.html#r-grep">grep</a>, <a href="r.html#r-grep">grepl</a>, <a href="https://r4ds.had.co.nz/strings.html#basic-matches">basic matches</a>, <a href="faqs.html#faq-escape-characters">escaping characters</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The R code and regular expression used to solve the first part of this problem.
</li>
<li>
The R code and regular expression used to solve the second part of this problem.
</li>
<li>
How many lines have &gt;= 2 directions?
</li>
<li>
How many lines have &gt;= 5 directions?
</li>
</ul>
</div>
</div>
<div id="solution-163" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat<span class="op">$</span>has_direction &lt;-<span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;(</span><span class="ch">\\</span><span class="st">[.*</span><span class="ch">\\</span><span class="st">])+&quot;</span>, dat<span class="op">$</span>text_w_direction)

<span class="co">#</span>

<span class="kw">length</span>(<span class="kw">grep</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">[.*</span><span class="ch">\\</span><span class="st">].*</span><span class="ch">\\</span><span class="st">[.*</span><span class="ch">\\</span><span class="st">]&quot;</span>, dat<span class="op">$</span>text_w_direction))
<span class="kw">length</span>(<span class="kw">grep</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">[.*</span><span class="ch">\\</span><span class="st">].*</span><span class="ch">\\</span><span class="st">[.*</span><span class="ch">\\</span><span class="st">].*</span><span class="ch">\\</span><span class="st">[.*</span><span class="ch">\\</span><span class="st">].*</span><span class="ch">\\</span><span class="st">[.*</span><span class="ch">\\</span><span class="st">].*</span><span class="ch">\\</span><span class="st">[.*</span><span class="ch">\\</span><span class="st">]&quot;</span>, dat<span class="op">$</span>text_w_direction))</code></pre></div>
</div>
<div id="use-the-str_extract_all-function-from-the-stringr-package-to-extract-the-directions-as-well-as-the-text-between-directions-from-each-line.-put-the-strings-in-a-new-column-called-direction." class="section level5">
<h5>5. Use the <code>str_extract_all</code> function from the <code>stringr</code> package to extract the direction(s) as well as the text between direction(s) from each line. Put the strings in a new column called <code>direction</code>.</h5>
<pre class="txt"><code>This is a line with [emphasize this] only 1 direction!
This is a line with [emphasize this] 2 sets of direction, do you see the difference [shrug].</code></pre>
<p>In this question, your solution may have extracted:</p>
<pre class="txt"><code>[emphasize this]
[emphasize this] 2 sets of direction, do you see the difference [shrug]</code></pre>
<p>(It is okay to keep the text between neighboring pairs of &quot;[&quot; and &quot;]&quot; for the second line.)</p>
<p><strong>Relevant topics:</strong> <em><a href="r.html#r-str-extract">str_extract_all</a>, <a href="https://r4ds.had.co.nz/strings.html#basic-matches">basic matches</a>, <a href="faqs.html#faq-escape-characters">escaping characters</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The R code used to solve this problem.
</li>
</ul>
</div>
</div>
<div id="solution-164" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat<span class="op">$</span>direction_correct &lt;-<span class="st"> </span><span class="kw">str_extract_all</span>(dat<span class="op">$</span>text_w_direction, <span class="st">&quot;(</span><span class="ch">\\</span><span class="st">[[^</span><span class="ch">\\</span><span class="st">[</span><span class="ch">\\</span><span class="st">]]*</span><span class="ch">\\</span><span class="st">])&quot;</span>, <span class="dt">simplify=</span>F)

<span class="co"># or </span>

dat<span class="op">$</span>direction_correct &lt;-<span class="st"> </span><span class="kw">str_extract_all</span>(dat<span class="op">$</span>text_w_direction, <span class="st">&quot;(</span><span class="ch">\\</span><span class="st">[.*?</span><span class="ch">\\</span><span class="st">])&quot;</span>, <span class="dt">simplify=</span>F)</code></pre></div>
</div>
<div id="optional-question.-repeat-5-but-this-time-make-sure-you-only-capture-the-brackets-and-text-within-the-brackets.-save-the-results-in-a-new-column-called-direction_correct.-you-can-test-to-see-if-it-is-working-by-running-the-following-code" class="section level5">
<h5>OPTIONAL QUESTION. Repeat (5) but this time make sure you only capture the brackets and text within the brackets. Save the results in a new column called <code>direction_correct</code>. You can test to see if it is working by running the following code:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat<span class="op">$</span>direction_correct[<span class="dv">747</span>]</code></pre></div>
<pre class="txt"><code>This is a line with [emphasize this] only 1 direction!
This is a line with [emphasize this] 2 sets of direction, do you see the difference [shrug].</code></pre>
<p>In (5), your solution may have extracted:</p>
<pre class="txt"><code>[emphasize this]
[emphasize this] 2 sets of direction, do you see the difference [shrug]</code></pre>
<p>This is ok for (5). In this question, however, we want to fix this to only extract:</p>
<pre class="txt"><code>[emphasize this]
[emphasize this] [shrug]</code></pre>
<p><strong>Hint:</strong> <em>This regular expression will be hard to read.</em></p>
<p><strong>Hint:</strong> <em>The pattern we want is: literal opening bracket, followed by 0+ of any character other than the literal [ or literal ], followed by a literal closing bracket.</em></p>
<p><strong>Relevant topics:</strong> <em><a href="r.html#r-str-extract">str_extract_all</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The R code used to solve this problem.
</li>
</ul>
</div>
</div>
<div id="solution-165" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat<span class="op">$</span>direction_correct &lt;-<span class="st"> </span><span class="kw">str_extract_all</span>(dat<span class="op">$</span>text_w_direction, <span class="st">&quot;(</span><span class="ch">\\</span><span class="st">[[^</span><span class="ch">\\</span><span class="st">[</span><span class="ch">\\</span><span class="st">]]*</span><span class="ch">\\</span><span class="st">])&quot;</span>, <span class="dt">simplify=</span>F)

<span class="co"># or </span>

dat<span class="op">$</span>direction_correct &lt;-<span class="st"> </span><span class="kw">str_extract_all</span>(dat<span class="op">$</span>text_w_direction, <span class="st">&quot;(</span><span class="ch">\\</span><span class="st">[.*?</span><span class="ch">\\</span><span class="st">])&quot;</span>, <span class="dt">simplify=</span>F)</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p05-390" class="section level3">
<h3>Project 5</h3>
<hr />
<p><strong>Motivation:</strong> Becoming comfortable stringing together commands and getting used to navigating files in a terminal is important for every data scientist to do. By learning the basics of a few useful tools, you will have the ability to quickly understand and manipulate files in a way which is just not possible using tools like Microsoft Office, Google Sheets, etc.</p>
<p><strong>Context:</strong> We've been using UNIX tools in a terminal to solve a variety of problems. In this project we will continue to solve problems by combining a variety of tools using a form of redirection called piping.</p>
<p><strong>Scope:</strong> grep, regular expression basics, UNIX utilities, redirection, piping</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Use <code>cut</code> to section off and slice up data from the command line.
</li>
<li>
Use piping to string UNIX commands together.
</li>
<li>
Use <code>sort</code> and it's options to sort data in different ways.
</li>
<li>
Use <code>head</code> to isolate <em>n</em> lines of output.
</li>
<li>
Use <code>wc</code> to summarize the number of lines in a file or in output.
</li>
<li>
Use <code>uniq</code> to filter out non-unique lines.
</li>
<li>
Use <code>grep</code> to search files effectively.
</li>
</ul>
</div>
<p>You can find useful examples that walk you through relevant material in The Examples Book:</p>
<p><a href="https://thedatamine.github.io/the-examples-book" class="uri">https://thedatamine.github.io/the-examples-book</a></p>
<p>It is highly recommended to read through, search, and explore these examples to help solve problems in this project.</p>
<p>Don't forget the very useful documentation shortcut <code>?</code> for R code. To use, simply type <code>?</code> in the console, followed by the name of the function you are interested in. In the Terminal, you can use the <code>man</code> command to check the documentation of <code>bash</code> code.</p>
<div id="dataset-29" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/amazon/amazon_fine_food_reviews.csv</code></p>
<p>A public sample of the data can be found here: <a href="https://www.datadepot.rcac.purdue.edu/datamine/data/amazon/amazon_fine_food_reviews.csv">amazon_fine_food_reviews.csv</a></p>
<p>Answers to questions should all be answered using the full dataset located on Scholar. You may use the public samples of data to experiment with your solutions prior to running them using the full dataset.</p>
<p>Here are three videos that might also be useful, as you work on Project 5:</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_033gzti4&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_s3x23xpl">Click here for video</a></p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_b3pvmwfh&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_b01m3m83">Click here for video</a></p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_wf3zmtmy&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_v55nhwhp">Click here for video</a></p>
</div>
<div id="questions-29" class="section level4">
<h4>Questions</h4>
<div id="what-is-the-id-of-the-most-helpful-review-according-to-the-highest-helpfulnessnumerator-1" class="section level5">
<h5>1. What is the <code>Id</code> of the most helpful review, according to the highest <code>HelpfulnessNumerator</code>?</h5>
<p><strong>Important note:</strong> You can always pipe output to <code>head</code> in case you want the first few values of a lot of output. Note that if you used <code>sort</code> before <code>head</code>, you may see the following error messages:</p>
<pre><code>sort: write failed: standard output: Broken pipe
sort: write error</code></pre>
<p>This is because <code>head</code> would truncate the output from <code>sort</code>. This is okay. See <a href="https://stackoverflow.com/questions/46202653/bash-error-in-sort-sort-write-failed-standard-output-broken-pipe">this discussion</a> for more details.</p>
<p><strong>Relevant topics:</strong> <em><a href="unix.html#cut">cut</a>, <a href="unix.html#sort">sort</a>, <a href="unix.html#head">head</a>, <a href="unix.html#piping-and-redirection">piping</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Line of UNIX commands used to solve the problem.
</li>
<li>
The <code>Id</code> of the most helpful review.
</li>
</ul>
</div>
</div>
<div id="solution-166" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cut</span> -d, -f5 amazon_fine_food_reviews.csv<span class="kw">|</span> <span class="fu">sort</span> -nr <span class="kw">|</span> <span class="fu">head</span> -n3</code></pre></div>
</div>
<div id="some-entries-under-the-summary-column-appear-more-than-once.-calculate-the-proportion-of-unique-summaries-over-the-total-number-of-summaries.-use-two-lines-of-unix-commands-to-find-the-numerator-and-the-denominator-and-manually-calculate-the-proportion.-1" class="section level5">
<h5>2. Some entries under the <code>Summary</code> column appear more than once. Calculate the proportion of unique summaries over the total number of summaries. Use two lines of UNIX commands to find the numerator and the denominator, and manually calculate the proportion.</h5>
</div>
<div id="to-further-clarify-what-we-mean-by-unique-if-we-had-the-following-vector-in-r-ca-b-a-c-its-unique-values-are-ca-b-c.-1" class="section level5">
<h5>To further clarify what we mean by <em>unique</em>, if we had the following vector in R, <code>c(&quot;a&quot;, &quot;b&quot;, &quot;a&quot;, &quot;c&quot;)</code>, its unique values are <code>c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)</code>.</h5>
<p><strong>Relevant topics:</strong> <em><a href="unix.html#cut">cut</a>, <a href="unix.html#uniq">uniq</a>, <a href="unix.html#sort">sort</a>, <a href="unix.html#wc">wc</a>, <a href="unix.html#piping-and-redirection">piping</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Two lines of UNIX commands used to solve the problem.
</li>
<li>
The ratio of unique <code>Summary</code>'s.
</li>
</ul>
</div>
</div>
<div id="solution-167" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cut</span> -d, -f9 amazon_fine_food_reviews.csv <span class="kw">|</span> <span class="fu">sort</span> -u <span class="kw">|</span> <span class="fu">wc</span> -l
<span class="fu">cut</span> -d, -f9 amazon_fine_food_reviews.csv <span class="kw">|</span> <span class="fu">wc</span> -l</code></pre></div>
</div>
<div id="use-a-chain-of-unix-commands-piped-in-a-sequence-to-create-a-frequency-table-of-score.-1" class="section level5">
<h5>3. Use a chain of UNIX commands, piped in a sequence, to create a frequency table of <code>Score</code>.</h5>
<p><strong>Relevant topics:</strong> <em><a href="unix.html#cut">cut</a>, <a href="unix.html#uniq">uniq</a>, <a href="unix.html#sort">sort</a>, <a href="unix.html#piping-and-redirection">piping</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The line of UNIX commands used to solve the problem.
</li>
<li>
The frequency table.
</li>
</ul>
</div>
</div>
<div id="solution-168" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cut</span> -d, -f7 amazon_fine_food_reviews.csv <span class="kw">|</span> <span class="fu">sort</span> -n <span class="kw">|</span> <span class="fu">uniq</span> -c</code></pre></div>
</div>
<div id="who-is-the-user-with-the-highest-number-of-reviews-there-are-two-columns-you-could-use-to-answer-this-question-but-which-column-do-you-think-would-be-most-appropriate-and-why-1" class="section level5">
<h5>4. Who is the user with the highest number of reviews? There are two columns you could use to answer this question, but which column do you think would be most appropriate and why?</h5>
<p><strong>Hint:</strong> <em>You may need to pipe the output to <code>sort</code> multiple times.</em></p>
<p><strong>Hint:</strong> <em>To create the frequency table, read through the <code>man</code> pages for <code>uniq</code>. Man pages are the &quot;manual&quot; pages for UNIX commands. You can read through the man pages for uniq by running the following:</em></p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">man</span> uniq</code></pre></div>
<p><strong>Relevant topics:</strong> <em><a href="unix.html#cut">cut</a>, <a href="unix.html#uniq">uniq</a>, <a href="unix.html#sort">sort</a>, <a href="unix.html#head">head</a>, <a href="unix.html#piping-and-redirection">piping</a>, <a href="unix.html#man">man</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The line of UNIX commands used to solve the problem.
</li>
<li>
The frequency table.
</li>
</ul>
</div>
</div>
<div id="solution-169" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cut</span> -d, -f3 amazon_fine_food_reviews.csv <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span> -c <span class="kw">|</span> <span class="fu">sort</span> -nr <span class="kw">|</span> <span class="fu">head</span> -n1</code></pre></div>
</div>
<div id="anecdotally-there-seems-to-be-a-tendency-to-leave-reviews-when-we-feel-strongly-either-positive-or-negative-about-a-product.-for-the-user-with-the-highest-number-of-reviews-i.e.-the-user-identified-in-question-4-would-you-say-that-they-follow-this-pattern-of-extremes-lets-consider-5-star-reviews-to-be-strongly-positive-and-1-star-reviews-to-be-strongly-negative.-lets-consider-anything-in-between-neither-strongly-positive-nor-negative.-1" class="section level5">
<h5>5. Anecdotally, there seems to be a tendency to leave reviews when we feel strongly (either positive or negative) about a product. For the user with the highest number of reviews (i.e., the user identified in question 4), would you say that they follow this pattern of extremes? Let's consider 5 star reviews to be strongly positive and 1 star reviews to be strongly negative. Let's consider anything in between neither strongly positive nor negative.</h5>
<p><strong>Hint:</strong> <em>You may find the solution to problem (3) useful.</em></p>
<p><strong>Relevant topics:</strong> <em><a href="unix.html#cut">cut</a>, <a href="unix.html#uniq">uniq</a>, <a href="unix.html#sort">sort</a>, <a href="unix.html#grep">grep</a>, <a href="unix.html#piping-and-redirection">piping</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The line of UNIX commands used to solve the problem.
</li>
</ul>
</div>
</div>
<div id="solution-170" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">grep</span> -i <span class="st">&#39;A3OXHLG6DIBRW8&#39;</span> amazon_fine_food_reviews.csv <span class="kw">|</span> <span class="fu">cut</span> -d, -f7 <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span> -c</code></pre></div>
</div>
<div id="find-the-most-helpful-review-with-a-score-of-5.-then-separately-find-the-most-helpful-review-with-a-score-of-1.-as-before-we-are-considering-the-most-helpful-review-to-be-the-review-with-the-highest-helpfulnessnumerator.-1" class="section level5">
<h5>6. Find the most helpful review with a <code>Score</code> of 5. Then (separately) find the most helpful review with a <code>Score</code> of 1. As before, we are considering the most helpful review to be the review with the highest <code>HelpfulnessNumerator</code>.</h5>
<p><strong>Hint:</strong> <em>You can use multiple lines to solve this problem.</em></p>
<p><strong>Relevant topics:</strong> <em><a href="unix.html#sort">sort</a>, <a href="unix.html#head">head</a>, <a href="unix.html#piping-and-redirection">piping</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The lines of UNIX commands used to solve the problem.
</li>
<li>
<code>ProductId</code>'s of both requested reviews.
</li>
</ul>
</div>
</div>
<div id="solution-171" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">sort</span> -t, -k7rn,7 -k5rn,5 amazon_fine_food_reviews.csv <span class="kw">|</span> <span class="fu">head</span> -n2
<span class="fu">sort</span> -t, -k7n,7 -k5rn,5 amazon_fine_food_reviews.csv <span class="kw">|</span> <span class="fu">head</span> -n2</code></pre></div>
</div>
<div id="for-only-the-two-productids-from-the-previous-question-create-a-new-dataset-called-scores.csv-that-contains-the-productids-and-scores-from-all-reviews-for-these-two-items." class="section level5">
<h5>7. For <strong>only</strong> the two <code>ProductId</code>s from the previous question, create a new dataset called <code>scores.csv</code> that contains the <code>ProductId</code>s and <code>Score</code>s from all reviews for these two items.</h5>
<p><strong>Relevant topics:</strong> <em><a href="unix.html#cut">cut</a>, <a href="unix.html#head">grep</a>, <a href="unix.html#piping-and-redirection">redirection</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The line of UNIX commands used to solve the problem.
</li>
</ul>
</div>
</div>
<div id="solution-172" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cut</span> -d, -f2,7 amazon_fine_food_reviews.csv<span class="kw">|</span> <span class="fu">grep</span> -Ei <span class="st">&#39;(B00012182G|B003EMQGVI|B00065LI0A)&#39;</span> <span class="op">&gt;</span> scores.csv</code></pre></div>
</div>
<div id="optional-question.-use-r-to-load-up-scores.csv-into-a-new-data.frame-called-dat.-create-a-histogram-for-each-products-score.-compare-the-most-helpful-review-score-with-the-scores-given-in-the-histogram.-based-on-this-comparison-point-out-some-curiosities-about-the-product-that-may-be-worth-exploring.-for-example-if-a-product-receives-many-high-scores-but-has-a-super-helpful-review-that-gives-the-product-1-star-i-may-tend-to-wonder-if-the-product-is-not-as-great-as-it-seems-to-be." class="section level5">
<h5>OPTIONAL QUESTION. Use R to load up <code>scores.csv</code> into a new data.frame called <code>dat</code>. Create a histogram for each products' <code>Score</code>. Compare the most helpful review <code>Score</code> with the <code>Score</code>'s given in the histogram. Based on this comparison, point out some curiosities about the product that may be worth exploring. For example, if a product receives many high scores, but has a super helpful review that gives the product 1 star, I may tend to wonder if the product is not as great as it seems to be.</h5>
<p><strong>Relevant topics:</strong> <em><a href="r.html#r-reading-and-writing-data">read.csv</a>, <a href="r.html#r-plotting">hist</a></em></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to create the histograms.
</li>
<li>
3 histograms, 1 for each <code>ProductId</code>.
</li>
<li>
1-2 sentences describing the curious pattern that you would like to further explore.
</li>
</ul>
</div>
</div>
<div id="solution-173" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;scores.csv&quot;</span>, <span class="dt">header=</span>F)
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
<span class="kw">tapply</span>(dat<span class="op">$</span>V2, dat<span class="op">$</span>V1, hist)</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p06-390" class="section level3">
<h3>Project 6</h3>
<hr />
<p><strong>Motivation:</strong> A bash script is a powerful tool to perform repeated tasks. RCAC uses bash scripts to automate a variety of tasks. In fact, we use bash scripts on Scholar to do things like link Python kernels to your account, fix potential isues with Firefox, etc. <code>awk</code> is a programming language designed for text processing. The combination of these tools can be really powerful and useful for a variety of quick tasks.</p>
<p><strong>Context:</strong> This is the first part in a series of projects that are designed to exercise skills around UNIX utilities, with a focus on writing bash scripts and <code>awk</code>. You will get the opportunity to manipulate data without leaving the terminal. At first it may seem overwhelming, however, with just a little practice you will be able to accomplish data wrangling tasks really efficiently.</p>
<p><strong>Scope:</strong> awk, UNIX utilities, bash scripts</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Use <code>awk</code> to process and manipulate textual data.
</li>
<li>
Use piping and redirection within the terminal to pass around data between utilities.
</li>
<li>
Use output created from the terminal to create a plot using R.
</li>
</ul>
</div>
<div id="dataset-30" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found <a href="https://www.datadepot.rcac.purdue.edu/datamine/data/flights/subset/YYYY.csv">here</a> or in Scholar:</p>
<p><code>/class/datamine/data/flights/subset/YYYY.csv</code></p>
<p>An example from 1987 data can be found <a href="https://www.datadepot.rcac.purdue.edu/datamine/data/flights/subset/1987.csv">here</a> or in Scholar:</p>
<p><code>/class/datamine/data/flights/subset/1987.csv</code></p>
</div>
<div id="questions-30" class="section level4">
<h4>Questions</h4>
<div id="in-previous-projects-we-learned-how-to-get-a-single-column-of-data-from-a-csv-file.-write-1-line-of-unix-commands-to-print-the-17th-column-the-origin-from-1987.csv.-write-another-line-this-time-using-awk-to-do-the-same-thing.-which-one-do-you-prefer-and-why-1" class="section level5">
<h5>1. In previous projects we learned how to get a single column of data from a csv file. Write 1 line of UNIX commands to print the 17th column, the <code>Origin</code>, from <code>1987.csv</code>. Write another line, this time using <code>awk</code> to do the same thing. Which one do you prefer, and why?</h5>
<p>Here is an example, from a different data set, to illustrate some differences and similarities between cut and awk:</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_hmf7lr7b&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_6tkg6zzx">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="unix.html#cut">cut</a>, <a href="unix.html#awk">awk</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
One line of UNIX commands to solve the problem <em>without</em> using <code>awk</code>.
</li>
<li>
One line of UNIX commands to solve the problem using <code>awk</code>.
</li>
<li>
1-2 sentences describing which method you prefer and why.
</li>
</ul>
</div>
</div>
<div id="solution-174" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cut</span> -d, -f17 1987.csv
<span class="fu">awk</span> -F, <span class="st">&#39;{print $17}&#39;</span> 1987.csv</code></pre></div>
</div>
<div id="write-a-bash-script-that-accepts-a-year-1987-1988-etc.-and-a-column-n-and-returns-the-nth-column-of-the-associated-year-of-data.-1" class="section level5">
<h5>2. Write a bash script that accepts a year (1987, 1988, etc.) and a column <em>n</em> and returns the <em>nth</em> column of the associated year of data.</h5>
<p>Here are two examples to illustrate how to write a bash script:</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_gkirnxfb&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_0qtbjjlt">Click here for video</a></p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_e14gbfiq&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_8tyncb6q">Click here for video</a></p>
<p><strong>Hint:</strong> In this example, you only need to turn in the content of your bash script (starting with <code>#!/bin/bash</code>) without evaluation in a code chunk. However, you should test your script before submission to make sure it works. To actually test out your bash script, take the following example. The script is simple and just prints out the first two arguments given to it:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>

<span class="bu">echo</span> <span class="st">&quot;First argument: </span><span class="va">$1</span><span class="st">&quot;</span>
<span class="bu">echo</span> <span class="st">&quot;Second argument: </span><span class="va">$2</span><span class="st">&quot;</span></code></pre></div>
<p>If you simply drop that text into a file called <code>my_script.sh</code>, located here: <code>/home/$USER/my_script.sh</code>, and if you run the following:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># Setup bash to run; this only needs to be run one time per session.</span>
<span class="co"># It makes bash behave a little more naturally in RStudio.</span>
<span class="bu">exec</span> bash

<span class="co"># Navigate to the location of my_script.sh</span>
<span class="bu">cd</span> /home/<span class="va">$USER</span>

<span class="co"># Make sure that the script is runable.</span>
<span class="co"># This only needs to be done one time for each new script that you write.</span>
<span class="fu">chmod</span> 755 my_script.sh

<span class="co"># Execute my_script.sh</span>
<span class="ex">./my_script.sh</span> okay cool</code></pre></div>
<p>then it will print:</p>
<pre><code>First argument: okay
Second argument: cool</code></pre>
<p>In this example, if we were to turn in the &quot;content of your bash script (starting with <code>#!/bin/bash</code>) in a code chunk, our solution would look like this:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>

<span class="bu">echo</span> <span class="st">&quot;First argument: </span><span class="va">$1</span><span class="st">&quot;</span>
<span class="bu">echo</span> <span class="st">&quot;Second argument: </span><span class="va">$2</span><span class="st">&quot;</span></code></pre></div>
<p>And although we aren't running the code chunk above, we know that it works because we tested it in the terminal.</p>
<p><strong>Hint:</strong> Using <code>awk</code> you could have a script with just two lines: 1 with the &quot;hash-bang&quot; (<code>#!/bin/bash</code>), and 1 with a single <code>awk</code> command.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a>, <a href="unix.html#unix-writing-scripts">bash scripts</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The content of your bash script (starting with <code>#!/bin/bash</code>) in a code chunk.
</li>
</ul>
</div>
</div>
<div id="solution-175" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>
<span class="fu">awk</span> -F, -v col=<span class="va">$2</span> <span class="st">&#39;{print $col}&#39;</span> <span class="va">$1</span>.csv</code></pre></div>
</div>
<div id="how-many-flights-arrived-at-indianapolis-ind-in-2008-first-solve-this-problem-without-using-awk-then-solve-this-problem-using-only-awk.-1" class="section level5">
<h5>3. How many flights arrived at Indianapolis (IND) in 2008? First solve this problem without using <code>awk</code>, then solve this problem using <em>only</em> <code>awk</code>.</h5>
<p>Here is a similar example, using the election data set:</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_mzv1gtb1&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_mv06yedm">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="unix.html#cut">cut</a>, <a href="unix.html#grep">grep</a>, <a href="unix.html#wc">wc</a>, <a href="unix.html#awk">awk</a>, <a href="unix.html#piping-and-redirection">piping</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
One line of UNIX commands to solve the problem <em>without</em> using <code>awk</code>.
</li>
<li>
One line of UNIX commands to solve the problem using <code>awk</code>.
</li>
<li>
The number of flights that arrived at Indianapolis (IND) in 2008.
</li>
</ul>
</div>
</div>
<div id="solution-176" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cut</span> -d, -f18 2008.csv <span class="kw">|</span> <span class="fu">grep</span> <span class="st">&#39;IND&#39;</span> <span class="kw">|</span> <span class="fu">wc</span> -l
<span class="fu">awk</span> -F, <span class="st">&#39;{if ($18 == &quot;IND&quot;) count++}END{print count}&#39;</span> 2008.csv</code></pre></div>
</div>
<div id="do-you-expect-the-number-of-unique-origins-and-destinations-to-be-the-same-based-on-flight-data-in-the-year-2008-find-out-using-any-command-line-tool-youd-like.-are-they-indeed-the-same-how-many-unique-values-do-we-have-per-category-origin-dest-1" class="section level5">
<h5>4. Do you expect the number of unique origins and destinations to be the same based on flight data in the year 2008? Find out, using any command line tool you'd like. Are they indeed the same? How many unique values do we have per category (<code>Origin</code>, <code>Dest</code>)?</h5>
<p>Here is an example to help you with the last part of the question, about Origin-to-Destination pairs. We analyze the city-state pairs from the election data:</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_7vly78sw&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_tba174p2">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="unix.html#cut">cut</a>, <a href="unix.html#sort">sort</a>, <a href="unix.html#uniq">uniq</a>, <a href="unix.html#wc">wc</a>, <a href="unix.html#awk">awk</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
1-2 sentences explaining whether or not you expect the number of unique origins and destinations to be the same.
</li>
<li>
The UNIX command(s) used to figure out if the number of unique origins and destinations are the same.
</li>
<li>
The number of unique values per category (<code>Origin</code>, <code>Dest</code>).
</li>
</ul>
</div>
</div>
<div id="solution-177" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cut</span> -d, -f17 2008.csv <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span> <span class="kw">|</span> <span class="fu">wc</span> -l
<span class="fu">cut</span> -d, -f18 2008.csv <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span> <span class="kw">|</span> <span class="fu">wc</span> -l</code></pre></div>
</div>
<div id="in-4-we-found-that-there-are-not-the-same-number-of-unique-origins-as-dests.-find-the-iata-airport-code-for-all-origins-that-dont-appear-in-a-dest-and-all-dests-that-dont-appear-in-an-origin-in-the-2008-data.-1" class="section level5">
<h5>5. In (4) we found that there are not the same number of unique <code>Origin</code>'s as <code>Dest</code>'s. Find the <a href="https://en.wikipedia.org/wiki/International_Air_Transport_Association_code#Airport_codes">IATA airport code</a> for all <code>Origin</code>'s that don't appear in a <code>Dest</code> and all <code>Dest</code>'s that don't appear in an <code>Origin</code> in the 2008 data.</h5>
<p><strong>Hint:</strong> The examples on <a href="https://www.tutorialspoint.com/unix_commands/comm.htm">this</a> page should help. Note that these examples are based on <a href="https://tldp.org/LDP/abs/html/process-sub.html">Process Substitution</a>, which basically allows you to specify commands whose output would be used as the input of <code>comm</code>. There should be no space between <code>&lt;</code> and <code>(</code>, otherwise your bash will not work as intended.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#unix">comm</a>, <a href="unix.html#cut">cut</a>, <a href="unix.html#sort">sort</a>, <a href="unix.html#uniq">uniq</a>, <a href="unix.html#piping-and-redirection">redirection</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The line(s) of UNIX command(s) used to answer the question.
</li>
<li>
The list of <code>Origin</code>s that don't appear in <code>Dest</code>.
</li>
<li>
The list of <code>Dest</code>s that don't appear in <code>Origin</code>.
</li>
</ul>
</div>
</div>
<div id="solution-178" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">comm</span> -23 <span class="op">&lt;(</span><span class="fu">cut</span> -d, -f17 2008.csv <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span><span class="op">)</span> <span class="op">&lt;(</span><span class="fu">cut</span> -d, -f18 2008.csv <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span><span class="op">)</span>
<span class="fu">comm</span> -13 <span class="op">&lt;(</span><span class="fu">cut</span> -d, -f17 2008.csv <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span><span class="op">)</span> <span class="op">&lt;(</span><span class="fu">cut</span> -d, -f18 2008.csv <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span><span class="op">)</span></code></pre></div>
</div>
<div id="what-was-the-percentage-of-flights-in-2008-per-unique-origin-with-the-dest-of-ind-what-percentage-of-flights-had-phx-as-origin-among-all-flights-with-dest-of-ind-1" class="section level5">
<h5>6. What was the percentage of flights in 2008 per unique <code>Origin</code> with the <code>Dest</code> of &quot;IND&quot;? What percentage of flights had &quot;PHX&quot; as <code>Origin</code> (among all flights with <code>Dest</code> of &quot;IND&quot;?</h5>
<p>Here is an example using the percentages of donations contributed from CEOs from various States:</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_4r4bx3by&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_43qkeojx">Click here for video</a></p>
<p><strong>Hint:</strong> You can do the mean calculation in awk by dividing the result from (3) by the number of unique <code>Origin</code>'s that have a <code>Dest</code> of &quot;IND&quot;.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a>, <a href="unix.html#sort">sort</a>, <a href="unix.html#grep">grep</a>, <a href="unix.html#wc">wc</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The percentage of flights in 2008 per unique <code>Origin</code> with the <code>Dest</code> of &quot;IND&quot;.
</li>
<li>
1-2 sentences explaining how &quot;PHX&quot; compares (as a unique <code>ORIGIN</code>) to the other <code>Origin</code>s (all with the <code>Dest</code> of &quot;IND&quot;)?
</li>
</ul>
</div>
</div>
<div id="solution-179" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">awk</span> -F, <span class="st">&#39;{if($18==&quot;IND&quot;) print $17}&#39;</span> 2008.csv <span class="kw">|</span> <span class="fu">sort</span> -u <span class="kw">|</span> <span class="fu">wc</span> -l
<span class="fu">awk</span> -F, <span class="st">&#39;{if($18==&quot;IND&quot;) print $17}&#39;</span> 2008.csv <span class="kw">|</span> <span class="fu">grep</span> -i PHX <span class="kw">|</span> <span class="fu">wc</span> -l</code></pre></div>
</div>
<div id="write-a-bash-script-that-takes-a-year-and-iata-airport-code-and-returns-the-year-and-the-total-number-of-flights-to-and-from-the-given-airport.-example-rows-may-look-like" class="section level5">
<h5>7. Write a bash script that takes a year and IATA airport code and returns the year, and the total number of flights to and from the given airport. Example rows may look like:</h5>
<pre class="txt"><code>1987, 12345
1988, 44</code></pre>
<p>Run the script with inputs: <code>1991</code> and <code>ORD</code>. Include the output in your submission.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#unix-writing-scripts">bash scripts</a>, <a href="unix.html#cut">cut</a>, <a href="unix.html#piping-and-redirection">piping</a>, <a href="unix.html#grep">grep</a>, <a href="unix.html#wc">wc</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The content of your bash script (starting with &quot;#!/bin/bash&quot;) in a code chunk.
</li>
<li>
The output of the script given <code>1991</code> and <code>ORD</code> as inputs.
</li>
</ul>
</div>
</div>
<div id="solution-180" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>
<span class="va">FLIGHTS_OUT=</span><span class="st">&quot;</span><span class="va">$(</span><span class="fu">cut</span> -d, -f17 <span class="va">$1</span>.csv <span class="kw">|</span> <span class="fu">grep</span> -i <span class="va">$2</span> <span class="kw">|</span> <span class="fu">wc</span> -l<span class="va">)</span><span class="st">&quot;</span>
<span class="va">FLIGHTS_IN=</span><span class="st">&quot;</span><span class="va">$(</span><span class="fu">cut</span> -d, -f18 <span class="va">$1</span>.csv <span class="kw">|</span> <span class="fu">grep</span> -i <span class="va">$2</span> <span class="kw">|</span> <span class="fu">wc</span> -l<span class="va">)</span><span class="st">&quot;</span>
<span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$((</span>FLIGHTS_OUT + FLIGHTS_IN<span class="va">))</span><span class="st">, </span><span class="va">$1</span><span class="st">&quot;</span></code></pre></div>
</div>
<div id="optional-question.-pick-your-favorite-airport-and-get-its-iata-airport-code.-write-a-bash-script-that-given-the-first-year-last-year-and-airport-code-runs-the-bash-script-from-7-for-all-years-in-the-provided-range-for-your-given-airport-or-loops-through-all-of-the-files-for-the-given-airport-appending-all-of-the-data-to-a-new-file-called-my_airport.csv." class="section level5">
<h5>OPTIONAL QUESTION. Pick your favorite airport and get its IATA airport code. Write a bash script that, given the first year, last year, and airport code, runs the bash script from (7) for all years in the provided range for your given airport, or loops through all of the files for the given airport, appending all of the data to a new file called <code>my_airport.csv</code>.</h5>
<p><strong>Relevant topics:</strong> <a href="#writing-scripts">bash scripts</a>, <a href="unix.html#cut">cut</a>, <a href="unix.html#grep">grep</a>, <a href="unix.html#wc">wc</a>, <a href="r.html#r-for-loops">for loops</a>, <a href="#echo">echo</a>, <a href="unix.html#piping-and-redirection">redirection</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The content of your bash script (starting with &quot;#!/bin/bash&quot;) in a code chunk.
</li>
</ul>
</div>
</div>
<div id="solution-181" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>
<span class="kw">for</span> <span class="kw">((</span>f=<span class="va">$1</span>; f&lt;=<span class="va">$2</span>; f++<span class="kw">))</span>; <span class="kw">do</span> 
    <span class="va">FLIGHTS_OUT=</span><span class="st">&quot;</span><span class="va">$(</span><span class="fu">cut</span> -d, -f17 <span class="va">$f</span>.csv <span class="kw">|</span> <span class="fu">grep</span> -i <span class="va">$3</span> <span class="kw">|</span> <span class="fu">wc</span> -l<span class="va">)</span><span class="st">&quot;</span>
    <span class="va">FLIGHTS_IN=</span><span class="st">&quot;</span><span class="va">$(</span><span class="fu">cut</span> -d, -f18 <span class="va">$f</span>.csv <span class="kw">|</span> <span class="fu">grep</span> -i <span class="va">$3</span> <span class="kw">|</span> <span class="fu">wc</span> -l<span class="va">)</span><span class="st">&quot;</span>
    <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$((</span>FLIGHTS_OUT + FLIGHTS_IN<span class="va">))</span><span class="st">, </span><span class="va">$f</span><span class="st">&quot;</span> 
<span class="kw">done</span></code></pre></div>
</div>
<div id="optional-question.-in-r-load-my_airport.csv-and-create-a-line-plot-showing-the-year-by-year-change.-label-your-x-axis-year-your-y-axis-num-flights-and-your-title-the-name-of-the-iata-airport-code.-write-1-2-sentences-with-your-observations." class="section level5">
<h5>OPTIONAL QUESTION. In R, load <code>my_airport.csv</code> and create a line plot showing the year-by-year change. Label your x-axis &quot;Year&quot;, your y-axis &quot;Num Flights&quot;, and your title the name of the IATA airport code. Write 1-2 sentences with your observations.</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-reading-and-writing-data">read.csv</a>, <a href="r.html#r-lines">lines</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Line chart showing year-by-year change in flights into and out of the chosen airport.
</li>
<li>
R code used to create the chart.
</li>
<li>
1-2 sentences with your observations.
</li>
</ul>
</div>
</div>
<div id="solution-182" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;my_airport.csv&quot;</span>, <span class="dt">header=</span>F)
<span class="kw">plot</span>(dat[,<span class="dv">2</span>], dat[,<span class="dv">1</span>],<span class="dt">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Num Flights&quot;</span>, <span class="dt">main=</span><span class="st">&quot;JFK&quot;</span>, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p07-390" class="section level3">
<h3>Project 7</h3>
<hr />
<p><strong>Motivation:</strong> A bash script is a powerful tool to perform repeated tasks. RCAC uses bash scripts to automate a variety of tasks. In fact, we use bash scripts on Scholar to do things like link Python kernels to your account, fix potential isues with Firefox, etc. <code>awk</code> is a programming language designed for text processing. The combination of these tools can be really powerful and useful for a variety of quick tasks.</p>
<p><strong>Context:</strong> This is the first part in a series of projects that are designed to exercise skills around UNIX utilities, with a focus on writing bash scripts and <code>awk</code>. You will get the opportunity to manipulate data without leaving the terminal. At first it may seem overwhelming, however, with just a little practice you will be able to accomplish data wrangling tasks really efficiently.</p>
<p><strong>Scope:</strong> awk, UNIX utilities, bash scripts</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Use <code>awk</code> to process and manipulate textual data.
</li>
<li>
Use piping and redirection within the terminal to pass around data between utilities.
</li>
</ul>
</div>
<div id="dataset-31" class="section level4">
<h4>Dataset:</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/flights/subset/YYYY.csv</code></p>
<p>An example of the data for the year 1987 can be found <a href="https://www.datadepot.rcac.purdue.edu/datamine/data/flights/subset/1987.csv">here</a>.</p>
<p>Sometimes if you are about to dig into a dataset, it is good to quickly do some sanity checks early on to make sure the data is what you expect it to be.</p>
</div>
<div id="questions-31" class="section level4">
<h4>Questions</h4>
<p><strong>Important note:</strong> Please make sure to <strong>double check</strong> that the your submission does indeed contain the files you think it does. You can do this by downloading your submission from Gradescope after uploading. If you can see all of your files and they open up properly on your computer, you should be good to go.</p>
<p><strong>Important note:</strong> Please make sure to look at your knit PDF <em>before</em> submitting. PDFs should be relatively short and not contain huge amounts of printed data. Remember you can use functions like <code>head</code> to print a sample of the data or output. Extremely large PDFs will be subject to lose points.</p>
<div id="write-a-line-of-code-that-prints-a-list-of-the-unique-values-in-the-dayofweek-column.-write-a-line-of-code-that-prints-a-list-of-the-unique-values-in-the-dayofmonth-column.-write-a-line-of-code-that-prints-a-list-of-the-unique-values-in-the-month-column.-use-the-1987.csv-dataset.-are-the-results-what-you-expected-1" class="section level5">
<h5>1. Write a line of code that prints a list of the unique values in the <code>DayOfWeek</code> column. Write a line of code that prints a list of the unique values in the <code>DayOfMonth</code> column. Write a line of code that prints a list of the unique values in the <code>Month</code> column. Use the <code>1987.csv</code> dataset. Are the results what you expected?</h5>
<p><strong>Relevant topics:</strong> <a href="unix.html#cut">cut</a>, <a href="unix.html#sort">sort</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
3 lines of code used to get a list of unique values for the chosen columns.
</li>
<li>
1-2 sentences explaining whether or not the results are what you expected.
</li>
</ul>
</div>
</div>
<div id="solution-183" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cut</span> -d, -f3 1987.csv <span class="kw">|</span> <span class="fu">sort</span> -nu
<span class="fu">cut</span> -d, -f4 1987.csv <span class="kw">|</span> <span class="fu">sort</span> -nu
<span class="fu">cut</span> -d, -f2 1987.csv <span class="kw">|</span> <span class="fu">sort</span> -nu</code></pre></div>
</div>
<div id="our-files-should-have-29-columns.-for-a-given-file-write-a-line-of-code-that-prints-any-lines-that-do-not-have-29-columns.-test-it-on-1987.csv-were-there-any-rows-without-29-columns-1" class="section level5">
<h5>2. Our files should have 29 columns. For a given file, write a line of code that prints any lines that do <em>not</em> have 29 columns. Test it on <code>1987.csv</code>, were there any rows without 29 columns?</h5>
<p><strong>Hint:</strong> See <a href="unix.html#unix-awk-built-in-variables">here</a>. <code>NF</code> looks like it may be useful!</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Line of code used to solve the problem.
</li>
<li>
1-2 sentences explaining whether or not there were any rows without 29 columns.
</li>
</ul>
</div>
</div>
<div id="solution-184" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">awk</span> -F, <span class="st">&#39;{if (NF != 29) print $0}&#39;</span> 1987.csv</code></pre></div>
</div>
<div id="write-a-bash-script-that-given-a-begin-year-and-end-year-cycles-through-the-associated-files-and-prints-any-lines-that-do-not-have-29-columns.-1" class="section level5">
<h5>3. Write a bash script that, given a &quot;begin&quot; year and &quot;end&quot; year, cycles through the associated files and prints any lines that do <em>not</em> have 29 columns.</h5>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a>, <a href="unix.html#unix-writing-scripts">bash scripts</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The content of your bash script (starting with &quot;#!/bin/bash&quot;) in a code chunk.
</li>
<li>
The results of running your bash scripts from year 1987 to 2008.
</li>
</ul>
</div>
</div>
<div id="solution-185" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>
<span class="kw">for</span> <span class="kw">((</span>f=<span class="va">$1</span>; f&lt;=<span class="va">$2</span>; f++<span class="kw">))</span>; <span class="kw">do</span>
  <span class="fu">awk</span> -F, <span class="st">&#39;{if (NF != 29) print $0}&#39;</span> <span class="va">$f</span>.csv
<span class="kw">done</span></code></pre></div>
</div>
<div id="awk-is-a-really-good-tool-to-quickly-get-some-data-and-manipulate-it-a-little-bit.-the-column-distance-contains-the-distances-of-the-flights-in-miles.-use-awk-to-calculate-the-total-distance-traveled-by-the-flights-in-1990-and-show-the-results-in-both-miles-and-kilometers.-to-convert-from-miles-to-kilometers-simply-multiply-by-1.609344.-1" class="section level5">
<h5>4.<code>awk</code> is a really good tool to quickly get some data and manipulate it a little bit. The column <code>Distance</code> contains the distances of the flights in miles. Use <code>awk</code> to calculate the total distance traveled by the flights in 1990, and show the results in both miles and kilometers. To convert from miles to kilometers, simply multiply by 1.609344.</h5>
<p><strong>Example output:</strong></p>
<pre class="txt"><code>Miles: 12345
Kilometers: 19867.35168</code></pre>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a>, <a href="unix.html#piping-and-redirection">piping</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The code used to solve the problem.
</li>
<li>
The results of running the code.
</li>
</ul>
</div>
</div>
<div id="solution-186" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">awk</span> -F, <span class="st">&#39;{miles=miles+$19}END{print &quot;Miles: &quot; miles, &quot;\nKilometers:&quot; miles*1.609344}&#39;</span> 1990.csv</code></pre></div>
</div>
<div id="use-awk-to-calculate-the-sum-of-the-number-of-depdelay-minutes-grouped-according-to-dayofweek.-use-2007.csv.-1" class="section level5">
<h5>5. Use <code>awk</code> to calculate the sum of the number of <code>DepDelay</code> minutes, grouped according to <code>DayOfWeek</code>. Use <code>2007.csv</code>.</h5>
<p><strong>Example output:</strong></p>
<pre class="txt"><code>DayOfWeek:  0
1:  1234567
2:  1234567
3:  1234567
4:  1234567
5:  1234567
6:  1234567
7:  1234567</code></pre>
<p><strong>Note:</strong> 1 is Monday.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a>, <a href="unix.html#sort">sort</a>, <a href="unix.html#piping-and-redirection">piping</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The code used to solve the problem.
</li>
<li>
The output from running the code.
</li>
</ul>
</div>
</div>
<div id="solution-187" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">awk</span> -F, <span class="st">&#39;{delay[$4]=delay[$4]+$16}END{for (d in delay) print d&quot;: &quot;, delay[d]}&#39;</span> 2007.csv <span class="kw">|</span> <span class="fu">sort</span> -n</code></pre></div>
</div>
<div id="it-wouldnt-be-fair-to-compare-the-total-depdelay-minutes-by-dayofweek-as-the-number-of-flights-may-vary.-one-way-to-take-this-into-account-is-to-instead-calculate-an-average.-modify-5-to-calculate-the-average-number-of-depdelay-minutes-by-the-number-of-flights-per-dayofweek.-use-2007.csv.-1" class="section level5">
<h5>6. It wouldn't be fair to compare the total <code>DepDelay</code> minutes by <code>DayOfWeek</code> as the number of flights may vary. One way to take this into account is to instead calculate an average. Modify (5) to calculate the average number of <code>DepDelay</code> minutes by the number of flights per <code>DayOfWeek</code>. Use <code>2007.csv</code>.</h5>
<p><strong>Example output:</strong></p>
<pre class="txt"><code>DayOfWeek:  0
1:  1.234567
2:  1.234567
3:  1.234567
4:  1.234567
5:  1.234567
6:  1.234567
7:  1.234567</code></pre>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a>, <a href="unix.html#sort">sort</a>, <a href="unix.html#piping-and-redirection">piping</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The code used to solve the problem.
</li>
<li>
The output from running the code.
</li>
</ul>
</div>
</div>
<div id="solution-188" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">awk</span> -F, <span class="st">&#39;{delay[$4]=delay[$4]+$16; flights[$4]++}END{for (d in delay) print d&quot;: &quot;, delay[d]/flights[d]}&#39;</span> 2007.csv <span class="kw">|</span> <span class="fu">sort</span> -n</code></pre></div>
</div>
<div id="anyone-who-has-flown-knows-how-frustrating-it-can-be-waiting-for-takeoff-or-deboarding-the-aircraft.-these-roughly-translate-to-taxiout-and-taxiin-respectively.-if-you-were-to-fly-into-or-out-of-ind-what-is-your-expected-total-taxi-time-use-2007.csv." class="section level5">
<h5>7. Anyone who has flown knows how frustrating it can be waiting for takeoff, or deboarding the aircraft. These roughly translate to <code>TaxiOut</code> and <code>TaxiIn</code> respectively. If you were to fly into or out of IND what is your expected total taxi time? Use <code>2007.csv</code>.</h5>
<p><strong>Note:</strong> Taxi times are in minutes.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a>, <a href="unix.html#grep">grep</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The code used to solve the problem.
</li>
<li>
The output from running the code.
</li>
</ul>
</div>
</div>
<div id="solution-189" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">grep</span> -i IND 2007.csv <span class="kw">|</span> <span class="fu">awk</span> -F, <span class="st">&#39;{taxi=taxi+$20+$21; count++}END{print taxi/count}&#39;</span></code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p08-390" class="section level3">
<h3>Project 8</h3>
<hr />
<p><strong>Motivation:</strong> A bash script is a powerful tool to perform repeated tasks. RCAC uses bash scripts to automate a variety of tasks. In fact, we use bash scripts on Scholar to do things like link Python kernels to your account, fix potential isues with Firefox, etc. <code>awk</code> is a programming language designed for text processing. The combination of these tools can be really powerful and useful for a variety of quick tasks.</p>
<p><strong>Context:</strong> This is the last part in a series of projects that are designed to exercise skills around UNIX utilities, with a focus on writing bash scripts and <code>awk</code>. You will get the opportunity to manipulate data without leaving the terminal. At first it may seem overwhelming, however, with just a little practice you will be able to accomplish data wrangling tasks really efficiently.</p>
<p><strong>Scope:</strong> awk, UNIX utilities, bash scripts</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Use <code>awk</code> to process and manipulate textual data.
</li>
<li>
Use piping and redirection within the terminal to pass around data between utilities.
</li>
</ul>
</div>
<div id="dataset-32" class="section level4">
<h4>Dataset:</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/flights/subset/YYYY.csv</code></p>
<p>An example of the data for the year 1987 can be found <a href="https://www.datadepot.rcac.purdue.edu/datamine/data/flights/subset/1987.csv">here</a>.</p>
</div>
<div id="questions-32" class="section level4">
<h4>Questions</h4>
<p><strong>Important note:</strong> Please make sure to <strong>double check</strong> that the your submission does indeed contain the files you think it does. You can do this by downloading your submission from Gradescope after uploading. If you can see all of your files and they open up properly on your computer, you should be good to go.</p>
<p><strong>Important note:</strong> Please make sure to look at your knit PDF <em>before</em> submitting. PDFs should be relatively short and not contain huge amounts of printed data. Remember you can use functions like <code>head</code> to print a sample of the data or output. Extremely large PDFs will be subject to lose points.</p>
<div id="lets-say-we-have-a-theory-that-there-are-more-flights-on-the-weekend-days-friday-saturday-sunday-than-the-rest-of-the-days-on-average.-we-can-use-awk-to-quickly-check-it-out-and-see-if-maybe-this-looks-like-something-that-is-true-1" class="section level5">
<h5>1. Let's say we have a theory that there are more flights on the weekend days (Friday, Saturday, Sunday) than the rest of the days, on average. We can use awk to quickly check it out and see if maybe this looks like something that is true!</h5>
</div>
<div id="write-a-line-of-awk-code-that-prints-the-total-number-of-flights-that-occur-on-weekend-days-followed-by-the-total-number-of-flights-that-occur-on-the-weekdays.-complete-this-calculation-for-2008-using-the-2008.csv-file.-1" class="section level5">
<h5>Write a line of <code>awk</code> code that, prints the <em>total</em> number of flights that occur on weekend days, followed by the <em>total</em> number of flights that occur on the weekdays. Complete this calculation for 2008 using the <code>2008.csv</code> file.</h5>
</div>
<div id="modify-your-code-to-instead-print-the-average-number-of-flights-that-occur-on-weekend-days-followed-by-the-average-number-of-flights-that-occur-on-the-weekdays." class="section level5">
<h5>Modify your code to instead print the average number of flights that occur on weekend days, followed by the average number of flights that occur on the weekdays.</h5>
<p><strong>Hint:</strong> You don't need a large if statement to do this, you can use the <code>~</code> comparison operator.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Lines of <code>awk</code> code that solves the problem.
</li>
<li>
The result: the number of flights on the weekend days, followed by the number of flights on the weekdays for the flights during 2008.
</li>
<li>
The result: the average number of flights on the weekend days, followed by the average number of flights on the weekdays for the flights during 2008.
</li>
</ul>
</div>
</div>
<div id="solution-190" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">awk</span> -F, <span class="st">&#39;{if ($4 ~ /1|2|3|4/) weekday++; else (weekend++)}END{print weekend,weekday}&#39;</span> 2008.csv</code></pre></div>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">awk</span> -F, <span class="st">&#39;{if ($4 ~ /1|2|3|4/) weekday++; else (weekend++)}END{print weekend/3,weekday/4}&#39;</span> 2008.csv</code></pre></div>
</div>
<div id="we-want-to-look-to-see-if-there-may-be-some-truth-to-the-whole-snow-bird-concept-where-people-will-travel-to-warmer-states-like-florida-and-arizona-during-the-winter.-lets-use-the-tools-weve-learned-to-explore-this-a-little-bit.-1" class="section level5">
<h5>2. We want to look to see if there may be some truth to the whole &quot;snow bird&quot; concept where people will travel to warmer states like Florida and Arizona during the Winter. Let's use the tools we've learned to explore this a little bit.</h5>
</div>
<div id="take-a-look-at-airports.csv.-in-particular-run-the-following-1" class="section level5">
<h5>Take a look at <code>airports.csv</code>. In particular run the following:</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">head</span> airports.csv</code></pre></div>
</div>
<div id="notice-how-all-of-the-non-numeric-text-is-surrounded-by-quotes.-the-surrounding-quotes-would-need-to-be-escaped-for-any-comparison-within-awk.-this-is-messy-and-we-would-prefer-to-create-a-new-file-called-new_airports.csv-without-any-quotes.-write-a-line-of-code-to-do-this.-1" class="section level5">
<h5>Notice how all of the non-numeric text is surrounded by quotes. The surrounding quotes would need to be escaped for any comparison within <code>awk</code>. This is messy and we would prefer to create a new file called <code>new_airports.csv</code> without any quotes. Write a line of code to do this.</h5>
<p><strong>Note:</strong> You may be wondering <em>why</em> we are asking you to do this. This sort of situation (where you need to deal with quotes) happens a lot! It's important to practice and learn ways to fix these things.</p>
<p><strong>Hint:</strong> You could use <code>gsub</code> within <code>awk</code> to replace '&quot;' with ''. You can find how to use <code>gsub</code> <a href="https://www.gnu.org/software/gawk/manual/html_node/String-Functions.html">here</a>.</p>
<p><strong>Hint:</strong> If you leave out the column number argument to <code>gsub</code> it will apply the substitution to every field in every column.</p>
<p><strong>Hint:</strong></p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cat</span> new_airports.csv <span class="kw">|</span> <span class="fu">wc</span> -l <span class="co"># should be 159 without header</span></code></pre></div>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a>, <a href="unix.html#piping-and-redirection">redirection</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Line of <code>awk</code> code used to create the new dataset.
</li>
</ul>
</div>
</div>
<div id="solution-191" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">awk</span> -F, <span class="st">&#39;{gsub(/&quot;/, &quot;&quot;); print $0}&#39;</span> airports.csv <span class="op">&gt;</span> new_airports.csv</code></pre></div>
</div>
<div id="write-a-line-of-commands-that-creates-a-new-dataset-called-az_fl_airports.txt.-az_fl_airports.txt-should-only-contain-a-list-of-airport-codes-for-all-airports-from-both-arizona-az-and-florida-fl.-use-the-file-we-created-in-3new_airports.csv-as-a-starting-point.-1" class="section level5">
<h5>3. Write a line of commands that creates a new dataset called <code>az_fl_airports.txt</code>. <code>az_fl_airports.txt</code> should <em>only</em> contain a list of airport codes for all airports from both Arizona (AZ) and Florida (FL). Use the file we created in (3),<code>new_airports.csv</code> as a starting point.</h5>
</div>
<div id="how-many-airports-are-there-did-you-expect-this-use-a-line-of-bash-code-to-count-this.-1" class="section level5">
<h5>How many airports are there? Did you expect this? Use a line of bash code to count this.</h5>
</div>
<div id="create-a-new-dataset-called-az_fl_flights.txt-that-contains-all-of-the-data-for-flights-into-or-out-of-florida-and-arizona-using-the-2008.csv-file.-use-the-newly-created-dataset-az_fl_airports.txt-to-accomplish-this.-1" class="section level5">
<h5>Create a new dataset (called <code>az_fl_flights.txt</code>) that contains all of the data for flights into or out of Florida and Arizona (using the <code>2008.csv</code> file). Use the newly created dataset, <code>az_fl_airports.txt</code> to accomplish this.</h5>
<p><strong>Hint:</strong> <a href="https://unix.stackexchange.com/questions/293684/basic-grep-awk-help-extracting-all-lines-containing-a-list-of-terms-from-one-f" class="uri">https://unix.stackexchange.com/questions/293684/basic-grep-awk-help-extracting-all-lines-containing-a-list-of-terms-from-one-f</a></p>
<p><strong>Hint:</strong></p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">cat</span> az_fl_flights.txt <span class="kw">|</span> <span class="fu">wc</span> -l <span class="co"># should be 484705</span></code></pre></div>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a>, <a href="unix.html#wc">wc</a>, <a href="unix.html#piping-and-redirection">piping</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
All UNIX commands used to answer the questions.
</li>
<li>
The number of airports.
</li>
<li>
1-2 sentences explaining whether you expected this number of airports.
</li>
</ul>
</div>
</div>
<div id="solution-192" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">awk</span> -F, <span class="st">&#39;{if ($4 == &quot;AZ&quot; || $4 == &quot;FL&quot;) print $1}&#39;</span> new_airports.csv <span class="op">&gt;</span> az_fl_airports.txt
<span class="fu">wc</span> -l az_fl_airports.txt</code></pre></div>
</div>
<div id="write-a-bash-script-that-accepts-the-start-year-end-year-and-filename-containing-airport-codes-az_fl_airports.txt-and-outputs-the-data-for-flights-into-or-out-of-any-of-the-airports-listed-in-the-provided-filename-az_fl_airports.txt.-the-script-should-output-data-for-flights-using-all-of-the-years-of-data-in-the-provided-range.-run-the-bash-script-to-create-a-new-file-called-az_fl_flights_total.csv." class="section level5">
<h5>4. Write a bash script that accepts the start year, end year, and filename containing airport codes (<code>az_fl_airports.txt</code>), and outputs the data for flights into or out of any of the airports listed in the provided filename (<code>az_fl_airports.txt</code>). The script should output data for flights using <em>all</em> of the years of data in the provided range. Run the bash script to create a new file called <code>az_fl_flights_total.csv</code>.</h5>
<p><strong>Relevant topics:</strong> <a href="#writing-scripts">bash scripts</a>, <a href="unix.html#grep">grep</a>, <a href="r.html#r-for-loops">for loop</a>, <a href="unix.html#redirection">redirection</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The content of your bash script (starting with &quot;#!/bin/bash&quot;) in a code chunk.
</li>
<li>
The line of UNIX code you used to execute the script and create the new dataset.
</li>
</ul>
</div>
</div>
<div id="solution-193" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>
<span class="kw">for</span> <span class="kw">((</span>f=<span class="va">$1</span>; f&lt;=<span class="va">$2</span>; f++<span class="kw">))</span>; <span class="kw">do</span>
  <span class="fu">grep</span> -w -F -f <span class="va">$3</span> <span class="va">$f</span>.csv
<span class="kw">done</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">./my_script.sh</span> 1987 2008 az_fl_airports.txt <span class="op">&gt;</span> az_fl_flights_total.csv</code></pre></div>
</div>
<div id="use-the-newly-created-dataset-az_fl_flights_total.csv-from-question-4-to-calculate-the-total-number-of-flights-into-and-out-of-both-states-by-month-and-by-year-for-a-total-of-3-columns-year-month-flights.-export-this-information-to-a-new-file-called-snowbirds.csv." class="section level5">
<h5>5. Use the newly created dataset, <code>az_fl_flights_total.csv</code>, from question 4 to calculate the total number of flights into and out of both states by month, and by year, for a total of 3 columns (year, month, flights). Export this information to a new file called <code>snowbirds.csv</code>.</h5>
</div>
<div id="load-up-your-newly-created-dataset-and-use-either-r-or-python-or-some-other-tool-to-create-a-graphic-that-illustrates-whether-or-not-we-believe-the-snowbird-effect-effects-flights.-include-a-description-of-your-graph-as-well-as-your-anecdotal-conclusion." class="section level5">
<h5>Load up your newly created dataset and use either R or Python (or some other tool) to create a graphic that illustrates whether or not we believe the &quot;snowbird effect&quot; effects flights. Include a description of your graph, as well as your (anecdotal) conclusion.</h5>
<p><strong>Hint:</strong> You can use 1 dimensional arrays to accomplish this if the key is the combination of, for example, the year and month.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a>, <a href="unix.html#piping-and-redirection">redirection</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The line of <code>awk</code> code used to create the new dataset, <code>snowbirds.csv</code>.
</li>
<li>
Code used to create the visualization in a code chunk.
</li>
<li>
The generated plot as either a png or jpg/jpeg.
</li>
<li>
1-2 sentences describing your plot and your conclusion.
</li>
</ul>
</div>
</div>
<div id="solution-194" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">awk</span> -F, <span class="st">&#39;{M[$1&quot;,&quot;$2]++}END{for (monthyear in M) print monthyear&quot;,&quot;M[monthyear]}&#39;</span> az_fl_flights_total.csv <span class="op">&gt;</span> snowbirds.csv</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;snowbirds.csv&quot;</span>, <span class="dt">header=</span>F)
<span class="kw">names</span>(dat) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;month&quot;</span>, <span class="st">&quot;n_flights&quot;</span>)
<span class="kw">ggplot</span>(dat) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>month, <span class="dt">y=</span>n_flights, <span class="dt">group=</span>year, <span class="dt">col =</span> <span class="kw">as.factor</span>(year))) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>month, <span class="dt">y=</span>n_flights)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_classic</span>(<span class="dt">base_size=</span><span class="dv">14</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">labels =</span> month.abb) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span> <span class="st">&#39;Month&#39;</span>, <span class="dt">y=</span><span class="st">&#39;&#39;</span>, <span class="dt">title =</span> <span class="st">&#39;Total flights per month in/out AZ and FL (1987-2008)&#39;</span>, <span class="dt">col=</span><span class="st">&#39;Year&#39;</span>)</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p09-390" class="section level3">
<h3>Project 9</h3>
<hr />
<p><strong>Motivation:</strong> Structured Query Language (SQL) is a language used for querying and manipulating data in a database. SQL can handle much larger amounts of data than R and Python can alone. SQL is incredibly powerful. In fact, <a href="https://www.cloudflare.com/">cloudflare</a>, a billion dollar company, had much of its starting infrastructure built on top of a Postgresql database (per <a href="https://news.ycombinator.com/item?id=22878136">this thread on hackernews</a>). Learning SQL is <em>well</em> worth your time!</p>
<p><strong>Context:</strong> There are a multitude of RDBMSs (relational database management systems). Among the most popular are: MySQL, MariaDB, Postgresql, and SQLite. As we've spent much of this semester in the terminal, we will start in the terminal using SQLite.</p>
<p><strong>Scope:</strong> SQL, sqlite</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Explain the advantages and disadvantages of using a database over a tool like a spreadsheet.
</li>
<li>
Describe basic database concepts like: rdbms, tables, indexes, fields, query, clause.
</li>
<li>
Basic clauses: select, order by, limit, desc, asc, count, where, from, etc.
</li>
</ul>
</div>
<div id="dataset-33" class="section level4">
<h4>Dataset:</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/lahman/lahman.db</code></p>
<p>This is the Lahman Baseball Database. You can find its documentation <a href="http://www.seanlahman.com/files/database/readme2017.txt">here</a>, including the definitions of the tables and columns.</p>
</div>
<div id="questions-33" class="section level4">
<h4>Questions</h4>
<p><strong>Important note:</strong> Please make sure to <strong>double check</strong> that the your submission does indeed contain the files you think it does. You can do this by downloading your submission from Gradescope after uploading. If you can see all of your files and they open up properly on your computer, you should be good to go.</p>
<p><strong>Important note:</strong> Please make sure to look at your knit PDF <em>before</em> submitting. PDFs should be relatively short and not contain huge amounts of printed data. Remember you can use functions like <code>head</code> to print a sample of the data or output. Extremely large PDFs will be subject to lose points.</p>
<p><strong>Important note:</strong> For this project all solutions should be done using SQL code chunks. To connect to the database, copy and paste the following before your solutions in your .Rmd:</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{r, include=F}
library(RSQLite)
lahman &lt;- dbConnect(RSQLite::SQLite(), &quot;/class/datamine/data/lahman/lahman.db&quot;)
```</code></pre></div>
<p>Each solution should then be placed in a code chunk like this:</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{sql, connection=lahman}
SELECT * FROM batting LIMIT 1;
```</code></pre></div>
<p>If you want to use a SQLite-specific function like <code>.tables</code> (or prefer to test things in the Terminal), you will need to use the Terminal to connect to the database and run queries. To do so, you can connect to RStudio Server at <a href="https://rstudio.scholar.rcac.purdue.edu" class="uri">https://rstudio.scholar.rcac.purdue.edu</a>, and navigate to the terminal. In the terminal execute the command:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">sqlite3</span> /class/datamine/data/lahman/lahman.db</code></pre></div>
<p>From there, the SQLite-specific commands will function properly. They will <em>not</em> function properly in an SQL code chunk. To display the SQLite-specific commands in a code chunk without running the code, use a code chunk with the option <code>eval=F</code> like this:</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{sql, connection=lahman, eval=F}
SELECT * FROM batting LIMIT 1;
```</code></pre></div>
<p>This will allow the code to be displayed without throwing an error.</p>
<div id="connect-to-rstudio-server-httpsrstudio.scholar.rcac.purdue.edu-and-navigate-to-the-terminal-and-access-the-lahman-database.-how-many-tables-are-available-1" class="section level5">
<h5>1. Connect to RStudio Server <a href="https://rstudio.scholar.rcac.purdue.edu" class="uri">https://rstudio.scholar.rcac.purdue.edu</a>, and navigate to the terminal and access the Lahman database. How many tables are available?</h5>
<p><strong>Hint:</strong> To connect to the database, do the following:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">sqlite3</span> /class/datamine/data/lahman/lahman.db</code></pre></div>
<p><strong>Hint:</strong> <a href="https://database.guide/2-ways-to-list-tables-in-sqlite-database/">This</a> is a good resource.</p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql">sqlite3</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
How many tables are available in the Lahman database?
</li>
<li>
The sqlite3 commands used to figure out how many tables are available.
</li>
</ul>
</div>
</div>
<div id="solution-195" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql">.tables</code></pre></div>
</div>
<div id="some-people-like-to-try-to-visit-all-30-mlb-ballparks-in-their-lifetime.-use-sql-commands-to-get-a-list-of-parks-and-the-cities-theyre-located-in.-for-your-final-answer-limit-the-output-to-10-recordsrows.-1" class="section level5">
<h5>2. Some people like to try to <a href="https://www.washingtonpost.com/graphics/2017/sports/how-many-mlb-parks-have-you-visited/">visit all 30 MLB ballparks</a> in their lifetime. Use SQL commands to get a list of <code>parks</code> and the cities they're located in. For your final answer, limit the output to 10 records/rows.</h5>
<p><strong>Note:</strong> There may be more than 30 parks in your result, this is ok. For long results, you can limit the number of printed results using the <code>LIMIT</code> clause.</p>
<p><strong>Hint:</strong> Make sure you take a look at the column names and get familiar with the data tables. If working from the Terminal, to see the header row as a part of each query result, run the following:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql">.headers <span class="kw">on</span></code></pre></div>
<p><strong>Relevant topics:</strong> SELECT, FROM, LIMIT</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL code used to solve the problem.
</li>
<li>
The first 10 results of the query.
</li>
</ul>
</div>
</div>
<div id="solution-196" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> parkname, city <span class="kw">FROM</span> parks <span class="kw">LIMIT</span> <span class="dv">10</span>;</code></pre></div>
</div>
<div id="there-is-nothing-more-exciting-to-witness-than-a-home-run-hit-by-a-batter.-its-impressive-if-a-player-hits-more-than-40-in-a-season.-find-the-hitters-who-have-hit-60-or-more-home-runs-hr-in-a-season.-list-their-playerid-yearid-home-run-total-and-the-teamid-they-played-for.-1" class="section level5">
<h5>3. There is nothing more exciting to witness than a home run hit by a batter. It's impressive if a player hits more than 40 in a season. Find the hitters who have hit 60 or more home runs (<code>HR</code>) in a season. List their <code>playerID</code>, <code>yearID</code>, home run total, and the <code>teamID</code> they played for.</h5>
<p><strong>Hint:</strong> There are 8 occurrences of home runs greater than or equal to 60.</p>
<p><strong>Hint:</strong> The <code>batting</code> table is where you should look for this question.</p>
<p><strong>Relevant topics:</strong> SELECT, FROM, WHERE, LIMIT</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL code used to solve the problem.
</li>
<li>
The first 10 results of the query.
</li>
</ul>
</div>
</div>
<div id="solution-197" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> teamID, yearID, teamID, HR <span class="kw">FROM</span> batting <span class="kw">WHERE</span> HR&gt;=<span class="dv">60</span>;</code></pre></div>
</div>
<div id="make-a-list-of-players-born-on-your-birth-day-dont-worry-about-the-year.-display-their-first-names-last-names-and-birth-year.-order-the-list-descending-by-their-birth-year.-1" class="section level5">
<h5>4. Make a list of players born on your birth day (don't worry about the year). Display their first names, last names, and birth year. Order the list descending by their birth year.</h5>
<p><strong>Hint:</strong> The <code>people</code> table is where you should look for this question.</p>
<p><strong>Relevant topics:</strong> SELECT, FROM, WHERE, AND, ORDER BY, DESC, LIMIT</p>
<p><strong>Note</strong>: Examples that utilize the relevant topics in this problem can be found <a href="sql.html#sql-examples">here</a>.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL code used to solve the problem.
</li>
<li>
The first 10 results of the query.
</li>
</ul>
</div>
</div>
<div id="solution-198" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> nameFirst, nameLast, birthYear <span class="kw">FROM</span> people
  <span class="kw">WHERE</span> birthMonth==<span class="dv">5</span> <span class="kw">AND</span> birthDay==<span class="dv">29</span>
  <span class="kw">ORDER</span> <span class="kw">BY</span> birthYear <span class="kw">DESC</span> <span class="kw">LIMIT</span> <span class="dv">10</span>;</code></pre></div>
</div>
<div id="get-the-cleveland-cle-pitching-roster-from-the-2016-season-playerid-w-l-so.-order-the-pitchers-by-number-of-strikeouts-so-in-descending-order.-1" class="section level5">
<h5>5. Get the Cleveland (CLE) Pitching Roster from the 2016 season (<code>playerID</code>, <code>W</code>, <code>L</code>, <code>SO</code>). Order the pitchers by number of Strikeouts (SO) in descending order.</h5>
<p><strong>Hint:</strong> The <code>pitching</code> table is where you should look for this question.</p>
<p><strong>Relevant topics:</strong> SELECT, FROM, WHERE, AND, ORDER BY, DESC, LIMIT</p>
<p><strong>Note</strong>: Examples that utilize the relevant topics in this problem can be found <a href="sql.html#sql-examples">here</a>.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL code used to solve the problem.
</li>
<li>
The first 10 results of the query.
</li>
</ul>
</div>
</div>
<div id="solution-199" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> playerID, W, L, SO <span class="kw">FROM</span> pitching 
    <span class="kw">WHERE</span> teamID==<span class="st">&#39;CLE&#39;</span> <span class="kw">AND</span> yearID==<span class="dv">2016</span>
    <span class="kw">ORDER</span> <span class="kw">BY</span> SO <span class="kw">DESC</span> <span class="kw">LIMIT</span> <span class="dv">10</span>;</code></pre></div>
</div>
<div id="find-the-10-team-and-year-pairs-that-have-the-most-number-of-errors-e-between-1960-and-1970.-display-their-win-and-loss-counts-too.-what-is-the-name-of-the-team-that-appears-in-3rd-place-in-the-ranking-of-the-team-and-year-pairs-1" class="section level5">
<h5>6. Find the 10 team and year pairs that have the most number of Errors (<code>E</code>) between 1960 and 1970. Display their Win and Loss counts too. What is the name of the team that appears in 3rd place in the ranking of the team and year pairs?</h5>
<p><strong>Hint:</strong> The <code>teams</code> table is where you should look for this question.</p>
<p><strong>Hint:</strong> The <code>BETWEEN</code> clause is useful here.</p>
<p><strong>Hint:</strong> It is OK to use multiple queries to answer the question.</p>
<p><strong>Relevant topics:</strong> SELECT, FROM, WHERE, AND, ORDER BY, DESC, LIMIT, BETWEEN</p>
<p><strong>Note</strong>: Examples that utilize the relevant topics in this problem can be found <a href="sql.html#sql-examples">here</a>.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL code used to solve the problem.
</li>
<li>
The first 10 results of the query.
</li>
</ul>
</div>
</div>
<div id="solution-200" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> teamID, franchID, yearID, W, L, E <span class="kw">FROM</span> teams
  <span class="kw">WHERE</span> yearID <span class="kw">BETWEEN</span> <span class="dv">1960</span> <span class="kw">AND</span> <span class="dv">1970</span>
  <span class="kw">ORDER</span> <span class="kw">BY</span> E <span class="kw">DESC</span>
  <span class="kw">LIMIT</span> <span class="dv">10</span>;</code></pre></div>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> franchName <span class="kw">FROM</span> teamsfranchises <span class="kw">WHERE</span> franchID==<span class="st">&#39;LAA&#39;</span>;</code></pre></div>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> teamID, franchID, yearID, W, L, E <span class="kw">FROM</span> teams
  <span class="kw">WHERE</span> yearID &gt;= <span class="dv">1960</span> <span class="kw">AND</span> yearID &lt;= <span class="dv">1970</span>
  <span class="kw">ORDER</span> <span class="kw">BY</span> E <span class="kw">DESC</span>
  <span class="kw">LIMIT</span> <span class="dv">10</span>;</code></pre></div>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> franchName <span class="kw">FROM</span> teamsfranchises <span class="kw">WHERE</span> franchID==<span class="st">&#39;LAA&#39;</span>;</code></pre></div>
</div>
<div id="find-the-playerid-for-bob-lemon.-what-year-and-team-was-he-on-when-he-got-the-most-wins-as-a-pitcher-use-table-pitching-what-year-and-team-did-he-win-the-most-games-as-a-manager-use-table-managers-1" class="section level5">
<h5>7. Find the <code>playerID</code> for Bob Lemon. What year and team was he on when he got the most wins as a pitcher (use table <code>pitching</code>)? What year and team did he win the most games as a manager (use table <code>managers</code>)?</h5>
<p><strong>Hint:</strong> It is OK to use multiple queries to answer the question.</p>
<p><strong>Note</strong>: There was a tie among the two years in which Bob Lemon had the most wins as a pitcher.</p>
<p><strong>Relevant topics:</strong> SELECT, FROM, WHERE, AND, ORDER BY, DESC, LIMIT, BETWEEN</p>
<p><strong>Note</strong>: Examples that utilize the relevant topics in this problem can be found <a href="sql.html#sql-examples">here</a>.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL code used to solve the problem.
</li>
<li>
The first 10 results of the query.
</li>
</ul>
</div>
</div>
<div id="solution-201" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> playerID <span class="kw">FROM</span> people
  <span class="kw">WHERE</span> nameFirst==<span class="st">&#39;Bob&#39;</span> <span class="kw">AND</span> nameLast==<span class="st">&#39;Lemon&#39;</span>;</code></pre></div>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> teamID, yearID, W <span class="kw">FROM</span> pitching
  <span class="kw">WHERE</span> playerID==<span class="st">&#39;lemonbo01&#39;</span>
  <span class="kw">ORDER</span> <span class="kw">BY</span> W <span class="kw">DESC</span>;</code></pre></div>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> teamID, yearID, W <span class="kw">FROM</span> managers
  <span class="kw">WHERE</span> playerID==<span class="st">&#39;lemonbo01&#39;</span>
  <span class="kw">ORDER</span> <span class="kw">BY</span> W <span class="kw">DESC</span>;</code></pre></div>
</div>
<div id="find-the-al-west-use-lgid-and-divid-to-specify-al-west-home-run-hr-walk-bb-and-stolen-base-sb-totals-by-team-between-2000-and-2010.-which-team-and-year-combo-led-in-each-category-in-the-decade" class="section level5">
<h5>8. Find the <a href="https://en.wikipedia.org/wiki/American_League_West">AL West</a> (use <code>lgID</code> and <code>divID</code> to specify AL West) home run (<code>HR</code>), walk (<code>BB</code>), and stolen base (<code>SB</code>) totals by team between 2000 and 2010. Which team and year combo led in each category in the decade?</h5>
<p><strong>Hint:</strong> The <code>teams</code> table is where you should look for this question.</p>
<p><strong>Hint:</strong> It is OK to use multiple queries to answer the question.</p>
<p><strong>Hint:</strong> Use <code>divID == 'W'</code> as one of the conditions. Please note using double quotes: <code>divID == &quot;W&quot;</code> will not work.</p>
<p><strong>Relevant topics:</strong> SELECT, FROM, WHERE, AND, ORDER BY, DESC, LIMIT, BETWEEN</p>
<p><strong>Note</strong>: Examples that utilize the relevant topics in this problem can be found <a href="sql.html#sql-examples">here</a>.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL code used to solve the problem.
</li>
<li>
The team-year combination that ranked top in each category.
</li>
</ul>
</div>
</div>
<div id="solution-202" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> teamID, yearID, HR, BB, SB <span class="kw">FROM</span> teams
  <span class="kw">WHERE</span> lgID==<span class="st">&#39;AL&#39;</span> <span class="kw">AND</span> divID==<span class="st">&#39;W&#39;</span>
  <span class="kw">AND</span> yearID <span class="kw">BETWEEN</span> <span class="dv">2000</span> <span class="kw">AND</span> <span class="dv">2010</span>
  <span class="kw">ORDER</span> <span class="kw">BY</span> HR <span class="kw">DESC</span> <span class="kw">LIMIT</span> <span class="dv">1</span>;</code></pre></div>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> teamID, yearID, HR, BB, SB <span class="kw">FROM</span> teams
  <span class="kw">WHERE</span> lgID==<span class="st">&#39;AL&#39;</span> <span class="kw">AND</span> divID==<span class="st">&#39;W&#39;</span>
  <span class="kw">AND</span> yearID <span class="kw">BETWEEN</span> <span class="dv">2000</span> <span class="kw">AND</span> <span class="dv">2010</span>
  <span class="kw">ORDER</span> <span class="kw">BY</span> BB <span class="kw">DESC</span> <span class="kw">LIMIT</span> <span class="dv">1</span>;</code></pre></div>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> teamID, yearID, HR, BB, SB <span class="kw">FROM</span> teams
  <span class="kw">WHERE</span> lgID==<span class="st">&#39;AL&#39;</span> <span class="kw">AND</span> divID==<span class="st">&#39;W&#39;</span>
  <span class="kw">AND</span> yearID <span class="kw">BETWEEN</span> <span class="dv">2000</span> <span class="kw">AND</span> <span class="dv">2010</span>
  <span class="kw">ORDER</span> <span class="kw">BY</span> SB <span class="kw">DESC</span> <span class="kw">LIMIT</span> <span class="dv">1</span>;</code></pre></div>
</div>
<div id="get-a-list-of-the-following-by-year-wins-w-losses-l-home-runs-hit-hr-homeruns-allowed-hra-and-total-home-game-attendance-attendance-for-the-detroit-tigers-when-winning-a-world-series-wswin-is-y-or-when-winning-league-champion-lgwin-is-y." class="section level5">
<h5>9. Get a list of the following by year: wins (<code>W</code>), losses (<code>L</code>), Home Runs Hit (<code>HR</code>), homeruns allowed (<code>HRA</code>), and total home game attendance (<code>attendance</code>) for the Detroit Tigers when winning a World Series (<code>WSWin</code> is <code>Y</code>) or when winning league champion (<code>LgWin</code> is <code>Y</code>).</h5>
<p><strong>Hint:</strong> The <code>teams</code> table is where you should look for this question.</p>
<p><strong>Hint:</strong> Be careful with the order of operations for <code>AND</code> and <code>OR</code>. Remember you can force order of operations using parentheses.</p>
<p><strong>Relevant topics:</strong> SELECT, FROM, WHERE, AND, ORDER BY, DESC, LIMIT, BETWEEN</p>
<p><strong>Note</strong>: Examples that utilize the relevant topics in this problem can be found <a href="sql.html#sql-examples">here</a>.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL code used to solve the problem.
</li>
<li>
The first 10 results of the query.
</li>
</ul>
</div>
</div>
<div id="solution-203" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> teamID, yearID, W, L, HR, HRA, attendance <span class="kw">FROM</span> teams
  <span class="kw">WHERE</span> teamID==<span class="st">&#39;DET&#39;</span> <span class="kw">AND</span> (WSWin==<span class="st">&#39;Y&#39;</span> <span class="kw">OR</span> LgWin==<span class="st">&#39;Y&#39;</span>);</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p10-390" class="section level3">
<h3>Project 10</h3>
<hr />
<p><strong>Motivation:</strong> Although SQL syntax may still feel unnatural and foreign, with more practice it <em>will</em> start to make more sense. The ability to read and write SQL queries is a bread-and-butter skill for anyone working with data.</p>
<p><strong>Context:</strong> We are in the second of a series of projects that focus on learning the basics of SQL. In this project, we will continue to harden our understanding of SQL syntax, and introduce common SQL functions like <code>AVG</code>, <code>MIN</code>, and <code>MAX</code>.</p>
<p><strong>Scope:</strong> SQL, sqlite</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Explain the advantages and disadvantages of using a database over a tool like a spreadsheet.
</li>
<li>
Describe basic database concepts like: rdbms, tables, indexes, fields, query, clause.
</li>
<li>
Basic clauses: select, order by, limit, desc, asc, count, where, from, etc.
</li>
<li>
Utilize SQL functions like min, max, avg, sum, and count to solve data-driven problems.
</li>
</ul>
</div>
<div id="dataset-34" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset similar to the one from Project 9, but this time we will use a MariaDB version of the database, which is also hosted on Scholar, at <code>scholar-db.rcac.purdue.edu</code>. As in Project 9, this is the Lahman Baseball Database. You can find its documentation <a href="http://www.seanlahman.com/files/database/readme2017.txt">here</a>, including the definitions of the tables and columns.</p>
</div>
<div id="questions-34" class="section level4">
<h4>Questions</h4>
<p><strong>Important note:</strong> Please make sure to <strong>double check</strong> that the your submission does indeed contain the files you think it does. You can do this by downloading your submission from Gradescope after uploading. If you can see all of your files and they open up properly on your computer, you should be good to go.</p>
<p><strong>Important note:</strong> Please make sure to look at your knit PDF <em>before</em> submitting. PDFs should be relatively short and not contain huge amounts of printed data. Remember you can use functions like <code>head</code> to print a sample of the data or output. Extremely large PDFs will be subject to lose points.</p>
<p><strong>Important note:</strong> For this project all solutions should be done using R code chunks, and the <code>RMariaDB</code> package. Run the following code to load the library:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RMariaDB)</code></pre></div>
<div id="connect-to-rstudio-server-httpsrstudio.scholar.rcac.purdue.edu-and-rather-than-navigating-to-the-terminal-like-we-did-in-the-previous-project-instead-create-a-connection-to-our-mariadb-lahman-database-using-the-rmariadb-package-in-r-and-the-credentials-below.-confirm-the-connection-by-running-the-following-code-chunk-1" class="section level5">
<h5>1. Connect to RStudio Server <a href="https://rstudio.scholar.rcac.purdue.edu" class="uri">https://rstudio.scholar.rcac.purdue.edu</a>, and, rather than navigating to the terminal like we did in the previous project, instead, create a connection to our MariaDB lahman database using the <code>RMariaDB</code> package in R, and the credentials below. Confirm the connection by running the following code chunk:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">con &lt;-<span class="st"> </span><span class="kw">dbConnect</span>(RMariaDB<span class="op">::</span><span class="kw">MariaDB</span>(), 
                 <span class="dt">host=</span><span class="st">&quot;scholar-db.rcac.purdue.edu&quot;</span>, 
                 <span class="dt">db=</span><span class="st">&quot;lahmandb&quot;</span>, 
                 <span class="dt">user=</span><span class="st">&quot;lahman_user&quot;</span>, 
                 <span class="dt">password=</span><span class="st">&quot;HitAH0merun&quot;</span>)

<span class="kw">head</span>(<span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SHOW tables;&quot;</span>))</code></pre></div>
<p><strong>Hint:</strong> In the example provided, the variable <code>con</code> from the <code>dbConnect</code> function is the connection. Each query that you make, using the <code>dbGetQuery</code>, needs to use this connection <code>con</code>. You can change the name <code>con</code> if you want to (it is user defined), but if you change the name <code>con</code>, you need to change it on all of your connections. If your connection to the database dies while you are working on the project, you can always re-run the <code>dbConnect</code> line again, to reset your connection to the database.</p>
<p><strong>Relevant topics:</strong> RMariaDB, dbConnect, dbGetQuery</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
Output from running your (potentially modified) <code>head(dbGetQuery(con, &quot;SHOW tables;&quot;))</code>.
</li>
</ul>
</div>
</div>
<div id="solution-204" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RMariaDB)
host &lt;-<span class="st"> &quot;scholar-db.rcac.purdue.edu&quot;</span>
dbname &lt;-<span class="st"> &quot;lahmandb&quot;</span>
user &lt;-<span class="st"> &quot;lahman_user&quot;</span>
password &lt;-<span class="st"> &quot;HitAH0merun&quot;</span>
con &lt;-<span class="st"> </span><span class="kw">dbConnect</span>(<span class="kw">MariaDB</span>(),<span class="dt">host=</span>host,
                 <span class="dt">dbname=</span>dbname,
                 <span class="dt">user=</span>user,
                 <span class="dt">password=</span>password)
<span class="kw">head</span>(<span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SHOW tables;&quot;</span>))</code></pre></div>
</div>
<div id="how-many-players-are-members-of-the-4040-club-these-are-players-that-have-stolen-at-least-40-bases-sb-and-hit-at-least-40-home-runs-hr-in-one-year.-1" class="section level5">
<h5>2. How many players are members of the 40/40 club? These are players that have stolen at least 40 bases (<code>SB</code>) and hit at least 40 home runs (<code>HR</code>) in one year.</h5>
<p><strong>Hint:</strong> Use the <code>batting</code> table.</p>
<p><strong>Important note:</strong> You only need to run <code>library(RMariaDB)</code> and the <code>dbConnect</code> portion of the code a single time towards the top of your project. After that, you can simply reuse your connection <code>con</code> to run queries.</p>
<p><strong>Important note:</strong> In our <a href="https://raw.githubusercontent.com/TheDataMine/the-examples-book/master/files/project_template.Rmd">project template</a>, for this project, make all of the SQL queries using the <code>dbGetQuery</code> function, which returns the results directly in <code>R</code>. Therefore, your <code>RMarkdown</code> blocks for this project should all be <code>{r}</code> blocks (as opposed to the <code>{sql}</code> blocks used in Project 9).</p>
<p><strong>Hint:</strong> You can use <code>dbGetQuery</code> to run your queries from within R. Example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT * FROM battings LIMIT 5;&quot;</span>)</code></pre></div>
<p><strong>Note:</strong> We already demonstrated the correct SQL query to use for the 40/40 club in this video, but now we want you to use <code>RMariaDB</code> to solve this query:</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_os59oucz&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_gy4f8y6j">Click here for video</a></p>
<p><strong>Relevant topics:</strong> dbGetQuery, AND/OR, DISTINCT, COUNT</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The result of running the R code.
</li>
</ul>
</div>
</div>
<div id="solution-205" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dbGetQuery</span>(con,<span class="st">&quot;SELECT DISTINCT COUNT(*) FROM batting WHERE HR&gt;=40 AND SB&gt;=40;&quot;</span>)</code></pre></div>
</div>
<div id="how-many-times-in-total-has-giancarlo-stanton-struck-out-in-years-in-which-he-played-for-mia-or-flo-1" class="section level5">
<h5>3. How many times in total has Giancarlo Stanton struck out in years in which he played for &quot;MIA&quot; or &quot;FLO&quot;?</h5>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_whzcdsrc&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_ruufmsf4">Click here for video</a></p>
<p><strong>Important note:</strong> Questions in this project need to be solved using SQL when possible. You will not receive credit for a question if you use <code>sum</code> in R rather than <code>SUM</code> in SQL.</p>
<p><strong>Hint:</strong> Use the <code>people</code> table to find the <code>playerID</code> and use the <code>batting</code> table to find the statistics.</p>
<p><strong>Relevant topics:</strong> dbGetQuery, AND/OR, SUM</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The result of running the R code.
</li>
</ul>
</div>
</div>
<div id="solution-206" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT playerID FROM people WHERE nameFirst =&#39;Giancarlo&#39; AND nameLast = &#39;Stanton&#39;;&quot;</span>)
<span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT COUNT(*), SUM(SO) FROM batting WHERE playerID = &#39;stantmi03&#39; AND (teamID = &#39;MIA&#39; OR teamID = &#39;FLO&#39;);&quot;</span>)</code></pre></div>
</div>
<div id="the-batting-average-is-a-metric-for-a-batters-performance.-the-batting-average-in-a-year-is-calculated-by-frachab-the-number-of-hits-divided-by-at-bats.-considering-only-the-years-between-2000-and-2010-calculate-the-seasonal-batting-average-for-each-batter-who-had-more-than-300-at-bats-in-a-season.-list-the-top-5-batting-averages-next-to-playerid-teamid-and-yearid.-1" class="section level5">
<h5>4. The <a href="https://en.wikipedia.org/wiki/Batting_average_(baseball)">Batting Average</a> is a metric for a batter's performance. The Batting Average in a year is calculated by <span class="math inline">\(\frac{H}{AB}\)</span> (the number of hits divided by at-bats). Considering (only) the years between 2000 and 2010, calculate the (seasonal) Batting Average for each batter who had more than 300 at-bats in a season. List the top 5 batting averages next to <code>playerID</code>, <code>teamID</code>, and <code>yearID.</code></h5>
<p><strong>Hint:</strong> Use the <code>batting</code> table.</p>
<p><strong>Relevant topics:</strong> dbGetQuery, ORDER BY, BETWEEN</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The result of running the R code.
</li>
</ul>
</div>
</div>
<div id="solution-207" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dbGetQuery</span>(con,<span class="st">&quot;SELECT playerID, teamID, yearID, H, AB, H/AB FROM batting</span>
<span class="st">  WHERE yearID BETWEEN 2000 AND 2010 AND AB&gt;300</span>
<span class="st">  ORDER BY H/AB DESC LIMIT 5;&quot;</span>)</code></pre></div>
</div>
<div id="how-many-unique-players-have-hit-50-home-runs-hr-in-a-season-1" class="section level5">
<h5>5. How many unique players have hit &gt; 50 home runs (<code>HR</code>) in a season?</h5>
<p><strong>Hint:</strong> If you view <code>DISTINCT</code> as being paired with <code>SELECT</code>, instead, think of it as being paired with one of the fields you are selecting.</p>
<p><strong>Relevant topics:</strong> dbGetQuery, DISTINCT, COUNT</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The result of running the R code.
</li>
</ul>
</div>
</div>
<div id="solution-208" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT COUNT(DISTINCT playerID) FROM batting WHERE HR&gt;50;&quot;</span>)
<span class="co"># As you can see, DISTINCT is with the field playerID, not with SELECT. </span>
<span class="co"># The following query should help distinguish this.</span>
<span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT COUNT(DISTINCT playerID), COUNT(playerID) FROM batting WHERE HR&gt;50;&quot;</span>)</code></pre></div>
</div>
<div id="find-the-number-of-unique-players-that-attended-purdue-university.-start-by-finding-the-schoolid-for-purdue-and-then-find-the-number-of-players-who-played-there.-do-the-same-for-iu.-who-had-more-purdue-or-iu-use-the-information-you-have-in-the-database-and-the-power-of-r-to-create-a-misleading-graphic-that-makes-purdue-look-better-than-iu-even-if-just-at-first-glance.-make-sure-you-label-the-graphic.-1" class="section level5">
<h5>6. Find the number of unique players that attended Purdue University. Start by finding the <code>schoolID</code> for Purdue and then find the number of players who played there. Do the same for IU. Who had more? Purdue or IU? Use the information you have in the database, and the power of R to create a misleading graphic that makes Purdue look better than IU, even if just at first glance. Make sure you label the graphic.</h5>
<p><strong>Hint:</strong> Use the <code>schools</code> table to get the <code>schoolID</code>s, and the <code>collegeplaying</code> table to get the statistics.</p>
<p><strong>Hint:</strong> You can mess with the scale of the y-axis. You could (potentially) filter the data to start from a certain year or be between two dates.</p>
<p><strong>Hint:</strong> To find IU's id, try the following query: <code>SELECT schoolID FROM schools WHERE name_full LIKE '%indiana%';</code>. You can find more about the LIKE clause and <code>%</code> <a href="https://www.tutorialspoint.com/sql/sql-like-clause.htm">here</a>.</p>
<p><strong>Relevant topics:</strong> dbGetQuery, <a href="r.html#r-plotting">plotting in R</a>, DISTINCT, COUNT</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The result of running the R code.
</li>
</ul>
</div>
</div>
<div id="solution-209" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT schoolID FROM schools WHERE name_full=&#39;Purdue University&#39;;&quot;</span>)
<span class="kw">dbGetQuery</span>(con, <span class="st">&quot;SELECT schoolID FROM schools WHERE LIKE &#39;%indiana%&#39;;&quot;</span>)
<span class="kw">dbGetQuery</span>(con,<span class="st">&quot;SELECT COUNT(DISTINCT playerID) FROM collegeplaying WHERE schoolID =&#39;purdue&#39;;&quot;</span>)
<span class="kw">dbGetQuery</span>(con,<span class="st">&quot;SELECT DISTINCT playerID FROM collegeplaying WHERE schoolID =&#39;indiana&#39;;&quot;</span>)
purdue &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(<span class="kw">dbGetQuery</span>(con,<span class="st">&quot;SELECT playerID FROM collegeplaying WHERE schoolID =&#39;purdue&#39;;&quot;</span>))<span class="op">$</span>playerID)
iu &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(<span class="kw">dbGetQuery</span>(con,<span class="st">&quot;SELECT playerID FROM collegeplaying WHERE schoolID =&#39;indiana&#39;;&quot;</span>))<span class="op">$</span>playerID)
<span class="kw">barplot</span>(purdue, iu)
<span class="kw">barplot</span>(<span class="kw">log</span>(<span class="kw">c</span>(purdue, iu)), <span class="dt">main=</span><span class="st">&quot;Pro baseball players: Indiana vs. Purdue&quot;</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;#990000&quot;</span>,<span class="st">&quot;#CFB53B&quot;</span>), <span class="dt">names.arg=</span><span class="kw">c</span>(<span class="st">&quot;Purdue&quot;</span>, <span class="st">&quot;IU&quot;</span>), <span class="dt">cex.names=</span>.<span class="dv">5</span>, <span class="dt">ylab=</span><span class="st">&quot;Log count&quot;</span>)</code></pre></div>
</div>
<div id="use-r-sql-and-the-lahman-database-to-create-an-interesting-infographic.-for-those-of-you-who-are-not-baseball-fans-try-doing-a-google-image-search-for-baseball-plots-for-inspiration.-make-sure-the-plot-is-polished-has-appropriate-labels-color-etc." class="section level5">
<h5>7. Use R, SQL and the lahman database to create an interesting infographic. For those of you who are not baseball fans, try doing a Google image search for &quot;baseball plots&quot; for inspiration. Make sure the plot is polished, has appropriate labels, color, etc.</h5>
<p><strong>Relevant topics:</strong> SQL, <a href="r.html#r-plotting">plotting in R</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code used to solve the problem.
</li>
<li>
The result of running the R code.
</li>
</ul>
</div>
</div>
<div id="solution-210" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Could be anything.</span></code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p11-390" class="section level3">
<h3>Project 11</h3>
<hr />
<p><strong>Motivation:</strong> Being able to use results of queries as tables in new queries (also known as writing sub-queries), and calculating values like MIN, MAX, and AVG in aggregate are key skills to have in order to write more complex queries. In this project we will learn about aliasing, writing sub-queries, and calculating aggregate values.</p>
<p><strong>Context:</strong> We are in the middle of a series of projects focused on working with databases and SQL. In this project we introduce aliasing, sub-queries, and calculating aggregate values using a much larger dataset!</p>
<p><strong>Scope:</strong> SQL, SQL in R</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Demonstrate the ability to interact with popular database management systems within R.
</li>
<li>
Solve data-driven problems using a combination of SQL and R.
</li>
<li>
Basic clauses: SELECT, ORDER BY, LIMIT, DESC, ASC, COUNT, WHERE, FROM, etc.
</li>
<li>
Showcase the ability to filter, alias, and write subqueries.
</li>
<li>
Perform grouping and aggregate data using group by and the following functions: COUNT, MAX, SUM, AVG, LIKE, HAVING. Explain when to use having, and when to use where.
</li>
</ul>
</div>
<div id="dataset-35" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the <code>elections</code> database. Similar to Project 10, this database is hosted on Scholar. Moreover, Question 1 also involves the following data files found in Scholar:</p>
<p><code>/class/datamine/data/election/itcontYYYY.txt</code> (for example, data for year 1980 would be <code>/class/datamine/data/election/itcont1980.txt</code>)</p>
<p>A public sample of the data can be found here:</p>
<p><a href="https://www.datadepot.rcac.purdue.edu/datamine/data/election/itcontYYYY.txt" class="uri">https://www.datadepot.rcac.purdue.edu/datamine/data/election/itcontYYYY.txt</a> (for example, data for year 1980 would be <a href="https://www.datadepot.rcac.purdue.edu/datamine/data/election/itcont1980.txt" class="uri">https://www.datadepot.rcac.purdue.edu/datamine/data/election/itcont1980.txt</a>)</p>
</div>
<div id="questions-35" class="section level4">
<h4>Questions</h4>
<p><strong>Important note:</strong> For this project you will need to connect to the database <code>elections</code> using the <code>RMariaDB</code> package in R. Include the following code chunk in the beginning of your RMarkdown file:</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{r setup-database-connection}
library(RMariaDB)
con &lt;- dbConnect(RMariaDB::MariaDB(), 
<span class="bn">                 host=&quot;scholar-db.rcac.purdue.edu&quot;, </span>
<span class="bn">                 db=&quot;elections&quot;, </span>
<span class="bn">                 user=&quot;elections_user&quot;, </span>
<span class="bn">                 password=&quot;Dataelect!98&quot;)</span>
```</code></pre></div>
<p>When a question involves SQL queries in this project, you may use a SQL code chunk (with <code>{sql}</code>), or an R code chunk (with <code>{r}</code>) and functions like <code>dbGetQuery</code> as you did in Project 10. Please refer to Question 5 in the <a href="https://raw.githubusercontent.com/TheDataMine/the-examples-book/master/files/project_template.Rmd">project template</a> for examples.</p>
<div id="approximately-how-large-was-the-lahman-database-use-the-sqlite-database-in-scholar-classdataminedatalahmanlahman.db-use-unix-utilities-youve-learned-about-this-semester-to-write-a-line-of-code-to-return-the-size-of-that-.db-file-in-mb.-1" class="section level5">
<h5>1. Approximately how large was the lahman database (use the sqlite database in Scholar: <code>/class/datamine/data/lahman/lahman.db</code>)? Use UNIX utilities you've learned about this semester to write a line of code to return the size of that .db file (in MB).</h5>
</div>
<div id="the-data-we-consider-in-this-project-are-much-larger.-use-unix-utilities-bash-and-awk-to-write-another-line-of-code-that-calculates-the-total-amount-of-data-in-the-elections-folder-classdataminedataelection.-how-much-data-in-mb-is-there-1" class="section level5">
<h5>The data we consider in this project are much larger. Use UNIX utilities (bash and awk) to write another line of code that calculates the total amount of data in the elections folder <code>/class/datamine/data/election/</code>. How much data (in MB) is there?</h5>
</div>
<div id="the-data-in-that-folder-has-been-added-to-the-elections-database-all-aggregated-in-the-elections-table.-write-a-sql-query-that-returns-the-number-of-rows-of-data-are-in-the-database.-how-many-rows-of-data-are-in-the-table-elections-1" class="section level5">
<h5>The data in that folder has been added to the <code>elections</code> database, all aggregated in the <code>elections</code> table. Write a SQL query that returns the number of rows of data are in the database. How many rows of data are in the table <code>elections</code>?</h5>
<p><strong>Note:</strong> These are some examples of how to get the sizes of collections of files in UNIX.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_edernjri&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_7g6c4dt2">Click here for video</a></p>
<p><strong>Hint:</strong> The SQL query will take some time! Be patient.</p>
<p><strong>Note:</strong> You may use more than one code chunk in your RMarkdown file for the different tasks.</p>
<p><strong>Note:</strong> We will accept values that represent either apparent or allocated size, as well as estimated disk usage. To get the size from <code>ls</code> and <code>du</code> to match, use the <code>--apparent-size</code> option with <code>du</code>.</p>
<p><strong>Note:</strong> A Megabyte (MB) is actually 1000^2 bytes, not 1024^2. A Mebibyte (MiB) is 1024^2 bytes. See <a href="https://en.wikipedia.org/wiki/Gigabyte">here</a> for more information. For this question, either solution will be given full credit. <a href="https://thedatamine.github.io/the-examples-book/unix.html#why-is-the-result-of-du--b-.metadata.csv-divided-by-1024-not-the-result-of-du--k-.metadata.csv">This</a> is a potentially useful example.</p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql">SQL</a>, <a href="r.html#r-sql">SQL in R</a>, <a href="unix.html#awk">awk</a>, <a href="unix.html#ls">ls</a>, <a href="unix.html#du">du</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Line of code (bash/awk) to show the size (in MB) of the lahman database file.
</li>
<li>
Approximate size of the lahman database in MB.
</li>
<li>
Line of code (bash/awk) to calculate the size (in MB) of the entire elections dataset in <code>/class/datamine/data/election</code>.
</li>
<li>
The size of the elections data in MB.
</li>
<li>
SQL query used to find the number of rows of data in the <code>elections</code> table in the <code>elections</code> database.
</li>
<li>
The number of rows in the <code>elections</code> table in the <code>elections</code> database.
</li>
</ul>
</div>
</div>
<div id="solution-211" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">ls</span> -la *.txt <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ total += $4; }END{print total/1000000}&#39;</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> <span class="fu">COUNT</span>(*) <span class="kw">FROM</span> elections;</code></pre></div>
</div>
<div id="write-a-sql-query-using-the-like-command-to-find-a-unique-list-of-zip_codes-that-start-with-479.-1" class="section level5">
<h5>2. Write a SQL query using the <code>LIKE</code> command to find a unique list of <code>zip_code</code>s that start with &quot;479&quot;.</h5>
</div>
<div id="write-another-sql-query-and-answer-how-many-unique-zip_codes-are-there-that-begin-with-479-1" class="section level5">
<h5>Write another SQL query and answer: How many unique <code>zip_code</code>s are there that begin with &quot;479&quot;?</h5>
<p><strong>Note:</strong> Here are some examples about SQL that might be relevant for Questions 2 and 3 in this project.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_gplhe4dj&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_o71dngd6">Click here for video</a></p>
<p><strong>Hint:</strong> The first query returns a list of zip codes, and the second returns a count.</p>
<p><strong>Hint:</strong> Make sure you only select <code>zip_code</code>s.</p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql">SQL</a>, <a href="https://www.tutorialspoint.com/sql/sql-like-clause.htm">LIKE</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL queries used to answer the question.
</li>
<li>
The first 5 results from running the query.
</li>
</ul>
</div>
</div>
<div id="solution-212" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> <span class="kw">DISTINCT</span> zip_code <span class="kw">FROM</span> elections <span class="kw">WHERE</span> zip_code <span class="kw">LIKE</span> <span class="st">&#39;479%&#39;</span> <span class="kw">LIMIT</span> <span class="dv">5</span>;
<span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="kw">DISTINCT</span> zip_code) <span class="kw">FROM</span> elections <span class="kw">WHERE</span> zip_code <span class="kw">LIKE</span> <span class="st">&#39;479%&#39;</span>;</code></pre></div>
</div>
<div id="write-a-sql-query-that-counts-the-number-of-donations-rows-that-are-from-indiana.-how-many-donations-are-from-indiana-rewrite-the-query-and-create-an-alias-for-our-field-so-it-doesnt-read-count-but-rather-indiana-donations.-1" class="section level5">
<h5>3. Write a SQL query that counts the number of donations (rows) that are from Indiana. How many donations are from Indiana? Rewrite the query and create an <em>alias</em> for our field so it doesn't read <code>COUNT(*)</code> but rather <code>Indiana Donations</code>.</h5>
<p><strong>Hint:</strong> You may enclose an alias's name in quotation marks (single or double) when the name contains space.</p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql">SQL</a>, <a href="sql.html#sql-where">WHERE</a>, <a href="sql.html#sql-aliasing">aliasing</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to answer the question.
</li>
<li>
The result of the SQL query.
</li>
</ul>
</div>
</div>
<div id="solution-213" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> <span class="fu">COUNT</span>(*) <span class="kw">FROM</span> elections <span class="kw">WHERE</span> state=<span class="st">&#39;IN&#39;</span>;
<span class="kw">SELECT</span> <span class="fu">COUNT</span>(*) <span class="kw">AS</span> <span class="st">&#39;Indiana Donations&#39;</span> <span class="kw">FROM</span> elections <span class="kw">WHERE</span> state=<span class="st">&#39;IN&#39;</span>;</code></pre></div>
</div>
<div id="rewrite-the-query-in-3-so-the-result-is-displayed-like-in-1234567.-note-if-instead-of-in-we-wanted-oh-only-the-where-clause-should-be-modified-and-the-display-should-automatically-change-to-oh-1234567.-in-other-words-the-state-abbreviation-should-be-dynamic-not-static.-1" class="section level5">
<h5>4. Rewrite the query in (3) so the result is displayed like: <code>IN: 1234567</code>. Note, if instead of &quot;IN&quot; we wanted &quot;OH&quot;, only the WHERE clause should be modified, and the display should automatically change to <code>OH: 1234567</code>. In other words, the state abbreviation should be dynamic, not static.</h5>
<p><strong>Note:</strong> This video demonstrates how to use CONCAT in a MySQL query.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_nu7iovqo&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_31dt64kx">Click here for video</a></p>
<p><strong>Hint:</strong> Use CONCAT and aliasing to accomplish this.</p>
<p><strong>Hint:</strong> Remember, <code>state</code> contains the state abbreviation.</p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql">SQL</a>, <a href="sql.html#sql-aliasing">aliasing</a>, <a href="https://www.tutorialspoint.com/sql/sql-concat-function.htm">CONCAT</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to answer the question.
</li>
</ul>
</div>
</div>
<div id="solution-214" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> <span class="fu">CONCAT</span>(state, <span class="ot">&quot;: &quot;</span>, <span class="fu">COUNT</span>(*)) <span class="kw">AS</span> <span class="st">&#39;Donations&#39;</span> <span class="kw">FROM</span> elections <span class="kw">WHERE</span> state=<span class="st">&#39;IN&#39;</span>;</code></pre></div>
</div>
<div id="in-2-we-wrote-a-query-that-returns-a-unique-list-of-zip_codes-that-start-with-479.-in-3-we-wrote-a-query-that-counts-the-number-of-donations-that-are-from-indiana.-use-our-query-from-2-as-a-sub-query-to-find-how-many-donations-come-from-areas-with-zip_codes-starting-with-479.-what-percent-of-donations-in-indiana-come-from-said-zip_codes-1" class="section level5">
<h5>5. In (2) we wrote a query that returns a unique list of <code>zip_code</code>s that start with &quot;479&quot;. In (3) we wrote a query that counts the number of donations that are from Indiana. Use our query from (2) as a sub-query to find how many donations come from areas with <code>zip_code</code>s starting with &quot;479&quot;. What percent of donations in Indiana come from said <code>zip_code</code>s?</h5>
<p><strong>Note:</strong> This video gives two examples of sub-queries.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_d2zr7cmo&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_4us9nsy9">Click here for video</a></p>
<p><strong>Hint:</strong> You can simply manually calculate the percent using the count in (2) and (5).</p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql">SQL</a>, <a href="sql.html#sql-aliasing">aliasing</a>, subqueries, <a href="https://www.tutorialspoint.com/mysql/mysql-in-clause.htm">IN</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL queries used to answer the question.
</li>
<li>
The percentage of donations from Indiana from <code>zip_code</code>s starting with &quot;479&quot;.
</li>
</ul>
</div>
</div>
<div id="solution-215" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> <span class="fu">COUNT</span>(*) <span class="kw">FROM</span> elections <span class="kw">WHERE</span> zip_code <span class="kw">IN</span> (<span class="kw">SELECT</span> <span class="kw">DISTINCT</span> zip_code <span class="kw">FROM</span> elections <span class="kw">WHERE</span> zip_code <span class="kw">LIKE</span> <span class="st">&#39;479%&#39;</span>);</code></pre></div>
</div>
<div id="in-3-we-wrote-a-query-that-counts-the-number-of-donations-that-are-from-indiana.-when-running-queries-like-this-a-natural-next-question-is-to-ask-the-same-question-about-another-state.-sql-gives-us-the-ability-to-calculate-functions-in-aggregate-when-grouping-by-a-certain-column.-write-a-sql-query-that-returns-the-state-number-of-donations-from-each-state-the-sum-of-the-donations-transaction_amt.-which-5-states-gave-the-most-donations-highest-count-order-you-result-from-most-to-least.-1" class="section level5">
<h5>6. In (3) we wrote a query that counts the number of donations that are from Indiana. When running queries like this, a natural &quot;next question&quot; is to ask the same question about another state. SQL gives us the ability to calculate functions in aggregate when grouping by a certain column. Write a SQL query that returns the state, number of donations from each state, the sum of the donations (<code>transaction_amt</code>). Which 5 states gave the most donations (highest count)? Order you result from most to least.</h5>
<p><strong>Note:</strong> In this video we demonstrate <code>GROUP BY</code>, <code>ORDER BY</code>, <code>DESC</code>, and other aspects of MySQL that might help with this question.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_530klfwl&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_iej3zqtf">Click here for video</a></p>
<p><strong>Hint:</strong> You may want to create an alias in order to sort.</p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql">SQL</a>, <a href="sql.html#sql-groupby">GROUP BY</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to answer the question.
</li>
<li>
Which 5 states gave the most donations?
</li>
</ul>
</div>
</div>
<div id="solution-216" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> state, <span class="fu">COUNT</span>(*) <span class="kw">AS</span> <span class="st">&#39;cnt&#39;</span>, <span class="fu">SUM</span>(transaction_amt) <span class="kw">AS</span> <span class="st">&#39;total&#39;</span> <span class="kw">FROM</span> elections <span class="kw">GROUP</span> <span class="kw">BY</span> state <span class="kw">ORDER</span> <span class="kw">BY</span> cnt <span class="kw">DESC</span>;</code></pre></div>
</div>
<div id="write-a-query-that-gets-the-number-of-donations-and-sum-of-donations-by-year-for-indiana.-create-one-or-more-graphics-that-highlights-the-year-by-year-changes.-write-a-short-1-2-sentences-explaining-your-graphics." class="section level5">
<h5>7. Write a query that gets the number of donations, and sum of donations, by year, for Indiana. Create one or more graphics that highlights the year-by-year changes. Write a short 1-2 sentences explaining your graphic(s).</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-sql">SQL in R</a>, <a href="sql.html#sql-groupby">GROUP</a>, <a href="https://www.tutorialspoint.com/sql/sql-date-functions.htm">date functions in SQL</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to answer the question.
</li>
<li>
R code used to create your graphic(s).
</li>
<li>
1 or more graphics in png/jpeg format.
</li>
<li>
1-2 sentences summarizing your graphic(s).
</li>
</ul>
</div>
</div>
<div id="solution-217" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RMariaDB)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(tidyverse)
db &lt;-<span class="st"> </span><span class="kw">dbConnect</span>(RMariaDB<span class="op">::</span><span class="kw">MariaDB</span>(), <span class="dt">host=</span><span class="st">&quot;scholar-db.rcac.purdue.edu&quot;</span>, <span class="dt">db=</span><span class="st">&quot;elections&quot;</span>, <span class="dt">user=</span><span class="st">&quot;elections_user&quot;</span>, <span class="dt">password=</span><span class="st">&quot;Dataelect!98&quot;</span>)
dat &lt;-<span class="st"> </span><span class="kw">dbGetQuery</span>(db, <span class="st">&quot;SELECT COUNT(*) as cnt, SUM(transaction_amt) as amt, YEAR(transaction_dt) as yr FROM elections WHERE state=&#39;IN&#39; GROUP BY yr ORDER BY yr;&quot;</span>)
filtered_dat =<span class="st"> </span><span class="kw">filter</span>(dat, <span class="kw">between</span>(yr, <span class="dv">1978</span>, <span class="dv">2020</span>))
<span class="kw">ggplot</span>(filtered_dat, <span class="kw">aes</span>(<span class="dt">x=</span>yr,<span class="dt">y=</span>amt<span class="op">/</span><span class="fl">1e6</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;Year&#39;</span>, <span class="dt">y=</span><span class="st">&#39;Amount in millions&#39;</span>)
<span class="kw">ggplot</span>(filtered_dat, <span class="kw">aes</span>(<span class="dt">x=</span>yr,<span class="dt">y=</span>amt<span class="op">/</span>(<span class="fl">1e3</span><span class="op">*</span>cnt))) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;Year&#39;</span>, <span class="dt">y=</span><span class="st">&#39;Average amount in thousands&#39;</span>)
<span class="kw">ggplot</span>(filtered_dat, <span class="kw">aes</span>(<span class="dt">x=</span>yr,<span class="dt">y=</span><span class="kw">as.numeric</span>(cnt)<span class="op">/</span><span class="fl">1e3</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()  <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;Year&#39;</span>, <span class="dt">y=</span><span class="st">&#39;Number of donations in thousands&#39;</span>)</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p12-390" class="section level3">
<h3>Project 12</h3>
<hr />
<p><strong>Motivation:</strong> Databases are comprised of many tables. It is imperative that we learn how to combine data from multiple tables using queries. To do so we perform joins! In this project we will explore learn about and practice using joins on a database containing bike trip information from the Bay Area Bike Share.</p>
<p><strong>Context:</strong> We've introduced a variety of SQL commands that let you filter and extract information from a database in an systematic way. In this project we will introduce joins, a powerful method to combine data from different tables.</p>
<p><strong>Scope:</strong> SQL, sqlite, joins</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Briefly explain the differences between left and inner join and demonstrate the ability to use the join statements to solve a data-driven problem.
</li>
<li>
Perform grouping and aggregate data using group by and the following functions: COUNT, MAX, SUM, AVG, LIKE, HAVING.
</li>
<li>
Showcase the ability to filter, alias, and write subqueries.
</li>
</ul>
</div>
<div id="dataset-36" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/bay_area_bike_share/bay_area_bike_share.db</code></p>
<p>A public sample of the data can be found <a href="https://www.datadepot.rcac.purdue.edu/datamine/data/bay_area_bike_share/bay_area_bike_share.db">here</a>.</p>
<p><strong>Important note:</strong> For this project all solutions should be done using SQL code chunks. To connect to the database, copy and paste the following before your solutions in your .Rmd:</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{r, include=F}
library(RSQLite)
bikeshare &lt;- dbConnect(RSQLite::SQLite(), &quot;/class/datamine/data/bay_area_bike_share/bay_area_bike_share.db&quot;)
```</code></pre></div>
<p>Each solution should then be placed in a code chunk like this:</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{sql, connection=bikeshare}
SELECT * FROM station LIMIT 5;
```</code></pre></div>
<p>If you want to use a SQLite-specific function like <code>.tables</code> (or prefer to test things in the Terminal), you will need to use the Terminal to connect to the database and run queries. To do so, you can connect to RStudio Server at <a href="https://rstudio.scholar.rcac.purdue.edu" class="uri">https://rstudio.scholar.rcac.purdue.edu</a>, and navigate to the terminal. In the terminal execute the command:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">sqlite3</span> /class/datamine/data/bay_area_bike_share/bay_area_bike_share.db</code></pre></div>
<p>From there, the SQLite-specific commands will function properly. They will <em>not</em> function properly in an SQL code chunk. To display the SQLite-specific commands in a code chunk without running the code, use a code chunk with the option <code>eval=F</code> like this:</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{sql, connection=bikeshare, eval=F}
SELECT * FROM station LIMIT 5;
```</code></pre></div>
<p>This will allow the code to be displayed without throwing an error.</p>
<div id="there-are-a-variety-of-ways-to-join-data-using-sql.-with-that-being-said-if-you-are-able-to-understand-and-use-a-left-join-and-inner-join-you-can-perform-all-of-the-other-types-of-joins-right-join-full-outer-join.-you-can-see-the-documentation-here-sql-inner-join-left-join-1" class="section level5">
<h5>There are a variety of ways to join data using SQL. With that being said, if you are able to understand and use a LEFT JOIN and INNER JOIN, you can perform <em>all</em> of the other types of joins (RIGHT JOIN, FULL OUTER JOIN). You can see the documentation here: <a href="sql.html#sql">SQL</a>, <a href="sql.html#sql-inner-join">INNER JOIN</a>, <a href="sql.html#sql-left-join">LEFT JOIN</a></h5>
</div>
</div>
<div id="questions-36" class="section level4">
<h4>Questions</h4>
<div id="aliases-can-be-created-for-tables-fields-and-even-results-of-aggregate-functions-like-min-max-count-avg-etc..-in-addition-you-can-combine-fields-using-the-sqlite-concatenate-operator-see-here.-write-a-query-that-returns-the-first-5-records-of-information-from-the-station-table-formatted-in-the-following-way-1" class="section level5">
<h5>1. Aliases can be created for tables, fields, and even results of aggregate functions (like MIN, MAX, COUNT, AVG, etc.). In addition, you can combine fields using the <code>sqlite</code> concatenate operator <code>||</code> (see <a href="https://www.sqlitetutorial.net/sqlite-string-functions/sqlite-concat/">here</a>). Write a query that returns the first 5 records of information from the <code>station</code> table formatted in the following way:</h5>
<p><code>(id) name @ (lat, long)</code></p>
<p>For example:</p>
<p><code>(84) Ryland Park @ (37.342725, -121.895617)</code></p>
<p><strong>Hint:</strong> Here is a video about how to concatenate strings in SQLite.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_40z55oz9&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_a4f4x2k9">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-aliasing">aliasing</a>, concat</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to solve this problem.
</li>
<li>
The first 5 records of information from the <code>station</code> table.
</li>
</ul>
</div>
</div>
<div id="solution-218" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> <span class="st">&#39;(&#39;</span>||id||<span class="st">&#39;) &#39;</span>||name||<span class="st">&#39; @ (&#39;</span>||lat||<span class="st">&#39;,&#39;</span>||long||<span class="st">&#39;)&#39;</span> <span class="kw">FROM</span> station <span class="kw">LIMIT</span> <span class="dv">5</span>;</code></pre></div>
</div>
<div id="there-is-a-variety-of-interesting-weather-information-in-the-weather-table.-write-a-query-that-finds-the-average-mean_temperature_f-by-zip_code.-which-is-on-average-the-warmest-zip_code-1" class="section level5">
<h5>2. There is a variety of interesting weather information in the <code>weather</code> table. Write a query that finds the average <code>mean_temperature_f</code> by <code>zip_code</code>. Which is on average the warmest <code>zip_code</code>?</h5>
<p>Use aliases to format the result in the following way:</p>
<pre class="txt"><code>Zip Code|Avg Temperature
94041|61.3808219178082</code></pre>
<p>Note that this is the output if you use <code>sqlite</code> in the terminal. While the output in your knitted pdf file may look different, you should name the columns accordingly.</p>
<p><strong>Hint:</strong> Here is a video about GROUP BY, ORDER BY, DISTINCT, and COUNT</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_soilqf5i&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_hwehjhwd">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-aliasing">aliasing</a>, <a href="https://www.w3schools.com/sql/sql_groupby.asp">GROUP BY</a>, <a href="https://www.w3schools.com/sql/sql_count_avg_sum.asp">AVG</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to solve this problem.
</li>
<li>
The results of the query copy and pasted.
</li>
</ul>
</div>
</div>
<div id="solution-219" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> zip_code <span class="kw">AS</span> <span class="st">&#39;Zip Code&#39;</span>, <span class="fu">AVG</span>(mean_temperature_f) <span class="kw">AS</span> <span class="st">&#39;Avg Temperature&#39;</span> <span class="kw">FROM</span> weather <span class="kw">GROUP</span> <span class="kw">BY</span> zip_code;</code></pre></div>
</div>
<div id="from-2-we-can-see-that-there-are-only-5-zip_codes-with-weather-information.-how-many-unique-zip_codes-do-we-have-in-the-trip-table-write-a-query-that-finds-the-number-of-unique-zip_codes-in-the-trip-table.-write-another-query-that-lists-the-zip_code-and-count-of-the-number-of-times-the-zip_code-appears.-if-we-had-originally-assumed-that-the-zip_code-was-related-to-the-location-of-the-trip-itself-we-were-wrong.-can-you-think-of-a-likely-explanation-for-the-unexpected-zip_code-values-in-the-trip-table-1" class="section level5">
<h5>3. From (2) we can see that there are only 5 <code>zip_code</code>s with weather information. How many unique <code>zip_code</code>s do we have in the <code>trip</code> table? Write a query that finds the number of unique <code>zip_code</code>s in the <code>trip</code> table. Write another query that lists the <code>zip_code</code> and count of the number of times the <code>zip_code</code> appears. If we had originally assumed that the <code>zip_code</code> was related to the location of the trip itself, we were wrong. Can you think of a likely explanation for the unexpected <code>zip_code</code> values in the <code>trip</code> table?</h5>
<p><strong>Hint:</strong> There could be missing values in <code>zip_code</code>. We want to avoid them in SQL queries, for now. You can learn more about the missing values (or NULL) in SQL <a href="https://www.w3schools.com/sql/sql_null_values.asp">here</a>.</p>
<p><strong>Relevant topics:</strong> <a href="https://www.w3schools.com/sql/sql_groupby.asp">GROUP BY</a>, <a href="https://www.w3schools.com/sql/sql_count_avg_sum.asp">COUNT</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL queries used to solve this problem.
</li>
<li>
1-2 sentences explainging what a possible explanation for the <code>zip_code</code>s could be.
</li>
</ul>
</div>
</div>
<div id="solution-220" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="kw">DISTINCT</span> zip_code) <span class="kw">FROM</span> trip;
<span class="kw">SELECT</span> zip_code, <span class="fu">COUNT</span>(zip_code) <span class="kw">FROM</span> trip <span class="kw">GROUP</span> <span class="kw">BY</span> zip_code;</code></pre></div>
</div>
<div id="in-2-we-wrote-a-query-that-finds-the-average-mean_temperature_f-by-zip_code.-what-if-we-want-to-tack-on-our-results-in-2-to-information-from-each-row-in-the-station-table-based-on-the-zip_codes-to-do-this-use-an-inner-join.-inner-join-combines-tables-based-on-specified-fields-and-returns-only-rows-where-there-is-a-match-in-both-the-left-and-right-tables.-1" class="section level5">
<h5>4. In (2) we wrote a query that finds the average <code>mean_temperature_f</code> by <code>zip_code</code>. What if we want to tack on our results in (2) to information from each row in the <code>station</code> table based on the <code>zip_code</code>s? To do this, use an INNER JOIN. INNER JOIN combines tables based on specified fields, and returns only rows where there is a match in both the &quot;left&quot; and &quot;right&quot; tables.</h5>
<p><strong>Hint:</strong> Use the query from (2) as a sub query within your solution.</p>
<p><strong>Hint:</strong> Here is a video about JOIN and LEFT JOIN.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_5ugjqrhk&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_i4qp5bam">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-inner-join">INNER JOIN</a>, subqueries, <a href="sql.html#sql-aliasing">aliasing</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to solve this problem.
</li>
</ul>
</div>
</div>
<div id="solution-221" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> * <span class="kw">FROM</span> station <span class="kw">as</span> s <span class="kw">INNER</span> <span class="kw">JOIN</span> (<span class="kw">SELECT</span> zip_code <span class="kw">AS</span> <span class="st">&#39;Zip Code&#39;</span>, <span class="fu">AVG</span>(mean_temperature_f) <span class="kw">AS</span> <span class="st">&#39;Avg Temperature&#39;</span> <span class="kw">FROM</span> weather <span class="kw">GROUP</span> <span class="kw">BY</span> zip_code) <span class="kw">AS</span> sub <span class="kw">ON</span> s.zip_code=sub.<span class="st">&#39;Zip Code&#39;</span>;</code></pre></div>
</div>
<div id="in-3-we-alluded-to-the-fact-that-the-zip_codes-in-the-trip-table-arent-very-consistent.-users-can-enter-a-zip-code-when-using-the-app.-this-means-that-zip_code-can-be-from-anywhere-in-the-world-with-that-being-said-if-the-zip_code-is-one-of-the-5-zip_codes-for-which-we-have-weather-data-from-question-2-we-can-add-that-weather-information-to-matching-rows-of-the-trip-table.-in-4-we-used-an-inner-join-to-append-some-weather-information-to-each-row-in-the-station-table.-for-this-question-write-a-query-that-performs-an-inner-join-and-appends-weather-data-from-the-weather-table-to-the-trip-data-from-the-trip-table.-limit-your-output-to-5-lines.-1" class="section level5">
<h5>5. In (3) we alluded to the fact that the <code>zip_code</code>s in the <code>trip</code> table aren't very consistent. Users can enter a zip code when using the app. This means that <code>zip_code</code> can be from anywhere in the world! With that being said, if the <code>zip_code</code> is one of the 5 <code>zip_code</code>s for which we have weather data (from question 2), we can add that weather information to matching rows of the <code>trip</code> table. In (4) we used an INNER JOIN to append some weather information to each row in the <code>station</code> table. For this question, write a query that performs an INNER JOIN and appends weather data from the <code>weather</code> table to the trip data from the <code>trip</code> table. Limit your output to 5 lines.</h5>
<p><strong>Important note:</strong> Notice that the weather data has about 1 row of weather information for each date and each zip code. This means you may have to join your data based on multiple constraints instead of just 1 like in (4). In the <code>trip</code> table, you can use <code>start_date</code> for for the date information.</p>
<p><strong>Hint:</strong> You will want to wrap your dates and datetimes in <a href="https://www.sqlitetutorial.net/sqlite-date-functions/sqlite-date-function/">sqlite's <code>date</code> function</a> prior to comparison.</p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-inner-join">INNER JOIN</a>, <a href="sql.html#sql-aliasing">aliasing</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to solve this problem.
</li>
<li>
First 5 lines of output.
</li>
</ul>
</div>
</div>
<div id="solution-222" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> * <span class="kw">FROM</span> trip <span class="kw">AS</span> t <span class="kw">INNER</span> <span class="kw">JOIN</span> weather <span class="kw">AS</span> w <span class="kw">ON</span> t.zip_code=w.zip_code <span class="kw">AND</span> <span class="dt">date</span>(t.start_date)=date(w.date) <span class="kw">LIMIT</span> <span class="dv">5</span>;</code></pre></div>
</div>
<div id="how-many-rows-are-in-the-result-from-5-when-not-limiting-to-5-lines-how-many-rows-are-in-the-trip-table-as-you-can-see-a-large-proportion-of-the-data-from-the-trip-table-did-not-match-the-data-from-the-weather-table-and-therefore-was-removed-from-the-result.-what-if-we-want-to-keep-all-of-the-data-from-the-trip-table-and-add-on-data-from-the-weather-table-if-we-have-a-match-write-a-query-to-accomplish-this.-how-many-rows-are-in-the-result" class="section level5">
<h5>6. How many rows are in the result from (5) (when not limiting to 5 lines)? How many rows are in the <code>trip</code> table? As you can see, a large proportion of the data from the <code>trip</code> table did not match the data from the <code>weather</code> table, and therefore was removed from the result. What if we want to keep all of the data from the <code>trip</code> table and add on data from the <code>weather</code> table if we have a match? Write a query to accomplish this. How many rows are in the result?</h5>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to find how many rows from the result in (5).
</li>
<li>
The number of rows in the result of (5).
</li>
<li>
SQL query to find how many rows are in the <code>trip</code> table.
</li>
<li>
The number of rows in the <code>trip</code> table.
</li>
<li>
SQL query to keep all of the data from the <code>trip</code> table and add on matching data from the <code>weather</code> table when available.
</li>
<li>
The number of rows in the result.
</li>
</ul>
</div>
</div>
<div id="solution-223" class="section level5">
<h5>Solution</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> <span class="fu">COUNT</span>(*) <span class="kw">FROM</span> trip <span class="kw">AS</span> t <span class="kw">INNER</span> <span class="kw">JOIN</span> weather <span class="kw">AS</span> w <span class="kw">ON</span> t.zip_code=w.zip_code <span class="kw">AND</span> <span class="dt">date</span>(t.start_date)=date(w.date);</code></pre></div>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> <span class="fu">COUNT</span>(*) <span class="kw">FROM</span> trip;</code></pre></div>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> * <span class="kw">FROM</span> trip <span class="kw">AS</span> t <span class="kw">LEFT</span> <span class="kw">JOIN</span> weather <span class="kw">AS</span> w <span class="kw">ON</span> t.zip_code=w.zip_code <span class="kw">AND</span> <span class="dt">date</span>(t.start_date)=date(w.date) <span class="kw">LIMIT</span> <span class="dv">5</span>;</code></pre></div>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> <span class="fu">COUNT</span>(*) <span class="kw">FROM</span> trip <span class="kw">AS</span> t <span class="kw">LEFT</span> <span class="kw">JOIN</span> weather <span class="kw">AS</span> w <span class="kw">ON</span> t.zip_code=w.zip_code <span class="kw">AND</span> <span class="dt">date</span>(t.start_date)=date(w.date);</code></pre></div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p13-390" class="section level3">
<h3>Project 13</h3>
<hr />
<p><strong>Motivation:</strong> Databases you will work with won't necessarily come organized in the way that you like. Getting really comfortable writing longer queries where you have to perform many joins, alias fields and tables, and aggregate results, is important. In addition, gaining some familiarity with terms like <em>primary key</em>, and <em>foreign key</em> will prove useful when you need to search for help online. In this project we will write some more complicated queries with a fun database. Proper preparation prevents poor performance, and that means practice!</p>
<p><strong>Context:</strong> We are towards the end of a series of projects that give you an opportunity to practice using SQL. In this project, we will reinforce topics you've already learned, with a focus on subqueries and joins.</p>
<p><strong>Scope:</strong> SQL, sqlite</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Write and run SQL queries in <code>sqlite</code> on real-world data.
</li>
<li>
Identify primary and foreign keys in a SQL table.
</li>
</ul>
</div>
<div id="dataset-37" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/movies_and_tv/imdb.db</code></p>
<p><strong>Important note:</strong> For this project you will use SQLite to access the data. To connect to the database, copy and paste the following before your solutions in your .Rmd:</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{r, include=F}
library(RSQLite)
imdb &lt;- dbConnect(RSQLite::SQLite(), &quot;/class/datamine/data/movies_and_tv/imdb.db&quot;)
```</code></pre></div>
<p>If you want to use a SQLite-specific function like <code>.tables</code> (or prefer to test things in the Terminal), you will need to use the Terminal to connect to the database and run queries. To do so, you can connect to RStudio Server at <a href="https://rstudio.scholar.rcac.purdue.edu" class="uri">https://rstudio.scholar.rcac.purdue.edu</a>, and navigate to the terminal. In the terminal execute the command:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">sqlite3</span> /class/datamine/data/movies_and_tv/imdb.db</code></pre></div>
<p>From there, the SQLite-specific commands will function properly. They will <em>not</em> function properly in an SQL code chunk. To display the SQLite-specific commands in a code chunk without running the code, use a code chunk with the option <code>eval=F</code> like this:</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">```{sql, connection=imdb, eval=F}
SELECT * FROM titles LIMIT 5;
```</code></pre></div>
<p>This will allow the code to be displayed without throwing an error.</p>
</div>
<div id="questions-37" class="section level4">
<h4>Questions</h4>
<div id="a-primary-key-is-a-field-in-a-table-which-uniquely-identifies-a-row-in-the-table.-primary-keys-must-be-unique-values-and-this-is-enforced-at-the-database-level.-a-foreign-key-is-a-field-whose-value-matches-a-primary-key-in-a-different-table.-a-table-can-have-0-1-primary-key-but-it-can-have-0-foreign-keys.-examine-the-titles-table.-do-you-think-there-are-any-primary-keys-how-about-foreign-keys-now-examine-the-episodes-table.-based-on-observation-and-the-column-names-do-you-think-there-are-any-primary-keys-how-about-foreign-keys-1" class="section level5">
<h5>1. A primary key is a field in a table which uniquely identifies a row in the table. Primary keys <em>must</em> be unique values, and this is enforced at the database level. A foreign key is a field whose value matches a primary key in a different table. A table can have 0-1 primary key, but it can have 0+ foreign keys. Examine the <code>titles</code> table. Do you think there are any primary keys? How about foreign keys? Now examine the <code>episodes</code> table. Based on observation and the column names, do you think there are any primary keys? How about foreign keys?</h5>
<p><strong>Hint:</strong> A primary key can also be a foreign key.</p>
<p><strong>Hint:</strong> Here are two videos. The first video will remind you how to find the names of all of the tables in the <code>imdb</code> database. The second video will introduce you to the <code>titles</code> and <code>episodes</code> tables in the <code>imdb</code> database.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_7ktvbhc9&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_ae112udc">Click here for video</a></p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_wc2hl3xm&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_y7qo7jpu">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="https://www.geeksforgeeks.org/difference-between-primary-key-and-foreign-key/">primary key</a>, <a href="https://www.geeksforgeeks.org/difference-between-primary-key-and-foreign-key/">foreign key</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
List any primary or foreign keys in the <code>titles</code> table.
</li>
<li>
List any primary or foreign keys in the <code>episodes</code> table.
</li>
</ul>
</div>
</div>
<div id="if-you-paste-a-title_id-to-the-end-of-the-following-url-it-will-pull-up-the-page-for-the-title.-for-example-httpswww.imdb.comtitlett0413573-leads-to-the-page-for-the-tv-series-greys-anatomy.-write-a-sql-query-to-confirm-that-the-title_id-tt0413573-does-indeed-belong-to-greys-anatomy.-then-browse-imdb.com-and-find-your-favorite-tv-show.-get-the-title_id-from-the-url-of-your-favorite-tv-show-and-run-the-following-query-to-confirm-that-the-tv-show-is-in-our-database-1" class="section level5">
<h5>2. If you paste a <code>title_id</code> to the end of the following url, it will pull up the page for the title. For example, <a href="https://www.imdb.com/title/tt0413573" class="uri">https://www.imdb.com/title/tt0413573</a> leads to the page for the TV series <em>Grey's Anatomy</em>. Write a SQL query to confirm that the <code>title_id</code> tt0413573 does indeed belong to <em>Grey's Anatomy</em>. Then browse imdb.com and find your favorite TV show. Get the <code>title_id</code> from the url of your favorite TV show and run the following query, to confirm that the TV show is in our database:</h5>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> * <span class="kw">FROM</span> titles <span class="kw">WHERE</span> title_id=<span class="st">&#39;&lt;title id here&gt;&#39;</span>;</code></pre></div>
<p>Make sure to replace &quot;&lt;title id here&gt;&quot; with the <code>title_id</code> of your favorite show. If your show does not appear, or has only a single season, pick another show until you find one we have in our database with multiple seasons.</p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-examples">SELECT</a>, WHERE</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to confirm that <code>title_id</code> tt0413573 does indeed belong to <em>Grey's Anatomy</em>.
</li>
<li>
The output of the query.
</li>
<li>
The <code>title_id</code> of your favorite TV show.
</li>
<li>
SQL query used to confirm the <code>title_id</code> for your favorite TV show.
</li>
<li>
The output of the query.
</li>
</ul>
</div>
</div>
<div id="the-episode_title_id-column-in-the-episodes-table-references-titles-of-individual-episodes-of-a-tv-series.-the-show_title_id-references-the-titles-of-the-show-itself.-with-that-in-mind-write-a-query-that-gets-a-list-of-all-of-the-episodes_title_ids-found-in-the-episodes-table-with-the-associated-primary_title-found-in-the-titles-table-for-each-episode-of-greys-anatomy.-1" class="section level5">
<h5>3. The <code>episode_title_id</code> column in the <code>episodes</code> table references titles of individual episodes of a TV series. The <code>show_title_id</code> references the titles of the show itself. With that in mind, write a query that gets a list of all of the <code>episodes_title_id</code>s (found in the <code>episodes</code> table), with the associated <code>primary_title</code> (found in the <code>titles</code> table) for each episode of <em>Grey's Anatomy</em>.</h5>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-inner-join">INNER JOIN</a></p>
<p><strong>Hint:</strong> This video shows how to extract titles of episodes in the <code>imdb</code> database.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_uhg3atol&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_wmo98brv">Click here for video</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to solve the problem in a code chunk.
</li>
</ul>
</div>
</div>
<div id="we-want-to-write-a-query-that-returns-the-title-and-rating-of-the-highest-rated-episode-of-your-favorite-tv-show-which-you-chose-in-2.-in-order-to-do-so-we-will-break-the-task-into-two-parts-in-4-and-5.-first-write-a-query-that-returns-a-list-of-episode_title_ids-found-in-the-episodes-table-with-the-associated-primary_title-found-in-the-titles-table-for-each-episode.-1" class="section level5">
<h5>4. We want to write a query that returns the title and rating of the highest rated episode of your favorite TV show, which you chose in (2). In order to do so, we will break the task into two parts in (4) and (5). First, write a query that returns a list of <code>episode_title_id</code>s (found in the <code>episodes</code> table), with the associated <code>primary_title</code> (found in the <code>titles</code> table) for each episode.</h5>
<p><strong>Hint:</strong> This part is just like question (3) but this time with your favorite TV show, which you chose in (2).</p>
<p><strong>Hint:</strong> This video shows how to use a subquery, to <code>JOIN</code> a total of three tables in the <code>imdb</code> database.</p>
<p><a href="https://cdnapisec.kaltura.com/p/983291/sp/98329100/embedIframeJs/uiconf_id/29134031/partner_id/983291?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_jb8vd4nc&amp;flashvars%5BstreamerType%5D=auto&amp;flashvars%5BlocalizationCode%5D=en&amp;flashvars%5BleadWithHTML5%5D=true&amp;flashvars%5BsideBarContainer.plugin%5D=true&amp;flashvars%5BsideBarContainer.position%5D=left&amp;flashvars%5BsideBarContainer.clickToClose%5D=true&amp;flashvars%5Bchapters.plugin%5D=true&amp;flashvars%5Bchapters.layout%5D=vertical&amp;flashvars%5Bchapters.thumbnailRotator%5D=false&amp;flashvars%5BstreamSelector.plugin%5D=true&amp;flashvars%5BEmbedPlayer.SpinnerTarget%5D=videoHolder&amp;flashvars%5BdualScreen.plugin%5D=true&amp;flashvars%5BKaltura.addCrossoriginToIframe%5D=true&amp;&amp;wid=1_sc5yje1a">Click here for video</a></p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-inner-join">INNER JOIN</a>, <a href="sql.html#sql-aliasing">aliasing</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to solve the problem in a code chunk.
</li>
<li>
The first 5 results from your query.
</li>
</ul>
</div>
</div>
<div id="write-a-query-that-adds-the-rating-to-the-end-of-each-episode.-to-do-so-use-the-query-you-wrote-in-4-as-a-subquery.-which-episode-has-the-highest-rating-is-it-also-your-favorite-episode-1" class="section level5">
<h5>5. Write a query that adds the rating to the end of each episode. To do so, use the query you wrote in (4) as a subquery. Which episode has the highest rating? Is it also your favorite episode?</h5>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-inner-join">INNER JOIN</a>, <a href="sql.html#sql-aliasing">aliasing</a>, subqueries, ORDER BY, DESC, LIMIT</p>
<p><strong>Note</strong>: Various helpful examples that utilize the relevant topics in this problem can be found <a href="sql.html#sql-examples">here</a>.</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to solve the problem in a code chunk.
</li>
<li>
The <code>episode_title_id</code>, <code>primary_title</code>, and <code>rating</code> of the top rated episode from your favorite TV series, in question (2).
</li>
<li>
A statement saying whether the highest rated episode is also your favorite episode.
</li>
</ul>
</div>
</div>
<div id="write-a-query-that-returns-the-season_number-from-the-episodes-table-and-average-rating-from-the-ratings-table-for-each-season-of-your-favorite-tv-show-from-2.-write-another-query-that-only-returns-the-season-number-and-rating-for-the-highest-rated-season.-consider-the-highest-rated-season-the-season-with-the-highest-average." class="section level5">
<h5>6. Write a query that returns the <code>season_number</code> (from the <code>episodes</code> table), and average <code>rating</code> (from the <code>ratings</code> table) for each season of your favorite TV show from (2). Write another query that only returns the season number and <code>rating</code> for the highest rated season. Consider the highest rated season the season with the highest average.</h5>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-inner-join">INNER JOIN</a>, <a href="sql.html#sql-aliasing">aliasing</a>, GROUP BY, AVG</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The 2 SQL queries used to solve the problems in two code chunks.
</li>
</ul>
</div>
</div>
<div id="write-a-query-that-returns-the-primary_title-and-rating-of-the-highest-rated-episode-per-season-for-your-favorite-tv-show-from-question-2." class="section level5">
<h5>7. Write a query that returns the <code>primary_title</code> and <code>rating</code> of the highest rated episode per season for your favorite TV show from question (2).</h5>
<p><strong>Note:</strong> You can show one highest rated episode for each season, without the need to worry about ties.</p>
<p><strong>Relevant topics:</strong> MAX, subqueries, GROUP BY, <a href="sql.html#sql-inner-join">INNER JOIN</a>, <a href="sql.html#sql-aliasing">aliasing</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The SQL query used to solve the problem.
</li>
<li>
The output from your query.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p14-390" class="section level3">
<h3>Project 14</h3>
<hr />
<p><strong>Motivation:</strong> As we learned earlier in the semester, bash scripts are a powerful tool when you need to perform repeated tasks in a UNIX-like system. In addition, sometimes preprocessing data using UNIX tools prior to analysis in R or Python is useful. Ample practice is integral to becoming proficient with these tools. As such, we will be reviewing topics learned earlier in the semester.</p>
<p><strong>Context:</strong> We've just ended a series of projects focused on SQL. In this project we will begin to review topics learned throughout the semester, starting writing bash scripts using the various UNIX tools we learned about in Projects 3 through 8.</p>
<p><strong>Scope:</strong> awk, UNIX utilities, bash scripts, fread</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Navigating UNIX via a terminal: ls, pwd, cd, ., .., ~, etc.
</li>
<li>
Analyzing file in a UNIX filesystem: wc, du, cat, head, tail, etc.
</li>
<li>
Creating and destroying files and folder in UNIX: scp, rm, touch, cp, mv, mkdir, rmdir, etc.
</li>
<li>
Use grep to search files effectively.
</li>
<li>
Use cut to section off data from the command line.
</li>
<li>
Use piping to string UNIX commands together.
</li>
<li>
Use awk for data extraction, and preprocessing.
</li>
<li>
Create bash scripts to automate a process or processes.
</li>
</ul>
</div>
<div id="dataset-38" class="section level4">
<h4>Dataset:</h4>
<p>The following questions will use PLOTSNAP.csv and TREE.csv from the data folder found in Scholar:</p>
<p><code>/class/datamine/data/forest</code></p>
<p>To read more about the two files from this dataset that you will be working with:</p>
<p>PLOTSNAP.csv:</p>
<p><a href="https://www.uvm.edu/femc/data/archive/project/federal-forest-inventory-analysis-data-for/dataset/plot-level-data-gathered-through-forest/metadata#fields" class="uri">https://www.uvm.edu/femc/data/archive/project/federal-forest-inventory-analysis-data-for/dataset/plot-level-data-gathered-through-forest/metadata#fields</a></p>
<p>TREE.csv:</p>
<p><a href="https://www.uvm.edu/femc/data/archive/project/federal-forest-inventory-analysis-data-for/dataset/tree-level-data-gathered-through-forest/metadata" class="uri">https://www.uvm.edu/femc/data/archive/project/federal-forest-inventory-analysis-data-for/dataset/tree-level-data-gathered-through-forest/metadata</a></p>
<p>AND</p>
<p><a href="https://www.uvm.edu/femc/data/archive/project/federal-forest-inventory-analysis-data-for/dataset/tree-level-data-gathered-through-forest/data" class="uri">https://www.uvm.edu/femc/data/archive/project/federal-forest-inventory-analysis-data-for/dataset/tree-level-data-gathered-through-forest/data</a></p>
</div>
<div id="questions-38" class="section level4">
<h4>Questions</h4>
<div id="take-a-look-at-at-plotsnap.csv.-write-a-line-of-awk-code-that-displays-the-statecd-followed-by-the-number-of-rows-with-that-statecd.-1" class="section level5">
<h5>1. Take a look at at <code>PLOTSNAP.csv</code>. Write a line of awk code that displays the <code>STATECD</code> followed by the number of rows with that <code>STATECD</code>.</h5>
<p><strong>Relevant topics:</strong> <a href="unix.html#awk">awk</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Code used to solve the problem.
</li>
<li>
Count of the following <code>STATECD</code>s: 1, 2, 4, 5, 6
</li>
</ul>
</div>
</div>
<div id="unfortunately-there-isnt-a-very-accessible-list-available-that-shows-which-state-each-statecd-represents.-this-is-no-problem-for-us-though-the-dataset-has-lat-and-lon-write-some-bash-that-prints-just-the-statecd-lat-and-lon.-1" class="section level5">
<h5>2. Unfortunately, there isn't a very accessible list available that shows which state each <code>STATECD</code> represents. This is no problem for us though, the dataset has <code>LAT</code> and <code>LON</code>! Write some bash that prints just the <code>STATECD</code>, <code>LAT</code>, and <code>LON</code>.</h5>
<p><strong>Note:</strong> There are 92 columns in our dataset: <code>awk -F, 'NR==1{print NF}' PLOTSNAP.csv</code>. To create a list of <code>STATECD</code> to state, we only really need <code>STATECD</code>, <code>LAT</code>, and <code>LON</code>. Keeping the other 89 variables will keep our data at 2.1gb.</p>
<p><strong>Relevant topics:</strong> <a href="unix.html#cut">cut</a>, <a href="unix.html#awk">awk</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Code used to solve the problem.
</li>
<li>
The output of your code piped to <code>head</code>.
</li>
</ul>
</div>
</div>
<div id="fread-is-a-fast-and-friendly-file-finagler.-it-is-part-of-the-very-popular-data.table-package-in-r.-we-will-learn-more-about-this-package-next-semester.-for-now-read-the-documentation-here-and-use-the-cmd-argument-in-conjunction-with-your-bash-code-from-2-to-read-the-data-of-statecd-lat-and-lon-into-a-data.table-in-your-r-environment.-1" class="section level5">
<h5>3. <code>fread</code> is a &quot;Fast and Friendly File Finagler&quot;. It is part of the very popular <code>data.table</code> package in R. We will learn more about this package next semester. For now, read the documentation <a href="https://www.rdocumentation.org/packages/data.table/versions/1.12.8/topics/fread">here</a> and use the <code>cmd</code> argument in conjunction with your bash code from (2) to read the data of <code>STATECD</code>, <code>LAT</code>, and <code>LON</code> into a <code>data.table</code> in your R environment.</h5>
<p><strong>Relevant topics:</strong> fread</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Code used to solve the problem.
</li>
<li>
The <code>head</code> of the resulting <code>data.table</code>.
</li>
</ul>
</div>
</div>
<div id="we-are-going-to-further-understand-the-data-from-question-3-by-finding-the-actual-locations-based-on-the-lat-and-lon-columns.-we-can-use-the-library-revgeo-to-get-a-location-given-a-pair-of-longitude-and-latitude-values.-revgeo-uses-a-free-api-hosted-by-photon-in-order-to-do-so.-1" class="section level5">
<h5>4. We are going to further understand the data from question (3) by finding the actual locations based on the <code>LAT</code> and <code>LON</code> columns. We can use the library <code>revgeo</code> to get a location given a pair of longitude and latitude values. <code>revgeo</code> uses a free API hosted by <a href="https://github.com/komoot/photon">photon</a> in order to do so.</h5>
</div>
<div id="for-example-1" class="section level5">
<h5>For example:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(revgeo)
<span class="kw">revgeo</span>(<span class="dt">longitude=</span><span class="op">-</span><span class="fl">86.926153</span>, <span class="dt">latitude=</span><span class="fl">40.427055</span>, <span class="dt">output=</span><span class="st">&#39;frame&#39;</span>)</code></pre></div>
</div>
<div id="the-code-above-will-give-you-the-address-information-in-six-columns-from-the-most-granular-housenumber-to-the-least-granular-country.-depending-on-the-coordinates-revgeo-may-or-may-not-give-you-results-for-each-column.-for-this-question-we-are-going-to-keep-only-the-state-column.-1" class="section level5">
<h5>The code above will give you the address information in six columns, from the most-granular <code>housenumber</code> to the least-granular <code>country</code>. Depending on the coordinates, <code>revgeo</code> may or may not give you results for each column. For this question, we are going to keep only the <code>state</code> column.</h5>
</div>
<div id="there-are-over-4-million-rows-in-our-dataset----we-do-not-want-to-hit-photons-api-that-many-times.-instead-we-are-going-to-do-the-following-1" class="section level5">
<h5>There are over 4 million rows in our dataset -- we do <em>not</em> want to hit <a href="https://github.com/komoot/photon">photon's</a> API that many times. Instead, we are going to do the following:</h5>
</div>
<div id="first-unless-you-feel-comfortable-using-data.table-convert-your-data.table-to-a-data.frame-1" class="section level5">
<h5>First: Unless you feel comfortable using <code>data.table</code>, convert your <code>data.table</code> to a <code>data.frame</code>:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_dataframe &lt;-<span class="st"> </span><span class="kw">data.frame</span>(my_datatable)</code></pre></div>
</div>
<div id="second-calculate-the-average-lat-and-lon-for-each-statecd-and-call-the-new-data.frame-dat.-this-should-result-in-57-rows-of-latlong-pairs.-1" class="section level5">
<h5>Second: Calculate the average <code>LAT</code> and <code>LON</code> for each <code>STATECD</code>, and call the new <code>data.frame</code>, <code>dat</code>. This should result in 57 rows of lat/long pairs.</h5>
</div>
<div id="third-for-each-row-in-dat-run-a-reverse-geocode-and-append-the-state-to-a-new-column-called-state.-1" class="section level5">
<h5>Third: For each row in <code>dat</code>, run a reverse geocode and append the <code>state</code> to a new column called <code>STATE</code>.</h5>
<p><strong>Hint:</strong> To calculate the average <code>LAT</code> and <code>LON</code> for each <code>STATECD</code>, you could use the <a href="https://www.rdocumentation.org/packages/sqldf/versions/0.4-11"><code>sqldf</code></a> package to run SQL queries on your <code>data.frame</code>.</p>
<p><strong>Hint:</strong> <a href="https://stackoverflow.com/questions/3505701/grouping-functions-tapply-by-aggregate-and-the-apply-family"><code>mapply</code></a> is a useful apply function to use to solve this problem.</p>
<p><strong>Hint:</strong> Here is some extra help:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(revgeo)

points &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">latitude=</span><span class="kw">c</span>(<span class="fl">40.433663</span>, <span class="fl">40.432104</span>, <span class="fl">40.428486</span>), <span class="dt">longitude=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">86.916584</span>, <span class="fl">-86.919610</span>, <span class="fl">-86.920866</span>))

<span class="co"># Note that the &quot;output&quot; argument gets passed to the &quot;revgeo&quot; function.</span>
<span class="kw">mapply</span>(revgeo, points<span class="op">$</span>longitude, points<span class="op">$</span>latitude, <span class="dt">output=</span><span class="st">&quot;frame&quot;</span>)

<span class="co"># The output isn&#39;t in a great format, and we&#39;d prefer to just get the &quot;state&quot; data.</span>
<span class="co"># Let&#39;s wrap &quot;revgeo&quot; into another function that just gets &quot;state&quot; and try again.</span>
get_state &lt;-<span class="st"> </span><span class="cf">function</span>(lon, lat) {
  <span class="kw">return</span>(<span class="kw">revgeo</span>(lon, lat, <span class="dt">output=</span><span class="st">&quot;frame&quot;</span>)[<span class="st">&quot;state&quot;</span>])
}

<span class="kw">mapply</span>(get_state, points<span class="op">$</span>longitude, points<span class="op">$</span>latitude)</code></pre></div>
<p><strong>Important note:</strong> It is okay to get &quot;Not Found&quot; for some of the addresses.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-apply-functions">apply functions</a>, sqldf</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Code used to solve the problem.
</li>
<li>
The <code>head</code> of the resulting <code>data.frame</code>.
</li>
</ul>
</div>
</div>
<div id="use-the-leaflet-addtiles-and-addcircles-functions-from-the-leaflet-package-to-map-our-average-latitude-and-longitude-data-from-question-4-to-a-map-should-be-a-total-of-57-latlong-pairs." class="section level5">
<h5>5. Use the <code>leaflet</code>, <code>addTiles</code>, and <code>addCircles</code> functions from the <code>leaflet</code> package to map our average latitude and longitude data from question (4) to a map (should be a total of 57 lat/long pairs).</h5>
<p><strong>Hint:</strong> See <a href="r.html#how-do-i-add-latitude-and-longitude-points-to-a-map-of-purdue-university">here</a> for an example of adding points to a map.</p>
<p><strong>Relevant topics:</strong> <a href="r.html#r-leaflet-example01">leaflet</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Code used to create the map.
</li>
<li>
The map itself as output from running the code chunk.
</li>
</ul>
</div>
</div>
<div id="write-a-bash-script-that-accepts-at-least-1-argument-and-performs-a-useful-task-using-at-least-1-dataset-from-the-forest-folder-in-classdataminedataforest.-an-example-of-a-useful-task-could-be-printing-a-report-of-summary-statistics-for-the-data.-feel-free-to-get-creative.-note-that-tasks-must-be-non-trivial----a-bash-script-that-counts-the-number-of-lines-in-a-file-is-not-appropriate.-make-sure-to-properly-document-via-comments-what-your-bash-script-does.-also-ensure-that-your-script-returns-columnar-data-with-appropriate-separating-characters-for-example-a-csv." class="section level5">
<h5>6. Write a bash script that accepts at least 1 argument, and performs a useful task using at least 1 dataset from the <code>forest</code> folder in <code>/class/datamine/data/forest</code>. An example of a useful task could be printing a report of summary statistics for the data. Feel free to get creative. Note that tasks must be non-trivial -- a bash script that counts the number of lines in a file is <em>not</em> appropriate. Make sure to properly document (via comments) what your bash script does. Also ensure that your script returns columnar data with appropriate separating characters (for example a csv).</h5>
<p><strong>Relevant topics:</strong> <a href="#writing-scripts">bash scripts</a>, <a href="unix.html#awk">awk</a>, <a href="unix.html#unix-utilities">unix utilities</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The content of your bash script starting from <code>#!/bin/bash</code>.
</li>
<li>
Example output from running your script as intended.
</li>
<li>
A description of what your script does.
</li>
</ul>
</div>
</div>
<div id="you-used-fread-in-question-2.-now-use-the-cmd-argument-in-conjunction-with-your-script-from-6-to-read-the-script-output-into-a-data.table-in-your-r-environment." class="section level5">
<h5>7. You used <code>fread</code> in question (2). Now use the <code>cmd</code> argument in conjunction with your script from (6) to read the script output into a <code>data.table</code> in your R environment.</h5>
<p><strong>Relevant topics:</strong> fread</p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The R code used to read in and preprocess your data using your bash script from (6).
</li>
<li>
The <code>head</code> of the resulting <code>data.table</code>.
</li>
</ul>
</div>
<hr />
</div>
</div>
</div>
<div id="fall2020-p15-390" class="section level3">
<h3>Project 15</h3>
<hr />
<p><strong>Motivation:</strong> We've done a lot of work with SQL this semester. Let's review concepts in this project and mix and match R and SQL to solve data-driven problems.</p>
<p><strong>Context:</strong> In this project, we will reinforce topics you've already learned, with a focus on SQL.</p>
<p><strong>Scope:</strong> SQL, sqlite, R</p>
<p><strong>Learning objectives:</strong></p>
<div class="bbox">
<ul>
<li>
Write and run SQL queries in <code>sqlite</code> on real-world data.
</li>
<li>
Use SQL from within R.
</li>
</ul>
</div>
<div id="dataset-39" class="section level4">
<h4>Dataset</h4>
<p>The following questions will use the dataset found in Scholar:</p>
<p><code>/class/datamine/data/movies_and_tv/imdb.db</code></p>
<p>F.R.I.E.N.D.S is a popular tv show. They have an interesting naming convention for the names of their episodes. They all begin with the text &quot;The One ...&quot;. There are 6 primary characters in the show: Chandler, Joey, Monica, Phoebe, Rachel, and Ross. Let's use SQL and R to take a look at how many times each characters' names appear in the title of the episodes.</p>
</div>
<div id="questions-39" class="section level4">
<h4>Questions</h4>
<div id="write-a-query-that-gets-the-episode_title_id-primary_title-rating-and-votes-of-all-of-the-episodes-of-friends-title_id-is-tt0108778.-1" class="section level5">
<h5>1. Write a query that gets the <code>episode_title_id</code>, <code>primary_title</code>, <code>rating</code>, and <code>votes</code>, of all of the episodes of Friends (<code>title_id</code> is tt0108778).</h5>
<p><strong>Hint:</strong> You can slightly modify the solution to question (5) in project 13.</p>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-inner-join">INNER JOIN</a>, subqueries, <a href="sql.html#sql-aliasing">aliasing</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
SQL query used to answer the question.
</li>
<li>
First 5 results of the query.
</li>
</ul>
</div>
</div>
<div id="now-that-you-have-a-working-query-connect-to-the-database-and-run-the-query-to-get-the-data-into-an-r-data-frame.-in-previous-projects-we-learned-how-to-used-regular-expressions-to-search-for-text.-for-each-character-how-many-episodes-primary_titles-contained-their-name-1" class="section level5">
<h5>2. Now that you have a working query, connect to the database and run the query to get the data into an R data frame. In previous projects, we learned how to used regular expressions to search for text. For each character, how many episodes <code>primary_title</code>s contained their name?</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-sql">SQL in R</a>, <a href="r.html#r-grep">grep</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
R code in a code chunk that was used to find the solution.
</li>
<li>
The solution pasted below the code chunk.
</li>
</ul>
</div>
</div>
<div id="create-a-graphic-showing-our-results-in-2-using-your-favorite-package.-make-sure-the-plot-has-a-good-title-x-label-y-label-and-try-to-incorporate-some-of-the-following-colors-273c8b-bd253a-016f7c-f56934-016c5a-9055b1-eaab37." class="section level5">
<h5>3. Create a graphic showing our results in (2) using your favorite package. Make sure the plot has a good title, x-label, y-label, and try to incorporate some of the following colors: #273c8b, #bd253a, #016f7c, #f56934, #016c5a, #9055b1, #eaab37.</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-plotting">plotting</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
The R code used to generate the graphic.
</li>
<li>
The graphic in a png or jpg/jpeg format.
</li>
</ul>
</div>
</div>
<div id="now-we-will-turn-our-focus-to-other-information-in-the-database.-use-a-combination-of-sql-and-r-to-find-which-of-the-following-3-genres-has-the-highest-average-rating-for-movies-see-type-column-from-titles-table-romance-comedy-animation.-in-the-titles-table-you-can-find-the-genres-in-the-genres-column.-there-may-be-some-overlap-i.e.-a-movie-may-have-more-than-one-genre-this-is-ok." class="section level5">
<h5>4. Now we will turn our focus to other information in the database. Use a combination of SQL and R to find which of the following 3 genres has the highest average rating for movies (see <code>type</code> column from <code>titles</code> table): Romance, Comedy, Animation. In the <code>titles</code> table, you can find the genres in the <code>genres</code> column. There may be some overlap (i.e. a movie may have more than one genre), this is ok.</h5>
<p>To query rows which have the genre Action as one of its genres:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> * <span class="kw">FROM</span> titles <span class="kw">WHERE</span> genres <span class="kw">LIKE</span> <span class="st">&#39;%action%&#39;</span>;</code></pre></div>
<p><strong>Relevant topics:</strong> <a href="sql.html#sql-examples">LIKE</a>, <a href="sql.html#sql-inner-join">INNER JOIN</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Any code you used to solve the problem in a code chunk.
</li>
<li>
The average rating of each of the genres listed for movies.
</li>
</ul>
</div>
</div>
<div id="write-a-function-called-top_episode-in-r-which-accepts-the-path-to-the-imdb.db-database-as-well-as-the-title_id-of-a-tv-series-for-example-tt0108778-or-tt1266020-and-returns-the-season_number-episode_number-primary_title-and-rating-of-the-highest-rated-episode-in-the-series.-test-it-out-on-some-of-your-favorite-series-and-share-the-results." class="section level5">
<h5>5. Write a function called <code>top_episode</code> in R which accepts the path to the <code>imdb.db</code> database, as well as the <code>title_id</code> of a tv series (for example, &quot;tt0108778&quot; or &quot;tt1266020&quot;), and returns the <code>season_number</code>, <code>episode_number</code>, <code>primary_title</code>, and <code>rating</code> of the highest rated episode in the series. Test it out on some of your favorite series, and share the results.</h5>
<p><strong>Relevant topics:</strong> <a href="r.html#r-writing-functions">functions</a>, <a href="sql.html#sql-inner-join">INNER JOIN</a>, <a href="sql.html#sql-order-by">ORDER BY</a></p>
<div class="bbox">
<p>
<strong>Item(s) to submit:</strong>
</p>
<ul>
<li>
Any code you used to solve the problem in a code chunk.
</li>
<li>
The results for at least 3 of your favorite tv series.
</li>
</ul>
</div>

</div>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="projects.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="contributors.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/kevinamstutz/the-examples-book/edit/master/10-fall-2020-projects.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["the-datamine-examples.pdf", "the-datamine-examples.epub"],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
