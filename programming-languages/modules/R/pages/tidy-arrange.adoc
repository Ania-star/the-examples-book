= `arrange`

The `arrange` function, coming from the `dplyr` package, orders the contents of a `tibble` by the values of its columns. It's essentially the best way to sort a `tibble`, allowing for groupings to be excluded or included, depending on the situation.

The following example lists the most violent hurricanes in terms of wind speed:

[source,R]
----
arrange(storms, desc(wind))
----
----
# A tibble: 11,859 x 13
   name     year month   day  hour   lat  long status    category  wind
   <chr>   <dbl> <dbl> <int> <dbl> <dbl> <dbl> <chr>     <ord>    <int>
 1 Gilbert  1988     9    14     0  19.7 -83.8 hurricane 5          160
 2 Wilma    2005    10    19    12  17.3 -82.8 hurricane 5          160
 3 Dorian   2019     9     1    16  26.5 -77   hurricane 5          160
 4 Dorian   2019     9     1    18  26.5 -77.1 hurricane 5          160
 5 Gilbert  1988     9    14     6  19.9 -85.3 hurricane 5          155
 6 Mitch    1998    10    26    18  16.9 -83.1 hurricane 5          155
 7 Mitch    1998    10    27     0  17.2 -83.8 hurricane 5          155
 8 Rita     2005     9    22     3  24.7 -87.3 hurricane 5          155
 9 Rita     2005     9    22     6  24.8 -87.6 hurricane 5          155
10 Dorian   2019     9     1    12  26.5 -76.5 hurricane 5          155
# ... with 11,849 more rows, and 3 more variables: pressure <int>,
#   tropicalstorm_force_diameter <int>, hurricane_force_diameter <int>
----

You can also arrange a `tibble` by several variables. Keep in mind this is best done with one or more factors and one target numeric column.

[source,R]
----
txhousing %>% arrange(month, desc(volume))
----
----
# A tibble: 8,602 x 9
   city     year month sales     volume median listings inventory  date
   <chr>   <int> <int> <dbl>      <dbl>  <dbl>    <dbl>     <dbl> <dbl>
 1 Houston  2015     1  4494 1155508809 189300    18649       2.7  2015
 2 Houston  2014     1  4418 1048623186 175600    17882       2.6  2014
 3 Houston  2013     1  4273  852045057 149500    21364       3.7  2013
 4 Houston  2007     1  4645  829875082 141500    35809       5.3  2007
 5 Dallas   2015     1  3066  773952769 203300     9063       1.8  2015
 6 Houston  2008     1  4061  766263358 139500    39790       6.2  2008
 7 Dallas   2007     1  3626  731573846 149300    28328       5.3  2007
 8 Houston  2006     1  4122  727754470 137600    33203       5.4  2006
 9 Dallas   2014     1  3152  720647942 180300    10603       2.1  2014
10 Dallas   2006     1  3457  681032359 149600    26232       5.2  2006
# ... with 8,592 more rows
----

The above line of code orders `txhousing` by month (1 to 12 meaning January to December), then by volume to get a list of largest sales for each month.

Similarly, we can use the `.by_group` parameter to indicate that we want to keep the grouping. Unlike other `tidyverse` aggregate functions, `arrange` will ignore any existing groupings without this specification. This example is taken from the https://dplyr.tidyverse.org/reference/arrange.html[`arrange` documentation].

[source,R]
----
by_cyl <- mtcars %>% group_by(cyl)
by_cyl %>% arrange(desc(wt), .by_group = TRUE)
----
----
# A tibble: 32 x 11
# Groups:   cyl [3]
     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
   <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>
 1  24.4     4 147.     62  3.69  3.19  20       1     0     4     2
 2  22.8     4 141.     95  3.92  3.15  22.9     1     0     4     2
 3  21.4     4 121     109  4.11  2.78  18.6     1     1     4     2
 4  21.5     4 120.     97  3.7   2.46  20.0     1     0     3     1
 5  22.8     4 108      93  3.85  2.32  18.6     1     1     4     1
 6  32.4     4  78.7    66  4.08  2.2   19.5     1     1     4     1
 7  26       4 120.     91  4.43  2.14  16.7     0     1     5     2
 8  27.3     4  79      66  4.08  1.94  18.9     1     1     4     1
 9  33.9     4  71.1    65  4.22  1.84  19.9     1     1     4     1
10  30.4     4  75.7    52  4.93  1.62  18.5     1     1     4     2
# ... with 22 more rows
----

This is similar to our output with the `txhousing` example, but this time we don't have to abandon `by_cyl`.