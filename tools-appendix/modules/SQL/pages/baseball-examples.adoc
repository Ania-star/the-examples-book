


==== Using `lahman`, get a list of attendance by season for the Toronto Blue Jays (`TOR`). What season had the highest attendance?

.Click to see solution
[%collapsible]
====
The Toronto Blue Jays were the 1993 World Series champion, meaning not all World Series-winning teams in MLB are American.

[source,SQL]
----
SELECT
	yearkey,
	attendance
FROM
	homegames
WHERE
	teamkey == 'TOR'
ORDER BY
	attendance DESC
LIMIT 10;
----

[%header,format=csv,stripes=even]
|===
include::../examples/result10.csv[]
|===
====


==== Using `lahman`, figure out how many different leagues have represented Major League Baseball over time.

.Click to see solution
[%collapsible]
====
Major League Baseball has had several leagues that have been represented in its history, though the only leagues currently are the National League and the American League.

[source,SQL]
----
SELECT DISTINCT league FROM leagues;
----

[%header,format=csv,stripes=even]
|===
include::../examples/result11.csv[]
|===
====


==== Using `lahman`, find the teams that have won the World Series.

.Click to see solution
[%collapsible]
====
[source,SQL]
----
SELECT teamID, yearID FROM teams WHERE WSWin=='Y' LIMIT 10;
----

[%header,format=csv,stripes=even]
|===
include::../examples/result12.csv[]
|===
====




==== Using `lahman`, get a printout of the hits (`H`), and home runs (`HR`) for Ichiro Suzuki's career. Answer this question using 2 queries. In the first query, find his `playerID`. In the second query, list the `teamID`, `yearID`, hits (`H`), and home runs (`HR`).

.Click to see solution
[%collapsible]
====
Ichiro Suzuki is regarded as one of the greatest hitters of all time because of his prowess in both American and Japanese professional baseball.

[source,SQL]
----
SELECT
	playerID
FROM
	people
WHERE
	nameFirst == 'Ichiro'
	AND nameLast == 'Suzuki';

SELECT
	teamID,
	yearID,
	H,
	HR
FROM
	batting
WHERE
	playerID == 'suzukic01';
----

[%header,format=csv,stripes=even]
|===
include::../examples/result15.csv[]
|===
====









==== Using `lahman`, make a list of players who walked (`BB`) more than they struck out (`SO`) between 1980 and 1985. Of these players, who walked the most? Use the `BETWEEN` clause in your queries. Use multiple queries.

.Click to see solution
[%collapsible]
====
[source,SQL]
----
SELECT
	playerID,
	yearID,
	teamID,
	BB,
	SO
FROM
	batting
WHERE
	BB > SO
LIMIT 10;
----

[%header,format=csv,stripes=even]
|===
include::../examples/result22.csv[]
|===

[source,SQL]
----
SELECT nameFirst, nameLast FROM people WHERE playerID=='randowi01';
----

[%header,format=csv,stripes=even]
|===
include::../examples/result23.csv[]
|===
====


==== Using `lahman`, figure out how many different National League (`lgID == NL`) catchers (`C`) won the gold glove between 1990 and 2000.

.Click to see solution
[%collapsible]
====
[source,SQL]
----
SELECT DISTINCT
	playerID
FROM
	awardsplayers
WHERE
	awardID == 'Gold Glove'
	AND notes == 'C'
	AND lgID == 'NL'
	AND yearID BETWEEN 1990 AND 2000;
----

[%header,format=csv,stripes=even]
|===
include::../examples/result36.csv[]
|===
====


==== Using `lahman`, figure out how many different 3rd basemen played for the Seattle Mariners between 2000 and 2005. Who had the most errors?

.Click to see solution
[%collapsible]
====
[source,SQL]
----
SELECT DISTINCT
	playerID,
	yearID,
	E
FROM
	fielding
WHERE
	yearID BETWEEN 2000 AND 2005
	AND teamID == 'SEA'
	AND POS == '3B'
ORDER BY
	E DESC
LIMIT 10;
----

[%header,format=csv,stripes=even]
|===
include::../examples/result37.csv[]
|===

[source,SQL]
----
SELECT
	nameFirst,
	nameLast
FROM
	people
WHERE
	playerID == 'camermi01';
----

[%header,format=csv,stripes=even]
|===
include::../examples/result38.csv[]
|===
====









==== Using `lahman`, get the at-bats, home runs, and stolen bases for Roberto Clements by year in ascending order.

.Click to see solution
[%collapsible]
====
[source,SQL]
----
SELECT
	playerID
FROM
	people
WHERE
	nameFirst == 'Roberto'
	AND nameLast == 'Clemente';
----

[%header,format=csv,stripes=even]
|===
include::../examples/result46.csv[]
|===

[source,SQL]
----
SELECT
	yearID,
	AB,
	HR,
	SB
FROM
	battingpost
WHERE
	playerID == 'clemero01'
ORDER BY
	yearID ASC;
----

[%header,format=csv,stripes=even]
|===
include::../examples/result47.csv[]
|===
====







==== Using `lahman`, get a `playerID` list of managers who won more games than they lost (better record than .500) between 1930 and 1950. Get the manager's name and name of their team for the winningest (best record) manager in that time period.

.Click to see solution
[%collapsible]
====
[source,SQL]
----
SELECT
	playerID,
	teamID,
	yearID,
	W,
	L
FROM
	managers
WHERE
	yearID BETWEEN 1930 AND 1950
	AND W > L
ORDER BY
	W DESC
LIMIT 10;
----

[%header,format=csv,stripes=even]
|===
include::../examples/result58.csv[]
|===

[source,SQL]
----
SELECT
	nameFirst,
	nameLast
FROM
	people
WHERE
	playerID == 'mackco01';
----

[%header,format=csv,stripes=even]
|===
include::../examples/result59.csv[]
|===

[source,SQL]
----
SELECT
	franchName
FROM
	teamsfranchises
WHERE
	franchID == 'PHA';
----

[%header,format=csv,stripes=even]
|===
include::../examples/result60.csv[]
|===
====


==== Using `lahman`, get the top 5 seasons for overall attendance for Florida teams (Florida Marlins, Tampa Bay Rays, and Miami Marlins). How many of the top 5 seasons by attendance have been since 2000?

.Click to see solution
[%collapsible]
====
[source,SQL]
----
SELECT
	teamID,
	yearID,
	attendance
FROM
	teams
WHERE
	franchID == 'TBD'
	OR franchID == 'FLA'
ORDER BY
	attendance DESC
LIMIT 10;
----

[%header,format=csv,stripes=even]
|===
include::../examples/result61.csv[]
|===
====


==== Using `lahman`, figure out which pitcher has thrown the most shutouts (`SHO`) in the American League since 2010? What about for the National League? Get the first and last names of the pitchers.

.Click to see solution
[%collapsible]
====
[source,SQL]
----
SELECT
	playerID,
	teamID,
	yearID,
	SHO
FROM
	pitching
WHERE
	yearID > 2010
	AND lgID == 'NL'
ORDER BY
	SHO DESC
LIMIT 10;
----

[%header,format=csv,stripes=even]
|===
include::../examples/result62.csv[]
|===
[source,SQL]
----
SELECT
	playerID,
	teamID,
	yearID,
	SHO
FROM
	pitching
WHERE
	yearID > 2010
	AND lgID == 'AL'
ORDER BY
	SHO DESC
LIMIT 10;
----

[%header,format=csv,stripes=even]
|===
include::../examples/result63.csv[]
|===

[source,SQL]
----
SELECT
	nameFirst,
	nameLast
FROM
	people
WHERE
	playerID == 'leecl02'
	OR playerID == 'hernafe02';
----

[%header,format=csv,stripes=even]
|===
include::../examples/result64.csv[]
|===
====
