= Baseball Examples Using the Lahman Database

These examples depend on this database:

`/anvil/projects/tdm/data/lahman/lahman.db`

== Batting and Pitching

Strikeouts are good for pitchers but bad for batters.  During the 2014 season, which pitcher had the most strikeouts?  Which batter had the most strikeouts?  Be sure to get their full names.

[source,SQL]
----
SELECT p.nameFirst, p.nameLast, t.playerID, t.SO FROM Pitching as t JOIN People as p ON p.playerID = t.playerID WHERE t.yearID = 2014 ORDER BY t.SO DESC LIMIT (1);

SELECT p.nameFirst, p.nameLast, b.playerID, b.SO FROM Batting as b JOIN People as p ON p.playerID = b.playerID WHERE b.yearID = 2014 ORDER BY b.SO DESC LIMIT (1);
----



== AwardsPlayers

Which pitcher has received the `Cy Young Award` the most times altogether?  How many times did he receive this award?

[source,SQL]
----
SELECT COUNT(*) as mycounts, playerID FROM awardsplayers WHERE awardID = 'Cy Young Award' GROUP BY playerID ORDER BY mycounts DESC LIMIT 1;
----



== Parks

Display the ballparks (from the `Parks` table) located in Indiana.

[source,SQL]
----
SELECT * FROM parks WHERE state = 'IN';
----

== Pitching

In recent years, it is rare for pitchers to throw a complete game.  For this question, in each year, consider only the pitchers (from the Pitching table) who pitched at least 1 complete game (in other words, who have `CG > 0`).  In each year, how many players achieved this feat, i.e., had at least one complete game?  (Hint:  In 1871, there were 14 such pitchers, and in 2023, there were 25 such pitchers, but the number changed a lot over the years.)

[source,SQL]
----
SELECT COUNT(*), yearID FROM Pitching WHERE CG > 0 GROUP BY yearID;
----

In recent years, it is rare for pitchers to throw a complete game.  For this question, in each year, consider only the pitchers (from the Pitching table) who pitched at least 1 complete game (in other words, who have `CG > 0`).  In each year, how many players achieved this feat, i.e., had at least one complete game?  (Hint:  In 1871, there were 14 such pitchers, and in 2023, there were 25 such pitchers, but the number changed a lot over the years.)

[source,SQL]
----
SELECT COUNT(*), yearID FROM Pitching WHERE CG > 0 GROUP BY yearID;
----

The term journeyman is one "who plays for numerous clubs during his career":

see https://en.wikipedia.org/wiki/Journeyman_(sports)

Make a list of all of the pitchers who have player for 12 or more teams during their careers.

[source,SQL]
----
SELECT COUNT(DISTINCT teamID) as mycounts, playerID FROM Pitching GROUP BY playerID ORDER BY mycounts DESC LIMIT 15;
----

Calculate Mike Piazza's batting average during each year of his career.

[TIP]
----
A player's batting average during a season is the number of hits (`H`) divided by the number of times at bat (`AB`).  In 1998, his batting average was 0.328.  It is necessary to group the player's statistics within the year (e.g., in case they were traded during the year).  It is also necessary to cast either the hits or the at-bats (or both) as a floating point number (or real number); otherwise, when dividing two integers, the result will be an integer.
----

[source,SQL]
----
SELECT CAST(SUM(b.H) AS FLOAT)/SUM(b.AB), b.yearID FROM People as p JOIN Batting as b ON p.playerID = b.playerID WHERE nameFirst = 'Mike' AND nameLast = 'Piazza' GROUP BY b.yearID;
----



